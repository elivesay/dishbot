From: <Saved by Blink>
Snapshot-Content-Location: https://claude.ai/chat/0d411d32-9e73-4e4c-b308-f2316a7dc3f0
Subject: Robotic dishwashing with vision and 3D reconstruction - Claude
Date: Thu, 5 Feb 2026 20:16:51 -0600
MIME-Version: 1.0
Content-Type: multipart/related;
	type="text/html";
	boundary="----MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----"


------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/html
Content-ID: <frame-3F419C16ED4C4A23A986CF911D0730EE@mhtml.blink>
Content-Transfer-Encoding: quoted-printable
Content-Location: https://claude.ai/chat/0d411d32-9e73-4e4c-b308-f2316a7dc3f0

<!DOCTYPE html><html class=3D"h-screen antialiased scroll-smooth __variable=
_8d1da5 __variable_2d8cf6 __variable_e4ce97 __variable_e4195f __variable_55=
81e8" lang=3D"en-US" data-theme=3D"claude" data-mode=3D"light" data-build-i=
d=3D"afaa5fafb1" data-env=3D"" data-cf-country=3D"US" data-org-plan=3D"free=
" data-p4n=3D"false" style=3D"--font-user-message: var(--font-sans-serif); =
--font-claude-response: var(--font-serif);"><head><meta http-equiv=3D"Conte=
nt-Type" content=3D"text/html; charset=3DUTF-8"><link rel=3D"stylesheet" ty=
pe=3D"text/css" href=3D"cid:css-3693dc1a-8511-4425-bfe1-f034accf4b16@mhtml.=
blink" /><link rel=3D"stylesheet" type=3D"text/css" href=3D"cid:css-1215cd8=
3-0cc1-4c2c-b167-cc23622e7f4c@mhtml.blink" /><link rel=3D"stylesheet" type=
=3D"text/css" href=3D"cid:css-1e190b87-6176-45b6-838d-9e1d95d6047f@mhtml.bl=
ink" /><link rel=3D"stylesheet" href=3D"https://claude.ai/_next/static/css/=
f614b4fc9a5ddba6.css" nonce=3D"" data-precedence=3D"next"><link rel=3D"styl=
esheet" href=3D"https://claude.ai/_next/static/css/c91ff5f87fd3377b.css" no=
nce=3D"" data-precedence=3D"next"><link rel=3D"stylesheet" href=3D"https://=
claude.ai/_next/static/css/05674d3eb9977543.css" nonce=3D"" data-precedence=
=3D"next"><link rel=3D"stylesheet" href=3D"https://claude.ai/_next/static/c=
ss/c2fb8af2f7b87066.css" nonce=3D"" data-precedence=3D"next"><link rel=3D"s=
tylesheet" href=3D"https://claude.ai/_next/static/css/d6bd087f08a7f52f.css"=
 nonce=3D"" data-precedence=3D"next"><link rel=3D"stylesheet" href=3D"https=
://claude.ai/_next/static/css/7bf97b7f00340a78.css" nonce=3D"" data-precede=
nce=3D"next"><link rel=3D"stylesheet" href=3D"https://claude.ai/_next/stati=
c/css/6492ae367fc05efc.css" nonce=3D"" data-precedence=3D"next"><link rel=
=3D"stylesheet" href=3D"https://claude.ai/_next/static/css/1e0cea0e83952274=
.css" nonce=3D"" data-precedence=3D"next"><link rel=3D"stylesheet" href=3D"=
https://claude.ai/_next/static/css/6c432c275096a856.css" nonce=3D"" data-pr=
ecedence=3D"next"><link rel=3D"stylesheet" href=3D"https://claude.ai/_next/=
static/css/acdaad1d23646914.css" nonce=3D"" data-precedence=3D"next"><link =
rel=3D"stylesheet" href=3D"https://claude.ai/_next/static/css/16cce5c2e2346=
66c.css" nonce=3D"" data-precedence=3D"next"><link rel=3D"stylesheet" href=
=3D"https://claude.ai/_next/static/css/608c281e38412b55.css" nonce=3D"" dat=
a-precedence=3D"next"><link rel=3D"preload" as=3D"script" fetchpriority=3D"=
low" nonce=3D"" href=3D"https://claude.ai/_next/static/chunks/webpack-1a860=
c2ce8d48892.js"><link rel=3D"preload" href=3D"https://claude.ai/_next/stati=
c/media/01d1396bd69a228a-s.p.woff2" as=3D"font" crossorigin=3D"" nonce=3D""=
 type=3D"font/woff2"><link rel=3D"preload" href=3D"https://claude.ai/_next/=
static/media/56139cc7a3934d47-s.p.woff2" as=3D"font" crossorigin=3D"" nonce=
=3D"" type=3D"font/woff2"><link rel=3D"preload" href=3D"https://claude.ai/_=
next/static/media/5ab84f5ed5bd55bd-s.p.woff2" as=3D"font" crossorigin=3D"" =
nonce=3D"" type=3D"font/woff2"><link rel=3D"preload" href=3D"https://claude=
.ai/_next/static/media/8d6f5db32d507c08-s.p.woff2" as=3D"font" crossorigin=
=3D"" nonce=3D"" type=3D"font/woff2"><link rel=3D"preload" href=3D"https://=
claude.ai/_next/static/media/a0eafab536ffd221-s.p.woff2" as=3D"font" crosso=
rigin=3D"" nonce=3D"" type=3D"font/woff2"><link rel=3D"preload" href=3D"htt=
ps://claude.ai/_next/static/media/a72997480c14a9d4-s.p.woff2" as=3D"font" c=
rossorigin=3D"" nonce=3D"" type=3D"font/woff2"><link rel=3D"preload" href=
=3D"https://claude.ai/_next/static/media/b8c97ebabd0473a4-s.p.woff2" as=3D"=
font" crossorigin=3D"" nonce=3D"" type=3D"font/woff2"><link rel=3D"preload"=
 href=3D"https://claude.ai/_next/static/media/b96accb76593e50d-s.p.woff2" a=
s=3D"font" crossorigin=3D"" nonce=3D"" type=3D"font/woff2"><link rel=3D"pre=
load" href=3D"https://claude.ai/_next/static/media/c25fe61b276783b5-s.p.wof=
f2" as=3D"font" crossorigin=3D"" nonce=3D"" type=3D"font/woff2"><link rel=
=3D"preload" href=3D"https://claude.ai/_next/static/media/d4ad98ce6ee578c0-=
s.p.woff2" as=3D"font" crossorigin=3D"" nonce=3D"" type=3D"font/woff2"><lin=
k rel=3D"preload" href=3D"https://claude.ai/_next/static/media/fe66948be403=
232d-s.p.woff2" as=3D"font" crossorigin=3D"" nonce=3D"" type=3D"font/woff2"=
><meta name=3D"theme-color" content=3D"hsl(53,28.6%,94.5%)"><link rel=3D"pr=
eload" href=3D"https://a-cdn.claude.ai/v2/EEA5F558-D6AC-4C03-B678-AABF639EE=
69A/api.js" as=3D"script" crossorigin=3D"" integrity=3D"sha384-aKVfzh6pHMnU=
0DTC1bbxwyCfq+4cOCjQD9JPKvAKqKMe7JV23vqhlg8L0PUm9Mr9 sha384-LJBmIH7dES2i1Ws=
1iZFQGfI4OAfe1EJQUbMVZNaldIM4tHx9auaee3EPnZ+qhoY4 sha384-lbvwXIcN7j0C6wFv9z=
4TWGgm/udARINke4Du5xBE65liFXIAKSrjTgMQXyNihsiU sha384-xErVOcgvj7V3c5BC1WmJR=
juVMo/QftLb+ulhj3S2S4Iv0MrueqoHPgtfhkwnmYp1 sha384-estHa4y1pTDxdpgUvRt1+71w=
7VpjUnmVOrlWkEpGjwXsDVtm6RIsiMzgH5t5/ioz sha384-pyWV3WvsHlN0ocuGQmHvtJh4vgC=
+pEryba0oLRfNuPsUeFKC4J1qODl3A+OxXkpQ sha384-ebnuWJWKrAwKiLcZM4RWDN2N7UaAdL=
2X9PPOJea1rA7oPhzSJOGgxtbyP9/hBGx9 sha384-/Q/k0RlPhHkXpk4PLhtQT/9BPbyayBYab=
M1dB77ADzlp+zEET9RjWRgbgMUNPJeG"><link id=3D"googleidentityservice" type=3D=
"text/css" media=3D"all" href=3D"https://accounts.google.com/gsi/style" rel=
=3D"stylesheet"><link rel=3D"preload" as=3D"style" href=3D"https://claude.a=
i/_next/static/css/acdaad1d23646914.css"><link rel=3D"preload" as=3D"style"=
 href=3D"https://claude.ai/_next/static/css/16cce5c2e234666c.css"><link rel=
=3D"preload" as=3D"style" href=3D"https://claude.ai/_next/static/css/608c28=
1e38412b55.css"><meta name=3D"viewport" content=3D"width=3Ddevice-width, in=
itial-scale=3D1, maximum-scale=3D1, viewport-fit=3Dcover"><meta name=3D"nex=
t-size-adjust" content=3D""><title>Robotic dishwashing with vision and 3D r=
econstruction - Claude</title><meta name=3D"description" content=3D"Talk wi=
th Claude, an AI assistant from Anthropic"><link rel=3D"manifest" href=3D"h=
ttps://claude.ai/manifest.json?v=3Dafaa5fafb1"><meta name=3D"apple-itunes-a=
pp" content=3D"app-id=3D6473753684"><meta name=3D"mobile-web-app-capable" c=
ontent=3D"yes"><link href=3D"https://claude.ai/images/claude_app_icon.png" =
rel=3D"apple-touch-startup-image"><meta name=3D"apple-mobile-web-app-status=
-bar-style" content=3D"default"><meta property=3D"og:title" content=3D"Clau=
de"><meta property=3D"og:description" content=3D"Talk with Claude, an AI as=
sistant from Anthropic"><meta property=3D"og:image" content=3D"https://clau=
de.ai/images/claude_ogimage.png"><meta property=3D"og:type" content=3D"webs=
ite"><meta name=3D"twitter:card" content=3D"summary_large_image"><meta name=
=3D"twitter:title" content=3D"Claude"><meta name=3D"twitter:description" co=
ntent=3D"Talk with Claude, an AI assistant from Anthropic"><meta name=3D"tw=
itter:image" content=3D"https://claude.ai/images/claude_ogimage.png"><link =
rel=3D"shortcut icon" href=3D"https://claude.ai/favicon.ico"><link rel=3D"i=
con" href=3D"https://claude.ai/favicon.svg" type=3D"image/svg+xml"><link re=
l=3D"icon" href=3D"https://claude.ai/favicon-32x32.png" sizes=3D"32x32" typ=
e=3D"image/png"><link rel=3D"icon" href=3D"https://claude.ai/favicon-16x16.=
png" sizes=3D"16x16" type=3D"image/png"><link rel=3D"apple-touch-icon" href=
=3D"https://claude.ai/apple-touch-icon.png"></head><body class=3D"bg-bg-100=
 text-text-100 font-ui min-h-screen chat-ui-core" style=3D"pointer-events: =
auto;"><div class=3D"root"><div class=3D"flex min-h-full w-full overflow-x-=
clip relative"><div class=3D"pointer-events-none absolute inset-0 bg-bg-100=
 [background-image:linear-gradient(to_right,hsl(var(--bg-200))_1px,transpar=
ent_1px),linear-gradient(to_bottom,hsl(var(--bg-200))_1px,transparent_1px)]=
 [background-size:32px_32px]" aria-hidden=3D"true" style=3D"clip-path: circ=
le(150% at 50% 50%); opacity: 0;"></div><div class=3D"shrink-0" style=3D"ov=
erflow: hidden; width: auto; opacity: 1;"><div class=3D"fixed z-sidebar lg:=
sticky" style=3D"width: 18rem;"><nav class=3D"flex flex-col px-0 fixed left=
-0 border-r-0.5 h-screen lg:bg-gradient-to-t from-bg-200/5 to-bg-200/30 sha=
dow-lg lg:shadow-none border-border-300 bg-bg-100 transition-[background-co=
lor,border-color,box-shadow] duration-[35ms]" aria-label=3D"Sidebar" style=
=3D"width: 18rem; top: 0px; padding-top: var(--app-install-banner-height, 0=
px);"><div class=3D"relative flex w-full items-center p-2 pt-2"><div class=
=3D"flex items-center gap-1.5 pl-2 h-8 overflow-hidden transition-opacity d=
uration-150 opacity-100"><a class=3D"flex flex-col justify-start items-top"=
 aria-label=3D"Home" tabindex=3D"0" href=3D"https://claude.ai/new"><svg xml=
ns=3D"http://www.w3.org/2000/svg" viewBox=3D"0 0 68 16" class=3D"h-4 flex-s=
hrink-0 text-text-100" height=3D"16" fill=3D"currentColor" aria-label=3D"Cl=
aude"><path d=3D"M7.98 15.73C6.50667 15.73 5.17667 15.4367 3.99 14.85C2.81 =
14.2567 1.88 13.4167 1.2 12.33C0.526669 11.2367 0.190002 9.96334 0.190002 8=
.51001C0.190002 7.01001 0.526669 5.67334 1.2 4.50001C1.87334 3.32668 2.8 2.=
41668 3.98 1.77001C5.16667 1.11668 6.49334 0.790009 7.96 0.790009C8.88667 0=
.790009 9.81667 0.896676 10.75 1.11001C11.69 1.32334 12.5033 1.64001 13.19 =
2.06001V5.36001H12.29C12.05 4.22668 11.5867 3.36334 10.9 2.77001C10.2133 2.=
17668 9.24 1.88001 7.98 1.88001C6.85334 1.88001 5.91334 2.15334 5.16 2.7000=
1C4.40667 3.24001 3.84667 3.98334 3.48 4.93001C3.12 5.87001 2.94 6.94668 2.=
94 8.16001C2.94 9.37334 3.14667 10.4733 3.56 11.46C3.97334 12.44 4.57667 13=
.2167 5.37 13.79C6.16334 14.3567 7.11 14.64 8.21 14.64C8.97667 14.64 9.6366=
7 14.4733 10.19 14.14C10.75 13.8 11.2167 13.3533 11.59 12.8C11.97 12.2467 1=
2.3367 11.5667 12.69 10.76H13.63L12.99 14.43C12.35 14.8567 11.5733 15.18 10=
.66 15.4C9.75334 15.62 8.86 15.73 7.98 15.73ZM15.15 14.63C15.4833 14.5833 1=
5.7433 14.53 15.93 14.47C16.1167 14.41 16.2633 14.3167 16.37 14.19C16.4767 =
14.0567 16.53 13.8733 16.53 13.64V2.96001L15.15 2.31001V1.65001L18.12 0.260=
01H18.91V13.64C18.91 13.8733 18.9633 14.0567 19.07 14.19C19.1767 14.3167 19=
.3233 14.41 19.51 14.47C19.6967 14.53 19.96 14.5833 20.3 14.63V15.5H15.15V1=
4.63ZM24.44 15.73C23.8867 15.73 23.39 15.6167 22.95 15.39C22.51 15.1567 22.=
1667 14.8367 21.92 14.43C21.68 14.0233 21.56 13.5567 21.56 13.03C21.56 12.2=
633 21.7967 11.6233 22.27 11.11C22.75 10.5967 23.47 10.2033 24.43 9.93001L2=
7.87 8.96001V7.56001C27.87 6.85334 27.7033 6.31668 27.37 5.95001C27.0433 5.=
58334 26.5633 5.40001 25.93 5.40001C25.37 5.40001 24.93 5.57668 24.61 5.930=
01C24.2967 6.27668 24.14 6.75668 24.14 7.37001V8.35001H22.47C22.2833 8.2300=
1 22.1367 8.06334 22.03 7.85001C21.93 7.63668 21.88 7.40334 21.88 7.15001C2=
1.88 6.67668 22.06 6.24001 22.42 5.84001C22.78 5.43334 23.2633 5.11334 23.8=
7 4.88001C24.4833 4.64668 25.16 4.53001 25.9 4.53001C26.8133 4.53001 27.593=
3 4.67334 28.24 4.96001C28.8933 5.24668 29.39 5.66668 29.73 6.22001C30.0767=
 6.77334 30.25 7.43668 30.25 8.21001V13.5C30.25 13.7333 30.29 13.9133 30.37=
 14.04C30.45 14.1667 30.5867 14.2667 30.78 14.34C30.98 14.4133 31.2633 14.4=
767 31.63 14.53V15.39C31.0967 15.5967 30.5633 15.7 30.03 15.7C29.4367 15.7 =
28.9567 15.56 28.59 15.28C28.23 15 28.0067 14.6 27.92 14.08C27.44 14.62 26.=
9067 15.03 26.32 15.31C25.7333 15.59 25.1067 15.73 24.44 15.73ZM25.62 14.13=
C26.0067 14.13 26.3967 14.0433 26.79 13.87C27.1833 13.69 27.5433 13.4433 27=
.87 13.13V9.87001L25.43 10.61C24.9233 10.7567 24.5433 10.99 24.29 11.31C24.=
0433 11.6233 23.92 12.0267 23.92 12.52C23.92 12.8267 23.9933 13.1033 24.14 =
13.35C24.2867 13.59 24.49 13.78 24.75 13.92C25.01 14.06 25.3 14.13 25.62 14=
.13ZM36.56 15.73C35.48 15.73 34.68 15.4467 34.16 14.88C33.6467 14.3133 33.3=
9 13.53 33.39 12.53V6.91001L32.01 6.37001V5.70001L34.98 4.53001H35.77V12.12=
C35.77 12.7533 35.9233 13.2233 36.23 13.53C36.5433 13.8367 37.0133 13.99 37=
.64 13.99C38.0533 13.99 38.4833 13.8967 38.93 13.71C39.3833 13.5167 39.8 13=
.27 40.18 12.97V6.91001L38.8 6.37001V5.70001L41.77 4.53001H42.56V12.91C42.5=
6 13.17 42.6133 13.37 42.72 13.51C42.8333 13.65 42.9833 13.7533 43.17 13.82=
C43.3567 13.88 43.6167 13.9333 43.95 13.98V14.84L40.97 15.69H40.18V13.96C39=
.6667 14.4933 39.0867 14.9233 38.44 15.25C37.8 15.57 37.1733 15.73 36.56 15=
.73ZM49.61 15.73C48.7367 15.73 47.9567 15.51 47.27 15.07C46.5833 14.6233 46=
.0467 14.02 45.66 13.26C45.28 12.5 45.09 11.66 45.09 10.74C45.09 9.56668 45=
.3167 8.51001 45.77 7.57001C46.2233 6.63001 46.8733 5.89001 47.72 5.35001C4=
8.5733 4.80334 49.5767 4.53001 50.73 4.53001C51.0767 4.53001 51.43 4.56668 =
51.79 4.64001C52.15 4.70668 52.4967 4.81001 52.83 4.95001V2.96001L51.45 2.3=
1001V1.65001L54.42 0.26001H55.21V12.91C55.21 13.17 55.2633 13.37 55.37 13.5=
1C55.4833 13.65 55.6333 13.7533 55.82 13.82C56.0067 13.88 56.2667 13.9333 5=
6.6 13.98V14.84L53.62 15.69H52.83V14.39C52.3833 14.8167 51.8867 15.1467 51.=
34 15.38C50.7933 15.6133 50.2167 15.73 49.61 15.73ZM50.6 14.12C50.9867 14.1=
2 51.3733 14.0467 51.76 13.9C52.1467 13.7467 52.5033 13.5367 52.83 13.27V6.=
38001C52.2567 5.92001 51.6167 5.69001 50.91 5.69001C50.1767 5.69001 49.5567=
 5.89001 49.05 6.29001C48.55 6.68334 48.1767 7.21334 47.93 7.88001C47.69 8.=
54668 47.57 9.28334 47.57 10.09C47.57 10.8567 47.6767 11.5433 47.89 12.15C4=
8.11 12.7567 48.4467 13.2367 48.9 13.59C49.3533 13.9433 49.92 14.12 50.6 14=
.12ZM62.93 15.73C61.9433 15.73 61.0533 15.4967 60.26 15.03C59.4733 14.5567 =
58.8567 13.9033 58.41 13.07C57.9633 12.2367 57.74 11.3 57.74 10.26C57.74 9.=
18001 57.9667 8.20334 58.42 7.33001C58.88 6.45668 59.51 5.77334 60.31 5.280=
01C61.1167 4.78001 62.0167 4.53001 63.01 4.53001C63.77 4.53001 64.4667 4.68=
668 65.1 5.00001C65.7333 5.31334 66.2567 5.76001 66.67 6.34001C67.09 6.9200=
1 67.37 7.59001 67.51 8.35001L60.14 10.66C60.3333 11.62 60.7267 12.38 61.32=
 12.94C61.92 13.4933 62.67 13.77 63.57 13.77C64.31 13.77 64.9767 13.5733 65=
.57 13.18C66.17 12.78 66.7 12.18 67.16 11.38L67.93 11.63C67.7633 12.4433 67=
.44 13.16 66.96 13.78C66.4867 14.4 65.9 14.88 65.2 15.22C64.5067 15.56 63.7=
5 15.73 62.93 15.73ZM64.95 8.03001C64.8567 7.55668 64.6933 7.14001 64.46 6.=
78001C64.2267 6.42001 63.94 6.14001 63.6 5.94001C63.2667 5.74001 62.9033 5.=
64001 62.51 5.64001C62.01 5.64001 61.57 5.79334 61.19 6.10001C60.8167 6.400=
01 60.5267 6.83001 60.32 7.39001C60.1133 7.95001 60.01 8.60001 60.01 9.3400=
1C60.01 9.46668 60.0133 9.56334 60.02 9.63001L64.95 8.03001Z"></path></svg>=
</a></div><div class=3D"absolute right-2 top-2"><button class=3D"inline-fle=
x
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group Button_ghost__BUAoh" type=3D"button" data-testid=3D"pin-side=
bar-toggle" aria-label=3D"Close sidebar" aria-pressed=3D"true" data-state=
=3D"closed"><div class=3D"relative size-4 flex items-center justify-center"=
><div class=3D"transition text-text-400 group-hover:text-text-100" style=3D=
"width: 20px; height: 20px; display: flex; align-items: center; justify-con=
tent: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=
=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"transition =
text-text-400 group-hover:text-text-100" aria-hidden=3D"true" style=3D"flex=
-shrink: 0;"><path d=3D"M16.5 4C17.3284 4 18 4.67157 18 5.5V14.5C18 15.3284=
 17.3284 16 16.5 16H3.5C2.67157 16 2 15.3284 2 14.5V5.5C2 4.67157 2.67157 4=
 3.5 4H16.5ZM7 15H16.5C16.7761 15 17 14.7761 17 14.5V5.5C17 5.22386 16.7761=
 5 16.5 5H7V15ZM3.5 5C3.22386 5 3 5.22386 3 5.5V14.5C3 14.7761 3.22386 15 3=
.5 15H6V5H3.5Z"></path></svg></div></div></button></div></div><div class=3D=
"flex flex-col flex-grow align-center overflow-hidden min-h-0" aria-hidden=
=3D"false"><div class=3D"flex flex-col gap-px pt-2"><div class=3D"px-2"><di=
v class=3D"relative group" data-state=3D"closed"><a class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" aria-label=3D"New chat" data-dd-action-=
name=3D"sidebar-new-item" href=3D"https://claude.ai/new"><div class=3D"-tra=
nslate-x-2 w-full flex flex-row items-center justify-start gap-3"><div clas=
s=3D"flex items-center justify-center text-text-100"><div class=3D"flex ite=
ms-center justify-center rounded-full transition-all ease-in-out group-hove=
r:-rotate-3 group-hover:scale-110 group-active:rotate-6 group-active:scale-=
[0.98]"><div class=3D"flex items-center justify-center rounded-full size-[1=
.4rem] -mx-[0.2rem] bg-text-500/15 active:bg-text-200 group-hover:bg-text-5=
00/25"><svg width=3D"16" height=3D"16" viewBox=3D"0 0 20 20" fill=3D"curren=
tColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-text-300 group-h=
over:text-text-000" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=
=3D"M10 3C10.4142 3 10.75 3.33579 10.75 3.75V9.25H16.25C16.6642 9.25 17 9.5=
8579 17 10C17 10.3882 16.7051 10.7075 16.3271 10.7461L16.25 10.75H10.75V16.=
25C10.75 16.6642 10.4142 17 10 17C9.58579 17 9.25 16.6642 9.25 16.25V10.75H=
3.75C3.33579 10.75 3 10.4142 3 10C3 9.58579 3.33579 9.25 3.75 9.25H9.25V3.7=
5C9.25 3.33579 9.58579 3 10 3Z"></path></svg></div></div></div><span class=
=3D"truncate text-sm whitespace-nowrap flex-1"><div class=3D"opacity-100 tr=
ansition-opacity ease-out duration-150">New chat</div></span><span class=3D=
"flex items-center flex-shrink-0 -mr-2 opacity-0 group-hover:opacity-100 tr=
ansition-opacity duration-75"><span class=3D"text-text-500 text-xs px-0.5">=
=E2=87=A7=E2=8C=98O</span></span></div></a><div class=3D"absolute right-0 t=
op-1/2 -translate-y-1/2 transition-opacity duration-150 hidden group-hover:=
block group-focus-within:block opacity-0 group-hover:opacity-100 group-focu=
s-within:opacity-100"></div></div></div></div><div class=3D"flex flex-grow =
flex-col overflow-y-auto overflow-x-hidden relative transition-[border-colo=
r] !outline-none border-t-0.5 border-transparent" tabindex=3D"-1"><div clas=
s=3D"flex flex-col px-2 gap-px"><div class=3D"relative group" data-state=3D=
"closed"><a class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" aria-label=3D"Chats" data-dd-action-nam=
e=3D"sidebar-nav-item" href=3D"https://claude.ai/recents"><div class=3D"-tr=
anslate-x-2 w-full flex flex-row items-center justify-start gap-3"><div cla=
ss=3D"flex items-center justify-center text-text-100"><div class=3D"group" =
style=3D"width: 16px; height: 16px; display: flex; align-items: center; jus=
tify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20=
" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"group=
" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path class=3D"group-hover=
:-translate-x-[0.5px] transition group-active:translate-x-0" d=3D"M8.99962 =
2C12.3133 2 14.9996 4.68629 14.9996 8C14.9996 11.3137 12.3133 14 8.99962 14=
H2.49962C2.30105 13.9998 2.12113 13.8821 2.04161 13.7002C1.96224 13.5181 1.=
99835 13.3058 2.1334 13.1602L3.93516 11.2178C3.34317 10.2878 2.99962 9.1834=
3 2.99962 8C2.99962 4.68643 5.68609 2.00022 8.99962 2ZM8.99962 3C6.23838 3.=
00022 3.99961 5.23871 3.99961 8C3.99961 9.11212 4.36265 10.1386 4.97618 10.=
9688C5.11884 11.1621 5.1035 11.4293 4.94004 11.6055L3.64512 13H8.99962C11.7=
61 13 13.9996 10.7614 13.9996 8C13.9996 5.23858 11.761 3 8.99962 3Z"></path=
><path class=3D"group-hover:translate-x-[0.5px] transition group-active:tra=
nslate-x-0" d=3D"M16.5445 9.72754C16.4182 9.53266 16.1678 9.44648 15.943 9.=
53418C15.7183 9.62215 15.5932 9.85502 15.6324 10.084L15.7369 10.3955C15.907=
3 10.8986 16.0006 11.438 16.0006 12C16.0006 13.1123 15.6376 14.1386 15.024 =
14.9687C14.8811 15.1621 14.8956 15.4302 15.0592 15.6064L16.3531 17H11.0006C=
9.54519 17 8.23527 16.3782 7.32091 15.3848L7.07091 15.1103C6.88996 14.9645 =
6.62535 14.9606 6.43907 15.1143C6.25267 15.2682 6.20668 15.529 6.31603 15.7=
344L6.58458 16.0625C7.68048 17.253 9.25377 18 11.0006 18H17.5006C17.6991 17=
.9998 17.8791 17.8822 17.9586 17.7002C18.038 17.5181 18.0018 17.3058 17.866=
8 17.1602L16.0631 15.2178C16.6554 14.2876 17.0006 13.1837 17.0006 12C17.000=
6 11.3271 16.8891 10.6792 16.6842 10.0742L16.5445 9.72754Z"></path></svg></=
div></div><span class=3D"truncate text-sm whitespace-nowrap flex-1"><div cl=
ass=3D"opacity-100 transition-opacity ease-out duration-150">Chats</div></s=
pan></div></a><div class=3D"absolute right-0 top-1/2 -translate-y-1/2 trans=
ition-opacity duration-150 hidden group-hover:block group-focus-within:bloc=
k opacity-0 group-hover:opacity-100 group-focus-within:opacity-100"></div><=
/div><div class=3D"relative group" data-state=3D"closed"><a class=3D"inline=
-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" aria-label=3D"Projects" data-dd-action-=
name=3D"sidebar-nav-item" href=3D"https://claude.ai/projects"><div class=3D=
"-translate-x-2 w-full flex flex-row items-center justify-start gap-3"><div=
 class=3D"flex items-center justify-center text-text-100"><div class=3D"gro=
up" style=3D"width: 16px; height: 16px; display: flex; align-items: center;=
 justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 2=
0 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"g=
roup" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path class=3D"group-h=
over:scale-95 origin-center" d=3D"M15.8198 7C16.6885 7.00025 17.3624 7.7315=
8 17.3178 8.57617L17.2993 8.74707L16.1332 15.7471C16.0126 16.4699 15.3865 1=
6.9996 14.6538 17H5.34711C4.6142 16.9998 3.98833 16.47 3.86762 15.7471L2.70=
16 8.74707C2.54922 7.83277 3.25418 7 4.18109 7H15.8198ZM4.18109 8C3.87216 8=
 3.63722 8.27731 3.68793 8.58203L4.85394 15.582C4.89413 15.8229 5.10291 15.=
9998 5.34711 16H14.6538C14.8978 15.9996 15.1068 15.8228 15.1469 15.582L16.3=
129 8.58203L16.3188 8.46973C16.3036 8.21259 16.0899 8.00023 15.8198 8H4.181=
09Z"></path><path class=3D"group-hover:-translate-y-[1.4px] group-hover:tra=
nslate-x-[0.5px] group-hover:rotate-3 transition group-active:translate-y-0=
" d=3D"M16.0004 5.5C16.0004 5.224 15.7764 5.00024 15.5004 5H4.50043C4.22428=
 5 4.00043 5.22386 4.00043 5.5C4.00043 5.77614 4.22428 6 4.50043 6H15.5004C=
15.7764 5.99976 16.0004 5.776 16.0004 5.5Z"></path><path class=3D"group-hov=
er:-translate-y-[2.8px] group-hover:translate-x-px group-hover:rotate-6 tra=
nsition group-active:translate-y-0" d=3D"M14.5004 3.5C14.5004 3.224 14.2764=
 3.00024 14.0004 3H6.00043C5.72428 3 5.50043 3.22386 5.50043 3.5C5.50043 3.=
77614 5.72428 4 6.00043 4H14.0004C14.2764 3.99976 14.5004 3.776 14.5004 3.5=
Z"></path></svg></div></div><span class=3D"truncate text-sm whitespace-nowr=
ap flex-1"><div class=3D"opacity-100 transition-opacity ease-out duration-1=
50">Projects</div></span></div></a><div class=3D"absolute right-0 top-1/2 -=
translate-y-1/2 transition-opacity duration-150 hidden group-hover:block gr=
oup-focus-within:block opacity-0 group-hover:opacity-100 group-focus-within=
:opacity-100"></div></div><div><div class=3D"relative group" data-state=3D"=
closed"><a class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" aria-label=3D"Artifacts" data-dd-action=
-name=3D"sidebar-nav-item" href=3D"https://claude.ai/artifacts"><div class=
=3D"-translate-x-2 w-full flex flex-row items-center justify-start gap-3"><=
div class=3D"flex items-center justify-center text-text-100"><div class=3D"=
group backface-hidden" style=3D"width: 16px; height: 16px; display: flex; a=
lign-items: center; justify-content: center;"><svg width=3D"20" height=3D"2=
0" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2=
000/svg" class=3D"group backface-hidden" aria-hidden=3D"true" style=3D"flex=
-shrink: 0;"><path fill-rule=3D"evenodd" clip-rule=3D"evenodd" d=3D"M6.3535=
2 3.1464L9.35352 6.14642C9.43935 6.25103 9.5 6.36003 9.5 6.50091C9.4998 6.6=
332 9.44704 6.75988 9.35352 6.85346L6.35352 9.85347C6.14584 10.0609 5.85611=
 10.0243 5.64648 9.85347L2.64648 6.85346C2.55296 6.75988 2.5002 6.6332 2.5 =
6.50091C2.5 6.36841 2.55285 6.24017 2.64648 6.14642L5.64648 3.1464C5.8552 2=
.97421 6.14635 2.93936 6.35352 3.1464ZM6 8.79194L3.70703 6.49994L6 4.20696L=
8.29297 6.49994L6 8.79194Z"></path><path class=3D"group-hover:-rotate-90 tr=
ansition-transform duration-200 ease-snappy-out" d=3D"M16.8984 3.7509C16.98=
75 3.90632 16.986 4.09826 16.8955 4.25286L15.5791 6.49994L16.8955 8.74702C1=
6.986 8.90159 16.9874 9.09354 16.8984 9.24898C16.8093 9.40436 16.643 9.4999=
6 16.4638 9.49996H11.5C11.3198 9.49996 11.1532 9.4028 11.0644 9.24605C10.97=
6 9.08949 10.9789 8.89736 11.0713 8.74312L12.417 6.49994L11.0713 4.25676C10=
.9789 4.1025 10.976 3.91037 11.0644 3.75383C11.1532 3.59717 11.3199 3.49992=
 11.5 3.49992H16.4638C16.6429 3.51309 16.8055 3.58909 16.8984 3.7509ZM13.42=
87 6.2431C13.5152 6.4107 13.5166 6.58638 13.4287 6.75678L12.3828 8.49995H15=
.5918L14.5683 6.75287C14.477 6.59683 14.477 6.40303 14.5683 6.24701L15.5918=
 4.49993H12.3828L13.4287 6.2431Z" style=3D"transform-origin: 14px 6.5px;"><=
/path><path class=3D"group-hover:rotate-[120deg] transition-transform durat=
ion-200 ease-snappy-out" fill-rule=3D"evenodd" clip-rule=3D"evenodd" d=3D"M=
7.25293 10.9668C7.40708 10.8793 7.59647 10.8801 7.75 10.9687C7.90356 11.057=
4 7.99869 11.2211 8 11.3984L8.01074 12.8388L9.30762 13.6054C9.42811 13.6994=
 9.49994 13.8448 9.5 14C9.5 14.1773 9.40587 14.3418 9.25293 14.4316L8.01074=
 15.1601L7.99512 16.667C7.97406 16.8184 7.88446 16.9536 7.75 17.0312C7.5964=
2 17.1199 7.40713 17.1207 7.25293 17.0332L6 16.3203L4.74707 17.0332C4.59287=
 17.1207 4.40358 17.1199 4.25 17.0312C4.09643 16.9425 4.00124 16.7789 4 16.=
6015L3.99023 15.1601L2.74707 14.4316C2.59413 14.3418 2.5 14.1773 2.5 14C2.5=
0006 13.8448 2.57188 13.6994 2.69238 13.6054L3.99023 12.8388L4 11.3984C4.00=
131 11.2211 4.09644 11.0574 4.25 10.9687C4.40353 10.8801 4.59292 10.8793 4.=
74707 10.9668L6 11.6787L7.25293 10.9668ZM4.99512 12.2568L5.75293 12.6884C5.=
90608 12.7754 6.09392 12.7754 6.24707 12.6884L7.00586 12.2568L7.01172 13.13=
08C7.01308 13.3068 7.10706 13.4695 7.25879 13.5586L8.01172 14L7.25879 14.44=
14C7.10706 14.5304 7.01315 14.6932 7.01172 14.8691L7.00586 15.7422L6.24707 =
15.3115C6.09397 15.2246 5.90603 15.2246 5.75293 15.3115L4.99512 15.7422L4.9=
8828 14.8691C4.98703 14.7152 4.91459 14.5716 4.79492 14.4785L3.98926 14L4.7=
4121 13.5586C4.87421 13.4805 4.96267 13.3457 4.9834 13.1953L4.99512 12.2568=
Z" style=3D"transform-origin: 6px 14px;"></path><path fill-rule=3D"evenodd"=
 clip-rule=3D"evenodd" d=3D"M14 11C15.6568 11 16.9999 12.3432 17 14C17 15.6=
568 15.6569 17 14 17C12.3431 17 11 15.6568 11 14C11.0001 12.3432 12.3432 11=
 14 11ZM12 14C12.0001 12.8955 12.8955 12 14 12C15.1045 12 15.9999 12.8955 1=
6 14C16 15.1045 15.1046 16 14 16C12.8954 16 12 15.1045 12 14Z"></path></svg=
></div></div><span class=3D"truncate text-sm whitespace-nowrap flex-1"><div=
 class=3D"opacity-100 transition-opacity ease-out duration-150 flex items-c=
enter gap-2">Artifacts</div></span></div></a><div class=3D"absolute right-0=
 top-1/2 -translate-y-1/2 transition-opacity duration-150 hidden group-hove=
r:block group-focus-within:block opacity-0 group-hover:opacity-100 group-fo=
cus-within:opacity-100"></div></div></div><div class=3D"relative group" dat=
a-state=3D"closed"><a class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" aria-label=3D"Code" data-dd-action-name=
=3D"sidebar-nav-item" target=3D"_blank" href=3D"https://claude.com/product/=
claude-code"><div class=3D"-translate-x-2 w-full flex flex-row items-center=
 justify-start gap-3"><div class=3D"flex items-center justify-center text-t=
ext-100"><div class=3D"group" style=3D"width: 16px; height: 16px; display: =
flex; align-items: center; justify-content: center;"><svg width=3D"20" heig=
ht=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w=
3.org/2000/svg" class=3D"group" aria-hidden=3D"true" style=3D"flex-shrink: =
0;"><path class=3D"transition" d=3D"M11.6318 4.01757C11.898 4.09032 12.055 =
4.36555 11.9824 4.63183L8.98242 15.6318C8.90966 15.8981 8.63449 16.0551 8.3=
6816 15.9824C8.10193 15.9097 7.94495 15.6345 8.01758 15.3682L11.0176 4.3681=
6C11.0904 4.102 11.3656 3.94497 11.6318 4.01757Z"></path><path class=3D"gro=
up-hover:translate-x-[1px] transition" d=3D"M13.124 6.17089C13.3059 5.96325=
 13.6213 5.9423 13.8291 6.12402L17.8291 9.62402L17.9014 9.70215C17.9647 9.7=
8754 18 9.89182 18 10C18 10.1441 17.9375 10.281 17.8291 10.376L13.8291 13.8=
76L13.7471 13.9346C13.5449 14.0498 13.2833 14.011 13.124 13.8291C12.9649 13=
.6472 12.9606 13.3824 13.1016 13.1973L13.1709 13.124L16.7412 10L13.1709 6.8=
7597C12.9632 6.69411 12.9422 6.37866 13.124 6.17089Z"></path><path class=3D=
"group-hover:-translate-x-[1px] transition" d=3D"M6.25293 6.06542C6.45509 5=
.95025 6.71675 5.98908 6.87598 6.17089C7.03513 6.35279 7.03933 6.6176 6.898=
44 6.80273L6.8291 6.87597L3.25879 10L6.8291 13.124C7.03682 13.3059 7.05771 =
13.6213 6.87598 13.8291C6.69413 14.0369 6.37869 14.0578 6.1709 13.876L2.170=
9 10.376L2.09863 10.2979C2.03528 10.2124 2 10.1082 2 10C2.00005 9.85591 2.0=
6247 9.71893 2.1709 9.62402L6.1709 6.12402L6.25293 6.06542Z"></path></svg><=
/div></div><span class=3D"truncate text-sm whitespace-nowrap flex-1"><div><=
div class=3D"opacity-100 transition-opacity ease-out duration-150">Code</di=
v><div class=3D"absolute -right-2 top-1/2 -translate-y-1/2 opacity-0 group-=
hover:opacity-50 transition duration-75" style=3D"width: 20px; height: 20px=
; display: flex; align-items: center; justify-content: center;"><svg width=
=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"=
http://www.w3.org/2000/svg" class=3D"absolute -right-2 top-1/2 -translate-y=
-1/2 opacity-0 group-hover:opacity-50 transition duration-75" aria-hidden=
=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M14.4999 5.00017C14.776 5.00=
017 14.9999 5.22403 14.9999 5.50017V12.5002C14.9998 12.7762 14.7759 13.0002=
 14.4999 13.0002C14.2239 13.0001 14 12.7762 13.9999 12.5002V6.7072L5.85338 =
14.8537C5.6581 15.0488 5.34155 15.0489 5.14635 14.8537C4.95116 14.6585 4.95=
127 14.3419 5.14635 14.1467L13.2928 6.00017H7.49986C7.22387 6.00006 6.99995=
 5.77617 6.99986 5.50017C6.99986 5.22409 7.22381 5.00028 7.49986 5.00017H14=
.4999Z"></path></svg></div></div></span></div></a><div class=3D"absolute ri=
ght-0 top-1/2 -translate-y-1/2 transition-opacity duration-150 hidden group=
-hover:block group-focus-within:block opacity-0 group-hover:opacity-100 gro=
up-focus-within:opacity-100"></div></div></div><div class=3D"flex-1 relativ=
e"><div class=3D"opacity-100 transition-opacity ease-out duration-150" aria=
-hidden=3D"false"><div class=3D"px-2 mt-4"><div class=3D"flex flex-col flex=
-grow"><div class=3D"flex items-center justify-between mb-2"><h3 aria-hidde=
n=3D"false" role=3D"button" aria-expanded=3D"true" class=3D"text-text-500 p=
b-2 mt-1 text-xs select-none pl-2 pr-2 group/header cursor-pointer flex ite=
ms-center justify-between gap-2" tabindex=3D"0">Recents<span class=3D"text-=
text-400 opacity-0 group-hover/header:opacity-75 transition-opacity">Hide</=
span></h3></div><ul class=3D"flex flex-col gap-px"><li style=3D"opacity: 1;=
"><div class=3D"relative group" data-state=3D"closed"><a class=3D"inline-fl=
ex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 !bg-bg-300 active:bg-=
bg-300 active:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sideb=
ar-chat-item" href=3D"https://claude.ai/chat/0d411d32-9e73-4e4c-b308-f2316a=
7dc3f0"><div class=3D"-translate-x-2 w-full flex flex-row items-center just=
ify-start gap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 g=
roup-hover:[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78=
%,transparent_95%)] group-focus-within:[mask-image:linear-gradient(to_right=
,hsl(var(--always-black))_78%,transparent_95%)] [mask-size:100%_100%] [mask=
-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transparent_95=
%)]">Robotic dishwashing with vision and 3D reconstruction</span></div></a>=
<div class=3D"absolute right-0 top-1/2 -translate-y-1/2 transition-opacity =
duration-150 block opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Robotic dishwashing with visio=
n and 3D reconstruction" id=3D"radix-_r_3h_" aria-haspopup=3D"menu" aria-ex=
panded=3D"false" data-state=3D"closed"><div style=3D"width: 20px; height: 2=
0px; display: flex; align-items: center; justify-content: center;"><svg wid=
th=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: =
0;"><path d=3D"M4.5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4=
.5 11.5C3.67157 11.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C1=
0.8284 8.5 11.5 9.17157 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 1=
1.5 8.5 10.8284 8.5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5=
 17 9.17157 17 10C17 10.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284=
 14 10C14 9.17157 14.6716 8.5 15.5 8.5Z"></path></svg></div></button></div>=
</div></li><li style=3D"opacity: 1;"><div class=3D"relative group" data-sta=
te=3D"closed"><a class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/31c21933-dcc8-4414-880a-0ccea8aa9e55"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Resume review f=
or AI positions</span></div></a><div class=3D"absolute right-0 top-1/2 -tra=
nslate-y-1/2 transition-opacity duration-150 hidden group-hover:block group=
-focus-within:block opacity-0 group-hover:opacity-100 group-focus-within:op=
acity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Resume review for AI positions=
" id=3D"radix-_r_3l_" aria-haspopup=3D"menu" aria-expanded=3D"false" data-s=
tate=3D"closed"><div style=3D"width: 20px; height: 20px; display: flex; ali=
gn-items: center; justify-content: center;"><svg width=3D"20" height=3D"20"=
 viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/200=
0/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.5 8.5C5=
.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11.5 3 10=
.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.17157 1=
1.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.5 10C8.=
5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C17 10.8=
284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 14.6716=
 8.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li style=3D"o=
pacity: 1;"><div class=3D"relative group" data-state=3D"closed"><a class=3D=
"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/3c3b4f59-f1f0-4ad4-9104-dfb5261e409e"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">TEGNA organizat=
ion configuration details</span></div></a><div class=3D"absolute right-0 to=
p-1/2 -translate-y-1/2 transition-opacity duration-150 hidden group-hover:b=
lock group-focus-within:block opacity-0 group-hover:opacity-100 group-focus=
-within:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for TEGNA organization configurati=
on details" id=3D"radix-_r_3p_" aria-haspopup=3D"menu" aria-expanded=3D"fal=
se" data-state=3D"closed"><div style=3D"width: 20px; height: 20px; display:=
 flex; align-items: center; justify-content: center;"><svg width=3D"20" hei=
ght=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.=
w3.org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"=
M4.5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157=
 11.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5=
 9.17157 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284=
 8.5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 =
10C17 10.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.171=
57 14.6716 8.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li =
style=3D"opacity: 1;"><div class=3D"relative group" data-state=3D"closed"><=
a class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/bace4e0a-8258-4f8f-a40d-286db114b626"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Google Form scr=
ipt not updating analysis sheets</span></div></a><div class=3D"absolute rig=
ht-0 top-1/2 -translate-y-1/2 transition-opacity duration-150 hidden group-=
hover:block group-focus-within:block opacity-0 group-hover:opacity-100 grou=
p-focus-within:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Google Form script not updatin=
g analysis sheets" id=3D"radix-_r_3t_" aria-haspopup=3D"menu" aria-expanded=
=3D"false" data-state=3D"closed"><div style=3D"width: 20px; height: 20px; d=
isplay: flex; align-items: center; justify-content: center;"><svg width=3D"=
20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http=
://www.w3.org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><pat=
h d=3D"M4.5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C=
3.67157 11.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8=
.5 11.5 9.17157 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 =
10.8284 8.5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17=
157 17 10C17 10.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C1=
4 9.17157 14.6716 8.5 15.5 8.5Z"></path></svg></div></button></div></div></=
li><li style=3D"opacity: 1;"><div class=3D"relative group" data-state=3D"cl=
osed"><a class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/c71778e9-8633-4292-861e-9b65e1b8f4e9"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Google form for=
 church voting</span></div></a><div class=3D"absolute right-0 top-1/2 -tran=
slate-y-1/2 transition-opacity duration-150 hidden group-hover:block group-=
focus-within:block opacity-0 group-hover:opacity-100 group-focus-within:opa=
city-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Google form for church voting"=
 id=3D"radix-_r_41_" aria-haspopup=3D"menu" aria-expanded=3D"false" data-st=
ate=3D"closed"><div style=3D"width: 20px; height: 20px; display: flex; alig=
n-items: center; justify-content: center;"><svg width=3D"20" height=3D"20" =
viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000=
/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.5 8.5C5.=
32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11.5 3 10.=
8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.17157 11=
.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.5 10C8.5=
 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C17 10.82=
84 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 14.6716 =
8.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li style=3D"op=
acity: 1;"><div class=3D"relative group" data-state=3D"closed"><a class=3D"=
inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/089e8be3-3ce1-4e2b-9b89-9a9bf1028218"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Poll creation w=
ithout Google login</span></div></a><div class=3D"absolute right-0 top-1/2 =
-translate-y-1/2 transition-opacity duration-150 hidden group-hover:block g=
roup-focus-within:block opacity-0 group-hover:opacity-100 group-focus-withi=
n:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Poll creation without Google l=
ogin" id=3D"radix-_r_45_" aria-haspopup=3D"menu" aria-expanded=3D"false" da=
ta-state=3D"closed"><div style=3D"width: 20px; height: 20px; display: flex;=
 align-items: center; justify-content: center;"><svg width=3D"20" height=3D=
"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org=
/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.5 8=
.5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11.5 =
3 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.171=
57 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.5 1=
0C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C17 =
10.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 14.=
6716 8.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li style=
=3D"opacity: 1;"><div class=3D"relative group" data-state=3D"closed"><a cla=
ss=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/70508bf8-ddd7-4084-bd4d-93889332c517"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Converting Tink=
ercad to dimensioned blueprint</span></div></a><div class=3D"absolute right=
-0 top-1/2 -translate-y-1/2 transition-opacity duration-150 hidden group-ho=
ver:block group-focus-within:block opacity-0 group-hover:opacity-100 group-=
focus-within:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Converting Tinkercad to dimens=
ioned blueprint" id=3D"radix-_r_49_" aria-haspopup=3D"menu" aria-expanded=
=3D"false" data-state=3D"closed"><div style=3D"width: 20px; height: 20px; d=
isplay: flex; align-items: center; justify-content: center;"><svg width=3D"=
20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http=
://www.w3.org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><pat=
h d=3D"M4.5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C=
3.67157 11.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8=
.5 11.5 9.17157 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 =
10.8284 8.5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17=
157 17 10C17 10.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C1=
4 9.17157 14.6716 8.5 15.5 8.5Z"></path></svg></div></button></div></div></=
li><li style=3D"opacity: 1;"><div class=3D"relative group" data-state=3D"cl=
osed"><a class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/3bdc3689-0121-4b87-ae9a-0f884c1439a9"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Converting metr=
ic TinkerCAD design to inches</span></div></a><div class=3D"absolute right-=
0 top-1/2 -translate-y-1/2 transition-opacity duration-150 hidden group-hov=
er:block group-focus-within:block opacity-0 group-hover:opacity-100 group-f=
ocus-within:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Converting metric TinkerCAD de=
sign to inches" id=3D"radix-_r_4d_" aria-haspopup=3D"menu" aria-expanded=3D=
"false" data-state=3D"closed"><div style=3D"width: 20px; height: 20px; disp=
lay: flex; align-items: center; justify-content: center;"><svg width=3D"20"=
 height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://=
www.w3.org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=
=3D"M4.5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.6=
7157 11.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 =
11.5 9.17157 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.=
8284 8.5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157=
 17 10C17 10.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9=
.17157 14.6716 8.5 15.5 8.5Z"></path></svg></div></button></div></div></li>=
<li style=3D"opacity: 1;"><div class=3D"relative group" data-state=3D"close=
d"><a class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/21984068-8329-4b89-8e6c-f66f542abe1f"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Baby gate board=
 spacing calculation</span></div></a><div class=3D"absolute right-0 top-1/2=
 -translate-y-1/2 transition-opacity duration-150 hidden group-hover:block =
group-focus-within:block opacity-0 group-hover:opacity-100 group-focus-with=
in:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Baby gate board spacing calcul=
ation" id=3D"radix-_r_4h_" aria-haspopup=3D"menu" aria-expanded=3D"false" d=
ata-state=3D"closed"><div style=3D"width: 20px; height: 20px; display: flex=
; align-items: center; justify-content: center;"><svg width=3D"20" height=
=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.=
org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.=
5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11=
.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.=
17157 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.=
5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C=
17 10.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 =
14.6716 8.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li sty=
le=3D"opacity: 1;"><div class=3D"relative group" data-state=3D"closed"><a c=
lass=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/4eb1637a-bef9-4062-aa40-b23585fd6120"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Background colo=
r identification</span></div></a><div class=3D"absolute right-0 top-1/2 -tr=
anslate-y-1/2 transition-opacity duration-150 hidden group-hover:block grou=
p-focus-within:block opacity-0 group-hover:opacity-100 group-focus-within:o=
pacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Background color identificatio=
n" id=3D"radix-_r_4l_" aria-haspopup=3D"menu" aria-expanded=3D"false" data-=
state=3D"closed"><div style=3D"width: 20px; height: 20px; display: flex; al=
ign-items: center; justify-content: center;"><svg width=3D"20" height=3D"20=
" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/20=
00/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.5 8.5C=
5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11.5 3 1=
0.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.17157 =
11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.5 10C8=
.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C17 10.=
8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 14.671=
6 8.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li style=3D"=
opacity: 1;"><div class=3D"relative group" data-state=3D"closed"><a class=
=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/2a796b16-df90-4423-9e74-dc59319354ee"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Texas November =
4 ballot propositions analysis</span></div></a><div class=3D"absolute right=
-0 top-1/2 -translate-y-1/2 transition-opacity duration-150 hidden group-ho=
ver:block group-focus-within:block opacity-0 group-hover:opacity-100 group-=
focus-within:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Texas November 4 ballot propos=
itions analysis" id=3D"radix-_r_4p_" aria-haspopup=3D"menu" aria-expanded=
=3D"false" data-state=3D"closed"><div style=3D"width: 20px; height: 20px; d=
isplay: flex; align-items: center; justify-content: center;"><svg width=3D"=
20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http=
://www.w3.org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><pat=
h d=3D"M4.5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C=
3.67157 11.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8=
.5 11.5 9.17157 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 =
10.8284 8.5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17=
157 17 10C17 10.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C1=
4 9.17157 14.6716 8.5 15.5 8.5Z"></path></svg></div></button></div></div></=
li><li style=3D"opacity: 1;"><div class=3D"relative group" data-state=3D"cl=
osed"><a class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/00d941b4-57d0-4c3a-9998-26f6a9ac0522"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Storing JSON in=
 Vertica</span></div></a><div class=3D"absolute right-0 top-1/2 -translate-=
y-1/2 transition-opacity duration-150 hidden group-hover:block group-focus-=
within:block opacity-0 group-hover:opacity-100 group-focus-within:opacity-1=
00"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Storing JSON in Vertica" id=3D=
"radix-_r_4t_" aria-haspopup=3D"menu" aria-expanded=3D"false" data-state=3D=
"closed"><div style=3D"width: 20px; height: 20px; display: flex; align-item=
s: center; justify-content: center;"><svg width=3D"20" height=3D"20" viewBo=
x=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" =
aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.5 8.5C5.32843 =
8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11.5 3 10.8284 3=
 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.17157 11.5 10C=
11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.5 10C8.5 9.171=
57 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C17 10.8284 16.=
3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 14.6716 8.5 15=
.5 8.5Z"></path></svg></div></button></div></div></li><li style=3D"opacity:=
 1;"><div class=3D"relative group" data-state=3D"closed"><a class=3D"inline=
-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/bdff4e3e-241d-4a74-9a12-9f1b5ce8f3ea"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Bigquery date f=
unction error</span></div></a><div class=3D"absolute right-0 top-1/2 -trans=
late-y-1/2 transition-opacity duration-150 hidden group-hover:block group-f=
ocus-within:block opacity-0 group-hover:opacity-100 group-focus-within:opac=
ity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Bigquery date function error" =
id=3D"radix-_r_51_" aria-haspopup=3D"menu" aria-expanded=3D"false" data-sta=
te=3D"closed"><div style=3D"width: 20px; height: 20px; display: flex; align=
-items: center; justify-content: center;"><svg width=3D"20" height=3D"20" v=
iewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/=
svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.5 8.5C5.3=
2843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11.5 3 10.8=
284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.17157 11.=
5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.5 10C8.5 =
9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C17 10.828=
4 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 14.6716 8=
.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li style=3D"opa=
city: 1;"><div class=3D"relative group" data-state=3D"closed"><a class=3D"i=
nline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/24b9f56b-d889-41ef-a551-a54c38d7bb30"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Mysterious rash=
 and potential poison sumac exposure</span></div></a><div class=3D"absolute=
 right-0 top-1/2 -translate-y-1/2 transition-opacity duration-150 hidden gr=
oup-hover:block group-focus-within:block opacity-0 group-hover:opacity-100 =
group-focus-within:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Mysterious rash and potential =
poison sumac exposure" id=3D"radix-_r_55_" aria-haspopup=3D"menu" aria-expa=
nded=3D"false" data-state=3D"closed"><div style=3D"width: 20px; height: 20p=
x; display: flex; align-items: center; justify-content: center;"><svg width=
=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"=
http://www.w3.org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;">=
<path d=3D"M4.5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 1=
1.5C3.67157 11.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.82=
84 8.5 11.5 9.17157 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 =
8.5 10.8284 8.5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 =
9.17157 17 10C17 10.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 =
10C14 9.17157 14.6716 8.5 15.5 8.5Z"></path></svg></div></button></div></di=
v></li><li style=3D"opacity: 1;"><div class=3D"relative group" data-state=
=3D"closed"><a class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/0e8a3f6b-bc7b-41ba-a9d5-4966f4818be5"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]"><span class=3D"=
opacity-60">Untitled</span></span></div></a><div class=3D"absolute right-0 =
top-1/2 -translate-y-1/2 transition-opacity duration-150 hidden group-hover=
:block group-focus-within:block opacity-0 group-hover:opacity-100 group-foc=
us-within:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options" id=3D"radix-_r_59_" aria-haspopup=
=3D"menu" aria-expanded=3D"false" data-state=3D"closed"><div style=3D"width=
: 20px; height: 20px; display: flex; align-items: center; justify-content: =
center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curr=
entColor" xmlns=3D"http://www.w3.org/2000/svg" aria-hidden=3D"true" style=
=3D"flex-shrink: 0;"><path d=3D"M4.5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.82=
84 5.32843 11.5 4.5 11.5C3.67157 11.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 =
4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.17157 11.5 10C11.5 10.8284 10.8284 11.5 =
10 11.5C9.17157 11.5 8.5 10.8284 8.5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.=
5 8.5C16.3284 8.5 17 9.17157 17 10C17 10.8284 16.3284 11.5 15.5 11.5C14.671=
6 11.5 14 10.8284 14 10C14 9.17157 14.6716 8.5 15.5 8.5Z"></path></svg></di=
v></button></div></div></li><li style=3D"opacity: 1;"><div class=3D"relativ=
e group" data-state=3D"closed"><a class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/c40a0e75-1a66-456c-ba88-c309f2012a3f"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Managing adhd s=
ymptoms without medication</span></div></a><div class=3D"absolute right-0 t=
op-1/2 -translate-y-1/2 transition-opacity duration-150 hidden group-hover:=
block group-focus-within:block opacity-0 group-hover:opacity-100 group-focu=
s-within:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Managing adhd symptoms without=
 medication" id=3D"radix-_r_5d_" aria-haspopup=3D"menu" aria-expanded=3D"fa=
lse" data-state=3D"closed"><div style=3D"width: 20px; height: 20px; display=
: flex; align-items: center; justify-content: center;"><svg width=3D"20" he=
ight=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www=
.w3.org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D=
"M4.5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.6715=
7 11.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.=
5 9.17157 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.828=
4 8.5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17=
 10C17 10.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17=
157 14.6716 8.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li=
 style=3D"opacity: 1;"><div class=3D"relative group" data-state=3D"closed">=
<a class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/75dd1f6a-f30f-40dd-b03e-f8f53f9b9197"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Sleep duration =
and quality assessment</span></div></a><div class=3D"absolute right-0 top-1=
/2 -translate-y-1/2 transition-opacity duration-150 hidden group-hover:bloc=
k group-focus-within:block opacity-0 group-hover:opacity-100 group-focus-wi=
thin:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Sleep duration and quality ass=
essment" id=3D"radix-_r_5h_" aria-haspopup=3D"menu" aria-expanded=3D"false"=
 data-state=3D"closed"><div style=3D"width: 20px; height: 20px; display: fl=
ex; align-items: center; justify-content: center;"><svg width=3D"20" height=
=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.=
org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.=
5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11=
.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.=
17157 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.=
5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C=
17 10.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 =
14.6716 8.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li sty=
le=3D"opacity: 1;"><div class=3D"relative group" data-state=3D"closed"><a c=
lass=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/88dde43b-fb72-4bdd-99b0-408abd222fb6"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Recovering dele=
ted GitHub commits</span></div></a><div class=3D"absolute right-0 top-1/2 -=
translate-y-1/2 transition-opacity duration-150 hidden group-hover:block gr=
oup-focus-within:block opacity-0 group-hover:opacity-100 group-focus-within=
:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Recovering deleted GitHub comm=
its" id=3D"radix-_r_5l_" aria-haspopup=3D"menu" aria-expanded=3D"false" dat=
a-state=3D"closed"><div style=3D"width: 20px; height: 20px; display: flex; =
align-items: center; justify-content: center;"><svg width=3D"20" height=3D"=
20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/=
2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.5 8.=
5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11.5 3=
 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.1715=
7 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.5 10=
C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C17 1=
0.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 14.6=
716 8.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li style=
=3D"opacity: 1;"><div class=3D"relative group" data-state=3D"closed"><a cla=
ss=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/4d626c07-6452-4ad2-b4bd-a02bf3e38aef"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Golf scoring: +=
25 on par 72</span></div></a><div class=3D"absolute right-0 top-1/2 -transl=
ate-y-1/2 transition-opacity duration-150 hidden group-hover:block group-fo=
cus-within:block opacity-0 group-hover:opacity-100 group-focus-within:opaci=
ty-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Golf scoring: +25 on par 72" i=
d=3D"radix-_r_5p_" aria-haspopup=3D"menu" aria-expanded=3D"false" data-stat=
e=3D"closed"><div style=3D"width: 20px; height: 20px; display: flex; align-=
items: center; justify-content: center;"><svg width=3D"20" height=3D"20" vi=
ewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/s=
vg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.5 8.5C5.32=
843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11.5 3 10.82=
84 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.17157 11.5=
 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.5 10C8.5 9=
.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C17 10.8284=
 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 14.6716 8.=
5 15.5 8.5Z"></path></svg></div></button></div></div></li><li style=3D"opac=
ity: 1;"><div class=3D"relative group" data-state=3D"closed"><a class=3D"in=
line-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/3aa3b513-5102-44f6-b4df-c17f11f2dc73"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Redo Analysis</=
span></div></a><div class=3D"absolute right-0 top-1/2 -translate-y-1/2 tran=
sition-opacity duration-150 hidden group-hover:block group-focus-within:blo=
ck opacity-0 group-hover:opacity-100 group-focus-within:opacity-100"><butto=
n class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Redo Analysis" id=3D"radix-_r_=
5t_" aria-haspopup=3D"menu" aria-expanded=3D"false" data-state=3D"closed"><=
div style=3D"width: 20px; height: 20px; display: flex; align-items: center;=
 justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 2=
0 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" aria-hidde=
n=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.5 8.5C5.32843 8.5 6 9.17=
157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11.5 3 10.8284 3 10C3 9.17=
157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.17157 11.5 10C11.5 10.82=
84 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.5 10C8.5 9.17157 9.17157=
 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C17 10.8284 16.3284 11.5 =
15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 14.6716 8.5 15.5 8.5Z"><=
/path></svg></div></button></div></div></li><li style=3D"opacity: 1;"><div =
class=3D"relative group" data-state=3D"closed"><a class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/64dcd2bd-513f-405d-ab8f-7efde2059355"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Feature Store v=
s Database Tables</span></div></a><div class=3D"absolute right-0 top-1/2 -t=
ranslate-y-1/2 transition-opacity duration-150 hidden group-hover:block gro=
up-focus-within:block opacity-0 group-hover:opacity-100 group-focus-within:=
opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Feature Store vs Database Tabl=
es" id=3D"radix-_r_61_" aria-haspopup=3D"menu" aria-expanded=3D"false" data=
-state=3D"closed"><div style=3D"width: 20px; height: 20px; display: flex; a=
lign-items: center; justify-content: center;"><svg width=3D"20" height=3D"2=
0" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2=
000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.5 8.5=
C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11.5 3 =
10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.17157=
 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.5 10C=
8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C17 10=
.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 14.67=
16 8.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li style=3D=
"opacity: 1;"><div class=3D"relative group" data-state=3D"closed"><a class=
=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/27ed57f6-fa76-47b8-bc06-dfc60748be93"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Professional Pr=
actice Group Dynamics</span></div></a><div class=3D"absolute right-0 top-1/=
2 -translate-y-1/2 transition-opacity duration-150 hidden group-hover:block=
 group-focus-within:block opacity-0 group-hover:opacity-100 group-focus-wit=
hin:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Professional Practice Group Dy=
namics" id=3D"radix-_r_65_" aria-haspopup=3D"menu" aria-expanded=3D"false" =
data-state=3D"closed"><div style=3D"width: 20px; height: 20px; display: fle=
x; align-items: center; justify-content: center;"><svg width=3D"20" height=
=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.=
org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.=
5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11=
.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.=
17157 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.=
5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C=
17 10.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 =
14.6716 8.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li sty=
le=3D"opacity: 1;"><div class=3D"relative group" data-state=3D"closed"><a c=
lass=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/0dbf92e7-dc03-43b9-bb08-6a4e53324ce9"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Middle-earth So=
lo RPG Adventure</span></div></a><div class=3D"absolute right-0 top-1/2 -tr=
anslate-y-1/2 transition-opacity duration-150 hidden group-hover:block grou=
p-focus-within:block opacity-0 group-hover:opacity-100 group-focus-within:o=
pacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Middle-earth Solo RPG Adventur=
e" id=3D"radix-_r_69_" aria-haspopup=3D"menu" aria-expanded=3D"false" data-=
state=3D"closed"><div style=3D"width: 20px; height: 20px; display: flex; al=
ign-items: center; justify-content: center;"><svg width=3D"20" height=3D"20=
" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/20=
00/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.5 8.5C=
5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11.5 3 1=
0.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.17157 =
11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.5 10C8=
.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C17 10.=
8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 14.671=
6 8.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li style=3D"=
opacity: 1;"><div class=3D"relative group" data-state=3D"closed"><a class=
=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/1e673467-40b4-48c7-aa1e-d48f1ca3ef98"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]"><span class=3D"=
opacity-60">Untitled</span></span></div></a><div class=3D"absolute right-0 =
top-1/2 -translate-y-1/2 transition-opacity duration-150 hidden group-hover=
:block group-focus-within:block opacity-0 group-hover:opacity-100 group-foc=
us-within:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options" id=3D"radix-_r_6d_" aria-haspopup=
=3D"menu" aria-expanded=3D"false" data-state=3D"closed"><div style=3D"width=
: 20px; height: 20px; display: flex; align-items: center; justify-content: =
center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curr=
entColor" xmlns=3D"http://www.w3.org/2000/svg" aria-hidden=3D"true" style=
=3D"flex-shrink: 0;"><path d=3D"M4.5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.82=
84 5.32843 11.5 4.5 11.5C3.67157 11.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 =
4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.17157 11.5 10C11.5 10.8284 10.8284 11.5 =
10 11.5C9.17157 11.5 8.5 10.8284 8.5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.=
5 8.5C16.3284 8.5 17 9.17157 17 10C17 10.8284 16.3284 11.5 15.5 11.5C14.671=
6 11.5 14 10.8284 14 10C14 9.17157 14.6716 8.5 15.5 8.5Z"></path></svg></di=
v></button></div></div></li><li style=3D"opacity: 1;"><div class=3D"relativ=
e group" data-state=3D"closed"><a class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/12cad49b-c39e-4bbd-a07f-2666cecf933a"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">System Memory O=
verview</span></div></a><div class=3D"absolute right-0 top-1/2 -translate-y=
-1/2 transition-opacity duration-150 hidden group-hover:block group-focus-w=
ithin:block opacity-0 group-hover:opacity-100 group-focus-within:opacity-10=
0"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for System Memory Overview" id=3D"=
radix-_r_6h_" aria-haspopup=3D"menu" aria-expanded=3D"false" data-state=3D"=
closed"><div style=3D"width: 20px; height: 20px; display: flex; align-items=
: center; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=
=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" a=
ria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.5 8.5C5.32843 8=
.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11.5 3 10.8284 3 =
10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.17157 11.5 10C1=
1.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.5 10C8.5 9.1715=
7 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C17 10.8284 16.3=
284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 14.6716 8.5 15.=
5 8.5Z"></path></svg></div></button></div></div></li><li style=3D"opacity: =
1;"><div class=3D"relative group" data-state=3D"closed"><a class=3D"inline-=
flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/120303d9-6a37-4377-80dd-8aab22311e42"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Faith-Based Tec=
h Learning Initiative</span></div></a><div class=3D"absolute right-0 top-1/=
2 -translate-y-1/2 transition-opacity duration-150 hidden group-hover:block=
 group-focus-within:block opacity-0 group-hover:opacity-100 group-focus-wit=
hin:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Faith-Based Tech Learning Init=
iative" id=3D"radix-_r_6l_" aria-haspopup=3D"menu" aria-expanded=3D"false" =
data-state=3D"closed"><div style=3D"width: 20px; height: 20px; display: fle=
x; align-items: center; justify-content: center;"><svg width=3D"20" height=
=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.=
org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.=
5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11=
.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.=
17157 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.=
5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C=
17 10.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 =
14.6716 8.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li sty=
le=3D"opacity: 1;"><div class=3D"relative group" data-state=3D"closed"><a c=
lass=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/7974d339-ae6a-45b8-b1ac-635cbde848f2"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Is a Taco a San=
dwich?</span></div></a><div class=3D"absolute right-0 top-1/2 -translate-y-=
1/2 transition-opacity duration-150 hidden group-hover:block group-focus-wi=
thin:block opacity-0 group-hover:opacity-100 group-focus-within:opacity-100=
"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Is a Taco a Sandwich?" id=3D"r=
adix-_r_6p_" aria-haspopup=3D"menu" aria-expanded=3D"false" data-state=3D"c=
losed"><div style=3D"width: 20px; height: 20px; display: flex; align-items:=
 center; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=
=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" a=
ria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.5 8.5C5.32843 8=
.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11.5 3 10.8284 3 =
10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.17157 11.5 10C1=
1.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.5 10C8.5 9.1715=
7 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C17 10.8284 16.3=
284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 14.6716 8.5 15.=
5 8.5Z"></path></svg></div></button></div></div></li><li style=3D"opacity: =
1;"><div class=3D"relative group" data-state=3D"closed"><a class=3D"inline-=
flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/506a7074-90e7-4fa9-b1bd-8331a6b4a92f"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Best Retro Hand=
held Emulator Under $120</span></div></a><div class=3D"absolute right-0 top=
-1/2 -translate-y-1/2 transition-opacity duration-150 hidden group-hover:bl=
ock group-focus-within:block opacity-0 group-hover:opacity-100 group-focus-=
within:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Best Retro Handheld Emulator U=
nder $120" id=3D"radix-_r_6t_" aria-haspopup=3D"menu" aria-expanded=3D"fals=
e" data-state=3D"closed"><div style=3D"width: 20px; height: 20px; display: =
flex; align-items: center; justify-content: center;"><svg width=3D"20" heig=
ht=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w=
3.org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M=
4.5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 =
11.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 =
9.17157 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 =
8.5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 1=
0C17 10.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.1715=
7 14.6716 8.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li s=
tyle=3D"opacity: 1;"><div class=3D"relative group" data-state=3D"closed"><a=
 class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/80526da6-7e2f-43a3-ab2f-943560468c94"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Atlassian JIRA =
MCP Configuration</span></div></a><div class=3D"absolute right-0 top-1/2 -t=
ranslate-y-1/2 transition-opacity duration-150 hidden group-hover:block gro=
up-focus-within:block opacity-0 group-hover:opacity-100 group-focus-within:=
opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Atlassian JIRA MCP Configurati=
on" id=3D"radix-_r_71_" aria-haspopup=3D"menu" aria-expanded=3D"false" data=
-state=3D"closed"><div style=3D"width: 20px; height: 20px; display: flex; a=
lign-items: center; justify-content: center;"><svg width=3D"20" height=3D"2=
0" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2=
000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M4.5 8.5=
C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4.5 11.5C3.67157 11.5 3 =
10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C10.8284 8.5 11.5 9.17157=
 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 11.5 8.5 10.8284 8.5 10C=
8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5 17 9.17157 17 10C17 10=
.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284 14 10C14 9.17157 14.67=
16 8.5 15.5 8.5Z"></path></svg></div></button></div></div></li><li style=3D=
"opacity: 1;"><div class=3D"relative group" data-state=3D"closed"><a class=
=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-chat-ite=
m" href=3D"https://claude.ai/chat/bdd28197-981b-4449-87eb-0403e0dc09a5"><di=
v class=3D"-translate-x-2 w-full flex flex-row items-center justify-start g=
ap-3"><span class=3D"truncate text-sm whitespace-nowrap flex-1 group-hover:=
[mask-image:linear-gradient(to_right,hsl(var(--always-black))_78%,transpare=
nt_95%)] group-focus-within:[mask-image:linear-gradient(to_right,hsl(var(--=
always-black))_78%,transparent_95%)] [mask-size:100%_100%]">Data Engineerin=
g Recipes for Pipelines and Dimensions</span></div></a><div class=3D"absolu=
te right-0 top-1/2 -translate-y-1/2 transition-opacity duration-150 hidden =
group-hover:block group-focus-within:block opacity-0 group-hover:opacity-10=
0 group-focus-within:opacity-100"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 active:!scale-100 aria-expanded:!bg-bg-400 Button_ghost__BUAoh" ty=
pe=3D"button" aria-label=3D"More options for Data Engineering Recipes for P=
ipelines and Dimensions" id=3D"radix-_r_75_" aria-haspopup=3D"menu" aria-ex=
panded=3D"false" data-state=3D"closed"><div style=3D"width: 20px; height: 2=
0px; display: flex; align-items: center; justify-content: center;"><svg wid=
th=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: =
0;"><path d=3D"M4.5 8.5C5.32843 8.5 6 9.17157 6 10C6 10.8284 5.32843 11.5 4=
.5 11.5C3.67157 11.5 3 10.8284 3 10C3 9.17157 3.67157 8.5 4.5 8.5ZM10 8.5C1=
0.8284 8.5 11.5 9.17157 11.5 10C11.5 10.8284 10.8284 11.5 10 11.5C9.17157 1=
1.5 8.5 10.8284 8.5 10C8.5 9.17157 9.17157 8.5 10 8.5ZM15.5 8.5C16.3284 8.5=
 17 9.17157 17 10C17 10.8284 16.3284 11.5 15.5 11.5C14.6716 11.5 14 10.8284=
 14 10C14 9.17157 14.6716 8.5 15.5 8.5Z"></path></svg></div></button></div>=
</div></li></ul><div class=3D"relative group" data-state=3D"closed"><a clas=
s=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs w-full overflow-hidd=
en !min-w-0 group py-1.5 rounded-lg px-4 !duration-75 active:bg-bg-300 acti=
ve:scale-[1.0] Button_ghost__BUAoh" data-dd-action-name=3D"sidebar-more-ite=
m" href=3D"https://claude.ai/recents"><div class=3D"-translate-x-2 w-full f=
lex flex-row items-center justify-start gap-3"><svg xmlns=3D"http://www.w3.=
org/2000/svg" width=3D"18" height=3D"18" fill=3D"currentColor" viewBox=3D"0=
 0 256 256" class=3D"shrink-0 "><path d=3D"M128,24A104,104,0,1,0,232,128,10=
4.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm=
12-88a12,12,0,1,1-12-12A12,12,0,0,1,140,128Zm44,0a12,12,0,1,1-12-12A12,12,0=
,0,1,184,128Zm-88,0a12,12,0,1,1-12-12A12,12,0,0,1,96,128Z"></path></svg><sp=
an class=3D"truncate text-sm whitespace-nowrap flex-1">All chats</span></di=
v></a><div class=3D"absolute right-0 top-1/2 -translate-y-1/2 transition-op=
acity duration-150 hidden group-hover:block group-focus-within:block opacit=
y-0 group-hover:opacity-100 group-focus-within:opacity-100"></div></div></d=
iv></div></div></div></div><div class=3D"flex items-center gap-2 transition=
 border-t-0.5 border-border-300"><div class=3D"flex-1 min-w-0"><button clas=
s=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-9 px-4 py-2 rounded-lg m=
in-w-[5rem] active:scale-[0.985] whitespace-nowrap !scale-100 flex-row !min=
-w-0 w-full rounded-none group px-2 !-outline-offset-2 transition-[gap] dur=
ation-150 ease-out gap-3 !py-8 my-0 Button_ghost__BUAoh" type=3D"button" da=
ta-testid=3D"user-menu-button" id=3D"radix-_r_a_" aria-haspopup=3D"menu" ar=
ia-expanded=3D"false" data-state=3D"closed"><div class=3D"relative flex-shr=
ink-0"><div class=3D"flex items-center justify-center rounded-full text-tex=
t-200 border-0.5 border-transparent group-hover:border-border-200 transitio=
n group-hover:opacity-90"><div class=3D"flex shrink-0 items-center justify-=
center rounded-full font-bold select-none h-9 w-9 text-[16px] bg-text-200 t=
ext-bg-100">EL</div></div></div><div class=3D"opacity-100 transition-opacit=
y ease-out duration-150 flex flex-1 text-sm justify-between items-center fo=
nt-medium min-w-0 overflow-hidden"><div class=3D"flex flex-col items-start =
min-w-0 flex-1 pr-1"><span class=3D"w-full text-start block truncate">Eric =
Livesay</span><span class=3D"w-full truncate text-xs text-text-500 font-nor=
mal text-start">Free plan</span></div><svg xmlns=3D"http://www.w3.org/2000/=
svg" width=3D"14" height=3D"14" fill=3D"currentColor" viewBox=3D"0 0 256 25=
6" class=3D"flex-shrink-0"><path d=3D"M181.66,170.34a8,8,0,0,1,0,11.32l-48,=
48a8,8,0,0,1-11.32,0l-48-48a8,8,0,0,1,11.32-11.32L128,212.69l42.34-42.35A8,=
8,0,0,1,181.66,170.34Zm-96-84.68L128,43.31l42.34,42.35a8,8,0,0,0,11.32-11.3=
2l-48-48a8,8,0,0,0-11.32,0l-48,48A8,8,0,0,0,85.66,85.66Z"></path></svg></di=
v></button></div></div></div></nav></div></div><div id=3D"main-content" cla=
ss=3D"w-full relative min-w-0" style=3D"height: calc(100vh - var(--app-inst=
all-banner-height, 0px)); padding: 0px;"><div class=3D"flex flex-1 h-full w=
-full overflow-hidden relative"><div class=3D"h-full flex flex-col overflow=
-hidden" style=3D"flex: 100 0 0%;"><header class=3D"flex w-full bg-bg-100 s=
ticky top-0 z-header h-12 -mb-3" aria-hidden=3D"false" data-testid=3D"page-=
header" style=3D"height: 48px;"><div class=3D"from-bg-100 via-bg-100 via-65=
% to-bg-100/0 pointer-events-none absolute inset-0 -bottom-5 z-[-1] bg-grad=
ient-to-b blur-sm"></div><div class=3D"flex w-full items-center justify-bet=
ween gap-4 pl-11 lg:px-8 gap-6 p-3 lg:pl-4 lg:pr-3 pr-3"><div class=3D"flex=
 min-w-0 flex-1 shrink md:items-center font-base-bold pr-[100px]"><div clas=
s=3D"flex min-w-0 shrink-1 items-center group"><div class=3D"flex items-cen=
ter group [&amp;:hover>button]:!bg-bg-300 [&amp;>button:hover]:!bg-bg-500">=
<button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-9 px-4 py-2 rounded-lg m=
in-w-[5rem] active:scale-[0.985] whitespace-nowrap !text-text-300 hover:!te=
xt-text-100 !shrink !min-w-0 !px-2 !py-0 !scale-100 !h-7 !rounded-r-none ac=
tive:!bg-bg-500 Button_ghost__BUAoh" type=3D"button" data-testid=3D"chat-ti=
tle-button"><div class=3D"min-w-0 flex-1"><div class=3D"truncate font-base-=
bold">Robotic dishwashing with vision and 3D reconstruction</div></div></bu=
tton><div class=3D"w-[1.5px] h-7"></div><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 !h-7 !w-7 !rounded-l-none !text-text-300 hover:!text-text-100 acti=
ve:!bg-bg-500 Button_ghost__BUAoh" type=3D"button" data-testid=3D"chat-menu=
-trigger" id=3D"radix-_r_fc_" aria-haspopup=3D"menu" aria-expanded=3D"false=
" data-state=3D"closed"><div style=3D"width: 16px; height: 16px; display: f=
lex; align-items: center; justify-content: center;"><svg width=3D"20" heigh=
t=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3=
.org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M1=
4.128 7.16482C14.3126 6.95983 14.6298 6.94336 14.835 7.12771C15.0402 7.3124=
2 15.0567 7.62952 14.8721 7.83477L10.372 12.835L10.2939 12.9053C10.2093 12.=
9667 10.1063 13 9.99995 13C9.85833 12.9999 9.72264 12.9402 9.62788 12.835L5=
.12778 7.83477L5.0682 7.75273C4.95072 7.55225 4.98544 7.28926 5.16489 7.127=
71C5.34445 6.96617 5.60969 6.95939 5.79674 7.09744L5.87193 7.16482L9.99995 =
11.7519L14.128 7.16482Z"></path></svg></div></button></div></div></div><div=
 class=3D"right-3 flex gap-2"></div></div></header><div class=3D"overflow-y=
-scroll overflow-x-hidden pt-6 flex-1"><div class=3D"relative w-full min-h-=
full"><div class=3D"mx-auto flex size-full max-w-3xl flex-col md:px-2"><div=
 class=3D"flex-1 flex flex-col px-4 max-w-3xl mx-auto w-full pt-1"><div dat=
a-test-render-count=3D"2"><div class=3D"mb-1 mt-6 group"><div class=3D"flex=
 flex-col items-end gap-1"><div class=3D"group relative inline-flex gap-2 b=
g-bg-300 rounded-xl pl-2.5 py-2.5 break-words text-text-100 transition-all =
max-w-[75ch] flex-col !px-4 max-w-[85%]" style=3D"opacity: 1; transform: no=
ne;"><div class=3D"flex flex-row gap-2 relative"><div class=3D"flex-1"><div=
 data-testid=3D"user-message" class=3D"font-large !font-user-message grid g=
rid-cols-1 gap-2 py-0.5 relative" style=3D"max-height: none; overflow: hidd=
en; position: relative;"><p class=3D"whitespace-pre-wrap break-words">I wan=
t to use a combination of a qwen 3 VL vision model and an algorithm to try =
to deduce the 3-D geometry of dishes in a sink so that I can then create a =
model that knows how to do the reverse key metrics to use a arm with a grip=
per to pick up the dishes in the correct place, I wanna be able to do some =
virtual training by creating a virtual sync and I want to figure out what=
=E2=80=99s the best way to do this. Maybe using the Omni platform from Nvid=
ia or the they have a virtual platform write out an outline in the code and=
 best practices</p></div></div></div></div><div class=3D"flex justify-start=
 opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 transitio=
n" role=3D"group" aria-label=3D"Message actions"><div class=3D"text-text-30=
0"><div class=3D"text-text-300 flex items-stretch justify-between"><span cl=
ass=3D"text-text-500 text-xs flex items-center mr-2" data-state=3D"closed">=
Feb 4</span><div class=3D"flex items-center"><div class=3D"w-fit" data-stat=
e=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Retry=
"><div class=3D"text-text-500 group-hover/btn:text-text-100" style=3D"width=
: 20px; height: 20px; display: flex; align-items: center; justify-content: =
center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curr=
entColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-text-500 group=
-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><p=
ath d=3D"M10.3857 2.50977C14.3486 2.71054 17.5 5.98724 17.5 10C17.5 14.1421=
 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 7.54619 3.67878 5=
.3677 5.49902 4H3C2.72386 4 2.5 3.77614 2.5 3.5C2.5 3.22386 2.72386 3 3 3H6=
.5C6.63261 3 6.75975 3.05272 6.85352 3.14648C6.92392 3.21689 6.97106 3.3061=
1 6.99023 3.40234L7 3.5V7C7 7.27614 6.77614 7.5 6.5 7.5C6.22386 7.5 6 7.276=
14 6 7V4.87891C4.4782 6.06926 3.5 7.91979 3.5 10C3.5 13.5899 6.41015 16.5 1=
0 16.5C13.5899 16.5 16.5 13.5899 16.5 10C16.5 6.5225 13.7691 3.68312 10.335=
 3.50879L10 3.5L9.89941 3.49023C9.67145 3.44371 9.5 3.24171 9.5 3C9.5 2.723=
86 9.72386 2.5 10 2.5L10.3857 2.50977Z"></path></svg></div></button></div><=
div class=3D"w-fit" data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Edit"=
><div class=3D"text-text-500 group-hover/btn:text-text-100" style=3D"width:=
 20px; height: 20px; display: flex; align-items: center; justify-content: c=
enter;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curre=
ntColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-text-500 group-=
hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><pa=
th d=3D"M9.72821 2.87934C10.0318 2.10869 10.9028 1.72933 11.6735 2.03266L14=
.4655 3.13226C15.236 3.43593 15.6145 4.30697 15.3112 5.07758L11.3903 15.030=
7C11.2954 15.2717 11.1394 15.4835 10.9391 15.6459L10.8513 15.7123L7.7077 17=
.8979C7.29581 18.1843 6.73463 17.9917 6.57294 17.5356L6.54657 17.4409L5.737=
 13.6987C5.67447 13.4092 5.69977 13.107 5.80829 12.8315L9.72821 2.87934ZM6.=
73798 13.1987C6.70201 13.2903 6.69385 13.3906 6.71454 13.4868L7.44501 16.86=
27L10.28 14.892L10.3376 14.8452C10.3909 14.7949 10.4325 14.7332 10.4597 14.=
6645L13.0974 7.96723L9.37567 6.50141L6.73798 13.1987ZM11.3073 2.96332C11.05=
04 2.86217 10.7601 2.98864 10.6589 3.24555L9.74188 5.57074L13.4636 7.03754L=
14.3806 4.71137C14.4817 4.45445 14.3552 4.16413 14.0983 4.06293L11.3073 2.9=
6332Z"></path></svg></div></button></div></div><div class=3D"w-fit" data-st=
ate=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" data-testid=3D"acti=
on-bar-copy" aria-label=3D"Copy"><div class=3D"relative text-text-500 group=
-hover/btn:text-text-100"><div class=3D"transition-all opacity-100 scale-10=
0" style=3D"width: 20px; height: 20px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"tr=
ansition-all opacity-100 scale-100" aria-hidden=3D"true" style=3D"flex-shri=
nk: 0;"><path d=3D"M12.5 3C13.3284 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 =
6.67157 17 7.5V15.5C17 16.3284 16.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 =
6 15.5V14H4.5C3.67157 14 3 13.3284 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.=
5ZM14 12.5C14 13.3284 13.3284 14 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16=
H15.5C15.7761 16 16 15.7761 16 15.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5=
ZM4.5 4C4.22386 4 4 4.22386 4 4.5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.=
7761 13 13 12.7761 13 12.5V4.5C13 4.22386 12.7761 4 12.5 4H4.5Z"></path></s=
vg></div><div class=3D"absolute top-0 left-0 transition-all opacity-0 scale=
-50" style=3D"width: 20px; height: 20px; display: flex; align-items: center=
; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 =
20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"=
absolute top-0 left-0 transition-all opacity-0 scale-50" aria-hidden=3D"tru=
e" style=3D"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15=
.6346 4.96153 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.736=
05L15.8836 5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 =
14.9989C7.88203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.0=
8172 11.2752C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755=
 4.58105 10.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.=
1794L15.1883 5.10908Z"></path></svg></div></div></button></div><div class=
=3D"flex items-center"></div></div></div></div></div></div></div><div data-=
test-render-count=3D"2"><div class=3D"group" style=3D"height: auto; opacity=
: 1; transform: none;"><div class=3D"contents"><div data-is-streaming=3D"fa=
lse" class=3D"group relative relative pb-3" style=3D"opacity: 1; transform:=
 none;"><div class=3D"font-claude-response relative leading-[1.65rem] [&amp=
;_pre>div]:bg-bg-000/50 [&amp;_pre>div]:border-0.5 [&amp;_pre>div]:border-b=
order-400 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_.standard-markdo=
wn_:is(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&amp;_.standard-markdown_:is(=
p,blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8 [&amp;_.progressive-markdown_:i=
s(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&amp;_.progressive-markdown_:is(p,=
blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8"><div><div class=3D"standard-mark=
down grid-cols-1 grid [&amp;_>_*]:min-w-0 gap-3 standard-markdown"><h1 clas=
s=3D"text-text-100 mt-3 -mb-1 text-[1.375rem] font-bold">Robotic Dishwashin=
g System: Architecture and Best Practices</h1>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">This is an excellent robotics project combining computer vision, 3D=
 reconstruction, and manipulation planning. Here's a comprehensive approach=
:</p>
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">System Arc=
hitecture Overview</h2>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]"><strong>Pipeline Flow:</strong></p>
<ol class=3D"[li_&amp;]:mb-0 [li_&amp;]:mt-1 [li_&amp;]:gap-1 [&amp;:not(:l=
ast-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal flex flex=
-col gap-1 pl-8 mb-3">
<li class=3D"whitespace-normal break-words pl-2">Vision (Qwen3-VL) =E2=86=
=92 2. 3D Geometry Reconstruction =E2=86=92 3. Grasp Planning =E2=86=92 4. =
Sim-to-Real Transfer =E2=86=92 5. Robot Control</li>
</ol>
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">Platform R=
ecommendation: NVIDIA Isaac Sim</h2>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]"><strong>Why Isaac Sim over other options:</strong></p>
<ul class=3D"[li_&amp;]:mb-0 [li_&amp;]:mt-1 [li_&amp;]:gap-1 [&amp;:not(:l=
ast-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc flex flex-co=
l gap-1 pl-8 mb-3">
<li class=3D"whitespace-normal break-words pl-2">Native USD (Universal Scen=
e Description) support for photorealistic simulation</li>
<li class=3D"whitespace-normal break-words pl-2">Built-in physics engine (P=
hysX) for accurate dish dynamics</li>
<li class=3D"whitespace-normal break-words pl-2">Synthetic data generation =
for training</li>
<li class=3D"whitespace-normal break-words pl-2">ROS/ROS2 integration</li>
<li class=3D"whitespace-normal break-words pl-2">Direct robot simulation wi=
th accurate kinematics</li>
<li class=3D"whitespace-normal break-words pl-2">Domain randomization for s=
im-to-real transfer</li>
</ul>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]"><strong>Alternative:</strong> Gazebo + MoveIt, but Isaac Sim offers=
 better visual fidelity and ML integration.</p>
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">Detailed I=
mplementation Plan</h2>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">Phase 1: Vision =
&amp; 3D Reconstruction</h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># vision_=
module.py</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> torch
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> transformers </span><span class=3D"t=
oken token" style=3D"color: rgb(129, 0, 194);">import</span><span> Qwen2VLF=
orConditionalGeneration</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">,</span><span> AutoProcessor
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> numpy </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> open3d </span><span class=3D"token=
 token" style=3D"color: rgb(129, 0, 194);">as</span><span> o3d
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">DishVisionSystem</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Combines Qwen3-VL for semantic understanding with t=
raditional CV
</span><span>    for geometric reconstruction
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> model_path</span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 0);">"Qwen/Qwen2-VL-7B=
-Instruct"</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:=
</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>processor </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> AutoPro=
cessor</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
.</span><span>from_pretrained</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">(</span><span>model_path</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>model </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Qwen2VLForCo=
nditionalGeneration</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">.</span><span>from_pretrained</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            model_path</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            torch_dtype</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>torch</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>flo=
at16</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,<=
/span><span>
</span></span><span><span>            device_map</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 0);">"auto"</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">detect_dishes</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> rgb_image</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> prompt</span><span class=3D"token token" style=3D"color: rgb(20, 24, =
31);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);=
">"Identify all dishes in this sink and their positions"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Use Qwen3-VL for semanti=
c dish detection"""</span><span>
</span></span><span><span>        messages </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">"role"</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 0);">"user"</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">"content"</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">[</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 0);">"type"</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">"image"</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">"image"</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> rgb_imag=
e</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">}</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 0);">"type"</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">"text"</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">"text"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> prompt</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">}</span><=
span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        inputs </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>processor</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            text</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span>self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>processor<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span=
><span>apply_chat_template</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">(</span><span>messages</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> tokenize</span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">False</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            images</span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span>rgb_image</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            return_tensors</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">"pt"</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">.</span><span>to</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>model</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>de=
vice</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span>       =20
</span><span><span>        outputs </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>model</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>gene=
rate</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(<=
/span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">**</spa=
n><span>inputs</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">,</span><span> max_new_tokens</span><span class=3D"token token" sty=
le=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">512</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> self</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>processor</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>decode</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span>outputs</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> skip_special_tokens</span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" styl=
e=3D"color: rgb(0, 128, 128);">True</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">reconstruct_3d_geometry</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> rg=
b_image</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>,</span><span> depth_image</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">,</span><span> camera_intrinsics</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Convert RGBD to point cloud for geometric recon=
struction
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Create point cloud from depth</span><span=
>
</span></span><span><span>        height</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> width </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> depth_i=
mage</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.<=
/span><span>shape
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Generate pixel coordinates</span><span>
</span></span><span><span>        u </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>arange</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>widt=
h</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span>
</span></span><span><span>        v </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>arange</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>heig=
ht</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span>
</span></span><span><span>        u</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> v </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>meshgrid=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>u</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">,</span><span> v</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Unproject to 3D</span><span>
</span></span><span><span>        fx</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span> fy </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> camera_intrinsic=
s</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'fx'</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> cam=
era_intrinsics</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);=
">'fy'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
]</span><span>
</span></span><span><span>        cx</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span> cy </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> camera_intrinsic=
s</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'cx'</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> cam=
era_intrinsics</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);=
">'cy'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
]</span><span>
</span></span><span>       =20
</span><span><span>        z </span><span class=3D"token token" style=3D"co=
lor: rgb(20, 24, 31);">=3D</span><span> depth_image
</span></span><span><span>        x </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span>u </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span> cx</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</s=
pan><span> z </span><span class=3D"token token" style=3D"color: rgb(20, 24,=
 31);">/</span><span> fx
</span></span><span><span>        y </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span>v </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span> cy</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</s=
pan><span> z </span><span class=3D"token token" style=3D"color: rgb(20, 24,=
 31);">/</span><span> fy
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Stack into point cloud</span><span>
</span></span><span><span>        points </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>stack</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>x</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan> y</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> z</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> axis</span><span class=3D"token token" style=3D"color: =
rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb=
(20, 24, 31);">-</span><span class=3D"token token" style=3D"color: rgb(0, 1=
28, 128);">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>.</span><span>reshape</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(20,=
 24, 31);">-</span><span class=3D"token token" style=3D"color: rgb(0, 128, =
128);">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, =
128, 128);">3</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">)</span><span>
</span></span><span><span>        colors </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> rgb_image</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>reshap=
e</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 12=
8);">255.0</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Filter invalid points</span><span>
</span></span><span><span>        valid </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>z</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>flatten=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&g=
t;</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 1=
28, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span> </span><span class=3D"token token" style=3D"color: rgb=
(20, 24, 31);">&amp;</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>z</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>flatten</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2.0</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span>
</span></span><span><span>        points </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> points</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>valid</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><s=
pan>
</span></span><span><span>        colors </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> colors</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>valid</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><s=
pan>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Create Open3D point cloud</span><span>
</span></span><span><span>        pcd </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>PointCloud</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span>
</span></span><span><span>        pcd</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">.</span><span>points </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>u=
tility</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
.</span><span>Vector3dVector</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">(</span><span>points</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        pcd</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">.</span><span>colors </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>u=
tility</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
.</span><span>Vector3dVector</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">(</span><span>colors</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> pcd
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">segment_individual_dishes</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> =
point_cloud</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Use clustering to segment individual dishes
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># DBSCAN clustering for segmentation</span>=
<span>
</span></span><span><span>        labels </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>=
point_cloud</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">.</span><span>cluster_dbscan</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            eps</span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">0.02</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span class=3D"token =
token" style=3D"color: rgb(110, 118, 135);"># 2cm</span><span>
</span></span><span><span>            min_points</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 128);">100</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Extract individual dish point clouds</span><span>
</span></span><span><span>        dishes </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> label </span><span class=3D"=
token token" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(179, 74, 0);">set</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>labels=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><sp=
an>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> label </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>  </s=
pan><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Nois=
e</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">continue</span><span>
</span></span><span><span>            mask </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> labels </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> =
label
</span></span><span><span>            dish_pcd </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> point_cloud</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>select_by_index</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span>np</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">.</span><span>where</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>mask</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            dishes</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>dish_pcd<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> dishes</span></span></code></pre>=
</div></div>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">Phase 2: Grasp P=
lanning Algorithm</h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># grasp_p=
lanning.py</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> numpy </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> scipy</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>spatial</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>transfor=
m </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">imp=
ort</span><span> Rotation
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">GraspPlanner</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Generates grasping poses for dishes based on 3D geo=
metry
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> gripper_width</sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.08</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>gripper_width </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grip=
per_width
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">compute_grasp_candidates</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> d=
ish_point_cloud</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Generate potential grasp poses for a dish
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Compute oriented bounding box</span><span=
>
</span></span><span><span>        obb </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> dish_point_cloud</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ge=
t_oriented_bounding_box</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Get principal axes</span><span>
</span></span><span><span>        R </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> obb</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>R
</span></span><span><span>        center </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> obb</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>center
</span></span><span><span>        extent </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> obb</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>extent
</span></span><span>       =20
</span><span><span>        grasp_candidates </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Strategy 1: Top-down grasp (plates, bowls)</span>=
<span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> extent</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.05</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>  </=
span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Fla=
t object</span><span>
</span></span><span><span>            grasp </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_top_dow=
n_grasp</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span>center</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">,</span><span> R</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            grasp_candidates</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>grasp</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Strategy 2: Side grasp (cups, glasses)</span><spa=
n>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> extent</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">&gt;</span><span> extent</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">and</span>=
<span> extent</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128)=
;">2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]<=
/span><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24,=
 31);">&gt;</span><span> extent</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">:</span><span>  </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Tall object</span><span>
</span></span><span><span>            grasp </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_side_gr=
asp</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span>center</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span> R</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">,</span><span> extent</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            grasp_candidates</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>grasp</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Strategy 3: Rim grasp (bowls, cups)</span><span>
</span></span><span><span>        rim_grasps </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_rim_gr=
asp</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span>dish_point_cloud</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        grasp_candidates</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>extend</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>rim=
_grasps</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> grasp_candidates
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_top_down_grasp</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> center</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> orientation</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Grasp from above"""</spa=
n><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Approach from top with gripper parallel t=
o surface</span><span>
</span></span><span><span>        grasp_pose </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> center </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><span> np</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>array</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>0.1</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"=
># 10cm above</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> orientation</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'approach_vector'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'gripper_width'</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span> self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>gripper_=
width </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
*</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">0.8</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> grasp_pose
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_side_grasp</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> center</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 orientation</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">,</span><span> extent</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Grasp from the side"""</=
span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Find the narrowest dimension for grasping=
</span><span>
</span></span><span><span>        min_dim_idx </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>argmin</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span>extent</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span>
</span></span><span><span>        approach </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> orientation</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> min_dim_i=
dx</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</s=
pan><span>
</span></span><span>       =20
</span><span><span>        grasp_pose </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> center</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> orientation</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'approach_vector'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> approach</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'gripper_width'</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span> extent</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>min_di=
m_idx</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]=
</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> grasp_pose
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_rim_grasp</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> point_cloud</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Find rim of bowl/cup for=
 grasping"""</span><span>
</span></span><span><span>        points </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>asarray</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n>point_cloud</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">.</span><span>points</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Find highest points (rim candidates)</span><span>
</span></span><span><span>        z_threshold </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>percenti=
le</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>points</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">95</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span>
</span></span><span><span>        rim_points </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> points</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>point=
s</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&=
gt;</span><span> z_threshold</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(179, 74, 0);">len</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>rim_points</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">10</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><s=
pan>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Sample grasp points on rim</span><span>
</span></span><span><span>        grasp_candidates </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> _ </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">3</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span>  </span><span class=
=3D"token token" style=3D"color: rgb(110, 118, 135);"># Generate 3 rim gras=
ps</span><span>
</span></span><span><span>            idx </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>randint</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">=
len</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span>rim_points</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span>
</span></span><span><span>            point </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rim_points</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>id=
x</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</sp=
an><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Compute approach direction (radially inward)<=
/span><span>
</span></span><span><span>            center_xy </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>mean</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span>points</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">[</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">:</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> axis</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span>
</span></span><span><span>            approach_2d </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> center_xy </sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><s=
pan> point</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">[</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:=
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><s=
pan>
</span></span><span><span>            approach_2d </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">/=3D</span><span> np</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>lin=
alg</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>norm</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span>approach_2d</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            approach </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
>approach_2d</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> approach_2d</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128,=
 128);">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,<=
/span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128,=
 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span>           =20
</span><span><span>            grasp_pose </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> point</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> self</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_compu=
te_orientation_from_approach</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">(</span><span>approach</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'approach_vector'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> approach</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'gripper_width'</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> self</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>grip=
per_width </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">*</span><span> </span><span class=3D"token token" style=3D"color: rgb(0=
, 128, 128);">0.6</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span><span>            grasp_candidates</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>grasp_pose</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> grasp_candidates
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_compute_orientation_from_approach</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>self=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</spa=
n><span> approach_vector</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Convert approach vector =
to rotation matrix"""</span><span>
</span></span><span><span>        z_axis </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> approach_vector </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><span=
> np</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.<=
/span><span>linalg</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">.</span><span>norm</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span>approach_vector</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        x_axis </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        y_axis </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>cross</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>=
z_axis</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> x_axis</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span>
</span></span><span><span>        y_axis </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">/=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>linalg</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>norm</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">(</span><span>y_axis</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">)</span><span>
</span></span><span><span>        x_axis </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>cross</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>=
y_axis</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> z_axis</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> np</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>column_stack</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>x_axis</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> y_axis</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span> z_axis</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">rank_grasps</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> grasp_candidat=
es</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> collision_checker</span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 128);">None</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Score and rank grasp candidates
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        scores </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> grasp </span><span class=3D"=
token token" style=3D"color: rgb(129, 0, 194);">in</span><span> grasp_candi=
dates</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:=
</span><span>
</span></span><span><span>            score </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0.0</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Prefer top-down grasps (more stable)</span><s=
pan>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> grasp</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">'approach_vector'</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.8</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                score </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.4</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Prefer grasps with gripper well within capaci=
ty</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">0.02</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> g=
rasp</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'gripper=
_width'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>]</span><span> </span><span class=3D"token token" style=3D"color: rgb(20, =
24, 31);">&lt;</span><span> self</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">.</span><span>gripper_width </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">*</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.9</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                score </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.3</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Height preference (easier to reach)</span><sp=
an>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> grasp</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">0.05</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                score </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Collision check</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> collision_checker </span><=
span class=3D"token token" style=3D"color: rgb(129, 0, 194);">and</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">n=
ot</span><span> collision_checker</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>check_collision</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>grasp</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                score </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.1</span><span>
</span></span><span>           =20
</span><span><span>            scores</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>score</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Sort by score</span><span>
</span></span><span><span>        ranked_indices </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>argso=
rt</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>scores</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">[</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">[</span><span>grasp_candidates<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span=
><span>i</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">]</span><span> </span><span class=3D"token token" style=3D"color: rgb(129=
, 0, 194);">for</span><span> i </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">in</span><span> ranked_indices</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>scores=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</spa=
n><span>i</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">]</span><span> </span><span class=3D"token token" style=3D"color: rgb(12=
9, 0, 194);">for</span><span> i </span><span class=3D"token token" style=3D=
"color: rgb(129, 0, 194);">in</span><span> ranked_indices</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span></span></code></=
pre></div></div>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">Phase 3: Isaac S=
im Virtual Environment Setup</h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># isaac_s=
im_environment.py</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>kit </span=
><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">import</spa=
n><span> SimulationApp
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> omni</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>core</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>utils</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">.</span><span>stage </span><span class=3D"token token" style=3D"color: rg=
b(129, 0, 194);">as</span><span> stage_utils
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>core </spa=
n><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">import</sp=
an><span> World
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>core</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>objects </span><span class=3D"token token" style=3D"color: rgb(129, 0, 19=
4);">import</span><span> DynamicCuboid
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>core</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>prims </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194)=
;">import</span><span> RigidPrimView
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> numpy </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">VirtualSinkEnvironment</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Create virtual sink environment in Isaac Sim
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> headless</span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 128);">False</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>simulation_app </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Sim=
ulationApp</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">{=
</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"headless"</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> headless</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"width"</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">1280</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"height"</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">720</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>world </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> World</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>setup_scene</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">setup_scene</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Build the virtual sink s=
cene"""</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Add ground plane</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>scene</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>add=
_default_ground_plane</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Create sink</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>create_sink</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Add lighting</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>add_lighting</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Add camera</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>add_camera</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">create_sink</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Create sink geometry"""<=
/span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Sink basin (using USD primitive)</span><s=
pan>
</span></span><span><span>        stage_utils</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">.</span><span>create_new_stage</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Sink walls</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>create_sink_wall</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0.25</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.1</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.5</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.01</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.=
2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135)=
;"># Back</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>create_sink_wall</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.25</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.1</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0.5</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.01</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>=
  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);">#=
 Front</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>create_sink_wall</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.25</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.1</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.01</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.5</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.=
2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135)=
;"># Right</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>create_sink_wall</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">0.25</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.1</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.01</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.5</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"=
># Left</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Sink bottom</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>create_sink_wall</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0.5</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.5</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </=
span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.01</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">create_sink_wall</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> position<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span> scale</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Helper to create sink wa=
lls"""</span><span>
</span></span><span><span>        wall </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> DynamicCuboid</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            prim_path</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en string-interpolation" style=3D"color: rgb(0, 128, 0);">f"/World/Sink/Wal=
l_</span><span class=3D"token token string-interpolation interpolation" sty=
le=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token string-in=
terpolation interpolation" style=3D"color: rgb(179, 74, 0);">len</span><spa=
n class=3D"token token string-interpolation interpolation" style=3D"color: =
rgb(43, 48, 59);">(</span><span class=3D"token token string-interpolation i=
nterpolation">self</span><span class=3D"token token string-interpolation in=
terpolation" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token=
 token string-interpolation interpolation">world</span><span class=3D"token=
 token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);=
">.</span><span class=3D"token token string-interpolation interpolation">sc=
ene</span><span class=3D"token token string-interpolation interpolation" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token token string-i=
nterpolation interpolation">_scene_registry</span><span class=3D"token toke=
n string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">)</=
span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">"</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            position</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan>position</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>,</span><span>
</span></span><span><span>            scale</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>scale</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span>
</span></span><span><span>            color</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.8</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.8</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.8</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>scene</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>add=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>wall</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> wall
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">add_lighting</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Add realistic lighting""=
"</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">from</span><span> pxr </span><span class=3D"t=
oken token" style=3D"color: rgb(129, 0, 194);">import</span><span> UsdLux</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> Gf
</span></span><span>       =20
</span><span><span>        stage </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>stag=
e
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Dome light for ambient</span><span>
</span></span><span><span>        dome_light </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> UsdLux</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>DomeL=
ight</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.<=
/span><span>Define</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">(</span><span>stage</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 0);">"/World/DomeLight"</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        dome_light</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>CreateIntensityAttr</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">500</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Directional light for shadows</span><span>
</span></span><span><span>        distant_light </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> UsdLux</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Di=
stantLight</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>Define</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">(</span><span>stage</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"/World/DistantLight"</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        distant_light</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>CreateIntensityAttr<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1000</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
>
</span></span><span><span>        distant_light</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>AddOrientOp</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Set</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>Gf</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>Quatf</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">0.707</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">0.707</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"co=
lor: rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">add_camera</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Add RGBD camera above si=
nk"""</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>se=
nsor </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">=
import</span><span> Camera
</span></span><span>       =20
</span><span><span>        camera </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> Camera</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            prim_path</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"/World/Camera"</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            position</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.8</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            orientation</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>  =
</span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># L=
ooking down</span><span>
</span></span><span><span>            frequency</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">30</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            resolution</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 128);">640</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">480</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        camera</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>initialize</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>camera </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> camera
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">spawn_random_dishes</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> num_di=
shes</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">5<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><spa=
n>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Randomly spawn dishes in=
 sink"""</span><span>
</span></span><span><span>        dish_types </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 0);">'plate'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 0);">'bowl'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'cup'</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'glass=
'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</sp=
an><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">for</span><span> i </span><span class=3D"token token"=
 style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(179, 74, 0);">range</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>num_dishes</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            dish_type </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</spa=
n><span>choice</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">(</span><span>dish_types</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            position </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
>
</span></span><span><span>                np</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>uniform</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.15</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.15</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                np</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>uniform</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.15</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.15</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">0.05</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><span> i </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span=
> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.0=
5</span><span>  </span><span class=3D"token token" style=3D"color: rgb(110,=
 118, 135);"># Stack with offset</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            self</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>spawn_dish</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span>dish_type</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> position</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">,</span><span> </span><span class=3D"token token string-interpolation=
" style=3D"color: rgb(0, 128, 0);">f"dish_</span><span class=3D"token token=
 string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">{</s=
pan><span class=3D"token token string-interpolation interpolation">i</span>=
<span class=3D"token token string-interpolation interpolation" style=3D"col=
or: rgb(43, 48, 59);">}</span><span class=3D"token token string-interpolati=
on" style=3D"color: rgb(0, 128, 0);">"</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">spawn_dish</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> dish_type</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n> position</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> name</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Spawn a single dish with=
 physics"""</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># This would load actual dish meshes - simp=
lified here</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> dish_type </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'plate'</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><s=
pan>
</span></span><span><span>            scale </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.12</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.12</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.02</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">elif</span><span> dish_type </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'bowl'</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><s=
pan>
</span></span><span><span>            scale </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.10</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.10</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.05</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">elif</span><span> dish_type </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'cup'</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><sp=
an>
</span></span><span><span>            scale </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.04</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.04</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.08</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>  </span><span class=3D"token to=
ken" style=3D"color: rgb(110, 118, 135);"># glass</span><span>
</span></span><span><span>            scale </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.03</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.03</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.10</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>           =20
</span><span><span>        dish </span><span class=3D"token token" style=3D=
"color: rgb(20, 24, 31);">=3D</span><span> DynamicCuboid</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            prim_path</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en string-interpolation" style=3D"color: rgb(0, 128, 0);">f"/World/Dishes/<=
/span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token string-inte=
rpolation interpolation">name</span><span class=3D"token token string-inter=
polation interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span cla=
ss=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">"<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span>
</span></span><span><span>            position</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>position</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            scale</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>scale</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span>
</span></span><span><span>            color</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>rand</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>scene</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>add=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>dish</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">get_camera_observation</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Capture RGBD from camera=
"""</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>camera</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>initialize</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        rgb </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>camera</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
get_rgba</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        depth </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>camera</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>get_depth</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> rgb</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> depth
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">step_simulation</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Advance simulation one s=
tep"""</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>step</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>rend=
er</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">True</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
</span></code></pre></div></div>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">Phase 4: Robot A=
rm Integration</h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># robot_c=
ontroller.py</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>franka </s=
pan><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">import</=
span><span> Franka
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>core</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>controllers </span><span class=3D"token token" style=3D"color: rgb(129, 0=
, 194);">import</span><span> BaseController
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>motion_gen=
eration </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194)=
;">import</span><span> RmpFlow
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> numpy </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">DishwashingRobotController</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Control robot arm to pick up dishes
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> world</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>world </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> world
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Add Franka robot (or your preferred arm)</span><s=
pan>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>robot </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Franka</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n>
</span></span><span><span>            prim_path</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"/World/Franka"</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            name</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 0);">"franka"</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            position</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.5</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>scene</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>add=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">.</span><span>robot</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Motion planning</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>motion_planner </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Rmp=
Flow</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(<=
/span><span>
</span></span><span><span>            robot_articulation</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>self</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>robot</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">,</span><span>
</span></span><span><span>            urdf_path</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>self</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>robot<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span=
><span>urdf_path
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">execute_grasp</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> grasp_pose</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span=
>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Execute a grasp given target pose
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Plan approach trajectory</span><span>
</span></span><span><span>        approach_pose </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp_pose</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>copy</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span>
</span></span><span><span>        approach_pose</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> grasp_pos=
e</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'approach_v=
ector'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
]</span><span> </span><span class=3D"token token" style=3D"color: rgb(20, 2=
4, 31);">*</span><span> </span><span class=3D"token token" style=3D"color: =
rgb(20, 24, 31);">-</span><span class=3D"token token" style=3D"color: rgb(0=
, 128, 128);">0.1</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Move to pre-grasp</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>move_to_pose</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>approach_=
pose</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Open gripper</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>robot</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>gripper</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span c=
lass=3D"token token" style=3D"color: rgb(179, 74, 0);">open</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Approach</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>move_to_pose</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>grasp_pos=
e</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Close gripper</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>robot</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>gripper</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>c=
lose</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Lift</span><span>
</span></span><span><span>        lift_pose </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp_pose</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>co=
py</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span>
</span></span><span><span>        lift_pose</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"=
color: rgb(0, 128, 128);">2</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">0.15</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>move_to_pose</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>lift_pose=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Move to placement location</span><span>
</span></span><span><span>        place_pose </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>array</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.3</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</=
span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.5</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
0.3</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">}</span><span=
>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>move_to_pose</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>place_pos=
e</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Release</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>robot</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>gripper</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span c=
lass=3D"token token" style=3D"color: rgb(179, 74, 0);">open</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">move_to_pose</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> target_pose</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span=
>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Move end effector to tar=
get pose"""</span><span>
</span></span><span><span>        target_position </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> target_pose</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'position'</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><sp=
an>
</span></span><span><span>        target_orientation </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> target_pose=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</spa=
n><span>get</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'=
orientation'</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">,</span><span> np</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">.</span><span>eye</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 128);">3</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Use RMPflow for collision-free motion</span><span=
>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> _ </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">100</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span>  </span><span class=
=3D"token token" style=3D"color: rgb(110, 118, 135);"># Max iterations</spa=
n><span>
</span></span><span><span>            current_ee_pose </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>robot</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>.</span><span>end_effector</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">.</span><span>get_world_pose</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Compute target joint positions</span><span>
</span></span><span><span>            target_joint_positions </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> sel=
f</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>motion_planner</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">.</span><span>compute_joint_targets</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                target_position</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>target_p=
osition</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>,</span><span>
</span></span><span><span>                target_orientation</span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>targe=
t_orientation
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Apply joint commands</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>robot</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>apply_acti=
on</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>target_joint_positions</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>step</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n>render</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);=
">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
True</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Check if reached</span><span>
</span></span><span><span>            position_error </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>l=
inalg</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.=
</span><span>norm</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span>
</span></span><span><span>                current_ee_pose</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span> target_po=
sition
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> position_error </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.01=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, =
135);"># 1cm threshold</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">break</span></span></code></pre></div>=
</div>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">Phase 5: Trainin=
g Pipeline</h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># trainin=
g_pipeline.py</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> torch
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> torch</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>nn </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">as</span><span> nn
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> torch</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>utils</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>data </spa=
n><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">import</sp=
an><span> Dataset</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span> DataLoader
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">SyntheticDishDataset</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>Dataset</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Generate synthetic training data from Isaac Sim
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> env</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> num_s=
amples</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">10=
00</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><=
span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>env </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> env
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>num_samples </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> num_sa=
mples
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>samples </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>generate_data</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">generate_data</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Generate synthetic train=
ing data"""</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> i </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>num_samples</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Randomize scene</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>env</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>spawn_random_d=
ishes</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span>num_dishes</span><span class=3D"token token" style=3D"color: r=
gb(20, 24, 31);">=3D</span><span>np</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>random</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>randint</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">8</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>env</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>step_simulatio=
n</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Capture observation</span><span>
</span></span><span><span>            rgb</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span> depth </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>env</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">.</span><span>get_camera_observation</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Get ground truth labels from simulator</span>=
<span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># (positions, orientations, grasp succes=
s labels)</span><span>
</span></span><span><span>            labels </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>extract=
_ground_truth</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">)</span><span>
</span></span><span>           =20
</span><span><span>            self</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>samples</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'rgb'</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> rgb</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'depth'</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> depth</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'labels'</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> labels
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Reset</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>env</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>reset</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__len__</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>samples<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__getitem__</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> idx</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> self</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>samples</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><spa=
n>idx</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]=
</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">GraspSuccessPredictor</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">(</span><span>nn</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Module<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><spa=
n>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Neural network to predict grasp success
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">super</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">.</span><span>__init__</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># This would integrate with your Qwen3-VL f=
eatures</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>feature_extractor </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
nn</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</s=
pan><span>Sequential</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">(</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Conv2d</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">4</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">64</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> padding</=
span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>  </sp=
an><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># RGBD =
input</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>MaxPool2d</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Conv2d</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">64</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">128</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> padd=
ing</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>MaxPool2d</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>grasp_predictor </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> nn</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>Sequential</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">(</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">128</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">160</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);"=
>*</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 1=
28, 128);">120</span><span> </span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">+</span><span> </span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">7</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">256</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span class=3D"token =
token" style=3D"color: rgb(110, 118, 135);"># + grasp pose params</span><sp=
an>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">256</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Sigmoid</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">forward</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> rgbd</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> grasp=
_pose</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span>
</span></span><span><span>        features </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>feature_e=
xtractor</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">(</span><span>rgbd</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">)</span><span>
</span></span><span><span>        features </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> features</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>flatt=
en</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
>
</span></span><span><span>        combined </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>cat</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>fe=
atures</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> grasp_pose</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">,</span><span> dim</span><span class=3D"token token" style=3D=
"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"co=
lor: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        success_prob </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>grasp=
_predictor</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span>combined</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> success_prob</span></span=
></code></pre></div></div>
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">Best Pract=
ices</h2>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">1. <strong>Domai=
n Randomization</strong></h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Randomi=
ze in simulation:</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Lighting conditions </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>intensity<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span> color temperature</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">)</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Camera noise </span><span class=3D"token=
 token" style=3D"color: rgb(129, 0, 194);">and</span><span> artifacts
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Dish textures</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> colors</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> mat=
erials
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Sink surface properties
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Number </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">and</span><span> arrangement of dishes=
</span></span></code></pre></div></div>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">2. <strong>Sim-t=
o-Real Transfer</strong></h3>
<ul class=3D"[li_&amp;]:mb-0 [li_&amp;]:mt-1 [li_&amp;]:gap-1 [&amp;:not(:l=
ast-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc flex flex-co=
l gap-1 pl-8 mb-3">
<li class=3D"whitespace-normal break-words pl-2">Use photorealistic renderi=
ng in Isaac Sim</li>
<li class=3D"whitespace-normal break-words pl-2">Match real camera intrinsi=
cs exactly</li>
<li class=3D"whitespace-normal break-words pl-2">Calibrate depth sensor noi=
se</li>
<li class=3D"whitespace-normal break-words pl-2">Test with diverse real dis=
hes</li>
</ul>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">3. <strong>Safet=
y &amp; Failure Handling</strong></h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">def</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(0, 81, 194);">=
safe_grasp_execution</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">(</span><span>self</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">,</span><span> grasp</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(110, 118, 135);"># Force/torque monitoring</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">if</span><span> self</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">.</span><span>robot</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>get_gripp=
er_force</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, =
31);">&gt;</span><span> threshold</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>robot</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>gripper</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span c=
lass=3D"token token" style=3D"color: rgb(179, 74, 0);">open</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Collision detection</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">if</span><span> self</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">.</span><span>detect_collision</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>robot</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>stop</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">return</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">True</span></span></code></pre></div></div=
>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">4. <strong>Perfo=
rmance Optimization</strong></h3>
<ul class=3D"[li_&amp;]:mb-0 [li_&amp;]:mt-1 [li_&amp;]:gap-1 [&amp;:not(:l=
ast-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc flex flex-co=
l gap-1 pl-8 mb-3">
<li class=3D"whitespace-normal break-words pl-2">Use GPU acceleration for Q=
wen3-VL inference</li>
<li class=3D"whitespace-normal break-words pl-2">Batch process multiple gra=
sp candidates</li>
<li class=3D"whitespace-normal break-words pl-2">Cache point cloud processi=
ng</li>
<li class=3D"whitespace-normal break-words pl-2">Use Isaac Sim's async rend=
ering</li>
</ul>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">5. <strong>Evalu=
ation Metrics</strong></h3>
<ul class=3D"[li_&amp;]:mb-0 [li_&amp;]:mt-1 [li_&amp;]:gap-1 [&amp;:not(:l=
ast-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc flex flex-co=
l gap-1 pl-8 mb-3">
<li class=3D"whitespace-normal break-words pl-2">Grasp success rate</li>
<li class=3D"whitespace-normal break-words pl-2">Planning time</li>
<li class=3D"whitespace-normal break-words pl-2">Collision rate</li>
<li class=3D"whitespace-normal break-words pl-2">Dish damage rate</li>
<li class=3D"whitespace-normal break-words pl-2">Coverage (% of dishes succ=
essfully picked)</li>
</ul>
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">Next Steps=
</h2>
<ol class=3D"[li_&amp;]:mb-0 [li_&amp;]:mt-1 [li_&amp;]:gap-1 [&amp;:not(:l=
ast-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal flex flex=
-col gap-1 pl-8 mb-3">
<li class=3D"whitespace-normal break-words pl-2"><strong>Start with Isaac S=
im tutorial</strong> on omniverse.nvidia.com</li>
<li class=3D"whitespace-normal break-words pl-2"><strong>Implement basic vi=
sion pipeline</strong> with simple geometric shapes</li>
<li class=3D"whitespace-normal break-words pl-2"><strong>Integrate Qwen3-VL=
</strong> for semantic understanding</li>
<li class=3D"whitespace-normal break-words pl-2"><strong>Build grasp planni=
ng</strong> with simple heuristics first</li>
<li class=3D"whitespace-normal break-words pl-2"><strong>Generate synthetic=
 training data</strong> (10k+ samples)</li>
<li class=3D"whitespace-normal break-words pl-2"><strong>Train grasp succes=
s predictor</strong></li>
<li class=3D"whitespace-normal break-words pl-2"><strong>Sim-to-real transf=
er</strong> with real robot</li>
</ol>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">Would you like me to elaborate on any specific component or provide=
 more detailed code for a particular phase?</p></div></div></div></div></di=
v><div class=3D"flex justify-start opacity-0 group-hover:opacity-100 group-=
focus-within:opacity-100 transition" role=3D"group" aria-label=3D"Message a=
ctions"><div class=3D"text-text-300"><div class=3D"text-text-300 flex items=
-stretch justify-between"><div class=3D"w-fit" data-state=3D"closed"><butto=
n class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" data-testid=3D"acti=
on-bar-copy" aria-label=3D"Copy"><div class=3D"relative text-text-500 group=
-hover/btn:text-text-100"><div class=3D"transition-all opacity-100 scale-10=
0" style=3D"width: 20px; height: 20px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"tr=
ansition-all opacity-100 scale-100" aria-hidden=3D"true" style=3D"flex-shri=
nk: 0;"><path d=3D"M12.5 3C13.3284 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 =
6.67157 17 7.5V15.5C17 16.3284 16.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 =
6 15.5V14H4.5C3.67157 14 3 13.3284 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.=
5ZM14 12.5C14 13.3284 13.3284 14 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16=
H15.5C15.7761 16 16 15.7761 16 15.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5=
ZM4.5 4C4.22386 4 4 4.22386 4 4.5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.=
7761 13 13 12.7761 13 12.5V4.5C13 4.22386 12.7761 4 12.5 4H4.5Z"></path></s=
vg></div><div class=3D"absolute top-0 left-0 transition-all opacity-0 scale=
-50" style=3D"width: 20px; height: 20px; display: flex; align-items: center=
; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 =
20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"=
absolute top-0 left-0 transition-all opacity-0 scale-50" aria-hidden=3D"tru=
e" style=3D"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15=
.6346 4.96153 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.736=
05L15.8836 5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 =
14.9989C7.88203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.0=
8172 11.2752C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755=
 4.58105 10.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.=
1794L15.1883 5.10908Z"></path></svg></div></div></button></div><div class=
=3D"w-fit" data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Give =
positive feedback"><div class=3D"text-text-500 group-hover/btn:text-text-10=
0" style=3D"width: 16px; height: 16px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"te=
xt-text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"fl=
ex-shrink: 0;"><path d=3D"M9.56055 2C11.1381 2.00009 12.3211 3.44332 12.011=
7 4.99023L11.6094 7H13.8438C15.5431 7 16.836 8.52594 16.5566 10.2021L15.876=
 14.2842C15.6148 15.8513 14.2586 17 12.6699 17H4.5C3.67157 17 3 16.3284 3 1=
5.5V9.23828C3.00013 8.57996 3.4294 7.99838 4.05859 7.80469L5.19824 7.4541L5=
.33789 7.40723C6.02983 7.15302 6.59327 6.63008 6.89746 5.9541L8.41113 2.589=
84L8.48047 2.46094C8.66235 2.17643 8.97898 2.00002 9.32324 2H9.56055ZM7.809=
57 6.36523C7.39486 7.2867 6.62674 7.99897 5.68359 8.3457L5.49219 8.41016L4.=
35254 8.76074C4.14305 8.82539 4.00013 9.01904 4 9.23828V15.5C4 15.7761 4.22=
386 16 4.5 16H12.6699C13.7697 16 14.7087 15.2049 14.8896 14.1201L15.5703 10=
.0381C15.7481 8.97141 14.9251 8 13.8438 8H11C10.8503 8 10.7083 7.9331 10.61=
33 7.81738C10.5184 7.70164 10.4805 7.54912 10.5098 7.40234L11.0312 4.79395C=
11.2167 3.86589 10.507 3.00009 9.56055 3H9.32324L7.80957 6.36523Z"></path><=
/svg></div></button></div><div class=3D"w-fit" data-state=3D"closed"><butto=
n class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Give =
negative feedback"><div class=3D"text-text-500 group-hover/btn:text-text-10=
0" style=3D"width: 16px; height: 16px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"te=
xt-text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"fl=
ex-shrink: 0;"><path d=3D"M12.6699 3C14.2586 3 15.6148 4.14871 15.876 5.715=
82L16.5566 9.79785C16.836 11.4741 15.5431 13 13.8438 13H11.6094L12.0117 15.=
0098C12.3211 16.5567 11.1381 17.9999 9.56055 18H9.32324C8.97898 18 8.66235 =
17.8236 8.48047 17.5391L8.41113 17.4102L6.89746 14.0459C6.59327 13.3699 6.0=
2983 12.847 5.33789 12.5928L5.19824 12.5459L4.05859 12.1953C3.4294 12.0016 =
3.00013 11.42 3 10.7617V4.5C3 3.67157 3.67157 3 4.5 3H12.6699ZM4.5 4C4.2238=
6 4 4 4.22386 4 4.5V10.7617C4.00013 10.981 4.14305 11.1746 4.35254 11.2393L=
5.49219 11.5898L5.68359 11.6543C6.62674 12.001 7.39486 12.7133 7.80957 13.6=
348L9.32324 17H9.56055C10.507 16.9999 11.2167 16.1341 11.0312 15.2061L10.50=
98 12.5977C10.4805 12.4509 10.5184 12.2984 10.6133 12.1826C10.7083 12.0669 =
10.8503 12 11 12H13.8438C14.9251 12 15.7481 11.0286 15.5703 9.96191L14.8896=
 5.87988C14.7087 4.79508 13.7697 4 12.6699 4H4.5Z"></path></svg></div></but=
ton></div><div class=3D"flex items-center"><div class=3D"w-fit" data-state=
=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" id=3D"radix-_r_k7_"=
 aria-haspopup=3D"menu" aria-expanded=3D"false" data-state=3D"closed" aria-=
label=3D"Retry"><div class=3D"text-text-500 group-hover/btn:text-text-100" =
style=3D"width: 20px; height: 20px; display: flex; align-items: center; jus=
tify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20=
" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-=
text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-=
shrink: 0;"><path d=3D"M10.3857 2.50977C14.3486 2.71054 17.5 5.98724 17.5 1=
0C17.5 14.1421 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 7.5=
4619 3.67878 5.3677 5.49902 4H3C2.72386 4 2.5 3.77614 2.5 3.5C2.5 3.22386 2=
.72386 3 3 3H6.5C6.63261 3 6.75975 3.05272 6.85352 3.14648C6.92392 3.21689 =
6.97106 3.30611 6.99023 3.40234L7 3.5V7C7 7.27614 6.77614 7.5 6.5 7.5C6.223=
86 7.5 6 7.27614 6 7V4.87891C4.4782 6.06926 3.5 7.91979 3.5 10C3.5 13.5899 =
6.41015 16.5 10 16.5C13.5899 16.5 16.5 13.5899 16.5 10C16.5 6.5225 13.7691 =
3.68312 10.335 3.50879L10 3.5L9.89941 3.49023C9.67145 3.44371 9.5 3.24171 9=
.5 3C9.5 2.72386 9.72386 2.5 10 2.5L10.3857 2.50977Z"></path></svg></div></=
button></div></div></div></div></div></div></div><div data-test-render-coun=
t=3D"2"><div class=3D"mb-1 mt-6 group"><div class=3D"flex flex-col items-en=
d gap-1"><div class=3D"group relative inline-flex gap-2 bg-bg-300 rounded-x=
l pl-2.5 py-2.5 break-words text-text-100 transition-all max-w-[75ch] flex-=
col !px-4 max-w-[85%]" style=3D"opacity: 1; transform: none;"><div class=3D=
"flex flex-row gap-2 relative"><div class=3D"flex-1"><div data-testid=3D"us=
er-message" class=3D"font-large !font-user-message grid grid-cols-1 gap-2 p=
y-0.5 relative" style=3D"max-height: none; overflow: hidden; position: rela=
tive;"><p class=3D"whitespace-pre-wrap break-words">Can you please explain =
the graspsuccesspredictor?</p></div></div></div></div><div class=3D"flex ju=
stify-start opacity-0 group-hover:opacity-100 group-focus-within:opacity-10=
0 transition" role=3D"group" aria-label=3D"Message actions"><div class=3D"t=
ext-text-300"><div class=3D"text-text-300 flex items-stretch justify-betwee=
n"><span class=3D"text-text-500 text-xs flex items-center mr-2" data-state=
=3D"closed">Feb 4</span><div class=3D"flex items-center"><div class=3D"w-fi=
t" data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Retry=
"><div class=3D"text-text-500 group-hover/btn:text-text-100" style=3D"width=
: 20px; height: 20px; display: flex; align-items: center; justify-content: =
center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curr=
entColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-text-500 group=
-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><p=
ath d=3D"M10.3857 2.50977C14.3486 2.71054 17.5 5.98724 17.5 10C17.5 14.1421=
 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 7.54619 3.67878 5=
.3677 5.49902 4H3C2.72386 4 2.5 3.77614 2.5 3.5C2.5 3.22386 2.72386 3 3 3H6=
.5C6.63261 3 6.75975 3.05272 6.85352 3.14648C6.92392 3.21689 6.97106 3.3061=
1 6.99023 3.40234L7 3.5V7C7 7.27614 6.77614 7.5 6.5 7.5C6.22386 7.5 6 7.276=
14 6 7V4.87891C4.4782 6.06926 3.5 7.91979 3.5 10C3.5 13.5899 6.41015 16.5 1=
0 16.5C13.5899 16.5 16.5 13.5899 16.5 10C16.5 6.5225 13.7691 3.68312 10.335=
 3.50879L10 3.5L9.89941 3.49023C9.67145 3.44371 9.5 3.24171 9.5 3C9.5 2.723=
86 9.72386 2.5 10 2.5L10.3857 2.50977Z"></path></svg></div></button></div><=
div class=3D"w-fit" data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Edit"=
><div class=3D"text-text-500 group-hover/btn:text-text-100" style=3D"width:=
 20px; height: 20px; display: flex; align-items: center; justify-content: c=
enter;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curre=
ntColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-text-500 group-=
hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><pa=
th d=3D"M9.72821 2.87934C10.0318 2.10869 10.9028 1.72933 11.6735 2.03266L14=
.4655 3.13226C15.236 3.43593 15.6145 4.30697 15.3112 5.07758L11.3903 15.030=
7C11.2954 15.2717 11.1394 15.4835 10.9391 15.6459L10.8513 15.7123L7.7077 17=
.8979C7.29581 18.1843 6.73463 17.9917 6.57294 17.5356L6.54657 17.4409L5.737=
 13.6987C5.67447 13.4092 5.69977 13.107 5.80829 12.8315L9.72821 2.87934ZM6.=
73798 13.1987C6.70201 13.2903 6.69385 13.3906 6.71454 13.4868L7.44501 16.86=
27L10.28 14.892L10.3376 14.8452C10.3909 14.7949 10.4325 14.7332 10.4597 14.=
6645L13.0974 7.96723L9.37567 6.50141L6.73798 13.1987ZM11.3073 2.96332C11.05=
04 2.86217 10.7601 2.98864 10.6589 3.24555L9.74188 5.57074L13.4636 7.03754L=
14.3806 4.71137C14.4817 4.45445 14.3552 4.16413 14.0983 4.06293L11.3073 2.9=
6332Z"></path></svg></div></button></div></div><div class=3D"w-fit" data-st=
ate=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" data-testid=3D"acti=
on-bar-copy" aria-label=3D"Copy"><div class=3D"relative text-text-500 group=
-hover/btn:text-text-100"><div class=3D"transition-all opacity-100 scale-10=
0" style=3D"width: 20px; height: 20px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"tr=
ansition-all opacity-100 scale-100" aria-hidden=3D"true" style=3D"flex-shri=
nk: 0;"><path d=3D"M12.5 3C13.3284 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 =
6.67157 17 7.5V15.5C17 16.3284 16.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 =
6 15.5V14H4.5C3.67157 14 3 13.3284 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.=
5ZM14 12.5C14 13.3284 13.3284 14 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16=
H15.5C15.7761 16 16 15.7761 16 15.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5=
ZM4.5 4C4.22386 4 4 4.22386 4 4.5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.=
7761 13 13 12.7761 13 12.5V4.5C13 4.22386 12.7761 4 12.5 4H4.5Z"></path></s=
vg></div><div class=3D"absolute top-0 left-0 transition-all opacity-0 scale=
-50" style=3D"width: 20px; height: 20px; display: flex; align-items: center=
; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 =
20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"=
absolute top-0 left-0 transition-all opacity-0 scale-50" aria-hidden=3D"tru=
e" style=3D"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15=
.6346 4.96153 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.736=
05L15.8836 5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 =
14.9989C7.88203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.0=
8172 11.2752C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755=
 4.58105 10.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.=
1794L15.1883 5.10908Z"></path></svg></div></div></button></div><div class=
=3D"flex items-center"></div></div></div></div></div></div></div><div data-=
test-render-count=3D"2"><div class=3D"group" style=3D"height: auto; opacity=
: 1; transform: none;"><div class=3D"contents"><div data-is-streaming=3D"fa=
lse" class=3D"group relative relative pb-3" style=3D"opacity: 1; transform:=
 none;"><div class=3D"font-claude-response relative leading-[1.65rem] [&amp=
;_pre>div]:bg-bg-000/50 [&amp;_pre>div]:border-0.5 [&amp;_pre>div]:border-b=
order-400 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_.standard-markdo=
wn_:is(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&amp;_.standard-markdown_:is(=
p,blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8 [&amp;_.progressive-markdown_:i=
s(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&amp;_.progressive-markdown_:is(p,=
blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8"><div><div class=3D"standard-mark=
down grid-cols-1 grid [&amp;_>_*]:min-w-0 gap-3 standard-markdown"><h1 clas=
s=3D"text-text-100 mt-3 -mb-1 text-[1.375rem] font-bold">GraspSuccessPredic=
tor Deep Dive</h1>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">The <code class=3D"bg-text-200/5 border border-0.5 border-border-30=
0 text-danger-000 whitespace-pre-wrap rounded-[0.4rem] px-1 py-px text-[0.9=
rem]">GraspSuccessPredictor</code> is a neural network that learns to predi=
ct whether a proposed grasp will succeed or fail <strong>before</strong> th=
e robot attempts it. This is crucial for efficient dishwashing because it a=
llows the system to evaluate multiple grasp candidates and choose the best =
one without trial-and-error.</p>
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">Problem It=
 Solves</h2>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">Imagine you've identified 5 different ways to grasp a bowl in the s=
ink. Which one should you try first? The predictor answers: "Grasp #3 has 9=
2% success probability, Grasp #1 has 45%, etc."</p>
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">Architectu=
re Breakdown</h2>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">Let me explain each component with more detail and context:</p>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">import</spa=
n><span> torch
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> torch</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>nn </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">as</span><span> nn
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> torch</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>nn</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>functional=
 </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">as</=
span><span> F
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">GraspSuccessPredictor</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">(</span><span>nn</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Module<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><spa=
n>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Predicts probability of grasp success given:
</span><span>    1. Visual input (RGBD image)
</span><span>    2. Proposed grasp parameters (position, orientation, width=
)
</span><span>   =20
</span><span>    Architecture:
</span><span>    - Visual encoder: Processes RGBD to extract scene features
</span><span>    - Grasp encoder: Encodes grasp pose into feature vector
</span><span>    - Fusion network: Combines visual + grasp features
</span><span>    - Output: Single probability [0, 1] of success
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> use_pretrained_vi=
sion</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">Tr=
ue</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><=
span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">super</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">.</span><span>__init__</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># PART 1: Visual Feature Extractor</span><s=
pan>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># This processes the RGBD image (4 channels=
: R, G, B, Depth)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Goal: Extract features about what's in th=
e scene</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> use_pretrained_vision</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Option A: Use pre-trained backbone (be=
tter performance)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">from</span><span> torchvision</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>model=
s </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">imp=
ort</span><span> resnet34
</span></span><span><span>            resnet </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> resnet34</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>pre=
trained</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);"=
>=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">T=
rue</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Modify first conv to accept RGBD (4 channels =
instead of 3)</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>visual_encoder </span><sp=
an class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>=
 nn</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>Sequential</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">(</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>Conv2d</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">4</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">64</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> kernel_si=
ze</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">7</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> stride</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span> padding</span><span class=3D"token token" style=3D"color: rgb(2=
0, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 1=
28, 128);">3</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">,</span><span> bias</span><span class=3D"token token" style=3D"color:=
 rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 128);">False</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>BatchNorm2d</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">64</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>inplace</s=
pan><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">True</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">*</span><span class=3D"token token" sty=
le=3D"color: rgb(179, 74, 0);">list</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>resnet</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>children</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">4</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">]</span><span>  </span><span class=3D"token token"=
 style=3D"color: rgb(110, 118, 135);"># Use ResNet layers</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            visual_feature_dim </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">512</span><s=
pan>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135)=
;"># ResNet34 output channels</span><span>
</span></span><span>           =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">else</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Option B: Simple custom CNN (easier to=
 understand)</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>visual_encoder </span><sp=
an class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>=
 nn</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>Sequential</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">(</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(110, 118, 135);"># Layer 1: Extract low-level feature=
s (edges, textures)</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>Conv2d</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">4</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">64</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> kernel_si=
ze</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> padding</span><span class=3D"token token" style=3D"color: rgb(20, 24, 3=
1);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128)=
;">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>BatchNorm2d</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">64</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>MaxPool2d</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span clas=
s=3D"token token" style=3D"color: rgb(110, 118, 135);"># 640x480 -&gt; 320x=
240</span><span>
</span></span><span>               =20
</span><span><span>                </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Layer 2: Detect patterns (dish edges, sur=
faces)</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>Conv2d</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">64</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">128</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> kernel_si=
ze</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> padding</span><span class=3D"token token" style=3D"color: rgb(20, 24, 3=
1);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128)=
;">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>BatchNorm2d</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">128</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>MaxPool2d</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span clas=
s=3D"token token" style=3D"color: rgb(110, 118, 135);"># 320x240 -&gt; 160x=
120</span><span>
</span></span><span>               =20
</span><span><span>                </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Layer 3: High-level features (dish types,=
 orientations)</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>Conv2d</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">128</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">256</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> kernel_s=
ize</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan> padding</span><span class=3D"token token" style=3D"color: rgb(20, 24, =
31);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128=
);">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</spa=
n><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>BatchNorm2d</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">256</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>MaxPool2d</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span clas=
s=3D"token token" style=3D"color: rgb(110, 118, 135);"># 160x120 -&gt; 80x6=
0</span><span>
</span></span><span>               =20
</span><span><span>                </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Layer 4: Abstract scene understanding</sp=
an><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>Conv2d</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">256</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">512</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> kernel_s=
ize</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan> padding</span><span class=3D"token token" style=3D"color: rgb(20, 24, =
31);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128=
);">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</spa=
n><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>BatchNorm2d</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">512</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>AdaptiveAvgPool2d</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>  </span><=
span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># -&gt; 512=
x1x1 (global pooling)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            visual_feature_dim </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">512</span><s=
pan>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># PART 2: Grasp Pose Encoder</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># This encodes the proposed grasp into a fe=
ature vector</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Input: 7D vector [x, y, z, qw, qx, qy, qz=
, gripper_width]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);">#   - x, y, z: 3D position of grasp point</=
span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);">#   - qw, qx, qy, qz: Quaternion for grippe=
r orientation</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);">#   - gripper_width: How wide to open the g=
ripper</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>grasp_encoder </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> nn</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>S=
equential</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">8</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">64</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span class=
=3D"token token" style=3D"color: rgb(110, 118, 135);"># 7D grasp + 1D width=
</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Dropout</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.2</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">64</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">128</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Dropout</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.2</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">128</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">256</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        grasp_feature_dim </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 128);">256</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># PART 3: Fusion Network</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Combines visual features + grasp features=
</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Learns relationships like:</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># - "This grasp position is too close to th=
e sink wall" (visual + spatial)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># - "The gripper is too wide for this narro=
w cup" (visual + gripper width)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># - "This approach angle will collide with =
other dishes" (visual + orientation)</span><span>
</span></span><span>       =20
</span><span><span>        combined_dim </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> visual_feature_dim </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><sp=
an> grasp_feature_dim
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>fusion_network </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> nn</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
Sequential</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>combined_dim<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128)=
;">512</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Dropout</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.3</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span>           =20
</span><span><span>            nn</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">512</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">256</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Dropout</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.3</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span>           =20
</span><span><span>            nn</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">256</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">128</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Final layer outputs success probability</span=
><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">128</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Sigmoid</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>  </span><span =
class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Squash to [0, =
1] probability</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># PART 4: Attention Mechanism (Optional Enh=
ancement)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># This helps the network focus on relevant =
parts of the image</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># based on where the grasp is proposed</spa=
n><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>spatial_attention </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Spatial=
AttentionModule</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span>visual_feature_dim</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">forward</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> rgbd_image</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 grasp_pose</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> return_attention</span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">False</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Forward pass through the network
</span><span>       =20
</span><span>        Args:
</span><span>            rgbd_image: Tensor [batch, 4, H, W] - RGBD image
</span><span>            grasp_pose: Tensor [batch, 8] - [x, y, z, qw, qx, =
qy, qz, width]
</span><span>            return_attention: Whether to return attention maps=
 (for visualization)
</span><span>           =20
</span><span>        Returns:
</span><span>            success_probability: Tensor [batch, 1] - Probabili=
ty grasp succeeds
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        batch_size </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rgbd_image</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>s=
hape</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><sp=
an>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 1: Extract visual features</span><span>
</span></span><span><span>        visual_features </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>vi=
sual_encoder</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">(</span><span>rgbd_image</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>  </span><span class=3D"token token" =
style=3D"color: rgb(110, 118, 135);"># [batch, 512, 1, 1]</span><span>
</span></span><span><span>        visual_features </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> visual_feature=
s</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>view</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">(</span><span>batch_size</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>  </span><span class=3D"token token"=
 style=3D"color: rgb(110, 118, 135);"># [batch, 512]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 2: Apply spatial attention (focus on grasp r=
egion)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(179, 74, 0);">hasattr</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'spatial_atten=
tion'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span>
</span></span><span><span>            visual_features</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> attention_map=
 </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</=
span><span> self</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">.</span><span>spatial_attention</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                visual_features</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=20
</span></span><span><span>                grasp_pose</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">3</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">]</span><span>  </span><span class=3D"t=
oken token" style=3D"color: rgb(110, 118, 135);"># Use x,y,z position</span=
><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 3: Encode grasp parameters</span><span>
</span></span><span><span>        grasp_features </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>gra=
sp_encoder</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span>grasp_pose</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">)</span><span>  </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># [batch, 256]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 4: Concatenate features</span><span>
</span></span><span><span>        combined_features </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>cat</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span=
><span>visual_features</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">,</span><span> grasp_features</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> dim</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 5: Predict success probability</span><span>
</span></span><span><span>        success_prob </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>fusio=
n_network</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span>combined_features</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>  </span><span class=3D"token to=
ken" style=3D"color: rgb(110, 118, 135);"># [batch, 1]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> return_attention</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> success_prob</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> a=
ttention_map
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> success_prob
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">predict_batch_grasps</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> rgbd_=
image</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,=
</span><span> grasp_candidates</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Efficiently evaluate multiple grasp candidates =
for same scene
</span><span>       =20
</span><span>        Args:
</span><span>            rgbd_image: Single RGBD image [1, 4, H, W]
</span><span>            grasp_candidates: List of N grasp poses, each [8]
</span><span>           =20
</span><span>        Returns:
</span><span>            probabilities: List of N success probabilities
</span><span>            best_grasp_idx: Index of highest-probability grasp
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Replicate image for each grasp</span><spa=
n>
</span></span><span><span>        batch_size </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>grasp_candida=
tes</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span>
</span></span><span><span>        rgbd_batch </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rgbd_image</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>r=
epeat</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span>batch_size</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Stack grasp poses</span><span>
</span></span><span><span>        grasp_batch </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>stack=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>grasp_candidates</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Single forward pass for all candidates</span><spa=
n>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">with</span><span> torch</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>no_grad</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            probabilities </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
forward</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span>rgbd_batch</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">,</span><span> grasp_batch</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Find best grasp</span><span>
</span></span><span><span>        best_idx </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>argmax</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span>probabilities</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">.</span><span>item</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> probabilities</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>cpu</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>numpy</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> best_=
idx
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">SpatialAttentionModule</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>nn</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Module=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><sp=
an>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Attention mechanism that focuses on the region arou=
nd the proposed grasp
</span><span>   =20
</span><span>    Why this helps:
</span><span>    - If grasping top-left of image, focus on that region
</span><span>    - Ignore irrelevant dishes on opposite side of sink
</span><span>    - Learn which local context matters for grasp success
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> feature_dim</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">super</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">.</span><span>__init__</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Learn to generate attention weights from grasp po=
sition</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>attention_mlp </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> nn</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>Sequential</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">(</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">3</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><span> feature=
_dim</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,<=
/span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128,=
 128);">256</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span>  </span><span class=3D"token token" style=3D"color: rgb(110,=
 118, 135);"># position + features</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">256</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> feature_dim</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Sigmoid</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>  </span><span =
class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Attention weig=
hts [0, 1]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">forward</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> features</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> g=
rasp_position</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Args:
</span><span>            features: Visual features [batch, feature_dim]
</span><span>            grasp_position: 3D position [batch, 3]
</span><span>       =20
</span><span>        Returns:
</span><span>            attended_features: Features weighted by attention
</span><span>            attention_weights: The attention map
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Concatenate position with features</span>=
<span>
</span></span><span><span>        combined </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>cat</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>fe=
atures</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> grasp_position</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">,</span><span> dim</span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Generate attention weights</span><span>
</span></span><span><span>        attention_weights </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
attention_mlp</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">(</span><span>combined</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Apply attention (element-wise multiplication)</sp=
an><span>
</span></span><span><span>        attended_features </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> features </s=
pan><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><=
span> attention_weights
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> attended_features</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> attenti=
on_weights</span></span></code></pre></div></div>
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">Training t=
he Predictor</h2>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">Here's how you would train this network:</p>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">class</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);=
">GraspTrainingPipeline</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Complete training pipeline for grasp success predic=
tion
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> isaac_sim_env</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>env </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> isaac_sim_env
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>model </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> GraspSuccess=
Predictor</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span>use_pretrained_vision</span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">True</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Use GPU if available</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>device </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>device</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'cud=
a'</span><span> </span><span class=3D"token token" style=3D"color: rgb(129,=
 0, 194);">if</span><span> torch</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">.</span><span>cuda</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>is_available</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(129, 0, 194);">else</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'=
cpu'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>model </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
model</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.=
</span><span>to</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span>self</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">.</span><span>device</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Optimizer</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>optimizer </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>optim</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">.</span><span>Adam</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">(</span><span>self</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>model</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>parameters</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> lr</span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 128);">1e-4</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Loss function</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>criterion </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> nn</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>BCELoss</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>  </span><span class=3D"token token" style=3D"color: rgb(110, =
118, 135);"># Binary Cross Entropy for binary classification</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">generate_training_sample</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Generate one training sample from Isaac Sim
</span><span>       =20
</span><span>        Returns:
</span><span>            rgbd: RGBD image
</span><span>            grasp_pose: Proposed grasp parameters
</span><span>            label: 1.0 if grasp succeeded, 0.0 if failed
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Reset simulation with random dishes</span=
><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>env</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>spawn_random_dishe=
s</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span>num_dishes</span><span class=3D"token token" style=3D"color: rgb(2=
0, 24, 31);">=3D</span><span>np</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>random</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">.</span><span>randint</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 128);">8</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>env</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>step_simulation</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Get camera observation</span><span>
</span></span><span><span>        rgb</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span> depth </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
env</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>get_camera_observation</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        rgbd </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>concatenate</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>r=
gb</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> depth</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">.</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
.</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
None</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n> axis</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);"=
>=3D</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Generate random grasp candidate</span><span>
</span></span><span><span>        grasp_pose </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>sample_=
random_grasp</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Try executing the grasp in simulation</span><span=
>
</span></span><span><span>        success </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>env</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>execute_grasp</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">(</span><span>grasp_pose</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Convert to tensors</span><span>
</span></span><span><span>        rgbd_tensor </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from_=
numpy</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span>rgbd</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">.</span><span>permute</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 128);">2</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"colo=
r: rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">.</span><span class=3D"token token" style=3D"color: rgb(17=
9, 74, 0);">float</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span>
</span></span><span><span>        rgbd_tensor </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rgbd_tensor</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>unsqueeze</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span>  </span><span class=3D"token token" style=3D"color: rgb(110, 118,=
 135);"># Add batch dimension</span><span>
</span></span><span>       =20
</span><span><span>        grasp_tensor </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from_numpy=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>grasp_pose</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">.</span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);=
">float</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>unsqueeze</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128=
);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>
</span></span><span><span>        label </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>tensor</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">1.0</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">if</span><s=
pan> success </span><span class=3D"token token" style=3D"color: rgb(129, 0,=
 194);">else</span><span> </span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 128);">0.0</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> rgbd_tensor</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> grasp_tensor<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span> label
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">train_epoch</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> num_samples</s=
pan><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1000</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Train for one epoch"""</=
span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>model</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>train</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        total_loss </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span>
</span></span><span><span>        correct_predictions </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">for</span><span> i </span><span class=3D"token token"=
 style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(179, 74, 0);">range</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>num_samples</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Generate sample from simulation</span>=
<span>
</span></span><span><span>            rgbd</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> grasp_pose</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> label=
 </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</=
span><span> self</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">.</span><span>generate_training_sample</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Move to device</span><span>
</span></span><span><span>            rgbd </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rgbd</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>to</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.=
</span><span>device</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span>
</span></span><span><span>            grasp_pose </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp_pose</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>to</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span>self</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">.</span><span>device</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            label </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> label</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>to</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>.</span><span>device</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Forward pass</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>optimizer</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>zero_gra=
d</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span><span>            prediction </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>mod=
el</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>rgbd</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">,</span><span> grasp_pose</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Compute loss</span><span>
</span></span><span><span>            loss </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>criterion=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>prediction</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">,</span><span> label</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Backward pass</span><span>
</span></span><span><span>            loss</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>backward</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>optimizer</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>step</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Track metrics</span><span>
</span></span><span><span>            total_loss </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> loss</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>it=
em</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span>
</span></span><span><span>            predicted_class </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>pr=
ediction </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31)=
;">&gt;</span><span> </span><span class=3D"token token" style=3D"color: rgb=
(0, 128, 128);">0.5</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">.</span><span class=3D"token token" style=3D"color: rgb(179, 74, 0)=
;">float</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span>
</span></span><span><span>            correct_predictions </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>predicted_class </span><span class=3D"token token" style=3D"color: rgb(2=
0, 24, 31);">=3D=3D</span><span> label</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token token" style=3D"c=
olor: rgb(179, 74, 0);">sum</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">.</span><span>item</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span>i </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">+</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">%</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">100</=
span><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, =
31);">=3D=3D</span><span> </span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token stri=
ng-interpolation" style=3D"color: rgb(0, 128, 0);">f"Sample </span><span cl=
ass=3D"token token string-interpolation interpolation" style=3D"color: rgb(=
43, 48, 59);">{</span><span class=3D"token token string-interpolation inter=
polation">i</span><span class=3D"token token string-interpolation interpola=
tion" style=3D"color: rgb(20, 24, 31);">+</span><span class=3D"token token =
string-interpolation interpolation" style=3D"color: rgb(0, 128, 128);">1</s=
pan><span class=3D"token token string-interpolation interpolation" style=3D=
"color: rgb(43, 48, 59);">}</span><span class=3D"token token string-interpo=
lation" style=3D"color: rgb(0, 128, 0);">/</span><span class=3D"token token=
 string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">{</s=
pan><span class=3D"token token string-interpolation interpolation">num_samp=
les</span><span class=3D"token token string-interpolation interpolation" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token string-i=
nterpolation" style=3D"color: rgb(0, 128, 0);">, "</span><span>
</span></span><span><span>                      </span><span class=3D"token=
 token string-interpolation" style=3D"color: rgb(0, 128, 0);">f"Loss: </spa=
n><span class=3D"token token string-interpolation interpolation" style=3D"c=
olor: rgb(43, 48, 59);">{</span><span class=3D"token token string-interpola=
tion interpolation">total_loss</span><span class=3D"token token string-inte=
rpolation interpolation" style=3D"color: rgb(20, 24, 31);">/</span><span cl=
ass=3D"token token string-interpolation interpolation" style=3D"color: rgb(=
43, 48, 59);">(</span><span class=3D"token token string-interpolation inter=
polation">i</span><span class=3D"token token string-interpolation interpola=
tion" style=3D"color: rgb(20, 24, 31);">+</span><span class=3D"token token =
string-interpolation interpolation" style=3D"color: rgb(0, 128, 128);">1</s=
pan><span class=3D"token token string-interpolation interpolation" style=3D=
"color: rgb(43, 48, 59);">)</span><span class=3D"token token string-interpo=
lation interpolation" style=3D"color: rgb(43, 48, 59);">:</span><span class=
=3D"token token string-interpolation interpolation format-spec">.4f</span><=
span class=3D"token token string-interpolation interpolation" style=3D"colo=
r: rgb(43, 48, 59);">}</span><span class=3D"token token string-interpolatio=
n" style=3D"color: rgb(0, 128, 0);">, "</span><span>
</span></span><span><span>                      </span><span class=3D"token=
 token string-interpolation" style=3D"color: rgb(0, 128, 0);">f"Accuracy: <=
/span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token string-inte=
rpolation interpolation" style=3D"color: rgb(0, 128, 128);">100</span><span=
 class=3D"token token string-interpolation interpolation" style=3D"color: r=
gb(20, 24, 31);">*</span><span class=3D"token token string-interpolation in=
terpolation">correct_predictions</span><span class=3D"token token string-in=
terpolation interpolation" style=3D"color: rgb(20, 24, 31);">/</span><span =
class=3D"token token string-interpolation interpolation" style=3D"color: rg=
b(43, 48, 59);">(</span><span class=3D"token token string-interpolation int=
erpolation">i</span><span class=3D"token token string-interpolation interpo=
lation" style=3D"color: rgb(20, 24, 31);">+</span><span class=3D"token toke=
n string-interpolation interpolation" style=3D"color: rgb(0, 128, 128);">1<=
/span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token string-inte=
rpolation interpolation" style=3D"color: rgb(43, 48, 59);">:</span><span cl=
ass=3D"token token string-interpolation interpolation format-spec">.2f</spa=
n><span class=3D"token token string-interpolation interpolation" style=3D"c=
olor: rgb(43, 48, 59);">}</span><span class=3D"token token string-interpola=
tion" style=3D"color: rgb(0, 128, 0);">%"</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> total_loss </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">/</span><span> num_samples</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> correct_predictions </span><span class=3D"token token" style=3D"colo=
r: rgb(20, 24, 31);">/</span><span> num_samples
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">sample_random_grasp</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Generate random grasp pose for training
</span><span>        Includes both good and bad grasps
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Random position in sink region</span><spa=
n>
</span></span><span><span>        x </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>unif=
orm</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span>
</span></span><span><span>        y </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>unif=
orm</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span>
</span></span><span><span>        z </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>unif=
orm</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.05</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>0.25</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Random orientation (quaternion)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Simple approach: random rotation around z=
-axis</span><span>
</span></span><span><span>        angle </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
uniform</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">2</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</=
span><span>np</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">.</span><span>pi</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">)</span><span>
</span></span><span><span>        qw </span><span class=3D"token token" sty=
le=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>cos</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>angle<=
/span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        qx </span><span class=3D"token token" sty=
le=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">0</span><span>
</span></span><span><span>        qy </span><span class=3D"token token" sty=
le=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">0</span><span>
</span></span><span><span>        qz </span><span class=3D"token token" sty=
le=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>sin</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>angle<=
/span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Random gripper width</span><span>
</span></span><span><span>        width </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
uniform</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.0=
2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 12=
8);">0.08</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> np</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>array</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span>x</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> y</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan> z</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> qw</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span> qx</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">,</span><span> qy</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">,</span><span> qz</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">,</span><span> width</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span></span></code>=
</pre></div></div>
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">How It Wor=
ks: Intuitive Explanation</h2>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">Think of the network as learning these patterns:</p>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">What the Visual =
Encoder Learns:</h3>
<ul class=3D"[li_&amp;]:mb-0 [li_&amp;]:mt-1 [li_&amp;]:gap-1 [&amp;:not(:l=
ast-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc flex flex-co=
l gap-1 pl-8 mb-3">
<li class=3D"whitespace-normal break-words pl-2">"This is a flat plate" =E2=
=86=92 easier top-down grasp</li>
<li class=3D"whitespace-normal break-words pl-2">"This is a tall cup" =E2=
=86=92 needs side grasp</li>
<li class=3D"whitespace-normal break-words pl-2">"Dishes are stacked" =E2=
=86=92 top dish is accessible</li>
<li class=3D"whitespace-normal break-words pl-2">"Sink wall is nearby" =E2=
=86=92 limits approach angles</li>
</ul>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">What the Grasp E=
ncoder Learns:</h3>
<ul class=3D"[li_&amp;]:mb-0 [li_&amp;]:mt-1 [li_&amp;]:gap-1 [&amp;:not(:l=
ast-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc flex flex-co=
l gap-1 pl-8 mb-3">
<li class=3D"whitespace-normal break-words pl-2">"Gripper width 8cm for 3cm=
 cup" =E2=86=92 too wide, fail</li>
<li class=3D"whitespace-normal break-words pl-2">"Grasp height 2cm above si=
nk" =E2=86=92 likely collision</li>
<li class=3D"whitespace-normal break-words pl-2">"Horizontal approach to ve=
rtical cup" =E2=86=92 probably won't work</li>
</ul>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">What the Fusion =
Network Learns:</h3>
<ul class=3D"[li_&amp;]:mb-0 [li_&amp;]:mt-1 [li_&amp;]:gap-1 [&amp;:not(:l=
ast-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc flex flex-co=
l gap-1 pl-8 mb-3">
<li class=3D"whitespace-normal break-words pl-2">Visual + Spatial: "Cup is =
here + grasp is there" =E2=86=92 too far</li>
<li class=3D"whitespace-normal break-words pl-2">Visual + Orientation: "Pla=
te angled 30=C2=B0 + vertical grasp" =E2=86=92 misaligned</li>
<li class=3D"whitespace-normal break-words pl-2">Visual + Width: "Narrow gl=
ass + wide gripper" =E2=86=92 won't fit</li>
</ul>
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">Example Pr=
edictions</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Scene: =
Bowl in sink, proposed grasps</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Grasp 1: Top-down, centered on bowl</span><span>
</span></span><span><span>success_prob </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 128);">0.89</span><span>  </span><spa=
n class=3D"token token" style=3D"color: rgb(110, 118, 135);"># HIGH - good =
alignment, clear approach</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Grasp 2: Side grasp on bowl rim</span><span>
</span></span><span><span>success_prob </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 128);">0.72</span><span>  </span><spa=
n class=3D"token token" style=3D"color: rgb(110, 118, 135);"># MEDIUM - pos=
sible but less stable</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Grasp 3: Bottom grasp (bowl resting on sink)</span><span>
</span></span><span><span>success_prob </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 128);">0.15</span><span>  </span><spa=
n class=3D"token token" style=3D"color: rgb(110, 118, 135);"># LOW - no cle=
arance, will fail</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Grasp 4: Top grasp but offset to side</span><span>
</span></span><span><span>success_prob </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 128);">0.34</span><span>  </span><spa=
n class=3D"token token" style=3D"color: rgb(110, 118, 135);"># LOW - poor c=
entering, likely slip</span></span></code></pre></div></div>
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">Key Advant=
ages</h2>
<ol class=3D"[li_&amp;]:mb-0 [li_&amp;]:mt-1 [li_&amp;]:gap-1 [&amp;:not(:l=
ast-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal flex flex=
-col gap-1 pl-8 mb-3">
<li class=3D"whitespace-normal break-words pl-2"><strong>No hand-crafted ru=
les</strong>: Learns from data what makes grasps succeed</li>
<li class=3D"whitespace-normal break-words pl-2"><strong>Generalizes</stron=
g>: Works on new dish types it hasn't seen</li>
<li class=3D"whitespace-normal break-words pl-2"><strong>Fast inference</st=
rong>: Evaluate 100 grasps in &lt;100ms</li>
<li class=3D"whitespace-normal break-words pl-2"><strong>Learns from failur=
es</strong>: Every failed grasp in simulation improves the model</li>
</ol>
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">Alternativ=
e: Using Qwen3-VL Features</h2>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">You could enhance this by using Qwen3-VL's visual understanding:</p=
>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">class</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);=
">EnhancedGraspPredictor</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">(</span><span>nn</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>Module</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">def</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">super</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">.</span><span>__init__</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Use Qwen3-VL for semantic features</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">from</span><span> transformers </span><span c=
lass=3D"token token" style=3D"color: rgb(129, 0, 194);">import</span><span>=
 Qwen2VLModel
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>qwen_vision </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Qwen2V=
LModel</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
.</span><span>from_pretrained</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: =
rgb(0, 128, 0);">"Qwen/Qwen2-VL-7B"</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Freeze Qwen weights (use as feature extractor)</s=
pan><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> param </span><span class=3D"=
token token" style=3D"color: rgb(129, 0, 194);">in</span><span> self</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>qwen_vision</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">.</span><span>parameters</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">:</span><span>
</span></span><span><span>            param</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>requires_grad </span><sp=
an class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">Fals=
e</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Your grasp-specific layers</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>grasp_encoder </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> nn</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>Linear</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">8</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, =
128);">256</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Fusion</span><span>
</span></span><span><span>        qwen_feature_dim </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 128);">3584</span><span> =
 </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># =
Qwen2-VL output dimension</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>fusion </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> nn</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>S=
equential</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>qwen_feature_=
dim </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">+<=
/span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128,=
 128);">256</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">512</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">512</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Sigmoid</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">forward</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> image</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> gras=
p_pose</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</sp=
an><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Extract Qwen features</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">with</span><span> torch</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>no_grad</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            qwen_features </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
qwen_vision</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span>image</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">.</span><span>last_hidden_state</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>mean</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>dim</span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Encode grasp</span><span>
</span></span><span><span>        grasp_features </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>gra=
sp_encoder</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span>grasp_pose</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Combine and predict</span><span>
</span></span><span><span>        combined </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>cat</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>qw=
en_features</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> grasp_features</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">,</span><span> dim</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> self</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>fusion</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>combined</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">)</span></span></code></pre></div></div>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">This would give you semantic understanding like "this is a ceramic =
plate" or "fragile wine glass" which could improve grasp selection.</p>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">Would you like me to explain any specific part in more detail, or s=
how how to integrate this with the full pipeline?</p></div></div></div></di=
v></div><div class=3D"flex justify-start opacity-0 group-hover:opacity-100 =
group-focus-within:opacity-100 transition" role=3D"group" aria-label=3D"Mes=
sage actions"><div class=3D"text-text-300"><div class=3D"text-text-300 flex=
 items-stretch justify-between"><div class=3D"w-fit" data-state=3D"closed">=
<button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" data-testid=3D"acti=
on-bar-copy" aria-label=3D"Copy"><div class=3D"relative text-text-500 group=
-hover/btn:text-text-100"><div class=3D"transition-all opacity-100 scale-10=
0" style=3D"width: 20px; height: 20px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"tr=
ansition-all opacity-100 scale-100" aria-hidden=3D"true" style=3D"flex-shri=
nk: 0;"><path d=3D"M12.5 3C13.3284 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 =
6.67157 17 7.5V15.5C17 16.3284 16.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 =
6 15.5V14H4.5C3.67157 14 3 13.3284 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.=
5ZM14 12.5C14 13.3284 13.3284 14 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16=
H15.5C15.7761 16 16 15.7761 16 15.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5=
ZM4.5 4C4.22386 4 4 4.22386 4 4.5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.=
7761 13 13 12.7761 13 12.5V4.5C13 4.22386 12.7761 4 12.5 4H4.5Z"></path></s=
vg></div><div class=3D"absolute top-0 left-0 transition-all opacity-0 scale=
-50" style=3D"width: 20px; height: 20px; display: flex; align-items: center=
; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 =
20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"=
absolute top-0 left-0 transition-all opacity-0 scale-50" aria-hidden=3D"tru=
e" style=3D"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15=
.6346 4.96153 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.736=
05L15.8836 5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 =
14.9989C7.88203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.0=
8172 11.2752C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755=
 4.58105 10.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.=
1794L15.1883 5.10908Z"></path></svg></div></div></button></div><div class=
=3D"w-fit" data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Give =
positive feedback"><div class=3D"text-text-500 group-hover/btn:text-text-10=
0" style=3D"width: 16px; height: 16px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"te=
xt-text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"fl=
ex-shrink: 0;"><path d=3D"M9.56055 2C11.1381 2.00009 12.3211 3.44332 12.011=
7 4.99023L11.6094 7H13.8438C15.5431 7 16.836 8.52594 16.5566 10.2021L15.876=
 14.2842C15.6148 15.8513 14.2586 17 12.6699 17H4.5C3.67157 17 3 16.3284 3 1=
5.5V9.23828C3.00013 8.57996 3.4294 7.99838 4.05859 7.80469L5.19824 7.4541L5=
.33789 7.40723C6.02983 7.15302 6.59327 6.63008 6.89746 5.9541L8.41113 2.589=
84L8.48047 2.46094C8.66235 2.17643 8.97898 2.00002 9.32324 2H9.56055ZM7.809=
57 6.36523C7.39486 7.2867 6.62674 7.99897 5.68359 8.3457L5.49219 8.41016L4.=
35254 8.76074C4.14305 8.82539 4.00013 9.01904 4 9.23828V15.5C4 15.7761 4.22=
386 16 4.5 16H12.6699C13.7697 16 14.7087 15.2049 14.8896 14.1201L15.5703 10=
.0381C15.7481 8.97141 14.9251 8 13.8438 8H11C10.8503 8 10.7083 7.9331 10.61=
33 7.81738C10.5184 7.70164 10.4805 7.54912 10.5098 7.40234L11.0312 4.79395C=
11.2167 3.86589 10.507 3.00009 9.56055 3H9.32324L7.80957 6.36523Z"></path><=
/svg></div></button></div><div class=3D"w-fit" data-state=3D"closed"><butto=
n class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Give =
negative feedback"><div class=3D"text-text-500 group-hover/btn:text-text-10=
0" style=3D"width: 16px; height: 16px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"te=
xt-text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"fl=
ex-shrink: 0;"><path d=3D"M12.6699 3C14.2586 3 15.6148 4.14871 15.876 5.715=
82L16.5566 9.79785C16.836 11.4741 15.5431 13 13.8438 13H11.6094L12.0117 15.=
0098C12.3211 16.5567 11.1381 17.9999 9.56055 18H9.32324C8.97898 18 8.66235 =
17.8236 8.48047 17.5391L8.41113 17.4102L6.89746 14.0459C6.59327 13.3699 6.0=
2983 12.847 5.33789 12.5928L5.19824 12.5459L4.05859 12.1953C3.4294 12.0016 =
3.00013 11.42 3 10.7617V4.5C3 3.67157 3.67157 3 4.5 3H12.6699ZM4.5 4C4.2238=
6 4 4 4.22386 4 4.5V10.7617C4.00013 10.981 4.14305 11.1746 4.35254 11.2393L=
5.49219 11.5898L5.68359 11.6543C6.62674 12.001 7.39486 12.7133 7.80957 13.6=
348L9.32324 17H9.56055C10.507 16.9999 11.2167 16.1341 11.0312 15.2061L10.50=
98 12.5977C10.4805 12.4509 10.5184 12.2984 10.6133 12.1826C10.7083 12.0669 =
10.8503 12 11 12H13.8438C14.9251 12 15.7481 11.0286 15.5703 9.96191L14.8896=
 5.87988C14.7087 4.79508 13.7697 4 12.6699 4H4.5Z"></path></svg></div></but=
ton></div><div class=3D"flex items-center"><div class=3D"w-fit" data-state=
=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" id=3D"radix-_r_kb_"=
 aria-haspopup=3D"menu" aria-expanded=3D"false" data-state=3D"closed" aria-=
label=3D"Retry"><div class=3D"text-text-500 group-hover/btn:text-text-100" =
style=3D"width: 20px; height: 20px; display: flex; align-items: center; jus=
tify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20=
" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-=
text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-=
shrink: 0;"><path d=3D"M10.3857 2.50977C14.3486 2.71054 17.5 5.98724 17.5 1=
0C17.5 14.1421 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 7.5=
4619 3.67878 5.3677 5.49902 4H3C2.72386 4 2.5 3.77614 2.5 3.5C2.5 3.22386 2=
.72386 3 3 3H6.5C6.63261 3 6.75975 3.05272 6.85352 3.14648C6.92392 3.21689 =
6.97106 3.30611 6.99023 3.40234L7 3.5V7C7 7.27614 6.77614 7.5 6.5 7.5C6.223=
86 7.5 6 7.27614 6 7V4.87891C4.4782 6.06926 3.5 7.91979 3.5 10C3.5 13.5899 =
6.41015 16.5 10 16.5C13.5899 16.5 16.5 13.5899 16.5 10C16.5 6.5225 13.7691 =
3.68312 10.335 3.50879L10 3.5L9.89941 3.49023C9.67145 3.44371 9.5 3.24171 9=
.5 3C9.5 2.72386 9.72386 2.5 10 2.5L10.3857 2.50977Z"></path></svg></div></=
button></div></div></div></div></div></div></div><div data-test-render-coun=
t=3D"2"><div class=3D"mb-1 mt-6 group"><div class=3D"flex flex-col items-en=
d gap-1"><div class=3D"group relative inline-flex gap-2 bg-bg-300 rounded-x=
l pl-2.5 py-2.5 break-words text-text-100 transition-all max-w-[75ch] flex-=
col !px-4 max-w-[85%]" style=3D"opacity: 1; transform: none;"><div class=3D=
"flex flex-row gap-2 relative"><div class=3D"flex-1"><div data-testid=3D"us=
er-message" class=3D"font-large !font-user-message grid grid-cols-1 gap-2 p=
y-0.5 relative" style=3D"max-height: none; overflow: hidden; position: rela=
tive;"><p class=3D"whitespace-pre-wrap break-words">Could we not fine tune =
a qwen3 vl model to also predict the best approach? Whats the pros and cons=
 there?</p></div></div></div></div><div class=3D"flex justify-start opacity=
-0 group-hover:opacity-100 group-focus-within:opacity-100 transition" role=
=3D"group" aria-label=3D"Message actions"><div class=3D"text-text-300"><div=
 class=3D"text-text-300 flex items-stretch justify-between"><span class=3D"=
text-text-500 text-xs flex items-center mr-2" data-state=3D"closed">Feb 4</=
span><div class=3D"flex items-center"><div class=3D"w-fit" data-state=3D"cl=
osed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Retry=
"><div class=3D"text-text-500 group-hover/btn:text-text-100" style=3D"width=
: 20px; height: 20px; display: flex; align-items: center; justify-content: =
center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curr=
entColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-text-500 group=
-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><p=
ath d=3D"M10.3857 2.50977C14.3486 2.71054 17.5 5.98724 17.5 10C17.5 14.1421=
 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 7.54619 3.67878 5=
.3677 5.49902 4H3C2.72386 4 2.5 3.77614 2.5 3.5C2.5 3.22386 2.72386 3 3 3H6=
.5C6.63261 3 6.75975 3.05272 6.85352 3.14648C6.92392 3.21689 6.97106 3.3061=
1 6.99023 3.40234L7 3.5V7C7 7.27614 6.77614 7.5 6.5 7.5C6.22386 7.5 6 7.276=
14 6 7V4.87891C4.4782 6.06926 3.5 7.91979 3.5 10C3.5 13.5899 6.41015 16.5 1=
0 16.5C13.5899 16.5 16.5 13.5899 16.5 10C16.5 6.5225 13.7691 3.68312 10.335=
 3.50879L10 3.5L9.89941 3.49023C9.67145 3.44371 9.5 3.24171 9.5 3C9.5 2.723=
86 9.72386 2.5 10 2.5L10.3857 2.50977Z"></path></svg></div></button></div><=
div class=3D"w-fit" data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Edit"=
><div class=3D"text-text-500 group-hover/btn:text-text-100" style=3D"width:=
 20px; height: 20px; display: flex; align-items: center; justify-content: c=
enter;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curre=
ntColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-text-500 group-=
hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><pa=
th d=3D"M9.72821 2.87934C10.0318 2.10869 10.9028 1.72933 11.6735 2.03266L14=
.4655 3.13226C15.236 3.43593 15.6145 4.30697 15.3112 5.07758L11.3903 15.030=
7C11.2954 15.2717 11.1394 15.4835 10.9391 15.6459L10.8513 15.7123L7.7077 17=
.8979C7.29581 18.1843 6.73463 17.9917 6.57294 17.5356L6.54657 17.4409L5.737=
 13.6987C5.67447 13.4092 5.69977 13.107 5.80829 12.8315L9.72821 2.87934ZM6.=
73798 13.1987C6.70201 13.2903 6.69385 13.3906 6.71454 13.4868L7.44501 16.86=
27L10.28 14.892L10.3376 14.8452C10.3909 14.7949 10.4325 14.7332 10.4597 14.=
6645L13.0974 7.96723L9.37567 6.50141L6.73798 13.1987ZM11.3073 2.96332C11.05=
04 2.86217 10.7601 2.98864 10.6589 3.24555L9.74188 5.57074L13.4636 7.03754L=
14.3806 4.71137C14.4817 4.45445 14.3552 4.16413 14.0983 4.06293L11.3073 2.9=
6332Z"></path></svg></div></button></div></div><div class=3D"w-fit" data-st=
ate=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" data-testid=3D"acti=
on-bar-copy" aria-label=3D"Copy"><div class=3D"relative text-text-500 group=
-hover/btn:text-text-100"><div class=3D"transition-all opacity-100 scale-10=
0" style=3D"width: 20px; height: 20px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"tr=
ansition-all opacity-100 scale-100" aria-hidden=3D"true" style=3D"flex-shri=
nk: 0;"><path d=3D"M12.5 3C13.3284 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 =
6.67157 17 7.5V15.5C17 16.3284 16.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 =
6 15.5V14H4.5C3.67157 14 3 13.3284 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.=
5ZM14 12.5C14 13.3284 13.3284 14 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16=
H15.5C15.7761 16 16 15.7761 16 15.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5=
ZM4.5 4C4.22386 4 4 4.22386 4 4.5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.=
7761 13 13 12.7761 13 12.5V4.5C13 4.22386 12.7761 4 12.5 4H4.5Z"></path></s=
vg></div><div class=3D"absolute top-0 left-0 transition-all opacity-0 scale=
-50" style=3D"width: 20px; height: 20px; display: flex; align-items: center=
; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 =
20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"=
absolute top-0 left-0 transition-all opacity-0 scale-50" aria-hidden=3D"tru=
e" style=3D"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15=
.6346 4.96153 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.736=
05L15.8836 5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 =
14.9989C7.88203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.0=
8172 11.2752C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755=
 4.58105 10.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.=
1794L15.1883 5.10908Z"></path></svg></div></div></button></div><div class=
=3D"flex items-center"></div></div></div></div></div></div></div><div data-=
test-render-count=3D"2"><div class=3D"group" style=3D"height: auto; opacity=
: 1; transform: none;"><div class=3D"contents"><div data-is-streaming=3D"fa=
lse" class=3D"group relative relative pb-3" style=3D"opacity: 1; transform:=
 none;"><div class=3D"font-claude-response relative leading-[1.65rem] [&amp=
;_pre>div]:bg-bg-000/50 [&amp;_pre>div]:border-0.5 [&amp;_pre>div]:border-b=
order-400 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_.standard-markdo=
wn_:is(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&amp;_.standard-markdown_:is(=
p,blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8 [&amp;_.progressive-markdown_:i=
s(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&amp;_.progressive-markdown_:is(p,=
blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8"><div><div class=3D"standard-mark=
down grid-cols-1 grid [&amp;_>_*]:min-w-0 gap-3 standard-markdown"><h1 clas=
s=3D"text-text-100 mt-3 -mb-1 text-[1.375rem] font-bold">Fine-tuning Qwen3-=
VL for Grasp Prediction: Comprehensive Analysis</h1>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">Great question! Yes, you absolutely could fine-tune Qwen3-VL to dir=
ectly predict grasp poses. This is actually a really interesting architectu=
ral decision. Let me break down both approaches:</p>
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">Approach C=
omparison</h2>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">Option 1: Custom=
 CNN + MLP (What I showed)</h3>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">Vision CNN =E2=86=92 Features =E2=86=92 MLP =E2=86=92 Success Proba=
bility</p>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">Option 2: Fine-t=
uned Qwen3-VL</h3>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">Qwen3-VL (fine-tuned) =E2=86=92 Grasp Pose + Success Probability</p=
>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">Detailed P=
ros &amp; Cons</h2>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold"><strong>Fine-tun=
ing Qwen3-VL</strong></h3>
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">=E2=9C=85 =
PROS</h2>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">1. <strong>Seman=
tic Understanding Out-of-the-Box</strong></h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Qwen3-V=
L already understands:</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"This is a ceramic bowl, fragile"</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"Wine glass, handle is graspable"</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"Stacked dishes, top one accessible"</span><spa=
n>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"Food residue on plate edge"</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"Wet/soapy dishes =3D slippery"</span></span></=
code></pre></div></div>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">This is <strong>huge</strong> - you don't need to teach basic dish =
recognition.</p>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">2. <strong>Bette=
r Generalization to Novel Objects</strong></h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Scenari=
o: User puts a weird object in sink (a measuring cup, thermos, etc.)</span>=
<span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Custom CNN: "Never seen this shape, features don't match =
training"</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># =E2=86=92 Poor grasp prediction</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Fine-tuned Qwen3-VL: "This is similar to cups I've seen, =
has a handle,</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);">#                        cylindrical body, likely pl=
astic"</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># =E2=86=92 Reasonable grasp based on semantic under=
standing</span></span></code></pre></div></div>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">3. <strong>Langu=
age-Guided Grasping</strong></h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># You cou=
ld do conditional grasping:</span><span>
</span></span><span><span>prompt </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"Grasp the blue plate gently, it's c=
hipped on the left edge"</span><span>
</span></span><span><span>grasp_pose </span><span class=3D"token token" sty=
le=3D"color: rgb(20, 24, 31);">=3D</span><span> model</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>generate_grasp=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>image</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span> prompt</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">)</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Or:</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 0);">"Pick up the bowl without tilting it, there's water insi=
de"</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 0);">"Grab the mug by the handle"</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 0);">"Avoid the knife, grasp the plate underneath"</span></sp=
an></code></pre></div></div>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">This is <strong>impossible</strong> with a pure CNN.</p>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">4. <strong>Multi=
-modal Reasoning</strong></h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Qwen3-V=
L can reason:</span><span>
</span></span><span><span>"The cup </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">is</span><span> tilted </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">45</span><span> degrees aga=
inst the bowl</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span>=20
</span></span><span><span> so I need to grasp </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">from</span><span> the exposed top =
rim=20
</span></span><span> rather than the blocked side"
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Custom CNN: Just sees pixels, no reasoning chain</span></=
span></code></pre></div></div>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">5. <strong>Less =
Training Data Required</strong></h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Qwen3-V=
L pre-trained on millions of images</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># You might only need:</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">5</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">,</span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 128);">000</span><span class=3D"token token" style=3D"color: =
rgb(20, 24, 31);">-</span><span class=3D"token token" style=3D"color: rgb(0=
, 128, 128);">10</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">,</span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">000</span><span> grasp examples </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span>vs </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">50</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 128);">000</span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(129, 0, 194);">for</span><span> CNN </span><spa=
n class=3D"token token" style=3D"color: rgb(129, 0, 194);">from</span><span=
> scratch</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">)</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Transfer learning helps immensely</span>=
</span></code></pre></div></div>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">6. <strong>Expla=
inability</strong></h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Qwen ca=
n explain its decision:</span><span>
</span></span><span><span>output </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"grasp_pose"</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">0.1</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">0.05</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0.15</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"explanation"</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">:</span><span> "I chose a top</span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span>down gra=
sp on the plate's center=20
</span></span><span><span>                    because it's lying flat </spa=
n><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">and</span>=
<span> unobstructed</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">.</span><span> The rim=20
</span></span><span><span>                    has food residue</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> so a=
voiding edge contact</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">.</span><span>"</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"confidence"</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">0.87</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">}</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Custom CNN: Black box, no explanation</span></span></code=
></pre></div></div>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">=E2=9D=8C =
CONS</h2>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">1. <strong>Compu=
tational Cost</strong></h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Model s=
izes:</span><span>
</span></span><span><span>Custom CNN</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">:</span><span>     </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">~</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">50</span><span> MB</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>   </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">~</span><span=
>5ms inference
</span></span><span><span>Qwen3</span><span class=3D"token token" style=3D"=
color: rgb(20, 24, 31);">-</span><span>VL 2B</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span>    </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">~</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">4</span><span> GB</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>   =
 </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">~</sp=
an><span>100ms inference =20
</span></span><span><span>Qwen3</span><span class=3D"token token" style=3D"=
color: rgb(20, 24, 31);">-</span><span>VL 7B</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span>    </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">~</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">14</span><span> GB</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>  =
 </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">~</sp=
an><span>200ms inference
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># For real-time robotics:</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Qwen needs high</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">-</span><span>end GPU </span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>R=
TX </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">40=
90</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> A100</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Custom CNN runs on modest GPU </span><sp=
an class=3D"token token" style=3D"color: rgb(129, 0, 194);">or</span><span>=
 even CPU
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Latency matters when robot needs to reac=
t quickly</span></span></code></pre></div></div>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">2. <strong>Fine-=
tuning Complexity</strong></h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Fine-tu=
ning Qwen3-VL requires:</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># a) LoRA (Low-Rank Adaptation) or full fine-tuning</span><=
span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> peft </span><span class=3D"token tok=
en" style=3D"color: rgb(129, 0, 194);">import</span><span> LoraConfig</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n> get_peft_model
</span></span><span>
</span><span><span>lora_config </span><span class=3D"token token" style=3D"=
color: rgb(20, 24, 31);">=3D</span><span> LoraConfig</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>    r</span><span class=3D"token token" style=3D"=
color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"col=
or: rgb(0, 128, 128);">16</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">,</span><span>
</span></span><span><span>    lora_alpha</span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">32</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>    target_modules</span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" styl=
e=3D"color: rgb(0, 128, 0);">"q_proj"</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"v_proj"</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span class=3D"t=
oken token" style=3D"color: rgb(110, 118, 135);"># Which layers to adapt</s=
pan><span>
</span></span><span><span>    lora_dropout</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">0.05</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>    bias</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 0);">"none"</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># b) Careful handling of vision-language alignment</span><s=
pan>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># Can't just treat it like a classification problem<=
/span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># c) Risk of catastrophic forgetting</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># Might lose general vision capabilities if not care=
ful</span></span></code></pre></div></div>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">3. <strong>Outpu=
t Format Design Challenge</strong></h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># How sho=
uld Qwen output grasp poses?</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Option A: Token generation (natural for LLMs)</span><span=
>
</span></span><span><span>output </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"Grasp at position x=3D0.15 y=3D0.08=
 z=3D0.12 with rotation quaternion..."</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># =E2=86=92 Need to parse text, error-prone, slow</s=
pan><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Option B: Add regression head (better but more complex)</=
span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">class</span><span> </span><span class=3D"token token" =
style=3D"color: rgb(179, 74, 0);">Qwen3VLGraspPredictor</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>nn</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
Module</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</sp=
an><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">def</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>qwen </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Qwen2VLForCon=
ditionalGeneration</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">.</span><span>from_pretrained</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">.</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Add custom regression head</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>grasp_head </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> nn</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>Linear</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span>qwen_hidden_dim</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 128);">8</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">)</span><span>  </span><span class=3D"token =
token" style=3D"color: rgb(110, 118, 135);"># [x,y,z,qw,qx,qy,qz,w]</span><=
span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">forward</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> image</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> text=
_prompt</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</s=
pan><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Get Qwen's vision features</span><span>
</span></span><span><span>        qwen_output </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>qwen</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>vision_model</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">(</span><span>image</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Predict grasp pose</span><span>
</span></span><span><span>        grasp_pose </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>grasp_h=
ead</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span>qwen_output</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">.</span><span>pooler_output</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> grasp_pose
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Option C: Hybrid (text for reasoning + structured output)=
</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># Most flexible but most complex</span></span></code=
></pre></div></div>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">4. <strong>Overk=
ill for Simple Geometric Problems</strong></h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># For a s=
imple plate lying flat:</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># - Qwen3-VL: Processes through 7B parameters, atten=
tion across patches,</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);">#             language understanding, multi-modal fu=
sion...</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># - Custom CNN: "Round shape, flat, center of mass h=
ere, done."</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Qwen is like using a sledgehammer to crack a nut sometime=
s</span></span></code></pre></div></div>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">5. <strong>Train=
ing Instability</strong></h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Fine-tu=
ning large VLMs can be tricky:</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Problem 1: Learning rate sensitivity</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># - Too high: Catastrophic forgetting of pre-trained=
 knowledge</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># - Too low: Doesn't adapt to grasp prediction task<=
/span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Problem 2: Batch size constraints</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># - Qwen3-VL 7B needs ~40GB VRAM per sample with gra=
dients</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># - Limits batch size =E2=86=92 noisier gradients =
=E2=86=92 longer training</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Problem 3: Gradient accumulation required</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># - Makes training slower (4-8x)</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Custom CNN: Stable, well-understood training dynamics</sp=
an></span></code></pre></div></div>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">6. <strong>Deplo=
yment Challenges</strong></h3>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Deployi=
ng Qwen3-VL on robot:</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Needs powerful edge GPU </span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>Jetson O=
rin 64GB minimum</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">,</span><span> preferably desktop GPU</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Power consumption</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">150</span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span>300W vs =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">20</s=
pan><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><=
span>50W </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194=
);">for</span><span> custom CNN
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Cooling requirements
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Cost</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> $</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">2000</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">+</span><span> GPU vs $</span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 128);">500</span><span=
> GPU
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># For a dishwashing robot, this might be prohibitive</span>=
</span></code></pre></div></div>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">Hybrid App=
roach (Best of Both Worlds?)</h2>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">Here's what I'd actually recommend:</p>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">class</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);=
">HybridGraspSystem</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Use Qwen3-VL for scene understanding, custom networ=
k for grasp pose
</span><span>   =20
</span><span>    Philosophy:
</span><span>    - Qwen3-VL: "What" and "Why" (semantic understanding, reas=
oning)
</span><span>    - Custom network: "How" and "Where" (precise geometric pre=
dictions)
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Semantic understanding (frozen, no fine-t=
uning needed)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>qwen </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Qwen2VLForCon=
ditionalGeneration</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">.</span><span>from_pretrained</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"Qwen/Qwen2-VL-7B-Instruct"</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            torch_dtype</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>torch</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>flo=
at16
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> param </span><span class=3D"=
token token" style=3D"color: rgb(129, 0, 194);">in</span><span> self</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>qwen</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.=
</span><span>parameters</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">:</span><span>
</span></span><span><span>            param</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>requires_grad </span><sp=
an class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">Fals=
e</span><span>  </span><span class=3D"token token" style=3D"color: rgb(110,=
 118, 135);"># Keep frozen</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Grasp prediction (trained from scratch)</span><sp=
an>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>grasp_predictor </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Gr=
aspSuccessPredictor</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">predict_grasp</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> rgbd_image</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> user_instruction</span><span class=3D"token token" style=3D"color: r=
gb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">None</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Two-stage pipeline:
</span><span>        1. Qwen3-VL: Understand scene semantically
</span><span>        2. Grasp predictor: Generate precise grasp poses
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># =3D=3D=3D=3D=3D STAGE 1: Semantic Analysis =3D=3D=
=3D=3D=3D</span><span>
</span></span><span><span>        prompt </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 0);">"Analyze this sink. Describe e=
ach dish, its material, "</span><span> \
</span></span><span><span>                 </span><span class=3D"token toke=
n" style=3D"color: rgb(0, 128, 0);">"orientation, and any obstacles. Identi=
fy which dishes "</span><span> \
</span></span><span><span>                 </span><span class=3D"token toke=
n" style=3D"color: rgb(0, 128, 0);">"are easiest to grasp."</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> user_instruction</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            prompt </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span class=
=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">f" U=
ser wants to: </span><span class=3D"token token string-interpolation interp=
olation" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token tok=
en string-interpolation interpolation">user_instruction</span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">}</span><span class=3D"token token string-interpolation" style=
=3D"color: rgb(0, 128, 0);">"</span><span>
</span></span><span>       =20
</span><span><span>        semantic_info </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>qwen_analy=
ze</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>rgbd_image</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">:</span><span class=3D"token token" style=3D"color: rgb(0, 128, 12=
8);">3</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span> prompt</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Returns: {</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);">#   "dishes": [</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);">#     {"type": "plate", "material": "cerami=
c", "orientation": "flat",</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);">#      "position": "center-left", "graspabi=
lity": "high"},</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);">#     {"type": "bowl", "material": "glass",=
 "orientation": "tilted",</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);">#      "position": "right", "graspability":=
 "medium"}</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);">#   ],</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);">#   "obstacles": ["sink wall on left", "sta=
cked dishes in back"],</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);">#   "recommendation": "Start with the plate=
, it's most accessible"</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># }</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># =3D=3D=3D=3D=3D STAGE 2: Geometric Grasp Generati=
on =3D=3D=3D=3D=3D</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Use semantic info to guide grasp candidat=
e generation</span><span>
</span></span><span><span>        grasp_candidates </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>g=
enerate_smart_candidates</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            rgbd_image</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>=20
</span></span><span>            semantic_info
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Rank candidates with custom predictor</span><span=
>
</span></span><span><span>        grasp_scores </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> grasp </span><span class=3D"=
token token" style=3D"color: rgb(129, 0, 194);">in</span><span> grasp_candi=
dates</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:=
</span><span>
</span></span><span><span>            score </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>grasp_pr=
edictor</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span>rgbd_image</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">,</span><span> grasp</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            grasp_scores</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>sco=
re</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Select best grasp</span><span>
</span></span><span><span>        best_idx </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>argmax</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan>grasp_scores</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span>
</span></span><span><span>        best_grasp </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp_candidates</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><=
span>best_idx</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"grasp_pose"</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> best_grasp</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"confidence"</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> grasp_scores</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>bes=
t_idx</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</spa=
n><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"reasoning"</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> semantic_info</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 0);">"recommendation"</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"dish_type"</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> semantic_info</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 0);">"dishes"</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>best_idx</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 0);">"type"</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">qwen_analyze</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> rgb_image</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan> prompt</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Use Qwen3-VL for semanti=
c scene understanding"""</span><span>
</span></span><span><span>        messages </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"role"</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"user"</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"content"</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">[</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 0);">"type"</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 0);">"image"</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">"image"</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> rgb_image</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">}</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 0);">"type"</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 0);">"text"</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">"text"</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> prompt</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Get structured output (you'd parse this)</span><s=
pan>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">with</span><span> torch</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>no_grad</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            response </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>qwen<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span=
><span>generate</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span>messages</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Parse response into structured format</span><span=
>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># (In practice, you'd fine-tune Qwen to out=
put JSON)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> self</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>parse_semanti=
c_response</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span>response</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">generate_smart_candidates</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> =
rgbd_image</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">,</span><span> semantic_info</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Generate grasp candidates informed by semantic =
understanding
</span><span>       =20
</span><span>        Instead of random sampling, use Qwen's insights:
</span><span>        - "Plate is flat" =E2=86=92 prioritize top-down grasps
</span><span>        - "Bowl is tilted" =E2=86=92 adjust approach angle
</span><span>        - "Material is glass" =E2=86=92 reduce gripper force
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        candidates </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">for</span><span> dish_info </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">in</span><span> semantic_info</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 0);">"dishes"</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> dish_info</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">"type"</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">"plate"=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(129, 0=
, 194);">and</span><span> dish_info</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"orientation"</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 0);">"flat"</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(110, 118, 135);"># Generate top-down grasps</span><sp=
an>
</span></span><span><span>                candidates</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>extend</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>s=
elf</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>top_down_grasps</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">(</span><span>dish_info</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"position"</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span>               =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">elif</span><span> dish_info</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 0);">"type"</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">"cup"</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194)=
;">or</span><span> dish_info</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: r=
gb(0, 128, 0);">"type"</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">]</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(20, 24, 31);">=3D=3D</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 0);">"bowl"</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(110, 118, 135);"># Generate rim grasps</span><span>
</span></span><span><span>                candidates</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>extend</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>s=
elf</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>rim_grasps</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">(</span><span>dish_info</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"position"</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>               =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Adjust based on material</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> dish_info</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">"material"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">"g=
lass"</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:=
</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">for</span><span> c </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> candida=
tes</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</=
span><span>
</span></span><span><span>                    c</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">"max_force"</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.5</span><s=
pan>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135)=
;"># Gentle grip</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> candidates</span></span></code></=
pre></div></div>
<h3 class=3D"text-text-100 mt-2 -mb-1 text-base font-bold">Why This Hybrid =
Works:</h3>
<ol class=3D"[li_&amp;]:mb-0 [li_&amp;]:mt-1 [li_&amp;]:gap-1 [&amp;:not(:l=
ast-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-decimal flex flex=
-col gap-1 pl-8 mb-3">
<li class=3D"whitespace-normal break-words pl-2"><strong>Leverages Qwen's S=
trengths</strong>: Semantic understanding, reasoning, language</li>
<li class=3D"whitespace-normal break-words pl-2"><strong>Avoids Qwen's Weak=
nesses</strong>: Doesn't ask it to output precise floats</li>
<li class=3D"whitespace-normal break-words pl-2"><strong>Fast Inference</st=
rong>: Qwen runs once per scene, custom net runs many times</li>
<li class=3D"whitespace-normal break-words pl-2"><strong>No Fine-tuning Nee=
ded</strong>: Use Qwen as-is, only train custom grasp net</li>
<li class=3D"whitespace-normal break-words pl-2"><strong>Explainable</stron=
g>: Get both reasoning and precise control</li>
</ol>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">Concrete C=
ode: Fine-tuning Qwen3-VL Approach</h2>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">If you do want to fine-tune, here's how:</p>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">from</span>=
<span> transformers </span><span class=3D"token token" style=3D"color: rgb(=
129, 0, 194);">import</span><span> Qwen2VLForConditionalGeneration</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> =
AutoProcessor
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> peft </span><span class=3D"token tok=
en" style=3D"color: rgb(129, 0, 194);">import</span><span> LoraConfig</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n> get_peft_model</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span> TaskType
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> torch
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> torch</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>nn </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">as</span><span> nn
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">FineTunedQwenGraspPredictor</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>nn</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
Module</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</sp=
an><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Fine-tune Qwen3-VL with LoRA for grasp prediction
</span><span>   =20
</span><span>    Approach: Add a regression head to Qwen's vision encoder
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> model_name</span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 0);">"Qwen/Qwen2-VL-7B=
-Instruct"</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">,</span><span> use_lora</span><span class=3D"token token" style=3D"colo=
r: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: =
rgb(0, 128, 128);">True</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">super</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">.</span><span>__init__</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Load base model</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>qwen </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Qwen2VLForCon=
ditionalGeneration</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">.</span><span>from_pretrained</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            model_name</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            torch_dtype</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>torch</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>flo=
at16</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,<=
/span><span>
</span></span><span><span>            device_map</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 0);">"auto"</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Configure LoRA for efficient fine-tuning</span><s=
pan>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> use_lora</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            lora_config </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> LoraConfig</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan>
</span></span><span><span>                r</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 128);">16</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span class=3D"token =
token" style=3D"color: rgb(110, 118, 135);"># Low rank</span><span>
</span></span><span><span>                lora_alpha</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">32</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                target_modules</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"q_proj"</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">"k_proj"</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 0);">"v_proj"</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">"o_pr=
oj"</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span>  </span><span class=3D"token token" style=3D"color: rgb(110, 11=
8, 135);"># Attention</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"gate_proj"</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 0);">"up_proj"</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">"down_proj"<=
/span><span>       </span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># MLP</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                lora_dropout</span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">0.05</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                bias</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token toke=
n" style=3D"color: rgb(0, 128, 0);">"none"</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                task_type</span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>TaskType</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>CAUSAL_LM
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            self</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>qwen </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> get_peft_model</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>qwen</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">,</span><span> lora_config</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>qwen</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>print_trainab=
le_parameters</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Output: "trainable params: 42M || all =
params: 7.6B || trainable%: 0.55%"</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Add grasp regression head</span><span>
</span></span><span><span>        hidden_size </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>qwen</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>config</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">.</span><span>hidden_size  </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># 3584 for 7B model</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>grasp_head </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> nn</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Sequ=
ential</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>hidden_size</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">1024</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Dropout</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.1</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">1024</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">512</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Dropout</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.1</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">512</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">8</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>  </span><span=
 class=3D"token token" style=3D"color: rgb(110, 118, 135);"># [x, y, z, qw,=
 qx, qy, qz, gripper_width]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Success prediction head (auxiliary task)</span><s=
pan>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>success_head </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> nn</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>Sequential</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>hidden_size</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">256</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</spa=
n><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">256</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Sigmoid</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>processor </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> AutoProcessor</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>from_pretrained</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">(</span><span>model_name</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">forward</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> images</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> tex=
t_prompts</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31)=
;">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>None</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Forward pass
</span><span>       =20
</span><span>        Args:
</span><span>            images: Batch of RGBD images (convert to RGB for Q=
wen)
</span><span>            text_prompts: Optional text guidance (e.g., "grasp=
 the blue bowl")
</span><span>       =20
</span><span>        Returns:
</span><span>            grasp_pose: [batch, 8] grasp parameters
</span><span>            success_prob: [batch, 1] probability of success
</span><span>            vision_features: [batch, hidden_size] for visualiz=
ation
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Prepare inputs</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> text_prompts </span><span cla=
ss=3D"token token" style=3D"color: rgb(129, 0, 194);">is</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">None</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><spa=
n>
</span></span><span><span>            text_prompts </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">"Predict the best grasp p=
ose for the dishes in this image."</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">*</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">(</span><span>images</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Process through Qwen's vision encoder</span><span=
>
</span></span><span><span>        inputs </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>processor<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span>
</span></span><span><span>            text</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span>text_prompts</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            images</span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span>images</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            return_tensors</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">"pt"</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            padding</span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">.</span><span>to</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>qwen</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>dev=
ice</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Get vision features (before language modeling hea=
d)</span><span>
</span></span><span><span>        outputs </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>qwen</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>model</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">**</span><span>inputs</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            output_hidden_states</span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">True</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            return_dict</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Extract vision features (use last hidden state, p=
ooled)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># For Qwen, vision features are at the star=
t of the sequence</span><span>
</span></span><span><span>        vision_features </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> outputs</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>hidden_states</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">[</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31)=
;">-</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><spa=
n>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"=
># [batch, hidden_size]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Predict grasp pose</span><span>
</span></span><span><span>        grasp_pose </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>grasp_h=
ead</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span>vision_features</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Predict success probability</span><span>
</span></span><span><span>        success_prob </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>succe=
ss_head</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span>vision_features</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> grasp_pose</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> success_prob</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> vision_features
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">compute_loss</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> pred_grasp</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> pred_success</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">,</span><span> target_grasp</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">,</span><span> target_success</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Multi-task loss function
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Grasp pose loss (MSE for position, specia=
l handling for quaternion)</span><span>
</span></span><span><span>        position_loss </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> F</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>mse_los=
s</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span>pred_grasp</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">:</span><span class=3D"token token" style=3D"color: rgb(0, 128,=
 128);">3</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,<=
/span><span> target_grasp</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">:</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">,</span><span> </span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">:</span><span class=3D"token token" style=3D"color: rgb(0=
, 128, 128);">3</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Quaternion loss (geodesic distance would be bette=
r, but MSE works)</span><span>
</span></span><span><span>        orientation_loss </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> F</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>mse_=
loss</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(<=
/span><span>pred_grasp</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">:</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">,</span><span> </span><span class=3D"token token" style=3D"color: rgb=
(0, 128, 128);">3</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">:</span><span class=3D"token token" style=3D"color: rgb(0, 128, =
128);">7</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span> target_grasp</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">:</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">,</span><span> </span><span class=3D"token token" style=3D"color: r=
gb(0, 128, 128);">3</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">:</span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 128);">7</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Gripper width loss</span><span>
</span></span><span><span>        width_loss </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> F</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>mse_loss</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span>pred_grasp</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">7</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> target_grasp</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">:</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 128);">7</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Success prediction loss</span><span>
</span></span><span><span>        success_loss </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> F</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>binary_c=
ross_entropy</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">(</span><span>pred_success</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">,</span><span> target_success</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Weighted combination</span><span>
</span></span><span><span>        total_loss </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">1.0</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">*</span><span> position_loss </=
span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span>=
<span>      </span><span class=3D"token token" style=3D"color: rgb(110, 118=
, 135);"># Position is most important</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">0.5</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">*</span><span> orientation_loss=
 </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</sp=
an><span>   </span><span class=3D"token token" style=3D"color: rgb(110, 118=
, 135);"># Orientation matters less</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">0.3</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">*</span><span> width_loss </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><sp=
an>         </span><span class=3D"token token" style=3D"color: rgb(110, 118=
, 135);"># Width is easiest to adjust</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">0.5</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">*</span><span> success_loss    =
     </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);=
"># Success prediction helps regularization</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> total_loss</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"position_loss"</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span> position_loss</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>item</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"orientation_loss"</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> orientation_loss<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span=
><span>item</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"width_loss"</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> width_loss</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>item<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"success_loss"</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> success_loss</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>i=
tem</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"total_loss"</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> total_loss</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>item<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">QwenGraspTrainer</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Training pipeline for fine-tuned Qwen grasp predict=
or
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> isaac_sim_env</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>env </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> isaac_sim_env
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>model </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> FineTunedQwe=
nGraspPredictor</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span>use_lora</span><span class=3D"token token" style=3D"=
color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"col=
or: rgb(0, 128, 128);">True</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Only optimize LoRA parameters + grasp heads</span=
><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>optimizer </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>optim</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">.</span><span>AdamW</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>model</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>parameters=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            lr</span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">1e-4</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            weight_decay</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">0.01</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Learning rate scheduler</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>scheduler </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>optim</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">.</span><span>lr_scheduler</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>CosineAnnealingLR</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>optimizer</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            T_max</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 128);">10000</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">train</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> num_iterations</spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">10000</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Training loop with synthetic data from Isaac Si=
m
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>model</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>train</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">for</span><span> iteration </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>num_iter=
ations</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</sp=
an><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Generate batch from simulation</span><=
span>
</span></span><span><span>            batch </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>generate=
_batch</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>batch_size</span><span class=3D"token token" style=3D"color: =
rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb=
(0, 128, 128);">4</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span>  </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Small batch due to memory</span><span>
</span></span><span>           =20
</span><span><span>            images </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> batch</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">"images"</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>            text_prompts </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> batch</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 0);">"text_prompts"</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><spa=
n>
</span></span><span><span>            target_grasps </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> batch</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 0);">"target_grasps"</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><s=
pan>
</span></span><span><span>            target_success </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> batch</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 0);">"target_success"</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span>=
<span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Forward pass</span><span>
</span></span><span><span>            pred_grasp</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> pred_success</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n> _ </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D</span><span> self</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">.</span><span>model</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>images</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> text_prompts</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Compute loss</span><span>
</span></span><span><span>            loss</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> loss_dict </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> sel=
f</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>model</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">.</span><span>compute_loss</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                pred_grasp</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> pred_success</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span>
</span></span><span><span>                target_grasps</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> target_su=
ccess
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Backward pass</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>optimizer</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>zero_gra=
d</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span><span>            loss</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>backward</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Gradient clipping (important for LLM fine-tun=
ing)</span><span>
</span></span><span><span>            torch</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>nn</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>utils</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>c=
lip_grad_norm_</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">(</span><span>self</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">.</span><span>model</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">.</span><span>parameters</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> max_norm</span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">1.0</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            self</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>optimizer</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>step</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>scheduler</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>step</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Logging</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> iteration </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">%</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">100</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D=3D</span><span> </span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token stri=
ng-interpolation" style=3D"color: rgb(0, 128, 0);">f"Iteration </span><span=
 class=3D"token token string-interpolation interpolation" style=3D"color: r=
gb(43, 48, 59);">{</span><span class=3D"token token string-interpolation in=
terpolation">iteration</span><span class=3D"token token string-interpolatio=
n interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"t=
oken token string-interpolation" style=3D"color: rgb(0, 128, 0);">/</span><=
span class=3D"token token string-interpolation interpolation" style=3D"colo=
r: rgb(43, 48, 59);">{</span><span class=3D"token token string-interpolatio=
n interpolation">num_iterations</span><span class=3D"token token string-int=
erpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span c=
lass=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">=
"</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token stri=
ng-interpolation" style=3D"color: rgb(0, 128, 0);">f"  Losses: </span><span=
 class=3D"token token string-interpolation interpolation" style=3D"color: r=
gb(43, 48, 59);">{</span><span class=3D"token token string-interpolation in=
terpolation">loss_dict</span><span class=3D"token token string-interpolatio=
n interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"t=
oken token string-interpolation" style=3D"color: rgb(0, 128, 0);">"</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token stri=
ng-interpolation" style=3D"color: rgb(0, 128, 0);">f"  LR: </span><span cla=
ss=3D"token token string-interpolation interpolation" style=3D"color: rgb(4=
3, 48, 59);">{</span><span class=3D"token token string-interpolation interp=
olation">self</span><span class=3D"token token string-interpolation interpo=
lation" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token toke=
n string-interpolation interpolation">scheduler</span><span class=3D"token =
token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);"=
>.</span><span class=3D"token token string-interpolation interpolation">get=
_last_lr</span><span class=3D"token token string-interpolation interpolatio=
n" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token str=
ing-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">)</span>=
<span class=3D"token token string-interpolation interpolation" style=3D"col=
or: rgb(43, 48, 59);">[</span><span class=3D"token token string-interpolati=
on interpolation" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D=
"token token string-interpolation interpolation" style=3D"color: rgb(43, 48=
, 59);">]</span><span class=3D"token token string-interpolation interpolati=
on" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token st=
ring-interpolation interpolation format-spec">.2e</span><span class=3D"toke=
n token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59)=
;">}</span><span class=3D"token token string-interpolation" style=3D"color:=
 rgb(0, 128, 0);">"</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span>
</span></span><span>               =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Validation</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> iteration </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">%</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1000</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D=3D</span><span> </span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">:</span><span>
</span></span><span><span>                self</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>validate</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">generate_batch</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> batch_siz=
e</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</=
span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">4</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Generate training batch from Isaac Sim
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        batch </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"images"</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"text_prompts"</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"target_grasps"</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"target_success"</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">for</span><span> _ </span><span class=3D"token token"=
 style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(179, 74, 0);">range</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>batch_size</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Create random scene</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>env</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>spawn_random_d=
ishes</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>env</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>step_simulatio=
n</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Get observation</span><span>
</span></span><span><span>            rgb</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span> depth </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>env</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">.</span><span>get_camera_observation</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Generate optimal grasp using ground truth phy=
sics</span><span>
</span></span><span><span>            optimal_grasp</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> success </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><sp=
an> self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">.</span><span>env</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">.</span><span>compute_optimal_grasp</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Optional: Add text guidance</span><span>
</span></span><span><span>            text_prompt </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ge=
nerate_text_prompt</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">(</span><span>self</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">.</span><span>env</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">.</span><span>get_scene_description</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            batch</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"=
color: rgb(0, 128, 0);">"images"</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">.</span><span>append</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>rgb</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            batch</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"text_prompts"</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>text_prompt</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span>
</span></span><span><span>            batch</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"target_grasps"</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>optimal_gr=
asp</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span>
</span></span><span><span>            batch</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"target_success"</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>success</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Convert to tensors</span><span>
</span></span><span><span>        batch</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"images"</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>stack<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><spa=
n>torch</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>.</span><span>from_numpy</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">(</span><span>img</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(129, 0, 194);">for</span><span> img </span><span c=
lass=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> bat=
ch</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">"images"</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        batch</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"target_grasps"</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>tensor</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span>batch</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 0);">"target_grasps"</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">)</span><span>
</span></span><span><span>        batch</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"target_success"</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>tensor</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">(</span><span>batch</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 1=
28, 0);">"target_success"</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">.</span><span>unsqueeze</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"colo=
r: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> batch
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">generate_text_prompt</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> scene=
_description</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Generate text prompts for conditioning
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        prompts </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">[</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"Find the best grasp for any dish in the sin=
k."</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"Identify the most accessible dish and sugge=
st a grasp."</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token str=
ing-interpolation" style=3D"color: rgb(0, 128, 0);">f"Scene: </span><span c=
lass=3D"token token string-interpolation interpolation" style=3D"color: rgb=
(43, 48, 59);">{</span><span class=3D"token token string-interpolation inte=
rpolation">scene_description</span><span class=3D"token token string-interp=
olation interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span clas=
s=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">. P=
redict optimal grasp."</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"Which dish should be picked first? Where to=
 grasp it?"</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> np</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>c=
hoice</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span>prompts</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">)</span></span></code></pre></div></div>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">My Recomme=
ndation</h2>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]"><strong>For a dishwashing robot, I'd use the Hybrid Approach:</stro=
ng></p>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Recomme=
nded architecture:</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 128);">1.</span><span> Qwen3</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">-</span><span>VL </span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span>frozen</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 no fine</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);=
">-</span><span>tuning</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">:</span><span> Scene understanding
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 128);">2.</span><span> Custom lightweight network</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> Gra=
sp pose prediction =20
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 128);">3.</span><span> Traditional geometry</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> Collision=
 checking</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">,</span><span> kinematics
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Rationale:</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Qwen gives you semantic understanding </=
span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">"for free=
"</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Custom network </span><span class=3D"tok=
en token" style=3D"color: rgb(129, 0, 194);">is</span><span> fast</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> r=
eliable</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>,</span><span> deployable
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> Best of both worlds</span></span></code>=
</pre></div></div>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]"><strong>Only fine-tune Qwen3-VL if:</strong></p>
<ul class=3D"[li_&amp;]:mb-0 [li_&amp;]:mt-1 [li_&amp;]:gap-1 [&amp;:not(:l=
ast-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc flex flex-co=
l gap-1 pl-8 mb-3">
<li class=3D"whitespace-normal break-words pl-2">You have &gt;50K labeled g=
rasp examples</li>
<li class=3D"whitespace-normal break-words pl-2">You need language-guided g=
rasping ("pick up the red bowl")</li>
<li class=3D"whitespace-normal break-words pl-2">You can afford powerful GP=
U hardware</li>
<li class=3D"whitespace-normal break-words pl-2">Your deployment environmen=
t allows 200ms inference times</li>
<li class=3D"whitespace-normal break-words pl-2">You want explainable AI ("=
why this grasp?")</li>
</ul>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]"><strong>Use custom CNN if:</strong></p>
<ul class=3D"[li_&amp;]:mb-0 [li_&amp;]:mt-1 [li_&amp;]:gap-1 [&amp;:not(:l=
ast-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc flex flex-co=
l gap-1 pl-8 mb-3">
<li class=3D"whitespace-normal break-words pl-2">You need &lt;10ms inferenc=
e</li>
<li class=3D"whitespace-normal break-words pl-2">You have limited compute b=
udget</li>
<li class=3D"whitespace-normal break-words pl-2">Your dishes are relatively=
 standard (plates, bowls, cups)</li>
<li class=3D"whitespace-normal break-words pl-2">You don't need natural lan=
guage interaction</li>
</ul>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">Does this help clarify the trade-offs? Would you like me to dive de=
eper into any particular approach?</p></div></div></div></div></div><div cl=
ass=3D"flex justify-start opacity-0 group-hover:opacity-100 group-focus-wit=
hin:opacity-100 transition" role=3D"group" aria-label=3D"Message actions"><=
div class=3D"text-text-300"><div class=3D"text-text-300 flex items-stretch =
justify-between"><div class=3D"w-fit" data-state=3D"closed"><button class=
=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" data-testid=3D"acti=
on-bar-copy" aria-label=3D"Copy"><div class=3D"relative text-text-500 group=
-hover/btn:text-text-100"><div class=3D"transition-all opacity-100 scale-10=
0" style=3D"width: 20px; height: 20px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"tr=
ansition-all opacity-100 scale-100" aria-hidden=3D"true" style=3D"flex-shri=
nk: 0;"><path d=3D"M12.5 3C13.3284 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 =
6.67157 17 7.5V15.5C17 16.3284 16.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 =
6 15.5V14H4.5C3.67157 14 3 13.3284 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.=
5ZM14 12.5C14 13.3284 13.3284 14 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16=
H15.5C15.7761 16 16 15.7761 16 15.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5=
ZM4.5 4C4.22386 4 4 4.22386 4 4.5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.=
7761 13 13 12.7761 13 12.5V4.5C13 4.22386 12.7761 4 12.5 4H4.5Z"></path></s=
vg></div><div class=3D"absolute top-0 left-0 transition-all opacity-0 scale=
-50" style=3D"width: 20px; height: 20px; display: flex; align-items: center=
; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 =
20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"=
absolute top-0 left-0 transition-all opacity-0 scale-50" aria-hidden=3D"tru=
e" style=3D"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15=
.6346 4.96153 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.736=
05L15.8836 5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 =
14.9989C7.88203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.0=
8172 11.2752C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755=
 4.58105 10.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.=
1794L15.1883 5.10908Z"></path></svg></div></div></button></div><div class=
=3D"w-fit" data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Give =
positive feedback"><div class=3D"text-text-500 group-hover/btn:text-text-10=
0" style=3D"width: 16px; height: 16px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"te=
xt-text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"fl=
ex-shrink: 0;"><path d=3D"M9.56055 2C11.1381 2.00009 12.3211 3.44332 12.011=
7 4.99023L11.6094 7H13.8438C15.5431 7 16.836 8.52594 16.5566 10.2021L15.876=
 14.2842C15.6148 15.8513 14.2586 17 12.6699 17H4.5C3.67157 17 3 16.3284 3 1=
5.5V9.23828C3.00013 8.57996 3.4294 7.99838 4.05859 7.80469L5.19824 7.4541L5=
.33789 7.40723C6.02983 7.15302 6.59327 6.63008 6.89746 5.9541L8.41113 2.589=
84L8.48047 2.46094C8.66235 2.17643 8.97898 2.00002 9.32324 2H9.56055ZM7.809=
57 6.36523C7.39486 7.2867 6.62674 7.99897 5.68359 8.3457L5.49219 8.41016L4.=
35254 8.76074C4.14305 8.82539 4.00013 9.01904 4 9.23828V15.5C4 15.7761 4.22=
386 16 4.5 16H12.6699C13.7697 16 14.7087 15.2049 14.8896 14.1201L15.5703 10=
.0381C15.7481 8.97141 14.9251 8 13.8438 8H11C10.8503 8 10.7083 7.9331 10.61=
33 7.81738C10.5184 7.70164 10.4805 7.54912 10.5098 7.40234L11.0312 4.79395C=
11.2167 3.86589 10.507 3.00009 9.56055 3H9.32324L7.80957 6.36523Z"></path><=
/svg></div></button></div><div class=3D"w-fit" data-state=3D"closed"><butto=
n class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Give =
negative feedback"><div class=3D"text-text-500 group-hover/btn:text-text-10=
0" style=3D"width: 16px; height: 16px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"te=
xt-text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"fl=
ex-shrink: 0;"><path d=3D"M12.6699 3C14.2586 3 15.6148 4.14871 15.876 5.715=
82L16.5566 9.79785C16.836 11.4741 15.5431 13 13.8438 13H11.6094L12.0117 15.=
0098C12.3211 16.5567 11.1381 17.9999 9.56055 18H9.32324C8.97898 18 8.66235 =
17.8236 8.48047 17.5391L8.41113 17.4102L6.89746 14.0459C6.59327 13.3699 6.0=
2983 12.847 5.33789 12.5928L5.19824 12.5459L4.05859 12.1953C3.4294 12.0016 =
3.00013 11.42 3 10.7617V4.5C3 3.67157 3.67157 3 4.5 3H12.6699ZM4.5 4C4.2238=
6 4 4 4.22386 4 4.5V10.7617C4.00013 10.981 4.14305 11.1746 4.35254 11.2393L=
5.49219 11.5898L5.68359 11.6543C6.62674 12.001 7.39486 12.7133 7.80957 13.6=
348L9.32324 17H9.56055C10.507 16.9999 11.2167 16.1341 11.0312 15.2061L10.50=
98 12.5977C10.4805 12.4509 10.5184 12.2984 10.6133 12.1826C10.7083 12.0669 =
10.8503 12 11 12H13.8438C14.9251 12 15.7481 11.0286 15.5703 9.96191L14.8896=
 5.87988C14.7087 4.79508 13.7697 4 12.6699 4H4.5Z"></path></svg></div></but=
ton></div><div class=3D"flex items-center"><div class=3D"w-fit" data-state=
=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" id=3D"radix-_r_kf_"=
 aria-haspopup=3D"menu" aria-expanded=3D"false" data-state=3D"closed" aria-=
label=3D"Retry"><div class=3D"text-text-500 group-hover/btn:text-text-100" =
style=3D"width: 20px; height: 20px; display: flex; align-items: center; jus=
tify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20=
" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-=
text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-=
shrink: 0;"><path d=3D"M10.3857 2.50977C14.3486 2.71054 17.5 5.98724 17.5 1=
0C17.5 14.1421 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 7.5=
4619 3.67878 5.3677 5.49902 4H3C2.72386 4 2.5 3.77614 2.5 3.5C2.5 3.22386 2=
.72386 3 3 3H6.5C6.63261 3 6.75975 3.05272 6.85352 3.14648C6.92392 3.21689 =
6.97106 3.30611 6.99023 3.40234L7 3.5V7C7 7.27614 6.77614 7.5 6.5 7.5C6.223=
86 7.5 6 7.27614 6 7V4.87891C4.4782 6.06926 3.5 7.91979 3.5 10C3.5 13.5899 =
6.41015 16.5 10 16.5C13.5899 16.5 16.5 13.5899 16.5 10C16.5 6.5225 13.7691 =
3.68312 10.335 3.50879L10 3.5L9.89941 3.49023C9.67145 3.44371 9.5 3.24171 9=
.5 3C9.5 2.72386 9.72386 2.5 10 2.5L10.3857 2.50977Z"></path></svg></div></=
button></div></div></div></div></div></div></div><div data-test-render-coun=
t=3D"2"><div class=3D"mb-1 mt-6 group"><div class=3D"flex flex-col items-en=
d gap-1"><div class=3D"group relative inline-flex gap-2 bg-bg-300 rounded-x=
l pl-2.5 py-2.5 break-words text-text-100 transition-all max-w-[75ch] flex-=
col !px-4 max-w-[85%]" style=3D"opacity: 1; transform: none;"><div class=3D=
"flex flex-row gap-2 relative"><div class=3D"flex-1"><div data-testid=3D"us=
er-message" class=3D"font-large !font-user-message grid grid-cols-1 gap-2 p=
y-0.5 relative" style=3D"max-height: none; overflow: hidden; position: rela=
tive;"><p class=3D"whitespace-pre-wrap break-words">Awesome. Lets incorpora=
te it into the initial code you generated. Include everything</p></div></di=
v></div></div><div class=3D"flex justify-start opacity-0 group-hover:opacit=
y-100 group-focus-within:opacity-100 transition" role=3D"group" aria-label=
=3D"Message actions"><div class=3D"text-text-300"><div class=3D"text-text-3=
00 flex items-stretch justify-between"><span class=3D"text-text-500 text-xs=
 flex items-center mr-2" data-state=3D"closed">Feb 4</span><div class=3D"fl=
ex items-center"><div class=3D"w-fit" data-state=3D"closed"><button class=
=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Retry=
"><div class=3D"text-text-500 group-hover/btn:text-text-100" style=3D"width=
: 20px; height: 20px; display: flex; align-items: center; justify-content: =
center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curr=
entColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-text-500 group=
-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><p=
ath d=3D"M10.3857 2.50977C14.3486 2.71054 17.5 5.98724 17.5 10C17.5 14.1421=
 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 7.54619 3.67878 5=
.3677 5.49902 4H3C2.72386 4 2.5 3.77614 2.5 3.5C2.5 3.22386 2.72386 3 3 3H6=
.5C6.63261 3 6.75975 3.05272 6.85352 3.14648C6.92392 3.21689 6.97106 3.3061=
1 6.99023 3.40234L7 3.5V7C7 7.27614 6.77614 7.5 6.5 7.5C6.22386 7.5 6 7.276=
14 6 7V4.87891C4.4782 6.06926 3.5 7.91979 3.5 10C3.5 13.5899 6.41015 16.5 1=
0 16.5C13.5899 16.5 16.5 13.5899 16.5 10C16.5 6.5225 13.7691 3.68312 10.335=
 3.50879L10 3.5L9.89941 3.49023C9.67145 3.44371 9.5 3.24171 9.5 3C9.5 2.723=
86 9.72386 2.5 10 2.5L10.3857 2.50977Z"></path></svg></div></button></div><=
div class=3D"w-fit" data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Edit"=
><div class=3D"text-text-500 group-hover/btn:text-text-100" style=3D"width:=
 20px; height: 20px; display: flex; align-items: center; justify-content: c=
enter;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curre=
ntColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-text-500 group-=
hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><pa=
th d=3D"M9.72821 2.87934C10.0318 2.10869 10.9028 1.72933 11.6735 2.03266L14=
.4655 3.13226C15.236 3.43593 15.6145 4.30697 15.3112 5.07758L11.3903 15.030=
7C11.2954 15.2717 11.1394 15.4835 10.9391 15.6459L10.8513 15.7123L7.7077 17=
.8979C7.29581 18.1843 6.73463 17.9917 6.57294 17.5356L6.54657 17.4409L5.737=
 13.6987C5.67447 13.4092 5.69977 13.107 5.80829 12.8315L9.72821 2.87934ZM6.=
73798 13.1987C6.70201 13.2903 6.69385 13.3906 6.71454 13.4868L7.44501 16.86=
27L10.28 14.892L10.3376 14.8452C10.3909 14.7949 10.4325 14.7332 10.4597 14.=
6645L13.0974 7.96723L9.37567 6.50141L6.73798 13.1987ZM11.3073 2.96332C11.05=
04 2.86217 10.7601 2.98864 10.6589 3.24555L9.74188 5.57074L13.4636 7.03754L=
14.3806 4.71137C14.4817 4.45445 14.3552 4.16413 14.0983 4.06293L11.3073 2.9=
6332Z"></path></svg></div></button></div></div><div class=3D"w-fit" data-st=
ate=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" data-testid=3D"acti=
on-bar-copy" aria-label=3D"Copy"><div class=3D"relative text-text-500 group=
-hover/btn:text-text-100"><div class=3D"transition-all opacity-100 scale-10=
0" style=3D"width: 20px; height: 20px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"tr=
ansition-all opacity-100 scale-100" aria-hidden=3D"true" style=3D"flex-shri=
nk: 0;"><path d=3D"M12.5 3C13.3284 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 =
6.67157 17 7.5V15.5C17 16.3284 16.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 =
6 15.5V14H4.5C3.67157 14 3 13.3284 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.=
5ZM14 12.5C14 13.3284 13.3284 14 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16=
H15.5C15.7761 16 16 15.7761 16 15.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5=
ZM4.5 4C4.22386 4 4 4.22386 4 4.5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.=
7761 13 13 12.7761 13 12.5V4.5C13 4.22386 12.7761 4 12.5 4H4.5Z"></path></s=
vg></div><div class=3D"absolute top-0 left-0 transition-all opacity-0 scale=
-50" style=3D"width: 20px; height: 20px; display: flex; align-items: center=
; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 =
20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"=
absolute top-0 left-0 transition-all opacity-0 scale-50" aria-hidden=3D"tru=
e" style=3D"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15=
.6346 4.96153 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.736=
05L15.8836 5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 =
14.9989C7.88203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.0=
8172 11.2752C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755=
 4.58105 10.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.=
1794L15.1883 5.10908Z"></path></svg></div></div></button></div><div class=
=3D"flex items-center"></div></div></div></div></div></div></div><div data-=
test-render-count=3D"2"><div class=3D"group" style=3D"height: auto; opacity=
: 1; transform: none;"><div class=3D"contents"><div data-is-streaming=3D"fa=
lse" class=3D"group relative relative pb-3" style=3D"opacity: 1; transform:=
 none;"><div class=3D"font-claude-response relative leading-[1.65rem] [&amp=
;_pre>div]:bg-bg-000/50 [&amp;_pre>div]:border-0.5 [&amp;_pre>div]:border-b=
order-400 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_.standard-markdo=
wn_:is(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&amp;_.standard-markdown_:is(=
p,blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8 [&amp;_.progressive-markdown_:i=
s(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&amp;_.progressive-markdown_:is(p,=
blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8"><div><div class=3D"standard-mark=
down grid-cols-1 grid [&amp;_>_*]:min-w-0 gap-3 standard-markdown"><h1 clas=
s=3D"text-text-100 mt-3 -mb-1 text-[1.375rem] font-bold">Complete Robotic D=
ishwashing System with Hybrid Qwen3-VL Architecture</h1>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">Here's the full integrated system with all components:</p>
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">Project St=
ructure</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div><pre c=
lass=3D"code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5"=
 style=3D"color: rgb(20, 24, 31); background: transparent; font-family: var=
(--font-mono);"><code style=3D"color: rgb(20, 24, 31); background: transpar=
ent; font-family: var(--font-mono); white-space: pre-wrap;"><span><span>dis=
hwashing_robot/
</span></span><span>=E2=94=9C=E2=94=80=E2=94=80 vision/
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 __init__.py
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 qwen_semantic.py      =
    # Qwen3-VL semantic understanding
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 geometry_reconstructio=
n.py # 3D reconstruction
</span><span>=E2=94=82   =E2=94=94=E2=94=80=E2=94=80 hybrid_vision.py      =
     # Combined vision system
</span><span>=E2=94=9C=E2=94=80=E2=94=80 grasp_planning/
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 __init__.py
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 grasp_generator.py    =
     # Grasp candidate generation
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 grasp_predictor.py    =
     # Success prediction network
</span><span>=E2=94=82   =E2=94=94=E2=94=80=E2=94=80 grasp_planner.py      =
     # Complete planning pipeline
</span><span>=E2=94=9C=E2=94=80=E2=94=80 simulation/
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 __init__.py
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 isaac_environment.py  =
     # Isaac Sim setup
</span><span>=E2=94=82   =E2=94=94=E2=94=80=E2=94=80 training_env.py       =
     # Training data generation
</span><span>=E2=94=9C=E2=94=80=E2=94=80 robot/
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 __init__.py
</span><span>=E2=94=82   =E2=94=94=E2=94=80=E2=94=80 robot_controller.py   =
     # Robot arm control
</span><span>=E2=94=9C=E2=94=80=E2=94=80 training/
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 __init__.py
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 train_grasp_predictor.=
py   # Training pipeline
</span><span>=E2=94=82   =E2=94=94=E2=94=80=E2=94=80 dataset.py            =
     # Dataset handling
</span><span>=E2=94=9C=E2=94=80=E2=94=80 utils/
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 __init__.py
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 transforms.py         =
     # Coordinate transforms
</span><span>=E2=94=82   =E2=94=94=E2=94=80=E2=94=80 visualization.py      =
     # Debug visualization
</span><span>=E2=94=9C=E2=94=80=E2=94=80 main.py                        # M=
ain execution
</span><span>=E2=94=94=E2=94=80=E2=94=80 requirements.txt</span></code></pr=
e></div></div>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">1. Require=
ments</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">txt</div><div><pre class=3D"code-b=
lock__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"colo=
r: rgb(20, 24, 31); background: transparent; font-family: var(--font-mono);=
"><code class=3D"language-txt" style=3D"color: rgb(20, 24, 31); background:=
 transparent; font-family: var(--font-mono); white-space: pre;"><span><span=
># requirements.txt
</span></span><span>
</span><span># Core Dependencies
</span><span>torch&gt;=3D2.0.0
</span><span>torchvision&gt;=3D0.15.0
</span><span>numpy&gt;=3D1.24.0
</span><span>scipy&gt;=3D1.10.0
</span><span>
</span><span># Vision Models
</span><span>transformers&gt;=3D4.35.0
</span><span>accelerate&gt;=3D0.24.0
</span><span>peft&gt;=3D0.6.0
</span><span>bitsandbytes&gt;=3D0.41.0  # For quantization
</span><span>
</span><span># 3D Processing
</span><span>open3d&gt;=3D0.17.0
</span><span>opencv-python&gt;=3D4.8.0
</span><span>pillow&gt;=3D10.0.0
</span><span>
</span><span># NVIDIA Isaac Sim (install separately)
</span><span># Follow: https://docs.omniverse.nvidia.com/isaacsim/latest/in=
stallation.html
</span><span># isaacsim&gt;=3D2023.1.0
</span><span>
</span><span># Robotics
</span><span># scipy for transforms
</span><span>scikit-learn&gt;=3D1.3.0
</span><span>
</span><span># Utilities
</span><span>matplotlib&gt;=3D3.7.0
</span><span>tqdm&gt;=3D4.66.0
</span><span>wandb&gt;=3D0.15.0  # Optional: for experiment tracking</span>=
</code></pre></div></div>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">2. Vision =
Module - Qwen Semantic Understanding</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># vision/=
qwen_semantic.py</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">import</span><span> torch
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> transformers </span><span class=3D"t=
oken token" style=3D"color: rgb(129, 0, 194);">import</span><span> Qwen2VLF=
orConditionalGeneration</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">,</span><span> AutoProcessor
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> numpy </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> typing </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">import</span><span> Dict</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> L=
ist</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span> Optional
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> json
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> re
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">QwenSemanticAnalyzer</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Uses Qwen3-VL for high-level semantic understanding=
 of dishes
</span><span>    - Identifies dish types, materials, orientations
</span><span>    - Provides reasoning about graspability
</span><span>    - Generates natural language explanations
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        model_name</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">str</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">"Qwen/Q=
wen2-VL-7B-Instruct"</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">,</span><span>
</span></span><span><span>        device</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(179, 74, 0);">str</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">"cuda"</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>        load_in_8bit</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
True</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Initialize Qwen3-VL model
</span><span>       =20
</span><span>        Args:
</span><span>            model_name: HuggingFace model identifier
</span><span>            device: 'cuda' or 'cpu'
</span><span>            load_in_8bit: Use 8-bit quantization to save memor=
y
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>device </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> device
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpolatio=
n" style=3D"color: rgb(0, 128, 0);">f"Loading Qwen3-VL model: </span><span =
class=3D"token token string-interpolation interpolation" style=3D"color: rg=
b(43, 48, 59);">{</span><span class=3D"token token string-interpolation int=
erpolation">model_name</span><span class=3D"token token string-interpolatio=
n interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"t=
oken token string-interpolation" style=3D"color: rgb(0, 128, 0);">"</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Load with quantization for memory efficiency</spa=
n><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> load_in_8bit </span><span cla=
ss=3D"token token" style=3D"color: rgb(129, 0, 194);">and</span><span> devi=
ce </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=
=3D</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, =
128, 0);">"cuda"</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">:</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>model </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Qwen2VL=
ForConditionalGeneration</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">.</span><span>from_pretrained</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                model_name</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                torch_dtype</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>torch</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>float16</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">,</span><span>
</span></span><span><span>                device_map</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">"auto"</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                load_in_8bit</span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>model </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Qwen2VL=
ForConditionalGeneration</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">.</span><span>from_pretrained</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                model_name</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                torch_dtype</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>torch</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>float16</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">,</span><span>
</span></span><span><span>                device_map</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">"auto"</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>processor </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> AutoProcessor</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>from_pretrained</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">(</span><span>model_name</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Keep model in eval mode (we don't fine-tune it)</=
span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>model</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token t=
oken" style=3D"color: rgb(179, 74, 0);">eval</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"Qwen3-VL loaded successfully"</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">analyze_scene</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        rgb_image</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n>
</span></span><span><span>        custom_prompt</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> Optional</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cla=
ss=3D"token token" style=3D"color: rgb(179, 74, 0);">str</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span=
> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">Non=
e</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> Dict</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Perform semantic analysis of sink scene
</span><span>       =20
</span><span>        Args:
</span><span>            rgb_image: RGB image (H, W, 3) as numpy array
</span><span>            custom_prompt: Optional custom prompt for specific=
 queries
</span><span>           =20
</span><span>        Returns:
</span><span>            Dictionary with semantic information
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Default structured prompt</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> custom_prompt </span><span cl=
ass=3D"token token" style=3D"color: rgb(129, 0, 194);">is</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">None</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><sp=
an>
</span></span><span><span>            prompt </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token triple-quoted-string" style=3D"color: rgb(0, 128, 0);">"""A=
nalyze this kitchen sink image. For each dish visible, provide:
</span></span><span>1. Dish type (plate, bowl, cup, glass, utensil, etc.)
</span><span>2. Material (ceramic, glass, plastic, metal)
</span><span>3. Orientation (flat, tilted, upright, inverted)
</span><span>4. Approximate position (left, center, right, front, back)
</span><span>5. Graspability score (0-10, where 10 is easiest to grasp)
</span><span>6. Any obstacles or challenges for grasping
</span><span>
</span><span>Also provide:
</span><span>- Overall scene complexity (low/medium/high)
</span><span>- Recommended picking order
</span><span>- Any safety concerns (sharp objects, fragile items)
</span><span>
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">Format your response as a structured list."""</span><sp=
an>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            prompt </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> custom_prompt
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Prepare messages for Qwen</span><span>
</span></span><span><span>        messages </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">"role"</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 0);">"user"</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">"content"</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">[</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                        </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 0);">"type"</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">"image"</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                        </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 0);">"image"</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> rgb_image
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                        </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 0);">"type"</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">"text"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                        </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 0);">"text"</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> prompt
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Process and generate</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">with</span><span> torch</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>no_grad</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            text_input </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>pro=
cessor</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
.</span><span>apply_chat_template</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                messages</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                tokenize</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">False</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                add_generation_prompt</span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            inputs </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>processor</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>
</span></span><span><span>                text</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">[</span><span>text_input</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                images</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">[</span><span>rgb_image</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                return_tensors</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">"pt"</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                padding</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>to</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>device</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Generate response</span><span>
</span></span><span><span>            outputs </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>model<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span=
><span>generate</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">**</span><span>inputs</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                max_new_tokens</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">1024</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                temperature</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 128);">0.7</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                top_p</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">0.9</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                do_sample</span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">False</span><span>  </span><span=
 class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Deterministic=
 for robotics</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Decode response</span><span>
</span></span><span><span>            response </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>proce=
ssor</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.<=
/span><span>decode</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">(</span><span>
</span></span><span><span>                outputs</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">[</span><span>inputs</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">'input_ids'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>shape</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                skip_special_tokens</span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Parse structured response</span><span>
</span></span><span><span>        parsed_info </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_parse=
_response</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span>response</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        parsed_info</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 0);">'raw_response'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> respons=
e
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> parsed_info
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_parse_response</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> response<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);=
">str</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24=
, 31);">-</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31)=
;">&gt;</span><span> Dict</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Parse Qwen's natural language response into str=
uctured data
</span><span>       =20
</span><span>        Note: In production, you'd fine-tune Qwen to output JS=
ON directly
</span><span>        This is a heuristic parser for the pretrained model
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Initialize structure</span><span>
</span></span><span><span>        parsed </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'dishes'</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'scene_complexity'</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">'unknown'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'recommended_order'</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'safety_concerns'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'obstacles'</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Extract dish information (simplified parsing)</sp=
an><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Look for numbered items or dish types</sp=
an><span>
</span></span><span><span>        lines </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> response</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>split</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'\n'</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        current_dish </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">None</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> line </span><span class=3D"t=
oken token" style=3D"color: rgb(129, 0, 194);">in</span><span> lines</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span=
>
</span></span><span><span>            line </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> line</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>strip</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Detect dish types</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(179, 74, 0);">any</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">(</span><span>dish_type </span><spa=
n class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> =
line</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.<=
/span><span>lower</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span> </span><span class=3D"token token" style=3D"color: rgb=
(129, 0, 194);">for</span><span> dish_type </span><span class=3D"token toke=
n" style=3D"color: rgb(129, 0, 194);">in</span><span>=20
</span></span><span><span>                   </span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 0);">'plate'</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">'bowl'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'cup'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 0);">'glass'</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'mug'</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">=
'utensil'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0,=
 128, 0);">'fork'</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 0);">'knife'</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'spoon'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span>               =20
</span><span><span>                </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> current_dish</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                    parsed</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 0);">'dishes'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>current_di=
sh</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span>
</span></span><span>               =20
</span><span><span>                current_dish </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'type'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> self</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_extract_=
dish_type</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span>line</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'material'</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">'unknown'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 0);">'unknown'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">'unknown'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'graspability'</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 128);">5</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>  </span>=
<span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Default =
medium</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'raw_description'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> line
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Extract attributes for current dish</span><sp=
an>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> current_dish</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'material'</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><=
span> line</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>lower</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">:</span><span>
</span></span><span><span>                    current_dish</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'material'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span=
> self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
.</span><span>_extract_material</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">(</span><span>line</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span> </=
span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</spa=
n><span> line</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">.</span><span>lower</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span> </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">or</span><span> </span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 0);">'angle'</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> line</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>lower</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span>
</span></span><span><span>                    current_dish</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><sp=
an> self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">.</span><span>_extract_orientation</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">(</span><span>line</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'position'</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><=
span> line</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>lower</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">)</span><span> </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">or</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'located'</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> line</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>lower</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><=
span>
</span></span><span><span>                    current_dish</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span=
> self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
.</span><span>_extract_position</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">(</span><span>line</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'graspability'</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</sp=
an><span> line</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">.</span><span>lower</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">)</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">or</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'score'</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> line</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>lower</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span>
</span></span><span><span>                    current_dish</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'graspability'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><s=
pan> self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">.</span><span>_extract_score</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">(</span><span>line</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Scene-level attributes</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">'complexity'</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><sp=
an> line</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">.</span><span>lower</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'high'</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span=
> line</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
.</span><span>lower</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">:</span><span>
</span></span><span><span>                    parsed</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 0);">'scene_complexity'</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'hig=
h'</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">elif</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'low'</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><s=
pan> line</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">.</span><span>lower</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">:</span><span>
</span></span><span><span>                    parsed</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 0);">'scene_complexity'</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'low=
'</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                    parsed</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 0);">'scene_complexity'</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'med=
ium'</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'sharp'</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> line</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>lower</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(129, 0=
, 194);">or</span><span> </span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 0);">'fragile'</span><span> </span><span class=3D"token token"=
 style=3D"color: rgb(129, 0, 194);">in</span><span> line</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>lower</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">or</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0)=
;">'danger'</span><span> </span><span class=3D"token token" style=3D"color:=
 rgb(129, 0, 194);">in</span><span> line</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>lower</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                parsed</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token toke=
n" style=3D"color: rgb(0, 128, 0);">'safety_concerns'</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>line<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'obstacle'</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> line<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span=
><span>lower</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>)</span><span> </span><span class=3D"token token" style=3D"color: rgb(129,=
 0, 194);">or</span><span> </span><span class=3D"token token" style=3D"colo=
r: rgb(0, 128, 0);">'blocking'</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(129, 0, 194);">in</span><span> line</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>lower</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                parsed</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token toke=
n" style=3D"color: rgb(0, 128, 0);">'obstacles'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>line</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Add last dish</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> current_dish</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            parsed</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 0);">'dishes'</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>current_dish</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Sort dishes by graspability (highest first)</span=
><span>
</span></span><span><span>        parsed</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'dishes'</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>sort</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">(</span><span>key</span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"to=
ken token" style=3D"color: rgb(129, 0, 194);">lambda</span><span> x</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>=
 x</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'graspabil=
ity'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span> reverse</span><span class=3D"token token" style=3D"color: rgb(20, 2=
4, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, =
128);">True</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">)</span><span>
</span></span><span><span>        parsed</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'recommended_order'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
>d</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'type'</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">=
for</span><span> d </span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">in</span><span> parsed</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"=
color: rgb(0, 128, 0);">'dishes'</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">:</span><span class=3D"token token" style=3D"color: rgb(0, =
128, 128);">3</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> parsed
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_extract_dish_type</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> text</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">=
str</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, =
31);">-</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);"=
>&gt;</span><span> </span><span class=3D"token token" style=3D"color: rgb(1=
79, 74, 0);">str</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Extract dish type from t=
ext"""</span><span>
</span></span><span><span>        dish_types </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 0);">'plate'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 0);">'bowl'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'cup'</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'glass=
'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0)=
;">'mug'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, =
128, 0);">'utensil'</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">,</span><span>=20
</span></span><span><span>                      </span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 0);">'fork'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'knife'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 0);">'spoon'</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'pot'</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">=
'pan'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]=
</span><span>
</span></span><span><span>        text_lower </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> text</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>lower</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> dish_type </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> dish_ty=
pes</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</=
span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> dish_type </span><span cla=
ss=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> text_=
lower</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:=
</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">return</span><span> dish_type
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 0);">'unknown'</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_extract_material</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> text</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">s=
tr</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 3=
1);">-</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
&gt;</span><span> </span><span class=3D"token token" style=3D"color: rgb(17=
9, 74, 0);">str</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Extract material from te=
xt"""</span><span>
</span></span><span><span>        materials </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 0);">'ceramic'</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 0);">'glass'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'plastic'<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);"=
>'metal'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, =
128, 0);">'stainless steel'</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" styl=
e=3D"color: rgb(0, 128, 0);">'wood'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        text_lower </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> text</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>lower</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> material </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> materia=
ls</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</s=
pan><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> material </span><span clas=
s=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> text_l=
ower</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:<=
/span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">return</span><span> material
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 0);">'unknown'</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_extract_orientation</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> text<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);=
">str</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24=
, 31);">-</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31)=
;">&gt;</span><span> </span><span class=3D"token token" style=3D"color: rgb=
(179, 74, 0);">str</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Extract orientation from=
 text"""</span><span>
</span></span><span><span>        orientations </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'flat'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 0);">'tilted'</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'upright'</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">=
'inverted'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0=
, 128, 0);">'sideways'</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 128, 0);">'angled'</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        text_lower </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> text</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>lower</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> orientation </span><span cla=
ss=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> orien=
tations</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> orientation </span><span c=
lass=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> tex=
t_lower</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">return</span><span> orientation
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 0);">'unknown'</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_extract_position</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> text</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">s=
tr</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 3=
1);">-</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
&gt;</span><span> </span><span class=3D"token token" style=3D"color: rgb(17=
9, 74, 0);">str</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Extract position from te=
xt"""</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Simple keyword matching</span><span>
</span></span><span><span>        positions </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        text_lower </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> text</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>lower</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'left'</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(129, 0, 194);">in</span><span> text_lower</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><=
span>
</span></span><span><span>            positions</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'left'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'right'</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> text=
_lower</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
:</span><span>
</span></span><span><span>            positions</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'right'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'center'</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> tex=
t_lower </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194)=
;">or</span><span> </span><span class=3D"token token" style=3D"color: rgb(0=
, 128, 0);">'middle'</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">in</span><span> text_lower</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            positions</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'center'</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'front'</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> text=
_lower</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
:</span><span>
</span></span><span><span>            positions</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'front'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'back'</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> text_=
lower </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);"=
>or</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, =
128, 0);">'rear'</span><span> </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">in</span><span> text_lower</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            positions</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'back'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'-'</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>join</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">(</span><span>positions</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">if</=
span><span> positions </span><span class=3D"token token" style=3D"color: rg=
b(129, 0, 194);">else</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'unknown'</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_extract_score</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> text</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">st=
r</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">-</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&=
gt;</span><span> </span><span class=3D"token token" style=3D"color: rgb(179=
, 74, 0);">float</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Extract numerical score =
from text"""</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Look for numbers 0-10</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">import</span><span> re
</span></span><span><span>        numbers </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> re</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>findall</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 0);">r'\b([0-9]|10)\=
b'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> text</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> numbers</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">float</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>numbers</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 128);">5.0</span><span>  </span><span=
 class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Default</span=
><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">get_grasp_guidance</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        rgb_image</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n>
</span></span><span><span>        target_dish_type</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> Optional</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span =
class=3D"token token" style=3D"color: rgb(179, 74, 0);">str</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">N=
one</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">str</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Get natural language guidance for grasping
</span><span>       =20
</span><span>        Args:
</span><span>            rgb_image: RGB image
</span><span>            target_dish_type: Specific dish to grasp (e.g., "b=
lue bowl")
</span><span>           =20
</span><span>        Returns:
</span><span>            Natural language grasp guidance
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> target_dish_type</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            prompt </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">f"I =
need to grasp the </span><span class=3D"token token string-interpolation in=
terpolation" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token=
 token string-interpolation interpolation">target_dish_type</span><span cla=
ss=3D"token token string-interpolation interpolation" style=3D"color: rgb(4=
3, 48, 59);">}</span><span class=3D"token token string-interpolation" style=
=3D"color: rgb(0, 128, 0);">. "</span><span> \
</span></span><span><span>                    </span><span class=3D"token t=
oken string-interpolation" style=3D"color: rgb(0, 128, 0);">f"Please sugges=
t the best approach: where to grip it, "</span><span> \
</span></span><span><span>                    </span><span class=3D"token t=
oken string-interpolation" style=3D"color: rgb(0, 128, 0);">f"from which an=
gle, and any precautions to take."</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            prompt </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">"Which dish should I pick=
 up first, and how should I grasp it? "</span><span> \
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"Provide specific guidance on grip l=
ocation and approach angle."</span><span>
</span></span><span>       =20
</span><span><span>        messages </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">[</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">"role"</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 0);">"user"</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">"content"</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">[</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 0);">"type"</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">"image"</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">"image"</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> rgb_imag=
e</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">}</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 0);">"type"</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">"text"</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">"text"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> prompt</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">}</span><=
span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">with</span><span> torch</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">.</span><span>no_grad</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            text_input </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>pro=
cessor</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
.</span><span>apply_chat_template</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                messages</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                tokenize</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">False</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                add_generation_prompt</span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            inputs </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>processor</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>
</span></span><span><span>                text</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">[</span><span>text_input</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                images</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">[</span><span>rgb_image</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                return_tensors</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">"pt"</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                padding</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>to</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>device</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span>           =20
</span><span><span>            outputs </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>model</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
generate</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">(</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">**</span><span>inputs</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                max_new_tokens</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">256</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                temperature</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 128);">0.5</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            guidance </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>processor<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span=
><span>decode</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">(</span><span>
</span></span><span><span>                outputs</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">[</span><span>inputs</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">'input_ids'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>shape</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                skip_special_tokens</span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> guidance</span></span></code></pr=
e></div></div>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">3. Vision =
Module - 3D Geometry Reconstruction</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># vision/=
geometry_reconstruction.py</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">import</span><span> numpy </span><span class=3D"token token" =
style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> open3d </span><span class=3D"token=
 token" style=3D"color: rgb(129, 0, 194);">as</span><span> o3d
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> typing </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">import</span><span> List</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> T=
uple</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,<=
/span><span> Dict
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> cv2
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">GeometryReconstructor</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Converts RGBD images to 3D point clouds and segment=
s individual dishes
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> camera_intrinsics=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span> Dict</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">[</span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);=
">str</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(179, 7=
4, 0);">float</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</=
span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Initialize with camera parameters
</span><span>       =20
</span><span>        Args:
</span><span>            camera_intrinsics: Dict with 'fx', 'fy', 'cx', 'cy=
', 'width', 'height'
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>intrinsics </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> camera_=
intrinsics
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Create Open3D camera intrinsic object</span><span=
>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>o3d_intrinsic </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span=
><span>camera</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">.</span><span>PinholeCameraIntrinsic</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            width</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" =
style=3D"color: rgb(179, 74, 0);">int</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>camera_intrinsics</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'width'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            height</span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token"=
 style=3D"color: rgb(179, 74, 0);">int</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span>camera_intrinsics</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">'height'</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            fx</span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span>camera_intrinsics</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 0);">'fx'</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            fy</span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span>camera_intrinsics</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 0);">'fy'</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            cx</span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span>camera_intrinsics</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 0);">'cx'</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            cy</span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span>camera_intrinsics</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 0);">'cy'</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">rgbd_to_pointcloud</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        rgb_image</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n>
</span></span><span><span>        depth_image</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>        depth_scale</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(179, 74, 0);">float</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">10=
00.0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,<=
/span><span>
</span></span><span><span>        depth_trunc</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(179, 74, 0);">float</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2.=
0</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> o3d</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>P=
ointCloud</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Convert RGBD image to point cloud
</span><span>       =20
</span><span>        Args:
</span><span>            rgb_image: RGB image (H, W, 3), uint8
</span><span>            depth_image: Depth image (H, W), float32 in meters
</span><span>            depth_scale: Scale factor for depth (1000 if in mm=
, 1 if in m)
</span><span>            depth_trunc: Maximum depth to consider (meters)
</span><span>           =20
</span><span>        Returns:
</span><span>            Open3D point cloud
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Convert to Open3D images</span><span>
</span></span><span><span>        rgb_o3d </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>Image</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span>rgb_image</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">.</span><span>astype</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span>np</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>uint8</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Ensure depth is in the right format</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> depth_image</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>dtype </sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">!=3D</span=
><span> np</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>float32</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            depth_image </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> depth_image</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>astype</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span>np</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">.</span><span>float32</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Scale depth to millimeters if needed</span><span>
</span></span><span><span>        depth_mm </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>depth_image <=
/span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span=
><span> depth_scale</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">.</span><span>astype</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">(</span><span>np</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>float32</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        depth_o3d </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span=
><span>Image</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">(</span><span>depth_mm</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Create RGBD image</span><span>
</span></span><span><span>        rgbd </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>RGBDImage</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">.</span><span>create_from_color_and_depth</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            rgb_o3d</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            depth_o3d</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            depth_scale</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>depth_scale</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>            depth_trunc</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>depth_trunc</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>            convert_rgb_to_intensity</span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Convert to point cloud</span><span>
</span></span><span><span>        pcd </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>PointCloud</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">.</span><span>create_from_rgbd_image</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            rgbd</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>o3d_intrinsic
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Flip it (Open3D convention)</span><span>
</span></span><span><span>        pcd</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">.</span><span>transform</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                       </span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                       </span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">-</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                       </span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> pcd
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">preprocess_pointcloud</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        pcd</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> o3d</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Po=
intCloud</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">,</span><span>
</span></span><span><span>        voxel_size</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">float</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span=
> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.0=
05</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span>
</span></span><span><span>        remove_outliers</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>True</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> o3d</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>P=
ointCloud</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Clean and downsample point cloud
</span><span>       =20
</span><span>        Args:
</span><span>            pcd: Input point cloud
</span><span>            voxel_size: Voxel size for downsampling (meters)
</span><span>            remove_outliers: Whether to remove statistical out=
liers
</span><span>           =20
</span><span>        Returns:
</span><span>            Cleaned point cloud
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Downsample</span><span>
</span></span><span><span>        pcd_down </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> pcd</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>voxel_down=
_sample</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span>voxel_size</span><span class=3D"token token" style=3D"color:=
 rgb(20, 24, 31);">=3D</span><span>voxel_size</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Remove outliers</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> remove_outliers</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            pcd_down</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span> ind </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> pcd_d=
own</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>remove_statistical_outlier</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                nb_neighbors</span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">20</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                std_ratio</span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">2.0</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Estimate normals</span><span>
</span></span><span><span>        pcd_down</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>estimate_normals</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            search_param</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>o3d</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geom=
etry</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.<=
/span><span>KDTreeSearchParamHybrid</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                radius</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>voxel_size </span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span>
</span></span><span><span>                max_nn</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 128);">30</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> pcd_down
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">segment_dishes</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        pcd</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> o3d</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Po=
intCloud</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">,</span><span>
</span></span><span><span>        eps</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(179, 74, 0);">float</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.02</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n>
</span></span><span><span>        min_points</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">int</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">100</=
span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> List</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">[</span><span>o3d</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geome=
try</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>PointCloud</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Segment individual dishes using clustering
</span><span>       =20
</span><span>        Args:
</span><span>            pcd: Input point cloud
</span><span>            eps: DBSCAN epsilon (meters) - max distance betwee=
n points in cluster
</span><span>            min_points: Minimum points to form a cluster
</span><span>           =20
</span><span>        Returns:
</span><span>            List of point clouds, one per dish
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># DBSCAN clustering</span><span>
</span></span><span><span>        labels </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            pcd</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">.</span><span>cluster_dbscan</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>eps<=
/span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</sp=
an><span>eps</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">,</span><span> min_points</span><span class=3D"token token" style=3D"=
color: rgb(20, 24, 31);">=3D</span><span>min_points</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Get unique labels (excluding noise label -1)</spa=
n><span>
</span></span><span><span>        unique_labels </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(179, 74, 0);">set</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>labels</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span><span>        unique_labels</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>discard</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Extract individual clusters</span><span>
</span></span><span><span>        dishes </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> label </span><span class=3D"=
token token" style=3D"color: rgb(129, 0, 194);">in</span><span> unique_labe=
ls</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</s=
pan><span>
</span></span><span><span>            mask </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> labels </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> =
label
</span></span><span><span>            indices </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>where</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><=
span>mask</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><sp=
an>
</span></span><span>           =20
</span><span><span>            dish_pcd </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> pcd</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>select_by_ind=
ex</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>indices</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Filter out very small or very large clusters<=
/span><span>
</span></span><span><span>            num_points </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">len</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>dish_pcd</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>points</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> num_points </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> min=
_points </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194)=
;">or</span><span> num_points </span><span class=3D"token token" style=3D"c=
olor: rgb(20, 24, 31);">&gt;</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">50000</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">continue</span><span>
</span></span><span>           =20
</span><span><span>            dishes</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>dish_pcd</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> dishes
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">get_dish_properties</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        dish_pcd</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> o3d</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>PointCloud
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> Dict</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Compute geometric properties of a dish
</span><span>       =20
</span><span>        Args:
</span><span>            dish_pcd: Point cloud of single dish
</span><span>           =20
</span><span>        Returns:
</span><span>            Dictionary with geometric properties
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Compute bounding box</span><span>
</span></span><span><span>        aabb </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> dish_pcd</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>get_axis_=
aligned_bounding_box</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span><span>        obb </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> dish_pcd</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>get_orient=
ed_bounding_box</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Get center and extent</span><span>
</span></span><span><span>        center </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> obb</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>center
</span></span><span><span>        extent </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> obb</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>extent  </=
span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># [le=
ngth, width, height]</span><span>
</span></span><span><span>        orientation </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> obb</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>R  </sp=
an><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Rotat=
ion matrix</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Classify dish type based on geometry</span><span>
</span></span><span><span>        dish_type </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_classif=
y_dish_geometry</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span>extent</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Compute convex hull volume (approximate dish volu=
me)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">try</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            hull</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> _ </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> dish_pcd</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>compute_convex_hull</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span>
</span></span><span><span>            volume </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> hull</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>get_vol=
ume</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">except</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            volume </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>prod</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>extent</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">)</span><span>  </span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Fallback: bounding box volume</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Surface area approximation</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">try</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            points </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>asarray</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span>dish_pcd</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">.</span><span>points</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            hull</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> _ </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> dish_pcd</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>compute_convex_hull</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span>
</span></span><span><span>            surface_area </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> hull</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>g=
et_surface_area</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">except</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            surface_area </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>extent</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">]</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
*</span><span>extent</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">]</span><span> </span><span class=3D"token token" style=3D"color: rgb(=
20, 24, 31);">+</span><span> extent</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb=
(20, 24, 31);">*</span><span>extent</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 128);">2</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">+</span><span> extent</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">*</span><span>extent</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Compute principal axes</span><span>
</span></span><span><span>        points </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>asarray</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n>dish_pcd</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>points</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        centered_points </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> points </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span=
> center
</span></span><span><span>        cov_matrix </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>cov</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n>centered_points</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">.</span><span>T</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        eigenvalues</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> eigenvectors </span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><spa=
n> np</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.=
</span><span>linalg</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">.</span><span>eig</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span>cov_matrix</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Sort by eigenvalue (largest first)</span><span>
</span></span><span><span>        idx </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> eigenvalues</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>argsort=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        eigenvalues </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> eigenvalues</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
>idx</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]<=
/span><span>
</span></span><span><span>        eigenvectors </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> eigenvectors</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> idx</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'center'</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> center</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'extent'</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> extent</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> orientation</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'aabb_min'</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> aabb</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>min_bound</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'aabb_max'</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> aabb</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>max_bound</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'volume'</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> volume</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'surface_area'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> surface_area</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'num_points'</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>points</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'dish_type_geometric'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> dish_type</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'principal_axes'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> eigenvectors</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'principal_values'</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> eigenvalues
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_classify_dish_geometry</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> ex=
tent</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:<=
/span><span> np</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">.</span><span>ndarray</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">str</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Classify dish type based on geometric extent
</span><span>       =20
</span><span>        Args:
</span><span>            extent: [length, width, height]
</span><span>           =20
</span><span>        Returns:
</span><span>            Dish type string
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        length</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> width</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> height </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">=
sorted</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>extent</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">[</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:=
</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> =
 </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># =
Sort descending</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Aspect ratios</span><span>
</span></span><span><span>        aspect_lw </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> length </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><span> widt=
h </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">if<=
/span><span> width </span><span class=3D"token token" style=3D"color: rgb(2=
0, 24, 31);">&gt;</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 128, 128);">0</span><span> </span><span class=3D"token token"=
 style=3D"color: rgb(129, 0, 194);">else</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">1.0</span><span>
</span></span><span><span>        aspect_lh </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> length </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><span> heig=
ht </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">if=
</span><span> height </span><span class=3D"token token" style=3D"color: rgb=
(20, 24, 31);">&gt;</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">0</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(129, 0, 194);">else</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">1.0</span><span>
</span></span><span><span>        aspect_wh </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> width </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><span> heigh=
t </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">if<=
/span><span> height </span><span class=3D"token token" style=3D"color: rgb(=
20, 24, 31);">&gt;</span><span> </span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 128);">0</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">else</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">1.0</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Classification rules</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> height </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> </span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.03</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">an=
d</span><span> aspect_lw </span><span class=3D"token token" style=3D"color:=
 rgb(20, 24, 31);">&lt;</span><span> </span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">1.3</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>  </span><span class=3D"token to=
ken" style=3D"color: rgb(110, 118, 135);"># Flat and round</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'plate'</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">elif</span><span> height </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.03</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);=
">and</span><span> aspect_lw </span><span class=3D"token token" style=3D"co=
lor: rgb(20, 24, 31);">&gt;</span><span> </span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 128);">1.5</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span>  </span><span class=3D"toke=
n token" style=3D"color: rgb(110, 118, 135);"># Flat and elongated</span><s=
pan>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'tray'</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">elif</span><span> height </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.05</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);=
">and</span><span> aspect_lh </span><span class=3D"token token" style=3D"co=
lor: rgb(20, 24, 31);">&gt;</span><span> </span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 128);">2.0</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span>  </span><span class=3D"toke=
n token" style=3D"color: rgb(110, 118, 135);"># Tall</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> aspect_lw </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1.3</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><spa=
n>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"=
># Cylindrical</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'cup'</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span>  </span><span class=3D"token =
token" style=3D"color: rgb(110, 118, 135);"># Elongated</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'glass'</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">elif</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">0.03</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> he=
ight </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&=
lt;</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, =
128, 128);">0.08</span><span> </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">and</span><span> aspect_lw </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">1.5</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>  </s=
pan><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Medi=
um height, round</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'bowl'</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">elif</span><span> length </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.15</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);=
">and</span><span> height </span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">&lt;</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">0.02</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span>  </span><span class=3D"token =
token" style=3D"color: rgb(110, 118, 135);"># Small and flat</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'utensil'</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'unknown'</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">visualize_segmentation</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        dishes</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> List</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">[</span><span>o3d</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geo=
metry</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.=
</span><span>PointCloud</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">,</span><span>
</span></span><span><span>        show</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">True</span=
><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">None</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Visualize segmented dishes with different color=
s
</span><span>       =20
</span><span>        Args:
</span><span>            dishes: List of dish point clouds
</span><span>            show: Whether to display visualization
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Assign random colors to each dish</span><span>
</span></span><span><span>        colored_dishes </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> i</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> dish </span><span =
class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> </=
span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">enumerat=
e</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span>dishes</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">:</span><span>
</span></span><span><span>            dish_colored </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ge=
ometry</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
.</span><span>PointCloud</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">(</span><span>dish</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            color </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> plt</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>cm</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>tab10</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>i </span><span class=3D"token token" style=3D"color: rgb(20, =
24, 31);">%</span><span> </span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 128);">10</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">:</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">3</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</=
span><span>  </span><span class=3D"token token" style=3D"color: rgb(110, 11=
8, 135);"># Cycle through 10 colors</span><span>
</span></span><span><span>            dish_colored</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>paint_uniform_col=
or</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>color</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span><span>            colored_dishes</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>d=
ish_colored</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> show</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            o3d</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">.</span><span>visualization</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>draw_=
geometries</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span>
</span></span><span><span>                colored_dishes</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                window_name</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 0);">"Segmented Dishes"</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> colored_dishes</span></span></cod=
e></pre></div></div>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">4. Vision =
Module - Hybrid Vision System</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># vision/=
hybrid_vision.py</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">from</span><span> </span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">.</span><span>qwen_semantic </span><span class=3D=
"token token" style=3D"color: rgb(129, 0, 194);">import</span><span> QwenSe=
manticAnalyzer
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">.</span><span>geometry_reconstruction </sp=
an><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">import</s=
pan><span> GeometryReconstructor
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> numpy </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> typing </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">import</span><span> Dict</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> L=
ist</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span> Tuple
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> open3d </span><span class=3D"token=
 token" style=3D"color: rgb(129, 0, 194);">as</span><span> o3d
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">HybridVisionSystem</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Combines Qwen3-VL semantic understanding with geome=
tric 3D reconstruction
</span><span>   =20
</span><span>    Architecture:
</span><span>    1. Qwen3-VL: Understands WHAT dishes are present and WHY t=
hey're graspable
</span><span>    2. Geometry: Provides precise WHERE and HOW (3D positions,=
 orientations)
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        camera_intrinsics</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span> Dict</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cla=
ss=3D"token token" style=3D"color: rgb(179, 74, 0);">str</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(179, 74, 0);">float</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        use_qwen</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">True</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span>
</span></span><span><span>        qwen_model</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">str</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">"Qwen/Q=
wen2-VL-7B-Instruct"</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Initialize hybrid vision system
</span><span>       =20
</span><span>        Args:
</span><span>            camera_intrinsics: Camera parameters
</span><span>            use_qwen: Whether to use Qwen (set False for faste=
r testing)
</span><span>            qwen_model: Qwen model to use
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Geometric reconstruction (always used)</span><spa=
n>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>geometry </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Geometr=
yReconstructor</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">(</span><span>camera_intrinsics</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Semantic understanding (optional, can disable for=
 speed)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>use_qwen </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> use_qwe=
n
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> use_qwen</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>qwen </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> QwenSem=
anticAnalyzer</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">(</span><span>model_name</span><span class=3D"token token" style=3D"=
color: rgb(20, 24, 31);">=3D</span><span>qwen_model</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>qwen </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">None</span><=
span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"Hybrid Vision System initialized"</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  - Qwen3-VL: </span><span cl=
ass=3D"token token string-interpolation interpolation" style=3D"color: rgb(=
43, 48, 59);">{</span><span class=3D"token token string-interpolation inter=
polation" style=3D"color: rgb(0, 128, 0);">'Enabled'</span><span class=3D"t=
oken token string-interpolation interpolation"> </span><span class=3D"token=
 token string-interpolation interpolation" style=3D"color: rgb(129, 0, 194)=
;">if</span><span class=3D"token token string-interpolation interpolation">=
 use_qwen </span><span class=3D"token token string-interpolation interpolat=
ion" style=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token tok=
en string-interpolation interpolation"> </span><span class=3D"token token s=
tring-interpolation interpolation" style=3D"color: rgb(0, 128, 0);">'Disabl=
ed'</span><span class=3D"token token string-interpolation interpolation" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token string-i=
nterpolation" style=3D"color: rgb(0, 128, 0);">"</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  - Geometry: Enabled"</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">analyze_scene</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        rgb_image</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n>
</span></span><span><span>        depth_image</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> Dict</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Complete scene analysis combining semantic and =
geometric understanding
</span><span>       =20
</span><span>        Args:
</span><span>            rgb_image: RGB image (H, W, 3)
</span><span>            depth_image: Depth image (H, W) in meters
</span><span>           =20
</span><span>        Returns:
</span><span>            Complete scene understanding with dishes and prope=
rties
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"Analyzing scene..."</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 1: Semantic understanding (if enabled)</span=
><span>
</span></span><span><span>        semantic_info </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">None</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>use_qwen</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"  [1/3] Running Qwen3-VL semantic analysis..."=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>
</span></span><span><span>            semantic_info </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
qwen</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.<=
/span><span>analyze_scene</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">(</span><span>rgb_image</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-i=
nterpolation" style=3D"color: rgb(0, 128, 0);">f"       Found </span><span =
class=3D"token token string-interpolation interpolation" style=3D"color: rg=
b(43, 48, 59);">{</span><span class=3D"token token string-interpolation int=
erpolation" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D"toke=
n token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59)=
;">(</span><span class=3D"token token string-interpolation interpolation">s=
emantic_info</span><span class=3D"token token string-interpolation interpol=
ation" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token=
 string-interpolation interpolation" style=3D"color: rgb(0, 128, 0);">'dish=
es'</span><span class=3D"token token string-interpolation interpolation" st=
yle=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token string-i=
nterpolation interpolation" style=3D"color: rgb(43, 48, 59);">)</span><span=
 class=3D"token token string-interpolation interpolation" style=3D"color: r=
gb(43, 48, 59);">}</span><span class=3D"token token string-interpolation" s=
tyle=3D"color: rgb(0, 128, 0);"> dishes semantically"</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 2: Geometric reconstruction</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"  [2/3] Converting RGBD to 3D point cloud..."</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n>
</span></span><span><span>        full_pcd </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span=
><span>rgbd_to_pointcloud</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">(</span><span>rgb_image</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> depth_image</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"  [2/3] Preprocessing point cloud..."</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        clean_pcd </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</spa=
n><span>preprocess_pointcloud</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">(</span><span>full_pcd</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"  [2/3] Segmenting individual dishes..."</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        dish_pcds </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</spa=
n><span>segment_dishes</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">(</span><span>clean_pcd</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"       Segmented </span><span=
 class=3D"token token string-interpolation interpolation" style=3D"color: r=
gb(43, 48, 59);">{</span><span class=3D"token token string-interpolation in=
terpolation" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D"tok=
en token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59=
);">(</span><span class=3D"token token string-interpolation interpolation">=
dish_pcds</span><span class=3D"token token string-interpolation interpolati=
on" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token st=
ring-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</span=
><span class=3D"token token string-interpolation" style=3D"color: rgb(0, 12=
8, 0);"> dishes geometrically"</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 3: Combine semantic + geometric information<=
/span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"  [3/3] Fusing semantic and geometric data..."</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an>
</span></span><span><span>        fused_dishes </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_fuse=
_information</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">(</span><span>
</span></span><span><span>            semantic_info</span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>semantic_info<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span>
</span></span><span><span>            dish_pointclouds</span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>dish_pcds
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Build complete scene representation</span><span>
</span></span><span><span>        scene </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'dishes'</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> fused_dishes</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'num_dishes'</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>fused_dishes</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'full_pointcloud'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> full_pcd</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'clean_pointcloud'</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> clean_pcd</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'semantic_info'</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span> semantic_info</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'rgb_image'</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> rgb_image</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'depth_image'</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> depth_image
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpolatio=
n" style=3D"color: rgb(0, 128, 0);">f"Scene analysis complete: </span><span=
 class=3D"token token string-interpolation interpolation" style=3D"color: r=
gb(43, 48, 59);">{</span><span class=3D"token token string-interpolation in=
terpolation" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D"tok=
en token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59=
);">(</span><span class=3D"token token string-interpolation interpolation">=
fused_dishes</span><span class=3D"token token string-interpolation interpol=
ation" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
 string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</s=
pan><span class=3D"token token string-interpolation" style=3D"color: rgb(0,=
 128, 0);"> dishes identified"</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> scene
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_fuse_information</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        semantic_info</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> Dict</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        dish_pointclouds</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> List</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>o3d<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span=
><span>geometry</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">.</span><span>PointCloud</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> List</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">[</span><span>Dict</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Fuse semantic understanding with geometric data
</span><span>       =20
</span><span>        Strategy:
</span><span>        - Use geometric center positions to match semantic des=
criptions
</span><span>        - Combine Qwen's dish type with geometric classificati=
on
</span><span>        - Priority: Qwen's semantic understanding &gt; geometr=
ic classification
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        fused_dishes </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Extract geometric properties for all dishes</span=
><span>
</span></span><span><span>        geometric_dishes </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> pcd </span><span class=3D"to=
ken token" style=3D"color: rgb(129, 0, 194);">in</span><span> dish_pointclo=
uds</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</=
span><span>
</span></span><span><span>            props </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</spa=
n><span>get_dish_properties</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span>pcd</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            props</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'pointcloud'</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> pcd
</span></span><span><span>            geometric_dishes</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>props</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># If no semantic info, return geometric only</span>=
<span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> semantic_info </span><span cl=
ass=3D"token token" style=3D"color: rgb(129, 0, 194);">is</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">None</spa=
n><span> </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194=
);">or</span><span> </span><span class=3D"token token" style=3D"color: rgb(=
179, 74, 0);">len</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span>semantic_info</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'dishes'</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">for</span><span> i</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> geo </span><spa=
n class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">enumer=
ate</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span>geometric_dishes</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">:</span><span>
</span></span><span><span>                fused_dishes</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'id'</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> i</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'type'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 0);">'dish_type_geometric'</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'material'</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">'unknown'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 0);">'unknown'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'position_3d'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 0);">'center'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'extent'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">'extent'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'orientation_matrix'</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 0);">'orientation'</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'graspability_semantic'</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">5.0</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'graspability_geometric'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> sel=
f</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>_compute_geometric_graspability</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>geo</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'pointcloud'</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">'pointcloud'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'properties'</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'source'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'geometric_only'</span><s=
pan>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> fused_dishes
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Match semantic descriptions with geometric detect=
ions</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Simple strategy: match by spatial proximi=
ty and size</span><span>
</span></span><span>       =20
</span><span><span>        semantic_dishes </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> semantic_info</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 0);">'dishes'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        used_geometric </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">False</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">len</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><=
span>geometric_dishes</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span>
</span></span><span><span>        used_semantic </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">False</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">len</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n>semantic_dishes</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Try to match each semantic dish with geometric di=
sh</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> sem_idx</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> sem </span><=
span class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">enu=
merate</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>semantic_dishes</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            best_match_idx </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">None</span><span=
>
</span></span><span><span>            best_match_score </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(179, 74, 0);">float</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 0);">'inf'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">for</span><span> geo_idx</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">,</span><span> geo </span><span=
 class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">enumera=
te</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>geometric_dishes</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">if</span><span> used_geometric</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>=
geo_idx</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</s=
pan><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">continue</span><span>
</span></span><span>               =20
</span><span><span>                </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Matching score based on type compatibilit=
y and position</span><span>
</span></span><span><span>                score </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_mat=
ch_score</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">(</span><span>sem</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">,</span><span> geo</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span>               =20
</span><span><span>                </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> score </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> best_match_=
score</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:=
</span><span>
</span></span><span><span>                    best_match_score </span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> s=
core
</span></span><span><span>                    best_match_idx </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> geo=
_idx
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># If found a reasonable match</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> best_match_idx </span><spa=
n class=3D"token token" style=3D"color: rgb(129, 0, 194);">is</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">not</=
span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, =
128);">None</span><span> </span><span class=3D"token token" style=3D"color:=
 rgb(129, 0, 194);">and</span><span> best_match_score </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">1.0</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                geo </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> geometric_dishes</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span>=
<span>best_match_idx</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">]</span><span>
</span></span><span>               =20
</span><span><span>                fused_dishes</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'id'</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>fused_dishes</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'type'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> sem</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 0);">'type'</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span class=
=3D"token token" style=3D"color: rgb(110, 118, 135);"># Prefer semantic typ=
e</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'material'</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> sem</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'material'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> sem</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 0);">'orientation'</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'position_3d'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 0);">'center'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'extent'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">'extent'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'orientation_matrix'</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 0);">'orientation'</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'graspability_semantic'</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> sem<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'graspability=
'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'graspability_geometric'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> sel=
f</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>_compute_geometric_graspability</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>geo</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'graspability_combined'</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.6</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);=
">*</span><span> sem</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 0);">'graspability'</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">]</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(20, 24, 31);">+</span><span>=20
</span></span><span><span>                                           </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.4</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
*</span><span> self</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">.</span><span>_compute_geometric_graspability</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>geo</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'pointcloud'</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">'pointcloud'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'properties'</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'semantic_description'</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> sem</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'raw_descripti=
on'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'source'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'fused'</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>               =20
</span><span><span>                used_geometric</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">[</span><span>best_match_idx</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, =
128, 128);">True</span><span>
</span></span><span><span>                used_semantic</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>sem_idx</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, =
128, 128);">True</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Add unmatched geometric detections</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> geo_idx</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> geo </span><=
span class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">enu=
merate</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>geometric_dishes</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">not</span><span> used_geometric=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</spa=
n><span>geo_idx</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">:</span><span>
</span></span><span><span>                fused_dishes</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'id'</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>fused_dishes</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'type'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 0);">'dish_type_geometric'</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'material'</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">'unknown'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 0);">'unknown'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'position_3d'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 0);">'center'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'extent'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">'extent'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'orientation_matrix'</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 0);">'orientation'</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'graspability_semantic'</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">5.0</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'graspability_geometric'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> sel=
f</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>_compute_geometric_graspability</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>geo</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'graspability_combined'</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> self=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</spa=
n><span>_compute_geometric_graspability</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">(</span><span>geo</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'pointcloud'</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">'pointcloud'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'properties'</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span> geo</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'source'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'geometric_unmatched'</sp=
an><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Sort by graspability (highest first)</span><span>
</span></span><span><span>        fused_dishes</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>sort</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            key</span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">lambda</span><span> x</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> x</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>get=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'graspabilit=
y_combined'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> x</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 1=
28, 0);">'graspability_geometric'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            reverse</span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> fused_dishes
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_match_score</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> semantic</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><sp=
an> Dict</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">,</span><span> geometric</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">:</span><span> Dict</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">float</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Compute matching score between semantic and geo=
metric dish
</span><span>        Lower is better match
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        score </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">0.0</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Type compatibility</span><span>
</span></span><span><span>        sem_type </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> semantic</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'type'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>lower</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        geo_type </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> geometric</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">'dish_type_geometric'</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
lower</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>
</span></span><span>       =20
</span><span><span>        type_compatibility </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'plate'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">'plate'</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">0.0</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'bowl'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">'bowl'</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">0.0</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'cup'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">'cup'</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">0.0</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'glass'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">'glass'</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">0.0</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'glass'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">'cup'</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">0.2</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span class=3D=
"token token" style=3D"color: rgb(110, 118, 135);"># Similar</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'cup'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">'glass'</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">0.2</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'mug'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">'cup'</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">0.1</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'mug'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">'glass'</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">0.3</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span>       =20
</span><span><span>        score </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">+=3D</span><span> type_compatibility</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ge=
t</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan>sem_type</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">,</span><span> geo_type</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">0.5</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Position compatibility (if semantic has position =
info)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># This is simplified - in practice you'd pr=
oject 3D to 2D and match</span><span>
</span></span><span><span>        sem_pos </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> semantic</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'position'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>lower</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        geo_center </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> geometric</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 0);">'center'</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Rough position matching</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'left'</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> sem_p=
os </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">an=
d</span><span> geo_center</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">]</span><span> </span><span class=3D"token token" style=3D"color:=
 rgb(20, 24, 31);">&lt;</span><span> </span><span class=3D"token token" sty=
le=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 128);">0.1</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            score </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0.0</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">elif</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 0);">'right'</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> se=
m_pos </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);"=
>and</span><span> geo_center</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: r=
gb(0, 128, 128);">0</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">]</span><span> </span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">&gt;</span><span> </span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 128);">0.1</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            score </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0.0</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">elif</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 0);">'center'</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> s=
em_pos </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);=
">and</span><span> </span><span class=3D"token token" style=3D"color: rgb(1=
79, 74, 0);">abs</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">(</span><span>geo_center</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span> </span><span class=3D"token token" style=3D"c=
olor: rgb(20, 24, 31);">&lt;</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">0.1</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            score </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0.0</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            score </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> score
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_compute_geometric_graspability</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> geometric_props</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">:</span><span> Dict</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(179, 74, 0);">float</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Compute graspability score from geometric prope=
rties
</span><span>        Returns 0-10 scale
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        extent </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> geometric_props</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'extent'</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        center </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> geometric_props</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 0);">'center'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        score </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">5.0</span><span>  </span><span cla=
ss=3D"token token" style=3D"color: rgb(110, 118, 135);"># Base score</span>=
<span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Prefer objects at accessible heights</span><span>
</span></span><span><span>        z </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> center</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">0.05</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> z </=
span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 12=
8);">0.2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">:</span><span>
</span></span><span><span>            score </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">2.0</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">elif</span><span> z </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.03</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            score </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">-=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">2.0</span><span>  </spa=
n><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Too lo=
w, hard to grasp</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Prefer objects with clear dimensions for grasping=
</span><span>
</span></span><span><span>        min_extent </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">min</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">(</span><span>extent</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        max_extent </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">max</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">(</span><span>extent</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">0.02</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> min_extent <=
/span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">0.12</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">:</span><span>  </span><span class=3D"token token" style=3D"color: rgb(=
110, 118, 135);"># Graspable size</span><span>
</span></span><span><span>            score </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">1.0</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> max_extent </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.25</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>  </spa=
n><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Not to=
o large</span><span>
</span></span><span><span>            score </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">1.0</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Penalize very thin objects (hard to grasp)</span>=
<span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> min_extent </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.01</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span=
>
</span></span><span><span>            score </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">-=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">2.0</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Clip to 0-10</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> np</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>clip</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>sco=
re</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 1=
28, 128);">10</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">)</span></span></code></pre></div></div>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]"><strong>(Continuing in next message due to length...)</strong></p><=
/div></div></div></div></div><div class=3D"flex justify-start opacity-0 gro=
up-hover:opacity-100 group-focus-within:opacity-100 transition" role=3D"gro=
up" aria-label=3D"Message actions"><div class=3D"text-text-300"><div class=
=3D"text-text-300 flex items-stretch justify-between"><div class=3D"w-fit" =
data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" data-testid=3D"acti=
on-bar-copy" aria-label=3D"Copy"><div class=3D"relative text-text-500 group=
-hover/btn:text-text-100"><div class=3D"transition-all opacity-100 scale-10=
0" style=3D"width: 20px; height: 20px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"tr=
ansition-all opacity-100 scale-100" aria-hidden=3D"true" style=3D"flex-shri=
nk: 0;"><path d=3D"M12.5 3C13.3284 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 =
6.67157 17 7.5V15.5C17 16.3284 16.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 =
6 15.5V14H4.5C3.67157 14 3 13.3284 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.=
5ZM14 12.5C14 13.3284 13.3284 14 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16=
H15.5C15.7761 16 16 15.7761 16 15.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5=
ZM4.5 4C4.22386 4 4 4.22386 4 4.5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.=
7761 13 13 12.7761 13 12.5V4.5C13 4.22386 12.7761 4 12.5 4H4.5Z"></path></s=
vg></div><div class=3D"absolute top-0 left-0 transition-all opacity-0 scale=
-50" style=3D"width: 20px; height: 20px; display: flex; align-items: center=
; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 =
20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"=
absolute top-0 left-0 transition-all opacity-0 scale-50" aria-hidden=3D"tru=
e" style=3D"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15=
.6346 4.96153 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.736=
05L15.8836 5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 =
14.9989C7.88203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.0=
8172 11.2752C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755=
 4.58105 10.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.=
1794L15.1883 5.10908Z"></path></svg></div></div></button></div><div class=
=3D"w-fit" data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Give =
positive feedback"><div class=3D"text-text-500 group-hover/btn:text-text-10=
0" style=3D"width: 16px; height: 16px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"te=
xt-text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"fl=
ex-shrink: 0;"><path d=3D"M9.56055 2C11.1381 2.00009 12.3211 3.44332 12.011=
7 4.99023L11.6094 7H13.8438C15.5431 7 16.836 8.52594 16.5566 10.2021L15.876=
 14.2842C15.6148 15.8513 14.2586 17 12.6699 17H4.5C3.67157 17 3 16.3284 3 1=
5.5V9.23828C3.00013 8.57996 3.4294 7.99838 4.05859 7.80469L5.19824 7.4541L5=
.33789 7.40723C6.02983 7.15302 6.59327 6.63008 6.89746 5.9541L8.41113 2.589=
84L8.48047 2.46094C8.66235 2.17643 8.97898 2.00002 9.32324 2H9.56055ZM7.809=
57 6.36523C7.39486 7.2867 6.62674 7.99897 5.68359 8.3457L5.49219 8.41016L4.=
35254 8.76074C4.14305 8.82539 4.00013 9.01904 4 9.23828V15.5C4 15.7761 4.22=
386 16 4.5 16H12.6699C13.7697 16 14.7087 15.2049 14.8896 14.1201L15.5703 10=
.0381C15.7481 8.97141 14.9251 8 13.8438 8H11C10.8503 8 10.7083 7.9331 10.61=
33 7.81738C10.5184 7.70164 10.4805 7.54912 10.5098 7.40234L11.0312 4.79395C=
11.2167 3.86589 10.507 3.00009 9.56055 3H9.32324L7.80957 6.36523Z"></path><=
/svg></div></button></div><div class=3D"w-fit" data-state=3D"closed"><butto=
n class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Give =
negative feedback"><div class=3D"text-text-500 group-hover/btn:text-text-10=
0" style=3D"width: 16px; height: 16px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"te=
xt-text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"fl=
ex-shrink: 0;"><path d=3D"M12.6699 3C14.2586 3 15.6148 4.14871 15.876 5.715=
82L16.5566 9.79785C16.836 11.4741 15.5431 13 13.8438 13H11.6094L12.0117 15.=
0098C12.3211 16.5567 11.1381 17.9999 9.56055 18H9.32324C8.97898 18 8.66235 =
17.8236 8.48047 17.5391L8.41113 17.4102L6.89746 14.0459C6.59327 13.3699 6.0=
2983 12.847 5.33789 12.5928L5.19824 12.5459L4.05859 12.1953C3.4294 12.0016 =
3.00013 11.42 3 10.7617V4.5C3 3.67157 3.67157 3 4.5 3H12.6699ZM4.5 4C4.2238=
6 4 4 4.22386 4 4.5V10.7617C4.00013 10.981 4.14305 11.1746 4.35254 11.2393L=
5.49219 11.5898L5.68359 11.6543C6.62674 12.001 7.39486 12.7133 7.80957 13.6=
348L9.32324 17H9.56055C10.507 16.9999 11.2167 16.1341 11.0312 15.2061L10.50=
98 12.5977C10.4805 12.4509 10.5184 12.2984 10.6133 12.1826C10.7083 12.0669 =
10.8503 12 11 12H13.8438C14.9251 12 15.7481 11.0286 15.5703 9.96191L14.8896=
 5.87988C14.7087 4.79508 13.7697 4 12.6699 4H4.5Z"></path></svg></div></but=
ton></div><div class=3D"flex items-center"><div class=3D"w-fit" data-state=
=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" id=3D"radix-_r_kj_"=
 aria-haspopup=3D"menu" aria-expanded=3D"false" data-state=3D"closed" aria-=
label=3D"Retry"><div class=3D"text-text-500 group-hover/btn:text-text-100" =
style=3D"width: 20px; height: 20px; display: flex; align-items: center; jus=
tify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20=
" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-=
text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-=
shrink: 0;"><path d=3D"M10.3857 2.50977C14.3486 2.71054 17.5 5.98724 17.5 1=
0C17.5 14.1421 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 7.5=
4619 3.67878 5.3677 5.49902 4H3C2.72386 4 2.5 3.77614 2.5 3.5C2.5 3.22386 2=
.72386 3 3 3H6.5C6.63261 3 6.75975 3.05272 6.85352 3.14648C6.92392 3.21689 =
6.97106 3.30611 6.99023 3.40234L7 3.5V7C7 7.27614 6.77614 7.5 6.5 7.5C6.223=
86 7.5 6 7.27614 6 7V4.87891C4.4782 6.06926 3.5 7.91979 3.5 10C3.5 13.5899 =
6.41015 16.5 10 16.5C13.5899 16.5 16.5 13.5899 16.5 10C16.5 6.5225 13.7691 =
3.68312 10.335 3.50879L10 3.5L9.89941 3.49023C9.67145 3.44371 9.5 3.24171 9=
.5 3C9.5 2.72386 9.72386 2.5 10 2.5L10.3857 2.50977Z"></path></svg></div></=
button></div></div></div></div></div></div></div><div data-test-render-coun=
t=3D"2"><div class=3D"mb-1 mt-6 group"><div class=3D"flex flex-col items-en=
d gap-1"><div class=3D"group relative inline-flex gap-2 bg-bg-300 rounded-x=
l pl-2.5 py-2.5 break-words text-text-100 transition-all max-w-[75ch] flex-=
col !px-4 max-w-[85%]" style=3D"opacity: 1; transform: none;"><div class=3D=
"flex flex-row gap-2 relative"><div class=3D"flex-1"><div data-testid=3D"us=
er-message" class=3D"font-large !font-user-message grid grid-cols-1 gap-2 p=
y-0.5 relative" style=3D"max-height: none; overflow: hidden; position: rela=
tive;"><p class=3D"whitespace-pre-wrap break-words">Continue</p></div></div=
></div></div><div class=3D"flex justify-start opacity-0 group-hover:opacity=
-100 group-focus-within:opacity-100 transition" role=3D"group" aria-label=
=3D"Message actions"><div class=3D"text-text-300"><div class=3D"text-text-3=
00 flex items-stretch justify-between"><span class=3D"text-text-500 text-xs=
 flex items-center mr-2" data-state=3D"closed">Feb 4</span><div class=3D"fl=
ex items-center"><div class=3D"w-fit" data-state=3D"closed"><button class=
=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Retry=
"><div class=3D"text-text-500 group-hover/btn:text-text-100" style=3D"width=
: 20px; height: 20px; display: flex; align-items: center; justify-content: =
center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curr=
entColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-text-500 group=
-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><p=
ath d=3D"M10.3857 2.50977C14.3486 2.71054 17.5 5.98724 17.5 10C17.5 14.1421=
 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 7.54619 3.67878 5=
.3677 5.49902 4H3C2.72386 4 2.5 3.77614 2.5 3.5C2.5 3.22386 2.72386 3 3 3H6=
.5C6.63261 3 6.75975 3.05272 6.85352 3.14648C6.92392 3.21689 6.97106 3.3061=
1 6.99023 3.40234L7 3.5V7C7 7.27614 6.77614 7.5 6.5 7.5C6.22386 7.5 6 7.276=
14 6 7V4.87891C4.4782 6.06926 3.5 7.91979 3.5 10C3.5 13.5899 6.41015 16.5 1=
0 16.5C13.5899 16.5 16.5 13.5899 16.5 10C16.5 6.5225 13.7691 3.68312 10.335=
 3.50879L10 3.5L9.89941 3.49023C9.67145 3.44371 9.5 3.24171 9.5 3C9.5 2.723=
86 9.72386 2.5 10 2.5L10.3857 2.50977Z"></path></svg></div></button></div><=
div class=3D"w-fit" data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Edit"=
><div class=3D"text-text-500 group-hover/btn:text-text-100" style=3D"width:=
 20px; height: 20px; display: flex; align-items: center; justify-content: c=
enter;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curre=
ntColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-text-500 group-=
hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><pa=
th d=3D"M9.72821 2.87934C10.0318 2.10869 10.9028 1.72933 11.6735 2.03266L14=
.4655 3.13226C15.236 3.43593 15.6145 4.30697 15.3112 5.07758L11.3903 15.030=
7C11.2954 15.2717 11.1394 15.4835 10.9391 15.6459L10.8513 15.7123L7.7077 17=
.8979C7.29581 18.1843 6.73463 17.9917 6.57294 17.5356L6.54657 17.4409L5.737=
 13.6987C5.67447 13.4092 5.69977 13.107 5.80829 12.8315L9.72821 2.87934ZM6.=
73798 13.1987C6.70201 13.2903 6.69385 13.3906 6.71454 13.4868L7.44501 16.86=
27L10.28 14.892L10.3376 14.8452C10.3909 14.7949 10.4325 14.7332 10.4597 14.=
6645L13.0974 7.96723L9.37567 6.50141L6.73798 13.1987ZM11.3073 2.96332C11.05=
04 2.86217 10.7601 2.98864 10.6589 3.24555L9.74188 5.57074L13.4636 7.03754L=
14.3806 4.71137C14.4817 4.45445 14.3552 4.16413 14.0983 4.06293L11.3073 2.9=
6332Z"></path></svg></div></button></div></div><div class=3D"w-fit" data-st=
ate=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" data-testid=3D"acti=
on-bar-copy" aria-label=3D"Copy"><div class=3D"relative text-text-500 group=
-hover/btn:text-text-100"><div class=3D"transition-all opacity-100 scale-10=
0" style=3D"width: 20px; height: 20px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"tr=
ansition-all opacity-100 scale-100" aria-hidden=3D"true" style=3D"flex-shri=
nk: 0;"><path d=3D"M12.5 3C13.3284 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 =
6.67157 17 7.5V15.5C17 16.3284 16.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 =
6 15.5V14H4.5C3.67157 14 3 13.3284 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.=
5ZM14 12.5C14 13.3284 13.3284 14 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16=
H15.5C15.7761 16 16 15.7761 16 15.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5=
ZM4.5 4C4.22386 4 4 4.22386 4 4.5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.=
7761 13 13 12.7761 13 12.5V4.5C13 4.22386 12.7761 4 12.5 4H4.5Z"></path></s=
vg></div><div class=3D"absolute top-0 left-0 transition-all opacity-0 scale=
-50" style=3D"width: 20px; height: 20px; display: flex; align-items: center=
; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 =
20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"=
absolute top-0 left-0 transition-all opacity-0 scale-50" aria-hidden=3D"tru=
e" style=3D"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15=
.6346 4.96153 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.736=
05L15.8836 5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 =
14.9989C7.88203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.0=
8172 11.2752C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755=
 4.58105 10.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.=
1794L15.1883 5.10908Z"></path></svg></div></div></button></div><div class=
=3D"flex items-center"></div></div></div></div></div></div></div><div data-=
test-render-count=3D"2"><div class=3D"group" style=3D"height: auto; opacity=
: 1; transform: none;"><div class=3D"contents"><div data-is-streaming=3D"fa=
lse" class=3D"group relative relative pb-3" style=3D"opacity: 1; transform:=
 none;"><div class=3D"font-claude-response relative leading-[1.65rem] [&amp=
;_pre>div]:bg-bg-000/50 [&amp;_pre>div]:border-0.5 [&amp;_pre>div]:border-b=
order-400 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_.standard-markdo=
wn_:is(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&amp;_.standard-markdown_:is(=
p,blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8 [&amp;_.progressive-markdown_:i=
s(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&amp;_.progressive-markdown_:is(p,=
blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8"><div><div class=3D"standard-mark=
down grid-cols-1 grid [&amp;_>_*]:min-w-0 gap-3 standard-markdown"><h1 clas=
s=3D"text-text-100 mt-3 -mb-1 text-[1.375rem] font-bold">Complete System (C=
ontinued)</h1>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">5. Grasp P=
lanning Module - Grasp Candidate Generation</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># grasp_p=
lanning/grasp_generator.py</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">import</span><span> numpy </span><span class=3D"token token" =
style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> scipy</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>spatial</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>transfor=
m </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">imp=
ort</span><span> Rotation
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> typing </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">import</span><span> List</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> D=
ict</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span> Tuple
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> open3d </span><span class=3D"token=
 token" style=3D"color: rgb(129, 0, 194);">as</span><span> o3d
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">GraspCandidateGenerator</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Generates grasp candidates based on dish geometry a=
nd semantic information
</span><span>   =20
</span><span>    Uses heuristics informed by:
</span><span>    - Dish type (plate, bowl, cup, etc.)
</span><span>    - Geometric properties (size, orientation)
</span><span>    - Semantic understanding (material, fragility)
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> gripper_width_ran=
ge</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</s=
pan><span> Tuple</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(179, 74, =
0);">float</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(1=
79, 74, 0);">float</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">]</span><span> </span><span class=3D"token token" style=3D"colo=
r: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">0.02</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">0.08</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Args:
</span><span>            gripper_width_range: (min, max) gripper opening in=
 meters
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>min_gripper_width </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
gripper_width_range</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">]</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>max_gripper_width </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
gripper_width_range</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 128);">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">]</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">generate_candidates</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        dish_info</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> Dict</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        num_candidates</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">int</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1=
0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>        use_semantic</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
True</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> List</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">[</span><span>Dict</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Generate grasp candidates for a dish
</span><span>       =20
</span><span>        Args:
</span><span>            dish_info: Dish information from hybrid vision sys=
tem
</span><span>            num_candidates: Number of candidates to generate
</span><span>            use_semantic: Whether to use semantic info for sma=
rt generation
</span><span>           =20
</span><span>        Returns:
</span><span>            List of grasp candidate dictionaries
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        candidates </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Extract dish properties</span><span>
</span></span><span><span>        dish_type </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> dish_info</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 0);">'type'</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        center </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> dish_info</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'position_3d'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        extent </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> dish_info</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'extent'</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        orientation </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> dish_info</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 0);">'orientation_matrix'<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span=
><span>
</span></span><span><span>        pointcloud </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> dish_info</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ge=
t</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'pointcloud=
'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Generate different grasp strategies based on dish=
 type</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> use_semantic</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Smart generation based on dish type</s=
pan><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> dish_type </span><span cla=
ss=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 0);">'plate'</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'tray'</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span=
>
</span></span><span><span>                candidates</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>extend</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                    self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>_generate_plate_g=
rasps</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span>center</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">,</span><span> extent</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> orientation</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> num_candi=
dates</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/=
/</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">elif</span><span> dish_type </span><span c=
lass=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'bowl'</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                candidates</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>extend</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                    self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>_generate_bowl_gr=
asps</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(<=
/span><span>center</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">,</span><span> extent</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> orientation</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> pointclou=
d</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span> num_candidates</span><span class=3D"token token" style=3D"color: =
rgb(20, 24, 31);">//</span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">2</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">elif</span><span> dish_type </span><span c=
lass=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'cup'</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'mug'</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'=
glass'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</sp=
an><span>
</span></span><span><span>                candidates</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>extend</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                    self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>_generate_cup_gra=
sps</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span>center</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span> extent</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">,</span><span> orientation</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> pointcloud</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan> num_candidates</span><span class=3D"token token" style=3D"color: rgb(2=
0, 24, 31);">//</span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">)</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">elif</span><span> dish_type </span><span c=
lass=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'utensil'</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'for=
k'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0=
);">'knife'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 0);">'spoon'</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">:</span><span>
</span></span><span><span>                candidates</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>extend</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                    self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>_generate_utensil=
_grasps</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span>center</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">,</span><span> extent</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span> orientation</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> num_candi=
dates</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(110, 118, 135);"># Unknown type, use generic approach=
</span><span>
</span></span><span><span>                candidates</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>extend</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                    self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>_generate_generic=
_grasps</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span>center</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">,</span><span> extent</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span> orientation</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> num_candi=
dates</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Always add some generic candidates for robustness=
</span><span>
</span></span><span><span>        candidates</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>extend</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>_generate_generic_grasps<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span>center</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span> extent</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">,</span><span> orientation</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> num_candidates</sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">//</span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Remove duplicates and limit to requested number</=
span><span>
</span></span><span><span>        candidates </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_dedupl=
icate_grasps</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">(</span><span>candidates</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        candidates </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> candidates</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>num_ca=
ndidates</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> candidates
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_generate_plate_grasps</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        center</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        extent</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        orientation</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>        num</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(179, 74, 0);">int</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> List</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">[</span><span>Dict</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Generate grasps for flat plates
</span><span>        Strategy: Top-down grasps with slight variations
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        grasps </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Main strategy: Top-down grasp in center</span><sp=
an>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> i </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>num</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Add slight position variation</span><s=
pan>
</span></span><span><span>            offset </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>randn</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">*</span><span> </span><span class=3D"token token" style=3D"color: rgb(0=
, 128, 128);">0.02</span><span>  </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># 2cm std dev in x,y</span><span>
</span></span><span><span>            grasp_pos </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> center</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>co=
py</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span>
</span></span><span><span>            grasp_pos</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> offset
</span></span><span><span>            grasp_pos</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">0.05</span><span>  </=
span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Sta=
rt 5cm above</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Approach from top</span><span>
</span></span><span><span>            approach_vector </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
array</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-=
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Slight rotation variation around z-axis</span=
><span>
</span></span><span><span>            angle </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>uniform</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
-</span><span>np</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">.</span><span>pi</span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">/</span><span class=3D"token token" style=3D"color: rgb=
(0, 128, 128);">6</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span> np</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">.</span><span>pi</span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">/</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">6</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>  </span><span class=3D"token token"=
 style=3D"color: rgb(110, 118, 135);"># =C2=B130 degrees</span><span>
</span></span><span><span>            rot </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Rotation</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from_e=
uler</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'z'</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> angle</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Gripper orientation: fingers parallel to plat=
e surface</span><span>
</span></span><span><span>            gripper_orientation </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rot</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>as_matrix</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Gripper width: 80% of plate diameter</span><s=
pan>
</span></span><span><span>            gripper_width </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(179, 74, 0);">min</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>np</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an class=3D"token token" style=3D"color: rgb(179, 74, 0);">max</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>exten=
t</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.8</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">.</span><span>max_gripper_width</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            grasps</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> grasp_pos</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> gripper_orientatio=
n</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'approach_vector'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> approach_vecto=
r</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'gripper_width'</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> gripper_width</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'strategy'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">'plate_top_down'</span><span=
>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> grasps
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_generate_bowl_grasps</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        center</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        extent</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        orientation</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>        pointcloud</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> o3d</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>PointCloud</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">,</span><span>
</span></span><span><span>        num</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(179, 74, 0);">int</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> List</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">[</span><span>Dict</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Generate grasps for bowls
</span><span>        Strategy: Rim grasps and top grasps
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        grasps </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Strategy 1: Rim grasps (if we have point cloud)</=
span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> pointcloud </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">is</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(129, 0, 194);">not</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
None</span><span> </span><span class=3D"token token" style=3D"color: rgb(12=
9, 0, 194);">and</span><span> num </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            rim_grasps </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_ge=
nerate_rim_grasps</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span>pointcloud</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> num </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">//</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            grasps</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>extend</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>rim_grasp=
s</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Strategy 2: Top-down grasps (similar to plate)</s=
pan><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> i </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>num </sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">l=
en</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>grasps</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
:</span><span>
</span></span><span><span>            grasp_pos </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> center</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>co=
py</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span>
</span></span><span><span>            grasp_pos</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> extent</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.3</=
span><span>  </span><span class=3D"token token" style=3D"color: rgb(110, 11=
8, 135);"># Slightly above center</span><span>
</span></span><span>           =20
</span><span><span>            approach_vector </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </=
span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Random rotation</span><span>
</span></span><span><span>            angle </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>uniform</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">2</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);"=
>*</span><span>np</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">.</span><span>pi</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            rot </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Rotation</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from_e=
uler</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'z'</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> angle</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">)</span><span>
</span></span><span><span>            gripper_orientation </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rot</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>as_matrix</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Width: diameter of bowl opening</span><span>
</span></span><span><span>            gripper_width </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(179, 74, 0);">min</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>np</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an class=3D"token token" style=3D"color: rgb(179, 74, 0);">max</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>exten=
t</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">.</span><span>max_gripper_width</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            grasps</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> grasp_pos</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> gripper_orientatio=
n</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'approach_vector'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> approach_vecto=
r</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'gripper_width'</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> gripper_width</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'strategy'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">'bowl_top'</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> grasps
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_generate_cup_grasps</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        center</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        extent</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        orientation</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>        pointcloud</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> o3d</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>PointCloud</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">,</span><span>
</span></span><span><span>        num</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(179, 74, 0);">int</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> List</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">[</span><span>Dict</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Generate grasps for cups/glasses
</span><span>        Strategy: Side grasps and rim grasps
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        grasps </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Strategy 1: Side grasp (around body)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> i </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>num </sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">//</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><=
span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Random angle around cup</span><span>
</span></span><span><span>            angle </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>uniform</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">2</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);"=
>*</span><span>np</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">.</span><span>pi</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Approach from side</span><span>
</span></span><span><span>            approach_vector </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
array</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</spa=
n><span>np</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>cos</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">(</span><span>angle</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">,</span><span> np</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">.</span><span>sin</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>angle</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Grasp position: mid-height of cup</span><span=
>
</span></span><span><span>            grasp_pos </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> center</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>co=
py</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span>
</span></span><span><span>            grasp_pos</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> approach_vector</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span> =
np</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</s=
pan><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">min</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n>extent</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">[</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</=
span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </=
span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">0.5</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Orientation: gripper fingers around cup</span=
><span>
</span></span><span><span>            rot </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Rotation</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from_e=
uler</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'z'</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> angle </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">+</span><span> np</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">.</span><span>pi</span><span class=3D"token token" style=3D"=
color: rgb(20, 24, 31);">/</span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 128);">2</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">)</span><span>
</span></span><span><span>            gripper_orientation </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rot</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>as_matrix</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Width: cup diameter</span><span>
</span></span><span><span>            cup_diameter </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span cla=
ss=3D"token token" style=3D"color: rgb(179, 74, 0);">min</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>extent</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            gripper_width </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(179, 74, 0);">min</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>cup_dia=
meter </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
*</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">1.1</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span> self</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">.</span><span>max_gripper_width</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            grasps</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> grasp_pos</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> gripper_orientatio=
n</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'approach_vector'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> approach_vecto=
r</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'gripper_width'</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> gripper_width</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'strategy'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">'cup_side'</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Strategy 2: Rim grasp (from top)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> pointcloud </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">is</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(129, 0, 194);">not</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
None</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:<=
/span><span>
</span></span><span><span>            rim_grasps </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_ge=
nerate_rim_grasps</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span>pointcloud</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> num </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">-</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>grasps</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            grasps</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>extend</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>rim_grasp=
s</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> grasps
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_generate_utensil_grasps</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        center</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        extent</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        orientation</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>        num</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(179, 74, 0);">int</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> List</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">[</span><span>Dict</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Generate grasps for utensils
</span><span>        Strategy: Pinch grasp along length
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        grasps </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Identify long axis</span><span>
</span></span><span><span>        long_axis_idx </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>argmax=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>extent</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">)</span><span>
</span></span><span><span>        long_axis </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> orientation</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> long_axis=
_idx</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]<=
/span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">for</span><span> i </span><span class=3D"token token"=
 style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(179, 74, 0);">range</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>num</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Grasp along length (avoid sharp end)</=
span><span>
</span></span><span><span>            offset_along_length </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>random</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>uniform</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">0.3</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"colo=
r: rgb(0, 128, 128);">0.7</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">)</span><span>  </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># 30-70% along length</span><span>
</span></span><span><span>            grasp_pos </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> center </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><span> =
long_axis </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">*</span><span> </span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">(</span><span>extent</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">[</span><span>long_axis_idx</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>offset_along_length </span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">-</span><span> </span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">0.5</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Approach perpendicular to length</span><span>
</span></span><span><span>            perpendicular_angle </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>random</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>uniform</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">,</span><span> </span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 128);">2</span><span class=3D"token token" style=3D"color: rgb=
(20, 24, 31);">*</span><span>np</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>pi</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> long_axis_idx </span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span=
> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span>=
<span>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 13=
5);"># Vertical utensil</span><span>
</span></span><span><span>                approach_vector </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>array</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[<=
/span><span>np</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">.</span><span>cos</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">(</span><span>perpendicular_angle</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>sin</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n>perpendicular_angle</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">,</span><span> </span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span>  </span><span class=3D"token =
token" style=3D"color: rgb(110, 118, 135);"># Horizontal utensil</span><spa=
n>
</span></span><span><span>                approach_vector </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>array</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</spa=
n><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128=
);">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Orientation: pinch across utensil</span><span=
>
</span></span><span><span>            gripper_orientation </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>_compute_orientation_from_approach</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>approach_vector</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Width: utensil thickness</span><span>
</span></span><span><span>            gripper_width </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(179, 74, 0);">max</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>np</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an class=3D"token token" style=3D"color: rgb(179, 74, 0);">min</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>exten=
t</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">*</span><span> </span><span class=3D"token token" style=3D"color: rgb(0=
, 128, 128);">1.5</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span> self</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">.</span><span>min_gripper_width</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            grasps</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> grasp_pos</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> gripper_orientatio=
n</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'approach_vector'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> approach_vecto=
r</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'gripper_width'</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> gripper_width</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'strategy'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">'utensil_pinch'</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> grasps
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_generate_rim_grasps</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        pointcloud</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> o3d</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>PointCloud</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">,</span><span>
</span></span><span><span>        num</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(179, 74, 0);">int</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> List</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">[</span><span>Dict</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Generate grasps on the rim of bowls/cups
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        points </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>asarray</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>poin=
tcloud</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
.</span><span>points</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(179, 74, 0);">len</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>points</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span=
>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Find rim: highest points</span><span>
</span></span><span><span>        z_threshold </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>percenti=
le</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>points</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">95</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span>
</span></span><span><span>        rim_candidates </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> points</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>p=
oints</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</spa=
n><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31)=
;">&gt;</span><span> z_threshold</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(179, 74, 0);">len</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>rim_candidates</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">10=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        grasps </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Sample rim points</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> _ </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>num</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Random rim point</span><span>
</span></span><span><span>            idx </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>randint</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">=
len</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span>rim_candidates</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">)</span><span>
</span></span><span><span>            rim_point </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rim_candidates</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span>=
<span>idx</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">]</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Compute center of mass (approximate)</span><s=
pan>
</span></span><span><span>            center_xy </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>mean</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span>points</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">[</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">:</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> axis</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Approach: radially inward</span><span>
</span></span><span><span>            approach_2d </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> center_xy </sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><s=
pan> rim_point</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">[</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">:</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</spa=
n><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> np</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>linalg</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>no=
rm</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>approach_2d</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span> </span><span class=3D"token token" style=3D"c=
olor: rgb(20, 24, 31);">&lt;</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">1e-6</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">continue</span><span>
</span></span><span><span>            approach_2d </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> approach_2d </=
span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span>=
<span> np</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">.</span><span>linalg</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">.</span><span>norm</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>approach_2d</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            approach_vector </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
array</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</spa=
n><span>approach_2d</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,=
</span><span> approach_2d</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">1</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(=
20, 24, 31);">-</span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">0.3</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">)</span><span>  </span><span class=3D"token token" style=3D"color: rgb(11=
0, 118, 135);"># Slight downward</span><span>
</span></span><span><span>            approach_vector </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> approach_v=
ector </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
/</span><span> np</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">.</span><span>linalg</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>norm</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">(</span><span>approach_vector</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Orientation</span><span>
</span></span><span><span>            gripper_orientation </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>_compute_orientation_from_approach</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>approach_vector</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Width</span><span>
</span></span><span><span>            gripper_width </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.06</span><span>=
  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);">#=
 Default rim grasp width</span><span>
</span></span><span>           =20
</span><span><span>            grasps</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> rim_point</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> gripper_orientatio=
n</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'approach_vector'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> approach_vecto=
r</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'gripper_width'</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> gripper_width</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'strategy'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">'rim_grasp'</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> grasps
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_generate_generic_grasps</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        center</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        extent</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        orientation</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>        num</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(179, 74, 0);">int</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> List</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">[</span><span>Dict</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Generate generic grasps for unknown objects
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        grasps </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">for</span><span> i </span><span class=3D"token token"=
 style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(179, 74, 0);">range</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>num</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Random approach angle</span><span>
</span></span><span><span>            theta </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>uniform</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">2</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);"=
>*</span><span>np</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">.</span><span>pi</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            phi </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>uniform</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
-</span><span>np</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">.</span><span>pi</span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">/</span><span class=3D"token token" style=3D"color: rgb=
(0, 128, 128);">6</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span> np</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">.</span><span>pi</span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">/</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">6</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>  </span><span class=3D"token token"=
 style=3D"color: rgb(110, 118, 135);"># Slight angle from horizontal</span>=
<span>
</span></span><span>           =20
</span><span><span>            approach_vector </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
>
</span></span><span><span>                np</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>cos</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>theta</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*<=
/span><span> np</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">.</span><span>cos</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">(</span><span>phi</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                np</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>sin</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>theta</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*<=
/span><span> np</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">.</span><span>cos</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">(</span><span>phi</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                np</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>sin</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>phi</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Grasp position: slightly offset from center</=
span><span>
</span></span><span><span>            offset </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>randn</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
3</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">*</span><span> extent </span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">*</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">0.2</span><span>
</span></span><span><span>            grasp_pos </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> center </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><span> =
offset
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Orientation</span><span>
</span></span><span><span>            gripper_orientation </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>_compute_orientation_from_approach</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>approach_vector</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Width: based on smallest dimension</span><spa=
n>
</span></span><span><span>            gripper_width </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(179, 74, 0);">min</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>np</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an class=3D"token token" style=3D"color: rgb(179, 74, 0);">min</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>exten=
t</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">*</span><span> </span><span class=3D"token token" style=3D"color: rgb(0=
, 128, 128);">1.2</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span> self</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">.</span><span>max_gripper_width</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            grasps</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> grasp_pos</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> gripper_orientatio=
n</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'approach_vector'</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> approach_vecto=
r</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'gripper_width'</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> gripper_width</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'strategy'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">'generic'</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> grasps
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_compute_orientation_from_approach</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>self=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</spa=
n><span> approach_vector</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">:</span><span> np</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">&gt;</span><span> np</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>ndarray</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Compute gripper orientation matrix from approac=
h vector
</span><span>       =20
</span><span>        Convention:
</span><span>        - Z-axis: approach direction
</span><span>        - X-axis: perpendicular (gripper opening direction)
</span><span>        - Y-axis: perpendicular to both
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        z_axis </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> approach_vector </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><span> np</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>linalg</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">.</span><span>norm</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">(</span><span>approach_vector</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Choose X-axis perpendicular to Z</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Prefer horizontal if possible</span><span=
>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(179, 74, 0);">abs</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">(</span><span>z_axis</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.9</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>  </s=
pan><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Not =
too vertical</span><span>
</span></span><span><span>            x_axis </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span>z_axis=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> z_axi=
s</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>  </span><span class=3D"token to=
ken" style=3D"color: rgb(110, 118, 135);"># Nearly vertical</span><span>
</span></span><span><span>            x_axis </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        x_axis </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> x_axis </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">/</span><span> np</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>lin=
alg</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>norm</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span>x_axis</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Y-axis: cross product</span><span>
</span></span><span><span>        y_axis </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>cross</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>=
z_axis</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> x_axis</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Construct rotation matrix</span><span>
</span></span><span><span>        R </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>column_stack</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>x_a=
xis</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span> y_axis</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">,</span><span> z_axis</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> R
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_deduplicate_grasps</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        grasps</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> List</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">[</span><span>Dict</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        position_threshold</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(179, 74, 0);">float</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 12=
8);">0.02</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">,</span><span>
</span></span><span><span>        angle_threshold</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(179, 74, 0);">float</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">0.3</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> List</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">[</span><span>Dict</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Remove duplicate or very similar grasps
</span><span>       =20
</span><span>        Args:
</span><span>            grasps: List of grasp candidates
</span><span>            position_threshold: Distance threshold (meters)
</span><span>            angle_threshold: Angular threshold (radians)
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(179, 74, 0);">len</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>grasps</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;=3D</span><span> </=
span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><spa=
n>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> grasps
</span></span><span>       =20
</span><span><span>        unique_grasps </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">for</span><span> grasp </span><span class=3D"token to=
ken" style=3D"color: rgb(129, 0, 194);">in</span><span> grasps</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            is_unique </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">for</span><span> unique_grasp </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> unique_=
grasps</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(110, 118, 135);"># Check position similarity</span><s=
pan>
</span></span><span><span>                pos_dist </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>lin=
alg</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>norm</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span>grasp</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: r=
gb(0, 128, 0);">'position'</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">-</span><span> unique_grasp</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>               =20
</span><span><span>                </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Check orientation similarity</span><span>
</span></span><span><span>                R1 </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>                R2 </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> unique_grasp</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 0);">'orientation'</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><spa=
n>
</span></span><span><span>                angle_diff </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>a=
rccos</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span>np</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">.</span><span>clip</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">(</span><span>np</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">.</span><span>trace</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">(</span><span>R1</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>T @ R2</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 128);">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">)</span><span> </span><span class=3D"token token" style=3D"color: rgb(2=
0, 24, 31);">/</span><span> </span><span class=3D"token token" style=3D"col=
or: rgb(0, 128, 128);">2</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span>
</span></span><span>               =20
</span><span><span>                </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> pos_dist </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> positi=
on_threshold </span><span class=3D"token token" style=3D"color: rgb(129, 0,=
 194);">and</span><span> angle_diff </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">&lt;</span><span> angle_threshold</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                    is_unique </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">False</span>=
<span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">break</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">if</span><span> is_unique</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                unique_grasps</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan>grasp</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> unique_grasps
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">convert_to_pose_array</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> gras=
p</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</sp=
an><span> Dict</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">)</span><span> </span><span class=3D"token token" style=3D"color: r=
gb(20, 24, 31);">-</span><span class=3D"token token" style=3D"color: rgb(20=
, 24, 31);">&gt;</span><span> np</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">.</span><span>ndarray</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Convert grasp dict to standard 8D array format
</span><span>        [x, y, z, qw, qx, qy, qz, gripper_width]
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        position </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        orientation </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Convert rotation matrix to quaternion</span><span=
>
</span></span><span><span>        rot </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> Rotation</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from_matri=
x</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span>orientation</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">)</span><span>
</span></span><span><span>        quat </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> rot</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>as_quat</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>  </=
span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># [qx=
, qy, qz, qw]</span><span>
</span></span><span><span>        quat </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>quat</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> quat</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> quat</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> quat</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>  </span><span =
class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Reorder to [qw=
, qx, qy, qz]</span><span>
</span></span><span>       =20
</span><span><span>        gripper_width </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 0);">'gripper_width'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        pose_array </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>concatenate</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>po=
sition</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> quat</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">[</span><span>gripper_width</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> pose_array</span></span></code></=
pre></div></div>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">6. Grasp P=
lanning Module - Grasp Success Predictor</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># grasp_p=
lanning/grasp_predictor.py</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">import</span><span> torch
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> torch</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>nn </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">as</span><span> nn
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> torch</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>nn</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>functional=
 </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">as</=
span><span> F
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> typing </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">import</span><span> Dict</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> L=
ist</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span> Tuple
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> numpy </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">GraspSuccessPredictor</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">(</span><span>nn</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Module<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><spa=
n>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Neural network to predict grasp success probability
</span><span>   =20
</span><span>    Inputs:
</span><span>    - RGBD image (4 channels)
</span><span>    - Grasp pose (8 dimensions: x,y,z,qw,qx,qy,qz,width)
</span><span>   =20
</span><span>    Output:
</span><span>    - Success probability [0, 1]
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        use_pretrained_vision</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(179, 74, 0);">bool</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 128);">True</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span>
</span></span><span><span>        image_size</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> Tuple</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">int</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(179, 74, 0);">int</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span=
> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">480</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">6=
40</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">super</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">.</span><span>__init__</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>image_size </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> image_size
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># =3D=3D=3D=3D=3D Visual Feature Extractor =3D=3D=
=3D=3D=3D</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> use_pretrained_vision</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Use ResNet34 backbone</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">from</span><span> torchvision</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>model=
s </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">imp=
ort</span><span> resnet34</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">,</span><span> ResNet34_Weights
</span></span><span><span>            resnet </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> resnet34</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>wei=
ghts</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D</span><span>ResNet34_Weights</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">.</span><span>IMAGENET1K_V1</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Modify first conv for RGBD (4 channels)</span=
><span>
</span></span><span><span>            original_conv </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> resnet</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>conv1
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>initial_conv </span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> n=
n</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>Conv2d</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">4</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">64</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                kernel_size</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 128);">7</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span> stride</span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> padding</spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> bia=
s</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</=
span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">False</=
span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Copy RGB weights, initialize D channel</span>=
<span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">with</span><span> torch</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>no_grad</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                self</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>initial_conv</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>w=
eight</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</=
span><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, =
31);">=3D</span><span> original_conv</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">.</span><span>weight
</span></span><span><span>                self</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>initial_conv</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>w=
eight</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">4</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);=
">=3D</span><span> original_conv</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">.</span><span>weight</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">.</span><span>mean</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>dim</span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> keepdim</=
span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">True</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Use ResNet layers</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>visual_encoder </span><sp=
an class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>=
 nn</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>Sequential</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">(</span><span>
</span></span><span><span>                self</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>initial_conv</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                resnet</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>bn1</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                resnet</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>relu</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                resnet</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>maxpool</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                resnet</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>layer1</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                resnet</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>layer2</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                resnet</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>layer3</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                resnet</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>layer4</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>AdaptiveAvgPool2d</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            visual_feature_dim </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">512</span><s=
pan>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135)=
;"># ResNet34 output</span><span>
</span></span><span>           =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">else</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Simple custom CNN</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>visual_encoder </span><sp=
an class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>=
 nn</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>Sequential</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">(</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(110, 118, 135);"># Block 1</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>Conv2d</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">4</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">64</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> padd=
ing</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>BatchNorm2d</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">64</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>MaxPool2d</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span>               =20
</span><span><span>                </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Block 2</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>Conv2d</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">64</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">128</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> padd=
ing</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>BatchNorm2d</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">128</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>MaxPool2d</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span>               =20
</span><span><span>                </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Block 3</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>Conv2d</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">128</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">256</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> pad=
ding</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>BatchNorm2d</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">256</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>MaxPool2d</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span>               =20
</span><span><span>                </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Block 4</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>Conv2d</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">256</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">512</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> pad=
ding</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>BatchNorm2d</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">512</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                nn</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>AdaptiveAvgPool2d</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            visual_feature_dim </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">512</span><s=
pan>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># =3D=3D=3D=3D=3D Grasp Pose Encoder =3D=3D=3D=3D=
=3D</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>grasp_encoder </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> nn</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>Sequential</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">(</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">8</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">64</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Dropout</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.2</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">64</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">128</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Dropout</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.2</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">128</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">256</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        grasp_feature_dim </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 128);">256</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># =3D=3D=3D=3D=3D Spatial Attention Module =3D=3D=
=3D=3D=3D</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>use_attention </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">True</spa=
n><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>use_attention</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><s=
pan>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>attention </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Spat=
ialAttentionModule</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">(</span><span>visual_feature_dim</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># =3D=3D=3D=3D=3D Fusion Network =3D=3D=3D=3D=3D</s=
pan><span>
</span></span><span><span>        combined_dim </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> visual_feature_di=
m </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</s=
pan><span> grasp_feature_dim
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>fusion_network </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> nn</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
Sequential</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>combined_dim<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128)=
;">512</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Dropout</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.3</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span>           =20
</span><span><span>            nn</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">512</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">256</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Dropout</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0.3</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span>           =20
</span><span><span>            nn</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">256</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">128</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span>           =20
</span><span><span>            nn</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">128</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Sigmoid</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>  </span><span =
class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Output probabi=
lity [0, 1]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">forward</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        rgbd_image</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> torch</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Tensor</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>        grasp_pose</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> torch</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Tensor</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>        return_attention</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">False</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> torch</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>Tensor</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Forward pass
</span><span>       =20
</span><span>        Args:
</span><span>            rgbd_image: [batch, 4, H, W] RGBD image
</span><span>            grasp_pose: [batch, 8] grasp parameters
</span><span>            return_attention: Whether to return attention maps
</span><span>           =20
</span><span>        Returns:
</span><span>            success_prob: [batch, 1] probability of success
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        batch_size </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> rgbd_image</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>shape</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Extract visual features</span><span>
</span></span><span><span>        visual_features </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>vi=
sual_encoder</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">(</span><span>rgbd_image</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>  </span><span class=3D"token token" =
style=3D"color: rgb(110, 118, 135);"># [batch, 512, 1, 1]</span><span>
</span></span><span><span>        visual_features </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> visual_feature=
s</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>view</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">(</span><span>batch_size</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>  </span><span class=3D"token token"=
 style=3D"color: rgb(110, 118, 135);"># [batch, 512]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Apply attention if enabled</span><span>
</span></span><span><span>        attention_map </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">None</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>use_attention</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><s=
pan>
</span></span><span><span>            visual_features</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> attention_map=
 </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</=
span><span> self</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">.</span><span>attention</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                visual_features</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                grasp_pose</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">3</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">]</span><span>  </span><span class=3D"t=
oken token" style=3D"color: rgb(110, 118, 135);"># Use x,y,z position</span=
><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Encode grasp parameters</span><span>
</span></span><span><span>        grasp_features </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>gra=
sp_encoder</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span>grasp_pose</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">)</span><span>  </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># [batch, 256]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Combine features</span><span>
</span></span><span><span>        combined </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>cat</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>vi=
sual_features</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span> grasp_features</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">,</span><span> dim</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Predict success probability</span><span>
</span></span><span><span>        success_prob </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>fusio=
n_network</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span>combined</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">)</span><span>  </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># [batch, 1]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> return_attention</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> success_prob</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> a=
ttention_map
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> success_prob
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">predict_batch_grasps</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        rgbd_image</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> torch</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Tensor</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>        grasp_candidates</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> List</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>np</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>ndarray</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">]</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> Tuple</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span>np</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarr=
ay</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(179, 74, =
0);">int</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</=
span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Efficiently evaluate multiple grasp candidates =
for same scene
</span><span>       =20
</span><span>        Args:
</span><span>            rgbd_image: Single RGBD image [1, 4, H, W]
</span><span>            grasp_candidates: List of N grasp poses [8]
</span><span>           =20
</span><span>        Returns:
</span><span>            probabilities: [N] success probabilities
</span><span>            best_idx: Index of best grasp
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(179, 74, 0);">len</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>grasp_candidates</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</=
span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Replicate image for batch processing</span><span>
</span></span><span><span>        batch_size </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>grasp_candida=
tes</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span>
</span></span><span><span>        rgbd_batch </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rgbd_image</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>r=
epeat</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span>batch_size</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Stack grasp poses</span><span>
</span></span><span><span>        grasp_batch </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from_=
numpy</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span>
</span></span><span><span>            np</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>stack</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span>grasp_candidat=
es</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">.</span><span class=3D"token token" style=3D"color:=
 rgb(179, 74, 0);">float</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">.</span><span>to</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">(</span><span>rgbd_image</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>device</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Single forward pass</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">with</span><span> torch</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>no_grad</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            probabilities </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
forward</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span>rgbd_batch</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">,</span><span> grasp_batch</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        probs_numpy </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> probabilities</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>cpu<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>num=
py</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
flatten</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span>
</span></span><span><span>        best_idx </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>argmax</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan>probs_numpy</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> probs_numpy</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> best_idx
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">SpatialAttentionModule</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>nn</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Module=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><sp=
an>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Attention mechanism focusing on grasp region
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> feature_dim</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">int=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><sp=
an>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">super</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">.</span><span>__init__</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>attention_mlp </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> nn</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>S=
equential</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">3</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><span> feature=
_dim</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,<=
/span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128,=
 128);">256</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ReLU</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Linear</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">256</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> feature_dim</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            nn</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>Sigmoid</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">forward</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        features</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> torch</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Tensor</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan>
</span></span><span><span>        grasp_position</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> torch</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Tenso=
r
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> Tuple</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span>torch</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Te=
nsor</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,<=
/span><span> torch</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">.</span><span>Tensor</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Args:
</span><span>            features: [batch, feature_dim]
</span><span>            grasp_position: [batch, 3] (x, y, z)
</span><span>           =20
</span><span>        Returns:
</span><span>            attended_features: [batch, feature_dim]
</span><span>            attention_weights: [batch, feature_dim]
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Concatenate</span><span>
</span></span><span><span>        combined </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>cat</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>fe=
atures</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> grasp_position</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">,</span><span> dim</span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Generate attention</span><span>
</span></span><span><span>        attention_weights </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
attention_mlp</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">(</span><span>combined</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Apply attention</span><span>
</span></span><span><span>        attended_features </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> features </s=
pan><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><=
span> attention_weights
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> attended_features</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> attenti=
on_weights</span></span></code></pre></div></div>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">7. Grasp P=
lanning Module - Complete Grasp Planner</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># grasp_p=
lanning/grasp_planner.py</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">import</span><span> torch
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> numpy </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> typing </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">import</span><span> Dict</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> L=
ist</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span> Optional
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">.</span><span>grasp_generator </span><span=
 class=3D"token token" style=3D"color: rgb(129, 0, 194);">import</span><spa=
n> GraspCandidateGenerator
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">.</span><span>grasp_predictor </span><span=
 class=3D"token token" style=3D"color: rgb(129, 0, 194);">import</span><spa=
n> GraspSuccessPredictor
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">GraspPlanner</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Complete grasp planning pipeline:
</span><span>    1. Generate grasp candidates
</span><span>    2. Evaluate with success predictor
</span><span>    3. Rank and select best grasp
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        predictor_model_path</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> Optional</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><s=
pan class=3D"token token" style=3D"color: rgb(179, 74, 0);">str</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128)=
;">None</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>,</span><span>
</span></span><span><span>        device</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(179, 74, 0);">str</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'cuda'</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>        use_predictor</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
True</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Args:
</span><span>            predictor_model_path: Path to trained predictor mo=
del
</span><span>            device: 'cuda' or 'cpu'
</span><span>            use_predictor: Whether to use learned predictor (F=
alse =3D heuristics only)
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>device </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> device
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>use_predictor </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> use_=
predictor
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Grasp candidate generator</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>generator </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> GraspCa=
ndidateGenerator</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Success predictor</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> use_predictor</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>predictor </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Gras=
pSuccessPredictor</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>.</span><span>to</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span>device</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">if</span><span> predictor_model_path</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token stri=
ng-interpolation" style=3D"color: rgb(0, 128, 0);">f"Loading grasp predicto=
r from </span><span class=3D"token token string-interpolation interpolation=
" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token stri=
ng-interpolation interpolation">predictor_model_path</span><span class=3D"t=
oken token string-interpolation interpolation" style=3D"color: rgb(43, 48, =
59);">}</span><span class=3D"token token string-interpolation" style=3D"col=
or: rgb(0, 128, 0);">"</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">)</span><span>
</span></span><span><span>                checkpoint </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>load</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>predictor_model_path</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> map_location</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>device</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span>
</span></span><span><span>                self</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>predictor</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>load=
_state_dict</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span>checkpoint</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: =
rgb(0, 128, 0);">'model_state_dict'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 0);">"Predictor loaded successfully"</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            self</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>predictor</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">eval</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>predictor </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">None</spa=
n><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"Running without learned predictor (heuristics =
only)"</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">plan_grasp</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        scene</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> Dict</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        target_dish_id</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> Optional</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">int</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span=
> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">Non=
e</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>        num_candidates</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">int</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2=
0</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> Dict</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Plan grasp for a dish in the scene
</span><span>       =20
</span><span>        Args:
</span><span>            scene: Scene dict from HybridVisionSystem
</span><span>            target_dish_id: Specific dish to grasp (None =3D h=
ighest graspability)
</span><span>            num_candidates: Number of candidates to evaluate
</span><span>           =20
</span><span>        Returns:
</span><span>            Best grasp with metadata
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        dishes </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> scene</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'dishes'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(179, 74, 0);">len</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>dishes</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span=
>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 0);">'success'</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">False</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'reason'</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'No =
dishes detected'</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">}</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Select target dish</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> target_dish_id </span><span c=
lass=3D"token token" style=3D"color: rgb(129, 0, 194);">is</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">None</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><s=
pan>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Choose dish with highest combined gras=
pability</span><span>
</span></span><span><span>            target_dish </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> dishes</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>  </span>=
<span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Already =
sorted by graspability</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            target_dish </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> dishes</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>=
target_dish_id</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpolatio=
n" style=3D"color: rgb(0, 128, 0);">f"\nPlanning grasp for: </span><span cl=
ass=3D"token token string-interpolation interpolation" style=3D"color: rgb(=
43, 48, 59);">{</span><span class=3D"token token string-interpolation inter=
polation">target_dish</span><span class=3D"token token string-interpolation=
 interpolation" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"to=
ken token string-interpolation interpolation" style=3D"color: rgb(0, 128, 0=
);">'type'</span><span class=3D"token token string-interpolation interpolat=
ion" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token s=
tring-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</spa=
n><span class=3D"token token string-interpolation" style=3D"color: rgb(0, 1=
28, 0);"> (ID: </span><span class=3D"token token string-interpolation inter=
polation" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token to=
ken string-interpolation interpolation">target_dish</span><span class=3D"to=
ken token string-interpolation interpolation" style=3D"color: rgb(43, 48, 5=
9);">[</span><span class=3D"token token string-interpolation interpolation"=
 style=3D"color: rgb(0, 128, 0);">'id'</span><span class=3D"token token str=
ing-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">]</span>=
<span class=3D"token token string-interpolation interpolation" style=3D"col=
or: rgb(43, 48, 59);">}</span><span class=3D"token token string-interpolati=
on" style=3D"color: rgb(0, 128, 0);">)"</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  Graspability: </span><span =
class=3D"token token string-interpolation interpolation" style=3D"color: rg=
b(43, 48, 59);">{</span><span class=3D"token token string-interpolation int=
erpolation">target_dish</span><span class=3D"token token string-interpolati=
on interpolation" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"=
token token string-interpolation interpolation">get</span><span class=3D"to=
ken token string-interpolation interpolation" style=3D"color: rgb(43, 48, 5=
9);">(</span><span class=3D"token token string-interpolation interpolation"=
 style=3D"color: rgb(0, 128, 0);">'graspability_combined'</span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">,</span><span class=3D"token token string-interpolation interpol=
ation"> </span><span class=3D"token token string-interpolation interpolatio=
n" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token st=
ring-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">)</span=
><span class=3D"token token string-interpolation interpolation" style=3D"co=
lor: rgb(43, 48, 59);">:</span><span class=3D"token token string-interpolat=
ion interpolation format-spec">.2f</span><span class=3D"token token string-=
interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</span><spa=
n class=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0)=
;">/10"</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Generate grasp candidates</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  Generating </span><span cla=
ss=3D"token token string-interpolation interpolation" style=3D"color: rgb(4=
3, 48, 59);">{</span><span class=3D"token token string-interpolation interp=
olation">num_candidates</span><span class=3D"token token string-interpolati=
on interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"=
token token string-interpolation" style=3D"color: rgb(0, 128, 0);"> grasp c=
andidates..."</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">)</span><span>
</span></span><span><span>        candidates_dict </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ge=
nerator</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>.</span><span>generate_candidates</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            target_dish</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            num_candidates</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>num_candidate=
s</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>            use_semantic</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(179, 74, 0);">len</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>candidates_dict</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</s=
pan><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 0);">'success'</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">False</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'reason'</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'No =
valid grasps generated'</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">}</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpolatio=
n" style=3D"color: rgb(0, 128, 0);">f"  Generated </span><span class=3D"tok=
en token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59=
);">{</span><span class=3D"token token string-interpolation interpolation" =
style=3D"color: rgb(179, 74, 0);">len</span><span class=3D"token token stri=
ng-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">(</span><=
span class=3D"token token string-interpolation interpolation">candidates_di=
ct</span><span class=3D"token token string-interpolation interpolation" sty=
le=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token string-in=
terpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span =
class=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);"=
> candidates"</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Convert to array format</span><span>
</span></span><span><span>        candidate_arrays </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>generator</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>convert_=
to_pose_array</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">(</span><span>g</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">)</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">for</span><span> g </span><span class=3D"token to=
ken" style=3D"color: rgb(129, 0, 194);">in</span><span> candidates_dict
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Evaluate candidates</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>use_predictor </s=
pan><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">and</spa=
n><span> self</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">.</span><span>predictor </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">is</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">not</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">None</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"  Evaluating with learned predictor..."</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
>
</span></span><span><span>            scores</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span> best_idx </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> se=
lf</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</s=
pan><span>_evaluate_with_predictor</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                scene</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span>                candidate_arrays
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"  Evaluating with heuristics..."</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            scores</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span> best_idx </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> se=
lf</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</s=
pan><span>_evaluate_with_heuristics</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                candidates_dict</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span>                target_dish
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Get best grasp</span><span>
</span></span><span><span>        best_grasp_dict </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> candidates_dic=
t</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</sp=
an><span>best_idx</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">]</span><span>
</span></span><span><span>        best_grasp_array </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> candidate_arr=
ays</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</=
span><span>best_idx</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">]</span><span>
</span></span><span><span>        best_score </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> scores</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>best_=
idx</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</=
span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpolatio=
n" style=3D"color: rgb(0, 128, 0);">f"  Selected grasp: </span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">{</span><span class=3D"token token string-interpolation interpol=
ation">best_grasp_dict</span><span class=3D"token token string-interpolatio=
n interpolation" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token string-interpolation interpolation" style=3D"color: rgb(0, 128, =
0);">'strategy'</span><span class=3D"token token string-interpolation inter=
polation" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token to=
ken string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}=
</span><span class=3D"token token string-interpolation" style=3D"color: rgb=
(0, 128, 0);">"</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  Success probability: </span=
><span class=3D"token token string-interpolation interpolation" style=3D"co=
lor: rgb(43, 48, 59);">{</span><span class=3D"token token string-interpolat=
ion interpolation">best_score</span><span class=3D"token token string-inter=
polation interpolation" style=3D"color: rgb(43, 48, 59);">:</span><span cla=
ss=3D"token token string-interpolation interpolation format-spec">.3f</span=
><span class=3D"token token string-interpolation interpolation" style=3D"co=
lor: rgb(43, 48, 59);">}</span><span class=3D"token token string-interpolat=
ion" style=3D"color: rgb(0, 128, 0);">"</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'success'</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">True</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'grasp'</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span> best_grasp_dict</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'grasp_array'</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> best_grasp_array</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'score'</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span> best_score</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'all_candidates'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> candidates_dict</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'all_scores'</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> scores</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'target_dish'</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> target_dish
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_evaluate_with_predictor</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        scene</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> Dict</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        candidate_arrays</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> List</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>np</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>ndarray</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">]</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> Tuple</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span>np</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarr=
ay</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(179, 74, =
0);">int</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</=
span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Evaluate candidates usin=
g neural network predictor"""</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Prepare RGBD image</span><span>
</span></span><span><span>        rgb </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> scene</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">'rgb_image'</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        depth </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> scene</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 0);">'depth_image'</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Stack RGBD</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> depth</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndim </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span=
><span>
</span></span><span><span>            depth </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> depth</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">None</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        rgbd </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>concatenate</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>r=
gb</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> depth</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> axis</span><span class=3D"token token" style=3D"color: =
rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb=
(20, 24, 31);">-</span><span class=3D"token token" style=3D"color: rgb(0, 1=
28, 128);">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Convert to tensor [1, 4, H, W]</span><span>
</span></span><span><span>        rgbd_tensor </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from_=
numpy</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span>rgbd</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">.</span><span>permute</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 128);">2</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"colo=
r: rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">.</span><span class=3D"token token" style=3D"color: rgb(17=
9, 74, 0);">float</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span>
</span></span><span><span>        rgbd_tensor </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rgbd_tensor</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>unsqueeze</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>to</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>self</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">.</span><span>device</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Normalize</span><span>
</span></span><span><span>        rgbd_tensor</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">3</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rgbd_tensor</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">255.0=
</span><span>  </span><span class=3D"token token" style=3D"color: rgb(110, =
118, 135);"># RGB to [0, 1]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Evaluate batch</span><span>
</span></span><span><span>        scores</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> best_idx </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>predictor</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">.</span><span>predict_batch_grasps</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            rgbd_tensor</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span>            candidate_arrays
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> scores</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> best_idx
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_evaluate_with_heuristics</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        candidates_dict</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> List</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>Dict<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n>
</span></span><span><span>        target_dish</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> Dict
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> Tuple</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span>np</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarr=
ay</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(179, 74, =
0);">int</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</=
span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Evaluate candidates usin=
g hand-crafted heuristics"""</span><span>
</span></span><span>       =20
</span><span><span>        scores </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">for</span><span> grasp </span><span class=3D"token to=
ken" style=3D"color: rgb(129, 0, 194);">in</span><span> candidates_dict</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><s=
pan>
</span></span><span><span>            score </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0.5</span><span>  </spa=
n><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Base s=
core</span><span>
</span></span><span>           =20
</span><span><span>            position </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>            approach </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">'approach_vector'</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span=
>
</span></span><span><span>            strategy </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">'strategy'</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Prefer top-down approaches (more stable)</spa=
n><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> approach</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>  </s=
pan><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Down=
ward approach</span><span>
</span></span><span><span>                score </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Prefer central positions</span><span>
</span></span><span><span>            dist_from_center </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>linalg</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">.</span><span>norm</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">(</span><span>
</span></span><span><span>                position</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">-</span><span> target_dish</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 0);">'position_3d'</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> dist_from_center </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.=
05</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</s=
pan><span>  </span><span class=3D"token token" style=3D"color: rgb(110, 118=
, 135);"># Within 5cm of center</span><span>
</span></span><span><span>                score </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.15</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Prefer certain strategies</span><span>
</span></span><span><span>            strategy_bonus </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'plate_top_down'</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'bowl_top'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0.15</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'rim_grasp'</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0.1</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'cup_side'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0.1</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'generic'</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">0.0</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span><span>            score </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> strategy_bonus</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>get</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>strategy</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 128, 128);">0.0</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Gripper width check</span><span>
</span></span><span><span>            width </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'gripper_width'</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">0.03</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> w=
idth </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&=
lt;</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, =
128, 128);">0.07</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">:</span><span>  </span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># Ideal range</span><span>
</span></span><span><span>                score </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.1</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Height accessibility</span><span>
</span></span><span><span>            z </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> position</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">0.05</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> z=
 </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;<=
/span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128,=
 128);">0.25</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">:</span><span>
</span></span><span><span>                score </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.1</span><span>
</span></span><span>           =20
</span><span><span>            scores</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>score</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        scores </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>scores=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>
</span></span><span><span>        best_idx </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>argmax</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan>scores</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> scores</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> best_idx
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">visualize_grasps</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        scene</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> Dict</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        grasp_result</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span> Dict</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        show_all</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">False<=
/span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Visualize grasps in 3D
</span><span>       =20
</span><span>        Args:
</span><span>            scene: Scene dictionary
</span><span>            grasp_result: Result from plan_grasp()
</span><span>            show_all: Show all candidates or just best
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">import</span><span> open3d </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">as</span><span> o3d
</span></span><span>       =20
</span><span><span>        geometries </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Add point cloud</span><span>
</span></span><span><span>        pcd </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> scene</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">'clean_pointcloud'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        geometries</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>pcd</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Add coordinate frame</span><span>
</span></span><span><span>        coord_frame </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometr=
y</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>TriangleMesh</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">.</span><span>create_coordinate_frame</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            size</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">0.1</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span> origin</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        geometries</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>coord_fra=
me</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Visualize grasps</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> show_all</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            candidates </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp_result</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'all_candidates=
'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</sp=
an><span>
</span></span><span><span>            scores </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp_result</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 0);">'all_scores'</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span=
>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">for</span><span> i</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span>grasp</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> =
score</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(129, 0=
, 194);">in</span><span> </span><span class=3D"token token" style=3D"color:=
 rgb(179, 74, 0);">enumerate</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: r=
gb(179, 74, 0);">zip</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">(</span><span>candidates</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span> scores</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                color </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">-</span><span>score</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> sco=
re</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>]</span><span>  </span><span class=3D"token token" style=3D"color: rgb(110=
, 118, 135);"># Red (bad) to Green (good)</span><span>
</span></span><span><span>                grasp_frame </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>_create_grasp_frame</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">(</span><span>grasp</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> color</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> size</span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">0.03</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>                geometries</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>extend</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>g=
rasp_frame</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Just show best grasp</span><span>
</span></span><span><span>            best_grasp </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp_result</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'grasp'</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>            grasp_frame </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_c=
reate_grasp_frame</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span>best_grasp</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> size</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 128);">0.05</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            geometries</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>extend</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>grasp=
_frame</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span>
</span></span><span>       =20
</span><span><span>        o3d</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">.</span><span>visualization</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>draw_geometries<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span>
</span></span><span><span>            geometries</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            window_name</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"Grasp Visualization"</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_create_grasp_frame</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        grasp</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> Dict</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        color</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> List</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">float</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        size</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">float</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.05</spa=
n><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> List</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Create visual representa=
tion of grasp"""</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">import</span><span> open3d </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">as</span><span> o3d
</span></span><span>       =20
</span><span><span>        position </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        orientation </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Create coordinate frame at grasp position</span><=
span>
</span></span><span><span>        frame </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>TriangleMesh</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">.</span><span>create_coordinate_frame</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            size</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span>size</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> origin</s=
pan><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span=
><span>position
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        frame</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">.</span><span>rotate</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span>orientation</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> center</span><span class=3D"token token" style=3D"color: rgb(20, 24, =
31);">=3D</span><span>position</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Create gripper visualization (two parallel bars)<=
/span><span>
</span></span><span><span>        width </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 0);">'gripper_width'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Gripper fingers</span><span>
</span></span><span><span>        finger1_pos </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> position </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><span> =
orientation @ np</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">.</span><span>array</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">[</span><span>width</span><span class=3D"token token" sty=
le=3D"color: rgb(20, 24, 31);">/</span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 128);">2</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        finger2_pos </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> position </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><span> =
orientation @ np</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">.</span><span>array</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(2=
0, 24, 31);">-</span><span>width</span><span class=3D"token token" style=3D=
"color: rgb(20, 24, 31);">/</span><span class=3D"token token" style=3D"colo=
r: rgb(0, 128, 128);">2</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        finger1 </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Tr=
iangleMesh</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>create_cylinder</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            radius</span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 128);">0.005</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span> height</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0.04</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        finger1</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">.</span><span>translate</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>finger1_p=
os</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span>
</span></span><span><span>        finger1</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">.</span><span>paint_uniform_color</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>color</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span>
</span></span><span>       =20
</span><span><span>        finger2 </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Tr=
iangleMesh</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>create_cylinder</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            radius</span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 128);">0.005</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span> height</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0.04</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        finger2</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">.</span><span>translate</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>finger2_p=
os</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span>
</span></span><span><span>        finger2</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">.</span><span>paint_uniform_color</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>color</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">[</span><span>frame</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> finger1</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> finger2</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">]</span></span></code></pre></div></div>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]"><strong>(Continuing in next message...)</strong></p></div></div></d=
iv></div></div><div class=3D"flex justify-start opacity-0 group-hover:opaci=
ty-100 group-focus-within:opacity-100 transition" role=3D"group" aria-label=
=3D"Message actions"><div class=3D"text-text-300"><div class=3D"text-text-3=
00 flex items-stretch justify-between"><div class=3D"w-fit" data-state=3D"c=
losed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" data-testid=3D"acti=
on-bar-copy" aria-label=3D"Copy"><div class=3D"relative text-text-500 group=
-hover/btn:text-text-100"><div class=3D"transition-all opacity-100 scale-10=
0" style=3D"width: 20px; height: 20px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"tr=
ansition-all opacity-100 scale-100" aria-hidden=3D"true" style=3D"flex-shri=
nk: 0;"><path d=3D"M12.5 3C13.3284 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 =
6.67157 17 7.5V15.5C17 16.3284 16.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 =
6 15.5V14H4.5C3.67157 14 3 13.3284 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.=
5ZM14 12.5C14 13.3284 13.3284 14 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16=
H15.5C15.7761 16 16 15.7761 16 15.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5=
ZM4.5 4C4.22386 4 4 4.22386 4 4.5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.=
7761 13 13 12.7761 13 12.5V4.5C13 4.22386 12.7761 4 12.5 4H4.5Z"></path></s=
vg></div><div class=3D"absolute top-0 left-0 transition-all opacity-0 scale=
-50" style=3D"width: 20px; height: 20px; display: flex; align-items: center=
; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 =
20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"=
absolute top-0 left-0 transition-all opacity-0 scale-50" aria-hidden=3D"tru=
e" style=3D"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15=
.6346 4.96153 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.736=
05L15.8836 5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 =
14.9989C7.88203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.0=
8172 11.2752C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755=
 4.58105 10.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.=
1794L15.1883 5.10908Z"></path></svg></div></div></button></div><div class=
=3D"w-fit" data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Give =
positive feedback"><div class=3D"text-text-500 group-hover/btn:text-text-10=
0" style=3D"width: 16px; height: 16px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"te=
xt-text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"fl=
ex-shrink: 0;"><path d=3D"M9.56055 2C11.1381 2.00009 12.3211 3.44332 12.011=
7 4.99023L11.6094 7H13.8438C15.5431 7 16.836 8.52594 16.5566 10.2021L15.876=
 14.2842C15.6148 15.8513 14.2586 17 12.6699 17H4.5C3.67157 17 3 16.3284 3 1=
5.5V9.23828C3.00013 8.57996 3.4294 7.99838 4.05859 7.80469L5.19824 7.4541L5=
.33789 7.40723C6.02983 7.15302 6.59327 6.63008 6.89746 5.9541L8.41113 2.589=
84L8.48047 2.46094C8.66235 2.17643 8.97898 2.00002 9.32324 2H9.56055ZM7.809=
57 6.36523C7.39486 7.2867 6.62674 7.99897 5.68359 8.3457L5.49219 8.41016L4.=
35254 8.76074C4.14305 8.82539 4.00013 9.01904 4 9.23828V15.5C4 15.7761 4.22=
386 16 4.5 16H12.6699C13.7697 16 14.7087 15.2049 14.8896 14.1201L15.5703 10=
.0381C15.7481 8.97141 14.9251 8 13.8438 8H11C10.8503 8 10.7083 7.9331 10.61=
33 7.81738C10.5184 7.70164 10.4805 7.54912 10.5098 7.40234L11.0312 4.79395C=
11.2167 3.86589 10.507 3.00009 9.56055 3H9.32324L7.80957 6.36523Z"></path><=
/svg></div></button></div><div class=3D"w-fit" data-state=3D"closed"><butto=
n class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Give =
negative feedback"><div class=3D"text-text-500 group-hover/btn:text-text-10=
0" style=3D"width: 16px; height: 16px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"te=
xt-text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"fl=
ex-shrink: 0;"><path d=3D"M12.6699 3C14.2586 3 15.6148 4.14871 15.876 5.715=
82L16.5566 9.79785C16.836 11.4741 15.5431 13 13.8438 13H11.6094L12.0117 15.=
0098C12.3211 16.5567 11.1381 17.9999 9.56055 18H9.32324C8.97898 18 8.66235 =
17.8236 8.48047 17.5391L8.41113 17.4102L6.89746 14.0459C6.59327 13.3699 6.0=
2983 12.847 5.33789 12.5928L5.19824 12.5459L4.05859 12.1953C3.4294 12.0016 =
3.00013 11.42 3 10.7617V4.5C3 3.67157 3.67157 3 4.5 3H12.6699ZM4.5 4C4.2238=
6 4 4 4.22386 4 4.5V10.7617C4.00013 10.981 4.14305 11.1746 4.35254 11.2393L=
5.49219 11.5898L5.68359 11.6543C6.62674 12.001 7.39486 12.7133 7.80957 13.6=
348L9.32324 17H9.56055C10.507 16.9999 11.2167 16.1341 11.0312 15.2061L10.50=
98 12.5977C10.4805 12.4509 10.5184 12.2984 10.6133 12.1826C10.7083 12.0669 =
10.8503 12 11 12H13.8438C14.9251 12 15.7481 11.0286 15.5703 9.96191L14.8896=
 5.87988C14.7087 4.79508 13.7697 4 12.6699 4H4.5Z"></path></svg></div></but=
ton></div><div class=3D"flex items-center"><div class=3D"w-fit" data-state=
=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" id=3D"radix-_r_kn_"=
 aria-haspopup=3D"menu" aria-expanded=3D"false" data-state=3D"closed" aria-=
label=3D"Retry"><div class=3D"text-text-500 group-hover/btn:text-text-100" =
style=3D"width: 20px; height: 20px; display: flex; align-items: center; jus=
tify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20=
" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-=
text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-=
shrink: 0;"><path d=3D"M10.3857 2.50977C14.3486 2.71054 17.5 5.98724 17.5 1=
0C17.5 14.1421 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 7.5=
4619 3.67878 5.3677 5.49902 4H3C2.72386 4 2.5 3.77614 2.5 3.5C2.5 3.22386 2=
.72386 3 3 3H6.5C6.63261 3 6.75975 3.05272 6.85352 3.14648C6.92392 3.21689 =
6.97106 3.30611 6.99023 3.40234L7 3.5V7C7 7.27614 6.77614 7.5 6.5 7.5C6.223=
86 7.5 6 7.27614 6 7V4.87891C4.4782 6.06926 3.5 7.91979 3.5 10C3.5 13.5899 =
6.41015 16.5 10 16.5C13.5899 16.5 16.5 13.5899 16.5 10C16.5 6.5225 13.7691 =
3.68312 10.335 3.50879L10 3.5L9.89941 3.49023C9.67145 3.44371 9.5 3.24171 9=
.5 3C9.5 2.72386 9.72386 2.5 10 2.5L10.3857 2.50977Z"></path></svg></div></=
button></div></div></div></div></div></div></div><div data-test-render-coun=
t=3D"2"><div class=3D"mb-1 mt-6 group"><div class=3D"flex flex-col items-en=
d gap-1"><div class=3D"group relative inline-flex gap-2 bg-bg-300 rounded-x=
l pl-2.5 py-2.5 break-words text-text-100 transition-all max-w-[75ch] flex-=
col !px-4 max-w-[85%]" style=3D"opacity: 1; transform: none;"><div class=3D=
"flex flex-row gap-2 relative"><div class=3D"flex-1"><div data-testid=3D"us=
er-message" class=3D"font-large !font-user-message grid grid-cols-1 gap-2 p=
y-0.5 relative" style=3D"max-height: none; overflow: hidden; position: rela=
tive;"><p class=3D"whitespace-pre-wrap break-words">Continue</p></div></div=
></div></div><div class=3D"flex justify-start opacity-0 group-hover:opacity=
-100 group-focus-within:opacity-100 transition" role=3D"group" aria-label=
=3D"Message actions"><div class=3D"text-text-300"><div class=3D"text-text-3=
00 flex items-stretch justify-between"><span class=3D"text-text-500 text-xs=
 flex items-center mr-2" data-state=3D"closed">Feb 4</span><div class=3D"fl=
ex items-center"><div class=3D"w-fit" data-state=3D"closed"><button class=
=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Retry=
"><div class=3D"text-text-500 group-hover/btn:text-text-100" style=3D"width=
: 20px; height: 20px; display: flex; align-items: center; justify-content: =
center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curr=
entColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-text-500 group=
-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><p=
ath d=3D"M10.3857 2.50977C14.3486 2.71054 17.5 5.98724 17.5 10C17.5 14.1421=
 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 7.54619 3.67878 5=
.3677 5.49902 4H3C2.72386 4 2.5 3.77614 2.5 3.5C2.5 3.22386 2.72386 3 3 3H6=
.5C6.63261 3 6.75975 3.05272 6.85352 3.14648C6.92392 3.21689 6.97106 3.3061=
1 6.99023 3.40234L7 3.5V7C7 7.27614 6.77614 7.5 6.5 7.5C6.22386 7.5 6 7.276=
14 6 7V4.87891C4.4782 6.06926 3.5 7.91979 3.5 10C3.5 13.5899 6.41015 16.5 1=
0 16.5C13.5899 16.5 16.5 13.5899 16.5 10C16.5 6.5225 13.7691 3.68312 10.335=
 3.50879L10 3.5L9.89941 3.49023C9.67145 3.44371 9.5 3.24171 9.5 3C9.5 2.723=
86 9.72386 2.5 10 2.5L10.3857 2.50977Z"></path></svg></div></button></div><=
div class=3D"w-fit" data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Edit"=
><div class=3D"text-text-500 group-hover/btn:text-text-100" style=3D"width:=
 20px; height: 20px; display: flex; align-items: center; justify-content: c=
enter;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curre=
ntColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-text-500 group-=
hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><pa=
th d=3D"M9.72821 2.87934C10.0318 2.10869 10.9028 1.72933 11.6735 2.03266L14=
.4655 3.13226C15.236 3.43593 15.6145 4.30697 15.3112 5.07758L11.3903 15.030=
7C11.2954 15.2717 11.1394 15.4835 10.9391 15.6459L10.8513 15.7123L7.7077 17=
.8979C7.29581 18.1843 6.73463 17.9917 6.57294 17.5356L6.54657 17.4409L5.737=
 13.6987C5.67447 13.4092 5.69977 13.107 5.80829 12.8315L9.72821 2.87934ZM6.=
73798 13.1987C6.70201 13.2903 6.69385 13.3906 6.71454 13.4868L7.44501 16.86=
27L10.28 14.892L10.3376 14.8452C10.3909 14.7949 10.4325 14.7332 10.4597 14.=
6645L13.0974 7.96723L9.37567 6.50141L6.73798 13.1987ZM11.3073 2.96332C11.05=
04 2.86217 10.7601 2.98864 10.6589 3.24555L9.74188 5.57074L13.4636 7.03754L=
14.3806 4.71137C14.4817 4.45445 14.3552 4.16413 14.0983 4.06293L11.3073 2.9=
6332Z"></path></svg></div></button></div></div><div class=3D"w-fit" data-st=
ate=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" data-testid=3D"acti=
on-bar-copy" aria-label=3D"Copy"><div class=3D"relative text-text-500 group=
-hover/btn:text-text-100"><div class=3D"transition-all opacity-100 scale-10=
0" style=3D"width: 20px; height: 20px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"tr=
ansition-all opacity-100 scale-100" aria-hidden=3D"true" style=3D"flex-shri=
nk: 0;"><path d=3D"M12.5 3C13.3284 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 =
6.67157 17 7.5V15.5C17 16.3284 16.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 =
6 15.5V14H4.5C3.67157 14 3 13.3284 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.=
5ZM14 12.5C14 13.3284 13.3284 14 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16=
H15.5C15.7761 16 16 15.7761 16 15.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5=
ZM4.5 4C4.22386 4 4 4.22386 4 4.5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.=
7761 13 13 12.7761 13 12.5V4.5C13 4.22386 12.7761 4 12.5 4H4.5Z"></path></s=
vg></div><div class=3D"absolute top-0 left-0 transition-all opacity-0 scale=
-50" style=3D"width: 20px; height: 20px; display: flex; align-items: center=
; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 =
20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"=
absolute top-0 left-0 transition-all opacity-0 scale-50" aria-hidden=3D"tru=
e" style=3D"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15=
.6346 4.96153 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.736=
05L15.8836 5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 =
14.9989C7.88203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.0=
8172 11.2752C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755=
 4.58105 10.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.=
1794L15.1883 5.10908Z"></path></svg></div></div></button></div><div class=
=3D"flex items-center"></div></div></div></div></div></div></div><div data-=
test-render-count=3D"2"><div class=3D"group" style=3D"height: auto; opacity=
: 1; transform: none;"><div class=3D"contents"><div data-is-streaming=3D"fa=
lse" class=3D"group relative relative pb-3" style=3D"opacity: 1; transform:=
 none;"><div class=3D"font-claude-response relative leading-[1.65rem] [&amp=
;_pre>div]:bg-bg-000/50 [&amp;_pre>div]:border-0.5 [&amp;_pre>div]:border-b=
order-400 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_.standard-markdo=
wn_:is(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&amp;_.standard-markdown_:is(=
p,blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8 [&amp;_.progressive-markdown_:i=
s(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&amp;_.progressive-markdown_:is(p,=
blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8"><div><div class=3D"standard-mark=
down grid-cols-1 grid [&amp;_>_*]:min-w-0 gap-3 standard-markdown"><h1 clas=
s=3D"text-text-100 mt-3 -mb-1 text-[1.375rem] font-bold">Complete System (C=
ontinued)</h1>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">8. Isaac S=
im Environment Setup</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># simulat=
ion/isaac_environment.py</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">from</span><span> omni</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>kit </span><span c=
lass=3D"token token" style=3D"color: rgb(129, 0, 194);">import</span><span>=
 SimulationApp
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> omni</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>core</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>utils</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">.</span><span>stage </span><span class=3D"token token" style=3D"color: rg=
b(129, 0, 194);">as</span><span> stage_utils
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>core </spa=
n><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">import</sp=
an><span> World
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>core</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>objects </span><span class=3D"token token" style=3D"color: rgb(129, 0, 19=
4);">import</span><span> DynamicCuboid</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span> DynamicSphere
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>core</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>prims </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194)=
;">import</span><span> RigidPrimView</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span> XFormPrim
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>core</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>materials </span><span class=3D"token token" style=3D"color: rgb(129, 0, =
194);">import</span><span> PhysicsMaterial
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> numpy </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> typing </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">import</span><span> Dict</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> L=
ist</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span> Optional</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">,</span><span> Tuple
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> pxr </span><span class=3D"token toke=
n" style=3D"color: rgb(129, 0, 194);">import</span><span> UsdGeom</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> G=
f</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span> UsdLux
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">VirtualSinkEnvironment</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Virtual sink environment in NVIDIA Isaac Sim for tr=
aining and testing
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        headless</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">False<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span>
</span></span><span><span>        enable_viewport</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>True</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Initialize Isaac Sim environment
</span><span>       =20
</span><span>        Args:
</span><span>            headless: Run without GUI
</span><span>            enable_viewport: Enable viewport rendering
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"Initializing Isaac Sim..."</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Launch Isaac Sim</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>simulation_app </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Sim=
ulationApp</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">{=
</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"headless"</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> headless</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"width"</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">1280</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"height"</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">720</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Import Isaac modules (must be after SimulationApp=
 creation)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>se=
nsor </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">=
import</span><span> Camera
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>Camera </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Camera
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Create world</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>world </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> World</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>
</span></span><span><span>            stage_units_in_meters</span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">1.0</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            physics_dt</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 128);">1.0</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">/</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">60.0</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span class=3D"token =
token" style=3D"color: rgb(110, 118, 135);"># 60 Hz physics</span><span>
</span></span><span><span>            rendering_dt</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">1.0</span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">/</span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 128);">30.0</span><span>  </span><span class=3D=
"token token" style=3D"color: rgb(110, 118, 135);"># 30 Hz rendering</span>=
<span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"Setting up scene..."</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>setup_scene</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Track spawned dishes</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>dishes </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>dish_counter </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><s=
pan>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Camera</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>camera </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">None</span><span=
>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>camera_intrinsics </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">None<=
/span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"Isaac Sim environment ready"</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">setup_scene</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Build the virtual sink s=
cene"""</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Add ground plane</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>scene</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>add=
_default_ground_plane</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Create sink</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>create_sink</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Add lighting</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>add_lighting</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Add camera</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>add_camera</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Reset world</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>reset</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">create_sink</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Create realistic sink geometry
</span><span>        Dimensions: 50cm x 50cm x 20cm deep
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"  Creating sink..."</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Material properties (stainless steel)</span><span=
>
</span></span><span><span>        sink_material </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> PhysicsMaterial<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span>
</span></span><span><span>            prim_path</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"/World/Physics/SinkMaterial"</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            static_friction</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 128);">0.5</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            dynamic_friction</span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">0.3</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            restitution</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">0.1</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Sink dimensions</span><span>
</span></span><span><span>        sink_length </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0.5</span><span>
</span></span><span><span>        sink_width </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0.5</span><span>
</span></span><span><span>        sink_depth </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2</span><span>
</span></span><span><span>        wall_thickness </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.01</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Bottom</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>sink_bottom </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Dynami=
cCuboid</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span>
</span></span><span><span>            prim_path</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"/World/Sink/Bottom"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            name</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 0);">"sink_bottom"</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            position</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            scale</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>si=
nk_length</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">,</span><span> sink_width</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">,</span><span> wall_thickness</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            color</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            mass</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">10.0</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>scene</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>add=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">.</span><span>sink_bottom</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>sink_bottom</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>set_collis=
ion_enabled</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>True</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Back wall</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>sink_back </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Dynamic=
Cuboid</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>
</span></span><span><span>            prim_path</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"/World/Sink/Back"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            name</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 0);">"sink_back"</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            position</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> sink_widt=
h</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 sink_depth</span><span class=3D"token token" style=3D"color: rgb(20, 24, 3=
1);">/</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            scale</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>si=
nk_length</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">,</span><span> wall_thickness</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">,</span><span> sink_depth</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            color</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            mass</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">10.0</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>scene</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>add=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">.</span><span>sink_back</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Front wall</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>sink_front </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Dynamic=
Cuboid</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>
</span></span><span><span>            prim_path</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"/World/Sink/Front"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            name</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 0);">"sink_front"</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            position</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span>s=
ink_width</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31)=
;">/</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</spa=
n><span> sink_depth</span><span class=3D"token token" style=3D"color: rgb(2=
0, 24, 31);">/</span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 128);">2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</spa=
n><span>
</span></span><span><span>            scale</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>si=
nk_length</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">,</span><span> wall_thickness</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">,</span><span> sink_depth</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            color</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            mass</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">10.0</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>scene</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>add=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">.</span><span>sink_front</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Left wall</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>sink_left </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Dynamic=
Cuboid</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>
</span></span><span><span>            prim_path</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"/World/Sink/Left"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            name</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 0);">"sink_left"</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            position</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span>sink_l=
ength</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/=
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span> sink_depth</span><span class=3D"token token" style=3D"color: rgb(=
20, 24, 31);">/</span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>            scale</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>wa=
ll_thickness</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">,</span><span> sink_width</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">,</span><span> sink_depth</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            color</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            mass</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">10.0</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>scene</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>add=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">.</span><span>sink_left</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Right wall</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>sink_right </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Dynamic=
Cuboid</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>
</span></span><span><span>            prim_path</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"/World/Sink/Right"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            name</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 0);">"sink_right"</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            position</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>s=
ink_length</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">/</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 12=
8);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> sink_depth</span><span class=3D"token token" style=3D"color:=
 rgb(20, 24, 31);">/</span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">2</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span>
</span></span><span><span>            scale</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>wa=
ll_thickness</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">,</span><span> sink_width</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">,</span><span> sink_depth</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            color</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.7</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            mass</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">10.0</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>scene</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>add=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">.</span><span>sink_right</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">add_lighting</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Add realistic lighting f=
or perception"""</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"  Setting up lighting..."</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        stage </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>stag=
e
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Dome light (ambient illumination)</span><span>
</span></span><span><span>        dome_light </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> UsdLux</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>DomeL=
ight</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.<=
/span><span>Define</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">(</span><span>stage</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 0);">"/World/Lights/DomeLight"</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        dome_light</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>CreateIntensityAttr</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">800</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        dome_light</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>CreateColorAttr</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>=
Gf</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</s=
pan><span>Vec3f</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 12=
8);">1.0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, =
128, 128);">1.0</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">,</span><span> </span><span class=3D"token token" style=3D"color: =
rgb(0, 128, 128);">1.0</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Directional light (simulates sun/ceiling light)</=
span><span>
</span></span><span><span>        distant_light </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> UsdLux</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Di=
stantLight</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>Define</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">(</span><span>stage</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"/World/Lights/DirectionalLight"</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span><span>        distant_light</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>CreateIntensityAttr<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1200</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
>
</span></span><span><span>        distant_light</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>CreateColorAttr</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>Gf</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.=
</span><span>Vec3f</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128,=
 128);">1.0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">0.98</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"col=
or: rgb(0, 128, 128);">0.95</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">)</span><span>  </span><span class=3D"token token" style=3D=
"color: rgb(110, 118, 135);"># Warm white</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Orient light to shine down at angle</span><span>
</span></span><span><span>        distant_light</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>AddOrientOp</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Set</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>Gf</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>Quatf</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">0.924</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">0.383</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"co=
lor: rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span>  </span><span class=3D"token token" styl=
e=3D"color: rgb(110, 118, 135);"># ~45 degree angle</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Add shadow</span><span>
</span></span><span><span>        distant_light</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>CreateEnableColorTem=
peratureAttr</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">True</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span>
</span></span><span><span>        distant_light</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>CreateColorTemperatu=
reAttr</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">5500=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, =
135);"># Daylight</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">add_camera</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Add RGBD camera above si=
nk"""</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"  Adding camera..."</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Camera positioned above sink, looking down</span>=
<span>
</span></span><span><span>        camera_position </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>arra=
y</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.8<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"=
># 80cm above sink</span><span>
</span></span><span><span>        camera_target </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>  =
</span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># L=
ooking at sink center</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Compute orientation (looking down)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">from</span><span> scipy</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>spatial</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>transform </span><span class=3D"token token" style=3D"color: rgb(129, 0, 1=
94);">import</span><span> Rotation
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Camera looks down negative Z in its local frame</=
span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># We want it to look down world Z</span><sp=
an>
</span></span><span><span>        forward </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> camera_target </span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span>=
 camera_position
</span></span><span><span>        forward </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> forward </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><span> np</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>linalg</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">.</span><span>norm</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">(</span><span>forward</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Simple approach: rotate 180 degrees around X to p=
oint down</span><span>
</span></span><span><span>        rot </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> Rotation</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from_euler=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'x'</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">180</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> degrees</span><span class=3D"token token" style=3D"color: rgb(20, 24=
, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">True</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">)</span><span>
</span></span><span><span>        orientation_quat </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rot</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>as=
_quat</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, =
135);"># [x, y, z, w]</span><span>
</span></span><span><span>        orientation </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>=
orientation_quat</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">3</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> orientation_quat</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span>=20
</span></span><span><span>                              orientation_quat</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> orientat=
ion_quat</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">[</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>  <=
/span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># [w=
, x, y, z]</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>camera </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Camera=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>
</span></span><span><span>            prim_path</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"/World/Camera"</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            name</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 0);">"overhead_camera"</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            position</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>camera_position</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan>
</span></span><span><span>            orientation</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>orientation</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>            frequency</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">30</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span class=3D"to=
ken token" style=3D"color: rgb(110, 118, 135);"># 30 Hz</span><span>
</span></span><span><span>            resolution</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 128);">640</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">480</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            focal_length</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">24.0</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span class=
=3D"token token" style=3D"color: rgb(110, 118, 135);"># Wide angle for full=
 sink view</span><span>
</span></span><span><span>            horizontal_aperture</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">20.955</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>  </span><=
span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Standard =
sensor</span><span>
</span></span><span><span>            clipping_range</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">0.01</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">10.0</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>camera</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">.</span><span>initialize</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>camera</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>add_distance_to=
_image_plane_to_frame</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span>  </span><span class=3D"token token" style=3D"color=
: rgb(110, 118, 135);"># Enable depth</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Store camera intrinsics</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>camera_intrinsics </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">{</spa=
n><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'width'</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">640</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'height'</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">480</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'fx'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">640.0</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">24.0</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 128);">20.955</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">,</span><span>  </span><span class=3D"token token" style=3D"color:=
 rgb(110, 118, 135);"># Approximate</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'fy'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">480.0</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">24.0</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 128);">20.955</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'cx'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">320.0</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'cy'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">240.0</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpolatio=
n" style=3D"color: rgb(0, 128, 0);">f"    Camera intrinsics: fx=3D</span><s=
pan class=3D"token token string-interpolation interpolation" style=3D"color=
: rgb(43, 48, 59);">{</span><span class=3D"token token string-interpolation=
 interpolation">self</span><span class=3D"token token string-interpolation =
interpolation" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"tok=
en token string-interpolation interpolation">camera_intrinsics</span><span =
class=3D"token token string-interpolation interpolation" style=3D"color: rg=
b(43, 48, 59);">[</span><span class=3D"token token string-interpolation int=
erpolation" style=3D"color: rgb(0, 128, 0);">'fx'</span><span class=3D"toke=
n token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59)=
;">]</span><span class=3D"token token string-interpolation interpolation" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token string-=
interpolation interpolation format-spec">.1f</span><span class=3D"token tok=
en string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}<=
/span><span class=3D"token token string-interpolation" style=3D"color: rgb(=
0, 128, 0);">, "</span><span>
</span></span><span><span>              </span><span class=3D"token token s=
tring-interpolation" style=3D"color: rgb(0, 128, 0);">f"fy=3D</span><span c=
lass=3D"token token string-interpolation interpolation" style=3D"color: rgb=
(43, 48, 59);">{</span><span class=3D"token token string-interpolation inte=
rpolation">self</span><span class=3D"token token string-interpolation inter=
polation" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token to=
ken string-interpolation interpolation">camera_intrinsics</span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">[</span><span class=3D"token token string-interpolation interpol=
ation" style=3D"color: rgb(0, 128, 0);">'fy'</span><span class=3D"token tok=
en string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">]<=
/span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token string-inte=
rpolation interpolation format-spec">.1f</span><span class=3D"token token s=
tring-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</spa=
n><span class=3D"token token string-interpolation" style=3D"color: rgb(0, 1=
28, 0);">"</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">spawn_random_dishes</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        num_dishes</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">int</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">5</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan>
</span></span><span><span>        dish_types</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> Optional</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>List</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span>=
<span class=3D"token token" style=3D"color: rgb(179, 74, 0);">str</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
None</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Spawn random dishes in sink
</span><span>       =20
</span><span>        Args:
</span><span>            num_dishes: Number of dishes to spawn
</span><span>            dish_types: List of dish types, or None for random
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> dish_types </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">is</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">None</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            dish_types </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'plate'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 0);">'bowl'</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'cup'</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'=
glass'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpolatio=
n" style=3D"color: rgb(0, 128, 0);">f"  Spawning </span><span class=3D"toke=
n token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59)=
;">{</span><span class=3D"token token string-interpolation interpolation">n=
um_dishes</span><span class=3D"token token string-interpolation interpolati=
on" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token st=
ring-interpolation" style=3D"color: rgb(0, 128, 0);"> random dishes..."</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">for</span><span> i </span><span class=3D"token token"=
 style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(179, 74, 0);">range</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>num_dishes</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Random dish type</span><span>
</span></span><span><span>            dish_type </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</spa=
n><span>choice</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">(</span><span>dish_types</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Random position in sink (with some height to =
avoid initial collision)</span><span>
</span></span><span><span>            x </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
uniform</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.15</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
0.15</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span><span>            y </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
uniform</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.15</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
0.15</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span><span>            z </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">0.05</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><span> i =
</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</spa=
n><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128=
);">0.06</span><span>  </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Stack with vertical offset</span><span>
</span></span><span><span>            position </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
>x</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> y</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">,</span><span> z</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Random orientation</span><span>
</span></span><span><span>            angle </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>uniform</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">2</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);"=
>*</span><span>np</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">.</span><span>pi</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">from</span><span> scipy</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>spatial</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>transform </span><span class=3D"token token" style=3D"color: rgb(129, =
0, 194);">import</span><span> Rotation
</span></span><span><span>            rot </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Rotation</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from_e=
uler</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'z'</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an> angle</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">)</span><span>
</span></span><span><span>            orientation </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rot</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>as_=
quat</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span>
</span></span><span><span>            orientation </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>arra=
y</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><s=
pan>orientation</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128, 12=
8);">3</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span> orientation</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 1=
28, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>,</span><span>=20
</span></span><span><span>                                  orientation</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> orientati=
on</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>  </span>=
<span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># [w,x,y,z=
]</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Spawn dish</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>spawn_dish</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>dish_ty=
pe</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> position</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">,</span><span> orientation</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Let physics settle</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> _ </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">60</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span>  </span><span class=
=3D"token token" style=3D"color: rgb(110, 118, 135);"># 1 second at 60Hz</s=
pan><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>step</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n>render</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);=
">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
True</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">spawn_dish</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        dish_type</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(179, 74, 0);">str</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        position</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>        orientation</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> Optional</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>np</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>ndarray</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">]</span><span> </span><span class=3D"token token" style=3D"color: rgb=
(20, 24, 31);">=3D</span><span> </span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 128);">None</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        color</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> Optional</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>np</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
ndarray</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>]</span><span> </span><span class=3D"token token" style=3D"color: rgb(20, =
24, 31);">=3D</span><span> </span><span class=3D"token token" style=3D"colo=
r: rgb(0, 128, 128);">None</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Spawn a single dish
</span><span>       =20
</span><span>        Args:
</span><span>            dish_type: 'plate', 'bowl', 'cup', 'glass', etc.
</span><span>            position: [x, y, z] position
</span><span>            orientation: [w, x, y, z] quaternion (None for def=
ault)
</span><span>            color: [r, g, b] color (None for random)
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> orientation </span><span class=3D"tok=
en token" style=3D"color: rgb(129, 0, 194);">is</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">None</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            orientation </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>arra=
y</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135=
);"># Identity</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> color </span><span class=3D"token tok=
en" style=3D"color: rgb(129, 0, 194);">is</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">None</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Random color</span><span>
</span></span><span><span>            color </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>rand</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);=
">*</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, =
128, 128);">0.5</span><span> </span><span class=3D"token token" style=3D"co=
lor: rgb(20, 24, 31);">+</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">0.3</span><span>  </span><span class=3D"to=
ken token" style=3D"color: rgb(110, 118, 135);"># Not too dark</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Dish geometries (simplified - in production use a=
ctual meshes)</span><span>
</span></span><span><span>        dish_name </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">f"di=
sh_</span><span class=3D"token token string-interpolation interpolation" st=
yle=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token string-i=
nterpolation interpolation">self</span><span class=3D"token token string-in=
terpolation interpolation" style=3D"color: rgb(43, 48, 59);">.</span><span =
class=3D"token token string-interpolation interpolation">dish_counter</span=
><span class=3D"token token string-interpolation interpolation" style=3D"co=
lor: rgb(43, 48, 59);">}</span><span class=3D"token token string-interpolat=
ion" style=3D"color: rgb(0, 128, 0);">_</span><span class=3D"token token st=
ring-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">{</span=
><span class=3D"token token string-interpolation interpolation">dish_type</=
span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">"</span><span>
</span></span><span><span>        prim_path </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">f"/W=
orld/Dishes/</span><span class=3D"token token string-interpolation interpol=
ation" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token=
 string-interpolation interpolation">dish_name</span><span class=3D"token t=
oken string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">=
}</span><span class=3D"token token string-interpolation" style=3D"color: rg=
b(0, 128, 0);">"</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> dish_type </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 0);">'plate'</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Flat cylinder</span><span>
</span></span><span><span>            scale </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.12</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.12</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.01=
5</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span><span>            mass </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0.3</span><span>
</span></span><span><span>            dish </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> DynamicCuboid</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>=
  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);">#=
 Use cuboid for simplicity</span><span>
</span></span><span><span>                prim_path</span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>prim_path</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>                name</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>dish_name</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                position</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>position</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>                orientation</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>orientation<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span>
</span></span><span><span>                scale</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>scale</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                color</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>color</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                mass</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>mass
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">elif</span><span> dish_type </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 0);">'bowl'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Short cylinder</span><span>
</span></span><span><span>            scale </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.10</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.10</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.05=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an>
</span></span><span><span>            mass </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0.25</span><span>
</span></span><span><span>            dish </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> DynamicCuboid</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                prim_path</span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>prim_path</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>                name</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>dish_name</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                position</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>position</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>                orientation</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>orientation<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span>
</span></span><span><span>                scale</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>scale</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                color</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>color</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                mass</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>mass
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">elif</span><span> dish_type </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 0);">'cup'</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">or</=
span><span> dish_type </span><span class=3D"token token" style=3D"color: rg=
b(20, 24, 31);">=3D=3D</span><span> </span><span class=3D"token token" styl=
e=3D"color: rgb(0, 128, 0);">'mug'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Tall cylinder</span><span>
</span></span><span><span>            scale </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.04</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.04</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.08=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an>
</span></span><span><span>            mass </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0.2</span><span>
</span></span><span><span>            dish </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> DynamicCuboid</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                prim_path</span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>prim_path</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>                name</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>dish_name</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                position</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>position</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>                orientation</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>orientation<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span>
</span></span><span><span>                scale</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>scale</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                color</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>color</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                mass</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>mass
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">elif</span><span> dish_type </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 0);">'glass'</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Thin tall cylinder</span><span>
</span></span><span><span>            scale </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.035</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.035</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.=
12</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span>
</span></span><span><span>            mass </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0.15</span><span>
</span></span><span><span>            dish </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> DynamicCuboid</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                prim_path</span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>prim_path</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>                name</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>dish_name</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                position</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>position</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>                orientation</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>orientation<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span>
</span></span><span><span>                scale</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>scale</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                color</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>color</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                mass</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>mass
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">elif</span><span> dish_type </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 0);">'utensil'</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Small elongated</span><span>
</span></span><span><span>            scale </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.02</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.15</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.01=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an>
</span></span><span><span>            mass </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0.05</span><span>
</span></span><span><span>            dish </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> DynamicCuboid</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                prim_path</span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>prim_path</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>                name</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>dish_name</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                position</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>position</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>                orientation</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>orientation<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span>
</span></span><span><span>                scale</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>scale</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                color</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>color</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                mass</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>mass
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Generic</span><span>
</span></span><span><span>            scale </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.08</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.08</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.04=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an>
</span></span><span><span>            mass </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0.2</span><span>
</span></span><span><span>            dish </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> DynamicCuboid</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                prim_path</span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>prim_path</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>                name</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>dish_name</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                position</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>position</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>                orientation</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>orientation<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span>
</span></span><span><span>                scale</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>scale</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                color</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>color</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                mass</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>mass
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>scene</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>add</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>dish</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>dishes</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'prim_path'</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> prim_path</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'name'</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> dish_name</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'type'</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> dish_type</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'object'</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> dish
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>dish_counter </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">get_camera_observation</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&gt;</span><sp=
an> Tuple</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">[</span><span>np</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">.</span><span>ndarray</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> np</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Capture RGBD from camera
</span><span>       =20
</span><span>        Returns:
</span><span>            rgb: (H, W, 3) uint8 RGB image
</span><span>            depth: (H, W) float32 depth in meters
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Ensure camera is initialized</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">not</span><span> self</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>camer=
a</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>is_initialized</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">:</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>camera</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>initialize=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Get RGB</span><span>
</span></span><span><span>        rgba </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>camera</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>get_rgba</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span><span>        rgb </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>rgba</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">255</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>astype</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span>np</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">.</span><span>uint8</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Get depth</span><span>
</span></span><span><span>        depth </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>camera</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>get_distance_to_image_plane</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> rgb</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> depth
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">execute_grasp</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        grasp_pose</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>        target_dish_name</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> Optional</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span =
class=3D"token token" style=3D"color: rgb(179, 74, 0);">str</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">N=
one</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span>
</span></span><span><span>        check_success</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
True</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">bool</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Execute a grasp in simulation to test if it suc=
ceeds
</span><span>       =20
</span><span>        Args:
</span><span>            grasp_pose: [x, y, z, qw, qx, qy, qz, width]
</span><span>            target_dish_name: Name of dish to grasp (for valid=
ation)
</span><span>            check_success: Whether to check if grasp succeeded
</span><span>           =20
</span><span>        Returns:
</span><span>            True if grasp succeeded, False otherwise
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># This is a simplified simulation of grasp executio=
n</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># In full implementation, you'd use a robot=
 arm simulation</span><span>
</span></span><span>       =20
</span><span><span>        position </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp_pose</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">3</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        gripper_width </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp_pose</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">7</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Find dishes within gripper range</span><span>
</span></span><span><span>        grasped_dishes </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> dish_info </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> self</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>dishes</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">:</span><span>
</span></span><span><span>            dish_obj </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> dish_info</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 0);">'object'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>            dish_pos</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span> _ </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> dish_ob=
j</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>get_world_pose</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Check if dish is within gripper</span><span>
</span></span><span><span>            dist </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>linalg</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>norm</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">(</span><span>dish_pos </span><span class=3D"token token" style=3D"color:=
 rgb(20, 24, 31);">-</span><span> position</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">if</span><span> dist </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> gripper_width </=
span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</=
span><span>
</span></span><span><span>                grasped_dishes</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>append</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan>dish_info</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Success if we grasped exactly one dish</span><spa=
n>
</span></span><span><span>        success </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">(</span><span>grasped_dishes</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D=3D</span><span> </span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">1</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Additional validation if target specified</span><=
span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> target_dish_name </span><span=
 class=3D"token token" style=3D"color: rgb(129, 0, 194);">and</span><span> =
success</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>:</span><span>
</span></span><span><span>            success </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasped_dishes</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 0);">'name'</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> t=
arget_dish_name
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> success
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">reset</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Reset environment and cl=
ear all dishes"""</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Remove all dishes</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> dish_info </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> self</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>dishes</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">:</span><span>
</span></span><span><span>            prim_path </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> dish_info</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 0);">'prim_path'</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> self</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>world</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>s=
cene</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.<=
/span><span>object_exists</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">(</span><span>dish_info</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 0);">'name'</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                self</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>scene</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>remove_object</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">(</span><span>dish_info</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">'name'</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>dishes </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>reset</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">close</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Clean shutdown"""</span>=
<span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"Closing Isaac Sim..."</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>simulation_app</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>close</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">get_ground_truth_labels</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </=
span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&gt;</span><s=
pan> List</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">[</span><span>Dict</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Get ground truth dish positions and properties
</span><span>        Useful for supervised training
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        labels </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">for</span><span> dish_info </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">in</span><span> self</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>dis=
hes</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</=
span><span>
</span></span><span><span>            dish_obj </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> dish_info</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 0);">'object'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>            position</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span> orientation </span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><spa=
n> dish_obj</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">.</span><span>get_world_pose</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Convert quaternion [w,x,y,z] to [qw,qx,qy,qz]=
</span><span>
</span></span><span><span>            quat </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> orientation  </span><=
span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Already i=
n [w,x,y,z] format</span><span>
</span></span><span>           =20
</span><span><span>            labels</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'name'</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> dish_info</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">'name'</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'type'</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> dish_info</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">'type'</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> position</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> quat</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'prim_path'</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span> dish_info</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 0);">'prim_path'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> labels</span></span></code></pre>=
</div></div>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">9. Trainin=
g Dataset</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># trainin=
g/dataset.py</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">import</span><span> torch
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> torch</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>utils</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>data </spa=
n><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">import</sp=
an><span> Dataset
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> numpy </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> typing </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">import</span><span> Dict</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> L=
ist</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span> Optional
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> pickle
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> os
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> pathlib </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">import</span><span> Path
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">SyntheticGraspDataset</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">(</span><span>Dataset</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Dataset of synthetic grasp attempts from Isaac Sim
</span><span>   =20
</span><span>    Each sample contains:
</span><span>    - RGBD image
</span><span>    - Grasp pose
</span><span>    - Success label (0 or 1)
</span><span>    - Metadata (dish types, scene complexity, etc.)
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        data_dir</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(179, 74, 0);">str</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        mode</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">str</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'train'</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n>
</span></span><span><span>        transform</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 128);">None</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        augment</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </=
span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">True</s=
pan><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Args:
</span><span>            data_dir: Directory containing dataset
</span><span>            mode: 'train', 'val', or 'test'
</span><span>            transform: Optional transforms to apply
</span><span>            augment: Whether to apply data augmentation
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>data_dir </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Path</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>data=
_dir</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>mode </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> mode
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>transform </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> transfo=
rm
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>augment </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> augment </=
span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">and</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span>mode </span><span class=3D"token token" style=3D"color: r=
gb(20, 24, 31);">=3D=3D</span><span> </span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 0);">'train'</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Load index</span><span>
</span></span><span><span>        index_file </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>data_di=
r </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</s=
pan><span> </span><span class=3D"token token string-interpolation" style=3D=
"color: rgb(0, 128, 0);">f"</span><span class=3D"token token string-interpo=
lation interpolation" style=3D"color: rgb(43, 48, 59);">{</span><span class=
=3D"token token string-interpolation interpolation">mode</span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">}</span><span class=3D"token token string-interpolation" style=
=3D"color: rgb(0, 128, 0);">_index.pkl"</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">not</span><span> index_file</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>exists</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><=
span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">raise</span><span> FileNotFoundError</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n class=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0)=
;">f"Dataset index not found: </span><span class=3D"token token string-inte=
rpolation interpolation" style=3D"color: rgb(43, 48, 59);">{</span><span cl=
ass=3D"token token string-interpolation interpolation">index_file</span><sp=
an class=3D"token token string-interpolation interpolation" style=3D"color:=
 rgb(43, 48, 59);">}</span><span class=3D"token token string-interpolation"=
 style=3D"color: rgb(0, 128, 0);">"</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">with</span><span> </span><span class=3D"token token" =
style=3D"color: rgb(179, 74, 0);">open</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span>index_file</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 0);">'rb'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">as</span=
><span> f</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">:</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>samples </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> pickle=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</spa=
n><span>load</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">(</span><span>f</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpolatio=
n" style=3D"color: rgb(0, 128, 0);">f"Loaded </span><span class=3D"token to=
ken string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">{=
</span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(179, 74, 0);">len</span><span class=3D"token token string-in=
terpolation interpolation" style=3D"color: rgb(43, 48, 59);">(</span><span =
class=3D"token token string-interpolation interpolation">self</span><span c=
lass=3D"token token string-interpolation interpolation" style=3D"color: rgb=
(43, 48, 59);">.</span><span class=3D"token token string-interpolation inte=
rpolation">samples</span><span class=3D"token token string-interpolation in=
terpolation" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token=
 token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);=
">}</span><span class=3D"token token string-interpolation" style=3D"color: =
rgb(0, 128, 0);"> samples for </span><span class=3D"token token string-inte=
rpolation interpolation" style=3D"color: rgb(43, 48, 59);">{</span><span cl=
ass=3D"token token string-interpolation interpolation">mode</span><span cla=
ss=3D"token token string-interpolation interpolation" style=3D"color: rgb(4=
3, 48, 59);">}</span><span class=3D"token token string-interpolation" style=
=3D"color: rgb(0, 128, 0);">"</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__len__</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>samples<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__getitem__</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> idx</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> </=
span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">int</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-<=
/span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&gt;</s=
pan><span> Dict</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Get a single sample
</span><span>       =20
</span><span>        Returns:
</span><span>            Dictionary with:
</span><span>            - rgbd: [4, H, W] tensor
</span><span>            - grasp_pose: [8] tensor
</span><span>            - success: [1] tensor (0 or 1)
</span><span>            - metadata: dict
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        sample_info </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>samples</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><spa=
n>idx</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]=
</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Load RGBD image</span><span>
</span></span><span><span>        rgbd_path </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>data_dir=
 </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</sp=
an><span> sample_info</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 1=
28, 0);">'rgbd_path'</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">]</span><span>
</span></span><span><span>        rgbd </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>load</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>rgb=
d_path</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span>  </span><span class=3D"token token" style=3D"color: rgb(110,=
 118, 135);"># Shape: [H, W, 4]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Load grasp pose</span><span>
</span></span><span><span>        grasp_pose </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan>sample_info</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0)=
;">'grasp_pose'</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">,</span><span> dtype</span><span class=3D"token token" style=3D"color: =
rgb(20, 24, 31);">=3D</span><span>np</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">.</span><span>float32</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span>  </span><span c=
lass=3D"token token" style=3D"color: rgb(110, 118, 135);"># [8]</span><span=
>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Load label</span><span>
</span></span><span><span>        success </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">float</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>sample_info</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 0);">'success'</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>  </=
span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># 0 o=
r 1</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Metadata</span><span>
</span></span><span><span>        metadata </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> sample_info</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ge=
t</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'metadata'<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">{</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">}</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Data augmentation</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>augment</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            rgbd</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> grasp_pose </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> se=
lf</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</s=
pan><span>_augment</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">(</span><span>rgbd</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">,</span><span> grasp_pose</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Normalize</span><span>
</span></span><span><span>        rgbd </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_normalize</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><=
span>rgbd</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Convert to tensors</span><span>
</span></span><span><span>        rgbd_tensor </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from_=
numpy</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span>rgbd</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">.</span><span>permute</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 128);">2</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"colo=
r: rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">.</span><span class=3D"token token" style=3D"color: rgb(17=
9, 74, 0);">float</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span>  </span><span class=3D"token token" style=3D"color: rg=
b(110, 118, 135);"># [4, H, W]</span><span>
</span></span><span><span>        grasp_tensor </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from=
_numpy</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>grasp_pose</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">.</span><span class=3D"token token" style=3D"color: rgb(179, 7=
4, 0);">float</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">)</span><span>
</span></span><span><span>        success_tensor </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> torch</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>te=
nsor</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span=
><span>success</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">,</span><span> dtype</span><span class=3D"token token" style=3D"color: r=
gb(20, 24, 31);">=3D</span><span>torch</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>float32</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'rgbd'</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span> rgbd_tensor</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'grasp_pose'</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> grasp_tensor</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'success'</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> success_tensor</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'metadata'</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> metadata
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_normalize</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> rgbd</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> np=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</spa=
n><span>ndarray</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span> </span><span class=3D"token token" style=3D"color: =
rgb(20, 24, 31);">-</span><span class=3D"token token" style=3D"color: rgb(2=
0, 24, 31);">&gt;</span><span> np</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Normalize RGBD image"""<=
/span><span>
</span></span><span>       =20
</span><span><span>        rgbd </span><span class=3D"token token" style=3D=
"color: rgb(20, 24, 31);">=3D</span><span> rgbd</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>copy</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># RGB: [0, 255] -&gt; [0, 1]</span><span>
</span></span><span><span>        rgbd</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">3</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rgbd</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">255.0</sp=
an><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Depth: already in meters, clip to reasonable rang=
e</span><span>
</span></span><span><span>        rgbd</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">3</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>clip<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span>rgbd</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">[</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 128);">3</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0=
, 128, 128);">2.0</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span>
</span></span><span><span>        rgbd</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">3</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rgbd</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>2.0</span><span>  </span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Normalize to [0, 1]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> rgbd
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_augment</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        rgbd</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        grasp_pose</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">tuple</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Apply data augmentation
</span><span>       =20
</span><span>        Augmentations:
</span><span>        - Random brightness/contrast (RGB only)
</span><span>        - Random noise
</span><span>        - Random rotation around Z-axis
</span><span>        - Random small translations
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        rgbd </span><span class=3D"token token" style=3D=
"color: rgb(20, 24, 31);">=3D</span><span> rgbd</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>copy</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        grasp_pose </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp_pose</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>c=
opy</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># RGB augmentation: brightness and contrast</span><=
span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> np</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>rand<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt=
;</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">0.5</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">:</span><span>
</span></span><span><span>            brightness </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>rando=
m</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>uniform</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">0.8</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0,=
 128, 128);">1.2</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span>
</span></span><span><span>            contrast </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span=
><span>uniform</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128=
);">0.8</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 1=
28, 128);">1.2</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">)</span><span>
</span></span><span><span>            rgbd</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 128);">3</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>clip</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>rgbd</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>[</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">:</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
3</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">*</span><span> contrast </span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">+</span><span> brightness </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">*</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">10</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">255</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Add small random noise to depth</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> np</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>rand<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt=
;</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">0.3</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">:</span><span>
</span></span><span><span>            noise </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>randn</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*<=
/span><span>rgbd</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> </span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0=
, 128, 128);">3</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>shape</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">)</span><span> </span><span class=3D"token token" style=3D=
"color: rgb(20, 24, 31);">*</span><span> </span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 128);">0.01</span><span>  </span><span class=
=3D"token token" style=3D"color: rgb(110, 118, 135);"># 1cm std</span><span=
>
</span></span><span><span>            rgbd</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 128);">3</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> noise
</span></span><span><span>            rgbd</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 128);">3</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>clip=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>rgbd</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">[</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">3</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">2.0</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Random rotation around Z-axis</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> np</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>rand<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt=
;</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">0.5</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">:</span><span>
</span></span><span><span>            angle </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>uniform</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">(</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
-</span><span>np</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">.</span><span>pi</span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">/</span><span class=3D"token token" style=3D"color: rgb=
(0, 128, 128);">6</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span> np</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">.</span><span>pi</span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">/</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">6</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>  </span><span class=3D"token token"=
 style=3D"color: rgb(110, 118, 135);"># =C2=B130 degrees</span><span>
</span></span><span><span>            rgbd</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> grasp_pose </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> se=
lf</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</s=
pan><span>_rotate_augment</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">(</span><span>rgbd</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span> grasp_pose</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> angle</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> rgbd</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span> grasp_pose
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_rotate_augment</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        rgbd</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        grasp_pose</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>        angle</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(179, 74, 0);">float</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">tuple</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Rotate image and adjust grasp pose accordingly
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">import</span><span> cv2
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">from</span><span> scipy</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>spatial</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>transform </span><span class=3D"token token" style=3D"color: rgb(129, 0, 1=
94);">import</span><span> Rotation
</span></span><span>       =20
</span><span><span>        h</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">,</span><span> w </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> rgbd</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>shape</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Rotation matrix for image</span><span>
</span></span><span><span>        M </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> cv2</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>getRotationMatrix=
2D</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><=
span>w</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
/</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> h</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);"=
>/</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
> np</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.<=
/span><span>degrees</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">(</span><span>angle</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" styl=
e=3D"color: rgb(0, 128, 128);">1.0</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Rotate each channel</span><span>
</span></span><span><span>        rgbd_rotated </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>zeros_l=
ike</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span>rgbd</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> c </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">4</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            rgbd_rotated</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span> c</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> c=
v2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</s=
pan><span>warpAffine</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">(</span><span>
</span></span><span><span>                rgbd</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> c</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                M</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span>w</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> h</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                flags</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>cv2</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>INTER_L=
INEAR
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Adjust grasp pose</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Position: rotate x,y coordinates</span><s=
pan>
</span></span><span><span>        x</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> y</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> z </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp_p=
ose</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        cos_a </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>cos</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>ang=
le</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span>
</span></span><span><span>        sin_a </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>sin</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>ang=
le</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span>
</span></span><span><span>        x_rot </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> x </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">*</span><span> cos_a </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span=
> y </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*<=
/span><span> sin_a
</span></span><span><span>        y_rot </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> x </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">*</span><span> sin_a </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><span=
> y </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*<=
/span><span> cos_a
</span></span><span><span>        grasp_pose</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">3</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">[</span><span>x_rot</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> y_=
rot</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span> z</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Orientation: compose with Z-rotation</span><span>
</span></span><span><span>        qw</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span> qx</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> qy</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> qz </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><=
span> grasp_pose</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">3</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>:</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">7</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span>=
<span>
</span></span><span><span>        rot_original </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Rotation</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>f=
rom_quat</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</=
span><span>qx</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span> qy</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">,</span><span> qz</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> qw</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        rot_z </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> Rotation</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from_eul=
er</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'z'</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
> angle</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>)</span><span>
</span></span><span><span>        rot_new </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rot_z </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span> rot_ori=
ginal
</span></span><span><span>        quat_new </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rot_new</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>as_qua=
t</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135)=
;"># [qx, qy, qz, qw]</span><span>
</span></span><span><span>        grasp_pose</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">3</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 128);">7</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">[</span><span>quat_new</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> quat_new</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> quat_new</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> quat_new<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> rgbd_rotated</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> grasp_pose
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">def</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 81, 194);">generate_dataset_from_simulation</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>    isaac_env</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>    output_dir</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(179, 74, 0);">str</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>    num_samples</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(179, 74, 0);">int</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">10000</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>    samples_per_scene</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">int</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1=
0</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Generate training dataset from Isaac Sim
</span><span>   =20
</span><span>    Args:
</span><span>        isaac_env: VirtualSinkEnvironment instance
</span><span>        output_dir: Where to save dataset
</span><span>        num_samples: Total number of samples to generate
</span><span>        samples_per_scene: Number of grasp attempts per scene
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    output_path </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> Path</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">(</span><span>output_dir</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
>
</span></span><span><span>    output_path</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">.</span><span>mkdir</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>parents</span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">True</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> e=
xist_ok</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);"=
>=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">T=
rue</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Create subdirectories</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span>output_path </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">/</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 0);">'rgbd'</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>mkdir</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>e=
xist_ok</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);"=
>=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">T=
rue</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span>
</span></span><span>   =20
</span><span><span>    samples </span><span class=3D"token token" style=3D"=
color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>    sample_idx </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0</span><span>
</span></span><span>   =20
</span><span><span>    num_scenes </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> num_samples </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">//</span><span> samples=
_per_scene
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">print</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">(</span><span class=3D"token token string-interpolation" s=
tyle=3D"color: rgb(0, 128, 0);">f"Generating </span><span class=3D"token to=
ken string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">{=
</span><span class=3D"token token string-interpolation interpolation">num_s=
amples</span><span class=3D"token token string-interpolation interpolation"=
 style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token strin=
g-interpolation" style=3D"color: rgb(0, 128, 0);"> samples from </span><spa=
n class=3D"token token string-interpolation interpolation" style=3D"color: =
rgb(43, 48, 59);">{</span><span class=3D"token token string-interpolation i=
nterpolation">num_scenes</span><span class=3D"token token string-interpolat=
ion interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D=
"token token string-interpolation" style=3D"color: rgb(0, 128, 0);"> scenes=
..."</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">for</span><span> scene_idx </span><span class=3D"token to=
ken" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>num_scenes=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><sp=
an>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> scene_idx </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">%</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">10</span><span=
> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=
=3D</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, =
128, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-i=
nterpolation" style=3D"color: rgb(0, 128, 0);">f"  Scene </span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">{</span><span class=3D"token token string-interpolation interpol=
ation">scene_idx</span><span class=3D"token token string-interpolation inte=
rpolation" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token t=
oken string-interpolation" style=3D"color: rgb(0, 128, 0);">/</span><span c=
lass=3D"token token string-interpolation interpolation" style=3D"color: rgb=
(43, 48, 59);">{</span><span class=3D"token token string-interpolation inte=
rpolation">num_scenes</span><span class=3D"token token string-interpolation=
 interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"to=
ken token string-interpolation" style=3D"color: rgb(0, 128, 0);">"</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Reset and create new random scene</span><span>
</span></span><span><span>        isaac_env</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>reset</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        isaac_env</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>spawn_random_dishes</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>num_dishes</span><span class=3D"token token" style=3D"color: rgb(20, 24,=
 31);">=3D</span><span>np</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">.</span><span>random</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">.</span><span>randint</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">3</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">8</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Let physics settle</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> _ </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">30</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            isaac_env</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>step</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><=
span>render</span><span class=3D"token token" style=3D"color: rgb(20, 24, 3=
1);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128)=
;">False</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Capture observation</span><span>
</span></span><span><span>        rgb</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span> depth </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> isaac_env</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>get_camera_observation</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Stack RGBD</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> depth</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndim </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span=
><span>
</span></span><span><span>            depth </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> depth</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">None</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        rgbd </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>concatenate</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>r=
gb</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> depth</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> axis</span><span class=3D"token token" style=3D"color: =
rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb=
(20, 24, 31);">-</span><span class=3D"token token" style=3D"color: rgb(0, 1=
28, 128);">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Get ground truth labels</span><span>
</span></span><span><span>        gt_labels </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> isaac_env</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>get=
_ground_truth_labels</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Generate multiple grasp attempts for this scene</=
span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> grasp_idx </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>=
samples_per_scene</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Generate random grasp</span><span>
</span></span><span><span>            grasp_pose </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> _sample_random_=
grasp</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Test grasp in simulation</span><span>
</span></span><span><span>            success </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> isaac_env</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>e=
xecute_grasp</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">(</span><span>grasp_pose</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Save RGBD</span><span>
</span></span><span><span>            rgbd_filename </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span=
 class=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);=
">f"rgbd_</span><span class=3D"token token string-interpolation interpolati=
on" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token st=
ring-interpolation interpolation">sample_idx</span><span class=3D"token tok=
en string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">:<=
/span><span class=3D"token token string-interpolation interpolation format-=
spec">06d</span><span class=3D"token token string-interpolation interpolati=
on" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token st=
ring-interpolation" style=3D"color: rgb(0, 128, 0);">.npy"</span><span>
</span></span><span><span>            rgbd_path </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> output_path </sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'r=
gbd'</span><span> </span><span class=3D"token token" style=3D"color: rgb(20=
, 24, 31);">/</span><span> rgbd_filename
</span></span><span><span>            np</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>save</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>rgbd_path</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n> rgbd</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Store sample info</span><span>
</span></span><span><span>            samples</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'rgbd_path'</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">str</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>Path</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 0);">'rgbd'</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><spa=
n> rgbd_filename</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'grasp_pose'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> grasp_pose</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>t=
olist</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'success'</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">int</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">(</span><span>success</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'metadata'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'scene_idx'</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> scene_idx</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'num_dishes'</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">len</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>gt_labels<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">'dish_types'</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>d</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 0);">'type'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">for</spa=
n><span> d </span><span class=3D"token token" style=3D"color: rgb(129, 0, 1=
94);">in</span><span> gt_labels</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            sample_idx </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">1</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Split into train/val/test</span><span>
</span></span><span><span>    np</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">.</span><span>random</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>shuffle</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>sample=
s</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span>
</span></span><span>   =20
</span><span><span>    n_train </span><span class=3D"token token" style=3D"=
color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(179, 74, 0);">int</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">0.8</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">*</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>samples</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    n_val </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">int</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">0.1</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">*</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">len</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>samples</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    train_samples </span><span class=3D"token token" sty=
le=3D"color: rgb(20, 24, 31);">=3D</span><span> samples</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span>n_train</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>    val_samples </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> samples</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>n_train=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span>n_train</span><span class=3D"token token" style=3D"color: rgb(20, 2=
4, 31);">+</span><span>n_val</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>    test_samples </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> samples</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>n_trai=
n</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</sp=
an><span>n_val</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">:</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">]</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Save indices</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">with</span><span> </span><span class=3D"token toke=
n" style=3D"color: rgb(179, 74, 0);">open</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>output_path </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'train_index=
.pkl'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 0);">'wb'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">)</span><span> </span><span class=3D"token token" style=3D"color: rgb(=
129, 0, 194);">as</span><span> f</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        pickle</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>dump</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>train_samples</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> f</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">with</span><span> </span><span class=3D"token token" styl=
e=3D"color: rgb(179, 74, 0);">open</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>output_path </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 0);">'val_index.pkl'<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);"=
>'wb'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(129, 0=
, 194);">as</span><span> f</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        pickle</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>dump</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>val_samples</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan> f</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">with</span><span> </span><span class=3D"token token" styl=
e=3D"color: rgb(179, 74, 0);">open</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>output_path </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 0);">'test_index.pkl'=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</spa=
n><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);=
">'wb'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span> </span><span class=3D"token token" style=3D"color: rgb(129, =
0, 194);">as</span><span> f</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        pickle</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>dump</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>test_samples</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> f</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">print</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">(</span><span class=3D"token token string-interpolation" s=
tyle=3D"color: rgb(0, 128, 0);">f"Dataset generated:"</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpola=
tion" style=3D"color: rgb(0, 128, 0);">f"  Train: </span><span class=3D"tok=
en token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59=
);">{</span><span class=3D"token token string-interpolation interpolation" =
style=3D"color: rgb(179, 74, 0);">len</span><span class=3D"token token stri=
ng-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">(</span><=
span class=3D"token token string-interpolation interpolation">train_samples=
</span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token string-inte=
rpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span cl=
ass=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">"=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpola=
tion" style=3D"color: rgb(0, 128, 0);">f"  Val: </span><span class=3D"token=
 token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);=
">{</span><span class=3D"token token string-interpolation interpolation" st=
yle=3D"color: rgb(179, 74, 0);">len</span><span class=3D"token token string=
-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token string-interpolation interpolation">val_samples</sp=
an><span class=3D"token token string-interpolation interpolation" style=3D"=
color: rgb(43, 48, 59);">)</span><span class=3D"token token string-interpol=
ation interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span class=
=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">"</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpola=
tion" style=3D"color: rgb(0, 128, 0);">f"  Test: </span><span class=3D"toke=
n token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59)=
;">{</span><span class=3D"token token string-interpolation interpolation" s=
tyle=3D"color: rgb(179, 74, 0);">len</span><span class=3D"token token strin=
g-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token string-interpolation interpolation">test_samples</=
span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token string-inte=
rpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span cl=
ass=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">"=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpola=
tion" style=3D"color: rgb(0, 128, 0);">f"  Saved to: </span><span class=3D"=
token token string-interpolation interpolation" style=3D"color: rgb(43, 48,=
 59);">{</span><span class=3D"token token string-interpolation interpolatio=
n">output_path</span><span class=3D"token token string-interpolation interp=
olation" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token tok=
en string-interpolation" style=3D"color: rgb(0, 128, 0);">"</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">def</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 81, 194);">_sample_random_grasp</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">)</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">&gt;</span><span> np</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span>=
<span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""Generate random grasp pose f=
or training"""</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">from</span><span> scipy</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">.</span><span>spatial</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>transform =
</span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">impor=
t</span><span> Rotation
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Random position in sink</span><span>
</span></span><span><span>    x </span><span class=3D"token token" style=3D=
"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>uniform<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n>
</span></span><span><span>    y </span><span class=3D"token token" style=3D=
"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>uniform<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><spa=
n>
</span></span><span><span>    z </span><span class=3D"token token" style=3D=
"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>uniform<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.05</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.2=
5</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Random orientation</span><span>
</span></span><span><span>    rot </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> Rotation</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    quat </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> rot</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>as_quat</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>  </span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># [qx, qy=
, qz, qw]</span><span>
</span></span><span><span>    quat </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>quat</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> quat</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> quat</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> quat</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>  </span><span =
class=3D"token token" style=3D"color: rgb(110, 118, 135);"># [qw, qx, qy, q=
z]</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Random gripper width</span><span>
</span></span><span><span>    width </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>random</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>unif=
orm</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.02</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>0.08</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">return</span><span> np</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>array</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">[</span><span>x</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> y</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 z</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> quat</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128, 12=
8);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span> quat</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128=
);">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</spa=
n><span> quat</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128)=
;">2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span> quat</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">3</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> width</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>)</span></span></code></pre></div></div>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">10. Traini=
ng Pipeline</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># trainin=
g/train_grasp_predictor.py</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">import</span><span> torch
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> torch</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>nn </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">as</span><span> nn
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> torch</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>utils</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>data </spa=
n><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">import</sp=
an><span> DataLoader
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> torch</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>optim </span><span clas=
s=3D"token token" style=3D"color: rgb(129, 0, 194);">import</span><span> Ad=
amW
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> torch</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>optim</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>lr_schedul=
er </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">im=
port</span><span> CosineAnnealingLR
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> numpy </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> pathlib </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">import</span><span> Path
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> json
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> tqdm </span><span class=3D"token tok=
en" style=3D"color: rgb(129, 0, 194);">import</span><span> tqdm
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> wandb  </span><span class=3D"token=
 token" style=3D"color: rgb(110, 118, 135);"># Optional: for experiment tra=
cking</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">from</span><span> </span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">.</span><span>dataset </span><span class=3D"token=
 token" style=3D"color: rgb(129, 0, 194);">import</span><span> SyntheticGra=
spDataset
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> grasp_planning</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>grasp_predicto=
r </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">imp=
ort</span><span> GraspSuccessPredictor
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">GraspPredictorTrainer</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Training pipeline for grasp success predictor
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        data_dir</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(179, 74, 0);">str</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        output_dir</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">str</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        batch_size</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">int</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">16</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>        learning_rate</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">float</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>1e-4</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,=
</span><span>
</span></span><span><span>        num_epochs</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">int</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">50</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>        device</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(179, 74, 0);">str</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'cuda'</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>        use_wandb</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">False=
</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Initialize trainer
</span><span>       =20
</span><span>        Args:
</span><span>            data_dir: Directory containing dataset
</span><span>            output_dir: Where to save checkpoints
</span><span>            batch_size: Batch size for training
</span><span>            learning_rate: Initial learning rate
</span><span>            num_epochs: Number of training epochs
</span><span>            device: 'cuda' or 'cpu'
</span><span>            use_wandb: Whether to use Weights &amp; Biases log=
ging
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>data_dir </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> data_dir
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>output_dir </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Path</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><=
span>output_dir</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>output_dir</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>mkdir</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>parents</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">True</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> exist_ok</span><span class=3D"token token" style=3D"color: r=
gb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">True</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>batch_size </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> batch_size
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>learning_rate </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> lear=
ning_rate
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>num_epochs </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> num_epo=
chs
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>device </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> device
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>use_wandb </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> use_wan=
db
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Initialize model</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"Initializing model..."</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>model </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> GraspSuccess=
Predictor</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span>use_pretrained_vision</span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">True</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>model </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
model</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.=
</span><span>to</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span>device</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Print model size</span><span>
</span></span><span><span>        num_params </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">sum</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>p</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>nume=
l</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">=
for</span><span> p </span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">in</span><span> self</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>model</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>parameters</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        num_trainable </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(179, 74, 0);">sum</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>p</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>n=
umel</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194)=
;">for</span><span> p </span><span class=3D"token token" style=3D"color: rg=
b(129, 0, 194);">in</span><span> self</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">.</span><span>model</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>parameters</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">if</span=
><span> p</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">.</span><span>requires_grad</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  Total parameters: </span><s=
pan class=3D"token token string-interpolation interpolation" style=3D"color=
: rgb(43, 48, 59);">{</span><span class=3D"token token string-interpolation=
 interpolation">num_params</span><span class=3D"token token string-interpol=
ation interpolation" style=3D"color: rgb(43, 48, 59);">:</span><span class=
=3D"token token string-interpolation interpolation format-spec">,</span><sp=
an class=3D"token token string-interpolation interpolation" style=3D"color:=
 rgb(43, 48, 59);">}</span><span class=3D"token token string-interpolation"=
 style=3D"color: rgb(0, 128, 0);">"</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  Trainable parameters: </spa=
n><span class=3D"token token string-interpolation interpolation" style=3D"c=
olor: rgb(43, 48, 59);">{</span><span class=3D"token token string-interpola=
tion interpolation">num_trainable</span><span class=3D"token token string-i=
nterpolation interpolation" style=3D"color: rgb(43, 48, 59);">:</span><span=
 class=3D"token token string-interpolation interpolation format-spec">,</sp=
an><span class=3D"token token string-interpolation interpolation" style=3D"=
color: rgb(43, 48, 59);">}</span><span class=3D"token token string-interpol=
ation" style=3D"color: rgb(0, 128, 0);">"</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Initialize datasets</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"Loading datasets..."</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>train_dataset </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Synt=
heticGraspDataset</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span>
</span></span><span><span>            data_dir</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span> mode</span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'train'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> augment</=
span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">True</span=
><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>val_dataset </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Synthe=
ticGraspDataset</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span>
</span></span><span><span>            data_dir</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span> mode</span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'val'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> augment</=
span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">False</spa=
n><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>train_loader </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> DataLoader</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>train_dataset</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            batch_size</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>batch_size</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>            shuffle</span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">True</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            num_workers</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">4</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            pin_memory</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>val_loader </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> DataLoader</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>val_dataset</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            batch_size</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>batch_size</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>            shuffle</span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">False</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            num_workers</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">4</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            pin_memory</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Optimizer and scheduler</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>optimizer </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> AdamW</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span>=
<span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>model</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>parameters=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            lr</span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span>learning_rate</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            weight_decay</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 128);">0.01</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>scheduler </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> CosineAnnealing=
LR</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>optimizer</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            T_max</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>num_epochs</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            eta_min</span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>learning_rate </span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.=
01</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Loss function</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>criterion </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> nn</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>BCELoss</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Tracking</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>best_val_acc </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.0</span>=
<span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>train_losses </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>val_losses </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>val_accuracies </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Initialize wandb if requested</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> use_wandb</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            wandb</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>init</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                project</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"dishwashing-robot"</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                config</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"batch_size"</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span> batch_size</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"learning_rate"</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> learning_rat=
e</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"num_epochs"</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span> num_epochs</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"model"</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">"GraspSuccessPredictor"</=
span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">train</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Main training loop"""</s=
pan><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpolatio=
n" style=3D"color: rgb(0, 128, 0);">f"\nStarting training for </span><span =
class=3D"token token string-interpolation interpolation" style=3D"color: rg=
b(43, 48, 59);">{</span><span class=3D"token token string-interpolation int=
erpolation">self</span><span class=3D"token token string-interpolation inte=
rpolation" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token t=
oken string-interpolation interpolation">num_epochs</span><span class=3D"to=
ken token string-interpolation interpolation" style=3D"color: rgb(43, 48, 5=
9);">}</span><span class=3D"token token string-interpolation" style=3D"colo=
r: rgb(0, 128, 0);"> epochs..."</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  Training samples: </span><s=
pan class=3D"token token string-interpolation interpolation" style=3D"color=
: rgb(43, 48, 59);">{</span><span class=3D"token token string-interpolation=
 interpolation" style=3D"color: rgb(179, 74, 0);">len</span><span class=3D"=
token token string-interpolation interpolation" style=3D"color: rgb(43, 48,=
 59);">(</span><span class=3D"token token string-interpolation interpolatio=
n">self</span><span class=3D"token token string-interpolation interpolation=
" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token token stri=
ng-interpolation interpolation">train_dataset</span><span class=3D"token to=
ken string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">)=
</span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">"</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  Validation samples: </span>=
<span class=3D"token token string-interpolation interpolation" style=3D"col=
or: rgb(43, 48, 59);">{</span><span class=3D"token token string-interpolati=
on interpolation" style=3D"color: rgb(179, 74, 0);">len</span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">(</span><span class=3D"token token string-interpolation interpol=
ation">self</span><span class=3D"token token string-interpolation interpola=
tion" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token token =
string-interpolation interpolation">val_dataset</span><span class=3D"token =
token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);"=
>)</span><span class=3D"token token string-interpolation interpolation" sty=
le=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token string-in=
terpolation" style=3D"color: rgb(0, 128, 0);">"</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  Batch size: </span><span cl=
ass=3D"token token string-interpolation interpolation" style=3D"color: rgb(=
43, 48, 59);">{</span><span class=3D"token token string-interpolation inter=
polation">self</span><span class=3D"token token string-interpolation interp=
olation" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token tok=
en string-interpolation interpolation">batch_size</span><span class=3D"toke=
n token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59)=
;">}</span><span class=3D"token token string-interpolation" style=3D"color:=
 rgb(0, 128, 0);">"</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  Device: </span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">{</span><span class=3D"token token string-interpolation interpol=
ation">self</span><span class=3D"token token string-interpolation interpola=
tion" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token token =
string-interpolation interpolation">device</span><span class=3D"token token=
 string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</s=
pan><span class=3D"token token string-interpolation" style=3D"color: rgb(0,=
 128, 0);">"</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">for</span><span> epoch </span><span class=3D"token to=
ken" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>num_epochs</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-i=
nterpolation" style=3D"color: rgb(0, 128, 0);">f"Epoch </span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">{</span><span class=3D"token token string-interpolation interpol=
ation">epoch</span><span class=3D"token token string-interpolation interpol=
ation" style=3D"color: rgb(20, 24, 31);">+</span><span class=3D"token token=
 string-interpolation interpolation" style=3D"color: rgb(0, 128, 128);">1</=
span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">/</span><span class=3D"token to=
ken string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">{=
</span><span class=3D"token token string-interpolation interpolation">self<=
/span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token token string-inte=
rpolation interpolation">num_epochs</span><span class=3D"token token string=
-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</span><sp=
an class=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0=
);">"</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Train</span><span>
</span></span><span><span>            train_loss</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> train_acc </span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><spa=
n> self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>.</span><span>train_epoch</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Validate</span><span>
</span></span><span><span>            val_loss</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span> val_acc </span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> s=
elf</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>validate</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Update scheduler</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>scheduler</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>step</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Log</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>train_losses</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>appen=
d</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span>train_loss</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>val_losses</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>append<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span>val_loss</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>val_accuracies</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>app=
end</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span>val_acc</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpol=
ation" style=3D"color: rgb(0, 128, 0);">f"  Train Loss: </span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">{</span><span class=3D"token token string-interpolation interpol=
ation">train_loss</span><span class=3D"token token string-interpolation int=
erpolation" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token =
token string-interpolation interpolation format-spec">.4f</span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">}</span><span class=3D"token token string-interpolation" style=
=3D"color: rgb(0, 128, 0);">, Train Acc: </span><span class=3D"token token =
string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">{</sp=
an><span class=3D"token token string-interpolation interpolation">train_acc=
</span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token string-inte=
rpolation interpolation format-spec">.4f</span><span class=3D"token token s=
tring-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</spa=
n><span class=3D"token token string-interpolation" style=3D"color: rgb(0, 1=
28, 0);">"</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-i=
nterpolation" style=3D"color: rgb(0, 128, 0);">f"  Val Loss: </span><span c=
lass=3D"token token string-interpolation interpolation" style=3D"color: rgb=
(43, 48, 59);">{</span><span class=3D"token token string-interpolation inte=
rpolation">val_loss</span><span class=3D"token token string-interpolation i=
nterpolation" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"toke=
n token string-interpolation interpolation format-spec">.4f</span><span cla=
ss=3D"token token string-interpolation interpolation" style=3D"color: rgb(4=
3, 48, 59);">}</span><span class=3D"token token string-interpolation" style=
=3D"color: rgb(0, 128, 0);">, Val Acc: </span><span class=3D"token token st=
ring-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">{</span=
><span class=3D"token token string-interpolation interpolation">val_acc</sp=
an><span class=3D"token token string-interpolation interpolation" style=3D"=
color: rgb(43, 48, 59);">:</span><span class=3D"token token string-interpol=
ation interpolation format-spec">.4f</span><span class=3D"token token strin=
g-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</span><s=
pan class=3D"token token string-interpolation" style=3D"color: rgb(0, 128, =
0);">"</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-i=
nterpolation" style=3D"color: rgb(0, 128, 0);">f"  LR: </span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">{</span><span class=3D"token token string-interpolation interpol=
ation">self</span><span class=3D"token token string-interpolation interpola=
tion" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token token =
string-interpolation interpolation">optimizer</span><span class=3D"token to=
ken string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">.=
</span><span class=3D"token token string-interpolation interpolation">param=
_groups</span><span class=3D"token token string-interpolation interpolation=
" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token stri=
ng-interpolation interpolation" style=3D"color: rgb(0, 128, 128);">0</span>=
<span class=3D"token token string-interpolation interpolation" style=3D"col=
or: rgb(43, 48, 59);">]</span><span class=3D"token token string-interpolati=
on interpolation" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"=
token token string-interpolation interpolation" style=3D"color: rgb(0, 128,=
 0);">'lr'</span><span class=3D"token token string-interpolation interpolat=
ion" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token s=
tring-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span class=3D"token token string-interpolation interpolation format-spec=
">.2e</span><span class=3D"token token string-interpolation interpolation" =
style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token string=
-interpolation" style=3D"color: rgb(0, 128, 0);">"</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">if</span><span> self</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>use_wandb</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                wandb</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>log</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"epoch"</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span> epoch</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"train_loss"</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span> train_loss</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"train_acc"</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> train_acc</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"val_loss"</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> val_loss</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"val_acc"</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> val_acc</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                    </span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 0);">"lr"</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>optimizer<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span=
><span>param_groups</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[=
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'lr'</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Save checkpoint if best</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> val_acc </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">&gt;</span><span> self</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>best_val_acc</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">:</span><span>
</span></span><span><span>                self</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>best_val_acc </span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><spa=
n> val_acc
</span></span><span><span>                self</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>save_checkpoint</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n>epoch</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>,</span><span> is_best</span><span class=3D"token token" style=3D"color: r=
gb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">True</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token stri=
ng-interpolation" style=3D"color: rgb(0, 128, 0);">f"  =E2=9C=93 New best v=
alidation accuracy: </span><span class=3D"token token string-interpolation =
interpolation" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"tok=
en token string-interpolation interpolation">val_acc</span><span class=3D"t=
oken token string-interpolation interpolation" style=3D"color: rgb(43, 48, =
59);">:</span><span class=3D"token token string-interpolation interpolation=
 format-spec">.4f</span><span class=3D"token token string-interpolation int=
erpolation" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token =
token string-interpolation" style=3D"color: rgb(0, 128, 0);">"</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Save regular checkpoint every 10 epochs</span=
><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>epoch </span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">%</s=
pan><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">10</span><span> </span><span class=3D"token token" style=3D"color: rg=
b(20, 24, 31);">=3D=3D</span><span> </span><span class=3D"token token" styl=
e=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                self</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>save_checkpoint</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n>epoch</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>,</span><span> is_best</span><span class=3D"token token" style=3D"color: r=
gb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb(=
0, 128, 128);">False</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpolatio=
n" style=3D"color: rgb(0, 128, 0);">f"Training complete! Best val accuracy:=
 </span><span class=3D"token token string-interpolation interpolation" styl=
e=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token string-int=
erpolation interpolation">self</span><span class=3D"token token string-inte=
rpolation interpolation" style=3D"color: rgb(43, 48, 59);">.</span><span cl=
ass=3D"token token string-interpolation interpolation">best_val_acc</span><=
span class=3D"token token string-interpolation interpolation" style=3D"colo=
r: rgb(43, 48, 59);">:</span><span class=3D"token token string-interpolatio=
n interpolation format-spec">.4f</span><span class=3D"token token string-in=
terpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span =
class=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);"=
>"</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Save final model</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>save_checkpoint</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>num_epochs </span><span class=3D"token token" style=3D"color: rgb(20,=
 24, 31);">-</span><span> </span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 128);">1</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">,</span><span> is_best</span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">False</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> name</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 0);">'final'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">train_epoch</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">tuple</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span=
>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Train for one epoch"""</=
span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>model</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>train</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        total_loss </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">0.0</span><span>
</span></span><span><span>        correct </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">0</span><span>
</span></span><span><span>        total </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">0</span><span>
</span></span><span>       =20
</span><span><span>        pbar </span><span class=3D"token token" style=3D=
"color: rgb(20, 24, 31);">=3D</span><span> tqdm</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>train_lo=
ader</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,<=
/span><span> desc</span><span class=3D"token token" style=3D"color: rgb(20,=
 24, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 0);">"Training"</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">for</span><span> batch </span><span class=3D"token to=
ken" style=3D"color: rgb(129, 0, 194);">in</span><span> pbar</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Move to device</span><span>
</span></span><span><span>            rgbd </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> batch</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">'rgbd'</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>to</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>device</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">)</span><span>
</span></span><span><span>            grasp_pose </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> batch</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 0);">'grasp_pose'</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>to</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>.</span><span>device</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span>
</span></span><span><span>            success </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> batch</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'success'</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>to</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>sel=
f</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>device</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Forward pass</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>optimizer</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>zero_gra=
d</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span><span>            prediction </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>mod=
el</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>rgbd</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">,</span><span> grasp_pose</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Compute loss</span><span>
</span></span><span><span>            loss </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>criterion=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>prediction</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">,</span><span> success</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Backward pass</span><span>
</span></span><span><span>            loss</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>backward</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Gradient clipping</span><span>
</span></span><span><span>            torch</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>nn</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>utils</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>c=
lip_grad_norm_</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">(</span><span>self</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">.</span><span>model</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">.</span><span>parameters</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> max_norm</span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">1.0</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            self</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>optimizer</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>step</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Track metrics</span><span>
</span></span><span><span>            total_loss </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> loss</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>it=
em</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span>
</span></span><span>           =20
</span><span><span>            predicted_class </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>predictio=
n </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&gt;=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 128);">0.5</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>.</span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">floa=
t</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span><span>            correct </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>predicted=
_class </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);"=
>=3D=3D</span><span> success</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">.</span><span class=3D"token token" style=3D"color: rgb(17=
9, 74, 0);">sum</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.=
</span><span>item</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span>
</span></span><span><span>            total </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> success</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>size=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Update progress bar</span><span>
</span></span><span><span>            pbar</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>set_postfix</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'loss'</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"tok=
en token string-interpolation" style=3D"color: rgb(0, 128, 0);">f'</span><s=
pan class=3D"token token string-interpolation interpolation" style=3D"color=
: rgb(43, 48, 59);">{</span><span class=3D"token token string-interpolation=
 interpolation">loss</span><span class=3D"token token string-interpolation =
interpolation" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"tok=
en token string-interpolation interpolation">item</span><span class=3D"toke=
n token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59)=
;">(</span><span class=3D"token token string-interpolation interpolation" s=
tyle=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token string-=
interpolation interpolation" style=3D"color: rgb(43, 48, 59);">:</span><spa=
n class=3D"token token string-interpolation interpolation format-spec">.4f<=
/span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'acc'</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"toke=
n token string-interpolation" style=3D"color: rgb(0, 128, 0);">f'</span><sp=
an class=3D"token token string-interpolation interpolation" style=3D"color:=
 rgb(43, 48, 59);">{</span><span class=3D"token token string-interpolation =
interpolation">correct</span><span class=3D"token token string-interpolatio=
n interpolation" style=3D"color: rgb(20, 24, 31);">/</span><span class=3D"t=
oken token string-interpolation interpolation">total</span><span class=3D"t=
oken token string-interpolation interpolation" style=3D"color: rgb(43, 48, =
59);">:</span><span class=3D"token token string-interpolation interpolation=
 format-spec">.4f</span><span class=3D"token token string-interpolation int=
erpolation" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token =
token string-interpolation" style=3D"color: rgb(0, 128, 0);">'</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        avg_loss </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> total_loss </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(179, 74, 0);">len</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>sel=
f</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>train_loader</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span>
</span></span><span><span>        accuracy </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> correct </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><span> tota=
l
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> avg_loss</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">,</span><span> accuracy
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">validate</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span><sp=
an class=3D"token token" style=3D"color: rgb(179, 74, 0);">tuple</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Validate on validation s=
et"""</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>model</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token token" s=
tyle=3D"color: rgb(179, 74, 0);">eval</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        total_loss </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">0.0</span><span>
</span></span><span><span>        correct </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">0</span><span>
</span></span><span><span>        total </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">0</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">with</span><span> torch</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">.</span><span>no_grad</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">for</span><span> batch </span><span class=
=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> tqdm</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><=
span>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">.</span><span>val_loader</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">,</span><span> desc</span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 0);">"Validation"</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                rgbd </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> batch</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">'rgbd'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>to</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>self<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span=
><span>device</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">)</span><span>
</span></span><span><span>                grasp_pose </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> batch</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 0);">'grasp_pose'</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>to<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">.</span><span>device</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">)</span><span>
</span></span><span><span>                success </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> batch</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 0);">'success'</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>to</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.=
</span><span>device</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span>
</span></span><span>               =20
</span><span><span>                </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Forward pass</span><span>
</span></span><span><span>                prediction </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>model</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>rgbd</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">,</span><span> grasp_pose</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>               =20
</span><span><span>                </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Compute loss</span><span>
</span></span><span><span>                loss </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>crite=
rion</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(<=
/span><span>prediction</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">,</span><span> success</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>               =20
</span><span><span>                </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Track metrics</span><span>
</span></span><span><span>                total_loss </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> loss</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>item</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span>
</span></span><span>               =20
</span><span><span>                predicted_class </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>predi=
ction </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
&gt;</span><span> </span><span class=3D"token token" style=3D"color: rgb(0,=
 128, 128);">0.5</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">.</span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">=
float</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>
</span></span><span><span>                correct </span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>predi=
cted_class </span><span class=3D"token token" style=3D"color: rgb(20, 24, 3=
1);">=3D=3D</span><span> success</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">.</span><span class=3D"token token" style=3D"color: rg=
b(179, 74, 0);">sum</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">.</span><span>item</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span>
</span></span><span><span>                total </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> success</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
size</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an>
</span></span><span>       =20
</span><span><span>        avg_loss </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> total_loss </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(179, 74, 0);">len</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>sel=
f</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>val_loader</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span>
</span></span><span><span>        accuracy </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> correct </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><span> tota=
l
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> avg_loss</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">,</span><span> accuracy
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">save_checkpoint</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        epoch</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token=
 token" style=3D"color: rgb(179, 74, 0);">int</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        is_best</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </=
span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">False</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span>
</span></span><span><span>        name</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">str</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">None</span>=
<span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Save model checkpoint"""=
</span><span>
</span></span><span>       =20
</span><span><span>        checkpoint </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'epoch'</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span> epoch</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'model_state_dict'</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> self</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>model=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</spa=
n><span>state_dict</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'optimizer_state_dict'</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">:</span><span> self</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>o=
ptimizer</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">.</span><span>state_dict</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'scheduler_state_dict'</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">:</span><span> self</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>s=
cheduler</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">.</span><span>state_dict</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'best_val_acc'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> self</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>best_val_=
acc</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'train_losses'</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> self</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>train_los=
ses</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'val_losses'</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>val_losses=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</spa=
n><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'val_accuracies'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span> self</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>val_acc=
uracies
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> name</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            filename </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span clas=
s=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">f'c=
heckpoint_</span><span class=3D"token token string-interpolation interpolat=
ion" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token s=
tring-interpolation interpolation">name</span><span class=3D"token token st=
ring-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</span=
><span class=3D"token token string-interpolation" style=3D"color: rgb(0, 12=
8, 0);">.pth'</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">elif</span><span> is_best</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            filename </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">'checkpoint_best.pth'</s=
pan><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            filename </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span clas=
s=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">f'c=
heckpoint_epoch_</span><span class=3D"token token string-interpolation inte=
rpolation" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token t=
oken string-interpolation interpolation">epoch</span><span class=3D"token t=
oken string-interpolation interpolation" style=3D"color: rgb(20, 24, 31);">=
+</span><span class=3D"token token string-interpolation interpolation" styl=
e=3D"color: rgb(0, 128, 128);">1</span><span class=3D"token token string-in=
terpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span =
class=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);"=
>.pth'</span><span>
</span></span><span>       =20
</span><span><span>        filepath </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>output_dir </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><sp=
an> filename
</span></span><span><span>        torch</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">.</span><span>save</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>checkpoint</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n> filepath</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">)</span><span>
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">if</span><span> __name__ </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'__main__'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(110, 118, 135);"># Example usage</span><span>
</span></span><span><span>    trainer </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> GraspPredictorTrainer</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>
</span></span><span><span>        data_dir</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 0);">'./data/grasp_dataset'</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        output_dir</span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 0);">'./checkpoints'</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        batch_size</span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 128);">16</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        learning_rate</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">1e-4</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        num_epochs</span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 128);">50</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        device</span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 0);">'cuda'</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        use_wandb</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    trainer</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">.</span><span>train</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span></span></code></pre></div></div>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]"><strong>(Continuing in next message with robot controller and main =
execution...)</strong></p></div></div></div></div></div><div class=3D"flex =
justify-start opacity-0 group-hover:opacity-100 group-focus-within:opacity-=
100 transition" role=3D"group" aria-label=3D"Message actions"><div class=3D=
"text-text-300"><div class=3D"text-text-300 flex items-stretch justify-betw=
een"><div class=3D"w-fit" data-state=3D"closed"><button class=3D"inline-fle=
x
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" data-testid=3D"acti=
on-bar-copy" aria-label=3D"Copy"><div class=3D"relative text-text-500 group=
-hover/btn:text-text-100"><div class=3D"transition-all opacity-100 scale-10=
0" style=3D"width: 20px; height: 20px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"tr=
ansition-all opacity-100 scale-100" aria-hidden=3D"true" style=3D"flex-shri=
nk: 0;"><path d=3D"M12.5 3C13.3284 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 =
6.67157 17 7.5V15.5C17 16.3284 16.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 =
6 15.5V14H4.5C3.67157 14 3 13.3284 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.=
5ZM14 12.5C14 13.3284 13.3284 14 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16=
H15.5C15.7761 16 16 15.7761 16 15.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5=
ZM4.5 4C4.22386 4 4 4.22386 4 4.5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.=
7761 13 13 12.7761 13 12.5V4.5C13 4.22386 12.7761 4 12.5 4H4.5Z"></path></s=
vg></div><div class=3D"absolute top-0 left-0 transition-all opacity-0 scale=
-50" style=3D"width: 20px; height: 20px; display: flex; align-items: center=
; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 =
20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"=
absolute top-0 left-0 transition-all opacity-0 scale-50" aria-hidden=3D"tru=
e" style=3D"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15=
.6346 4.96153 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.736=
05L15.8836 5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 =
14.9989C7.88203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.0=
8172 11.2752C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755=
 4.58105 10.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.=
1794L15.1883 5.10908Z"></path></svg></div></div></button></div><div class=
=3D"w-fit" data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Give =
positive feedback"><div class=3D"text-text-500 group-hover/btn:text-text-10=
0" style=3D"width: 16px; height: 16px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"te=
xt-text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"fl=
ex-shrink: 0;"><path d=3D"M9.56055 2C11.1381 2.00009 12.3211 3.44332 12.011=
7 4.99023L11.6094 7H13.8438C15.5431 7 16.836 8.52594 16.5566 10.2021L15.876=
 14.2842C15.6148 15.8513 14.2586 17 12.6699 17H4.5C3.67157 17 3 16.3284 3 1=
5.5V9.23828C3.00013 8.57996 3.4294 7.99838 4.05859 7.80469L5.19824 7.4541L5=
.33789 7.40723C6.02983 7.15302 6.59327 6.63008 6.89746 5.9541L8.41113 2.589=
84L8.48047 2.46094C8.66235 2.17643 8.97898 2.00002 9.32324 2H9.56055ZM7.809=
57 6.36523C7.39486 7.2867 6.62674 7.99897 5.68359 8.3457L5.49219 8.41016L4.=
35254 8.76074C4.14305 8.82539 4.00013 9.01904 4 9.23828V15.5C4 15.7761 4.22=
386 16 4.5 16H12.6699C13.7697 16 14.7087 15.2049 14.8896 14.1201L15.5703 10=
.0381C15.7481 8.97141 14.9251 8 13.8438 8H11C10.8503 8 10.7083 7.9331 10.61=
33 7.81738C10.5184 7.70164 10.4805 7.54912 10.5098 7.40234L11.0312 4.79395C=
11.2167 3.86589 10.507 3.00009 9.56055 3H9.32324L7.80957 6.36523Z"></path><=
/svg></div></button></div><div class=3D"w-fit" data-state=3D"closed"><butto=
n class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Give =
negative feedback"><div class=3D"text-text-500 group-hover/btn:text-text-10=
0" style=3D"width: 16px; height: 16px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"te=
xt-text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"fl=
ex-shrink: 0;"><path d=3D"M12.6699 3C14.2586 3 15.6148 4.14871 15.876 5.715=
82L16.5566 9.79785C16.836 11.4741 15.5431 13 13.8438 13H11.6094L12.0117 15.=
0098C12.3211 16.5567 11.1381 17.9999 9.56055 18H9.32324C8.97898 18 8.66235 =
17.8236 8.48047 17.5391L8.41113 17.4102L6.89746 14.0459C6.59327 13.3699 6.0=
2983 12.847 5.33789 12.5928L5.19824 12.5459L4.05859 12.1953C3.4294 12.0016 =
3.00013 11.42 3 10.7617V4.5C3 3.67157 3.67157 3 4.5 3H12.6699ZM4.5 4C4.2238=
6 4 4 4.22386 4 4.5V10.7617C4.00013 10.981 4.14305 11.1746 4.35254 11.2393L=
5.49219 11.5898L5.68359 11.6543C6.62674 12.001 7.39486 12.7133 7.80957 13.6=
348L9.32324 17H9.56055C10.507 16.9999 11.2167 16.1341 11.0312 15.2061L10.50=
98 12.5977C10.4805 12.4509 10.5184 12.2984 10.6133 12.1826C10.7083 12.0669 =
10.8503 12 11 12H13.8438C14.9251 12 15.7481 11.0286 15.5703 9.96191L14.8896=
 5.87988C14.7087 4.79508 13.7697 4 12.6699 4H4.5Z"></path></svg></div></but=
ton></div><div class=3D"flex items-center"><div class=3D"w-fit" data-state=
=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" id=3D"radix-_r_kr_"=
 aria-haspopup=3D"menu" aria-expanded=3D"false" data-state=3D"closed" aria-=
label=3D"Retry"><div class=3D"text-text-500 group-hover/btn:text-text-100" =
style=3D"width: 20px; height: 20px; display: flex; align-items: center; jus=
tify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20=
" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-=
text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-=
shrink: 0;"><path d=3D"M10.3857 2.50977C14.3486 2.71054 17.5 5.98724 17.5 1=
0C17.5 14.1421 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 7.5=
4619 3.67878 5.3677 5.49902 4H3C2.72386 4 2.5 3.77614 2.5 3.5C2.5 3.22386 2=
.72386 3 3 3H6.5C6.63261 3 6.75975 3.05272 6.85352 3.14648C6.92392 3.21689 =
6.97106 3.30611 6.99023 3.40234L7 3.5V7C7 7.27614 6.77614 7.5 6.5 7.5C6.223=
86 7.5 6 7.27614 6 7V4.87891C4.4782 6.06926 3.5 7.91979 3.5 10C3.5 13.5899 =
6.41015 16.5 10 16.5C13.5899 16.5 16.5 13.5899 16.5 10C16.5 6.5225 13.7691 =
3.68312 10.335 3.50879L10 3.5L9.89941 3.49023C9.67145 3.44371 9.5 3.24171 9=
.5 3C9.5 2.72386 9.72386 2.5 10 2.5L10.3857 2.50977Z"></path></svg></div></=
button></div></div></div></div></div></div></div><div data-test-render-coun=
t=3D"2"><div class=3D"mb-1 mt-6 group"><div class=3D"flex flex-col items-en=
d gap-1"><div class=3D"group relative inline-flex gap-2 bg-bg-300 rounded-x=
l pl-2.5 py-2.5 break-words text-text-100 transition-all max-w-[75ch] flex-=
col !px-4 max-w-[85%]" style=3D"opacity: 1; transform: none;"><div class=3D=
"flex flex-row gap-2 relative"><div class=3D"flex-1"><div data-testid=3D"us=
er-message" class=3D"font-large !font-user-message grid grid-cols-1 gap-2 p=
y-0.5 relative" style=3D"max-height: none; overflow: hidden; position: rela=
tive;"><p class=3D"whitespace-pre-wrap break-words">continue</p></div></div=
></div></div><div class=3D"flex justify-start opacity-0 group-hover:opacity=
-100 group-focus-within:opacity-100 transition" role=3D"group" aria-label=
=3D"Message actions"><div class=3D"text-text-300"><div class=3D"text-text-3=
00 flex items-stretch justify-between"><span class=3D"text-text-500 text-xs=
 flex items-center mr-2" data-state=3D"closed">7:58 PM</span><div class=3D"=
flex items-center"><div class=3D"w-fit" data-state=3D"closed"><button class=
=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Retry=
"><div class=3D"text-text-500 group-hover/btn:text-text-100" style=3D"width=
: 20px; height: 20px; display: flex; align-items: center; justify-content: =
center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curr=
entColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-text-500 group=
-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><p=
ath d=3D"M10.3857 2.50977C14.3486 2.71054 17.5 5.98724 17.5 10C17.5 14.1421=
 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 7.54619 3.67878 5=
.3677 5.49902 4H3C2.72386 4 2.5 3.77614 2.5 3.5C2.5 3.22386 2.72386 3 3 3H6=
.5C6.63261 3 6.75975 3.05272 6.85352 3.14648C6.92392 3.21689 6.97106 3.3061=
1 6.99023 3.40234L7 3.5V7C7 7.27614 6.77614 7.5 6.5 7.5C6.22386 7.5 6 7.276=
14 6 7V4.87891C4.4782 6.06926 3.5 7.91979 3.5 10C3.5 13.5899 6.41015 16.5 1=
0 16.5C13.5899 16.5 16.5 13.5899 16.5 10C16.5 6.5225 13.7691 3.68312 10.335=
 3.50879L10 3.5L9.89941 3.49023C9.67145 3.44371 9.5 3.24171 9.5 3C9.5 2.723=
86 9.72386 2.5 10 2.5L10.3857 2.50977Z"></path></svg></div></button></div><=
div class=3D"w-fit" data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Edit"=
><div class=3D"text-text-500 group-hover/btn:text-text-100" style=3D"width:=
 20px; height: 20px; display: flex; align-items: center; justify-content: c=
enter;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"curre=
ntColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-text-500 group-=
hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><pa=
th d=3D"M9.72821 2.87934C10.0318 2.10869 10.9028 1.72933 11.6735 2.03266L14=
.4655 3.13226C15.236 3.43593 15.6145 4.30697 15.3112 5.07758L11.3903 15.030=
7C11.2954 15.2717 11.1394 15.4835 10.9391 15.6459L10.8513 15.7123L7.7077 17=
.8979C7.29581 18.1843 6.73463 17.9917 6.57294 17.5356L6.54657 17.4409L5.737=
 13.6987C5.67447 13.4092 5.69977 13.107 5.80829 12.8315L9.72821 2.87934ZM6.=
73798 13.1987C6.70201 13.2903 6.69385 13.3906 6.71454 13.4868L7.44501 16.86=
27L10.28 14.892L10.3376 14.8452C10.3909 14.7949 10.4325 14.7332 10.4597 14.=
6645L13.0974 7.96723L9.37567 6.50141L6.73798 13.1987ZM11.3073 2.96332C11.05=
04 2.86217 10.7601 2.98864 10.6589 3.24555L9.74188 5.57074L13.4636 7.03754L=
14.3806 4.71137C14.4817 4.45445 14.3552 4.16413 14.0983 4.06293L11.3073 2.9=
6332Z"></path></svg></div></button></div></div><div class=3D"w-fit" data-st=
ate=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" data-testid=3D"acti=
on-bar-copy" aria-label=3D"Copy"><div class=3D"relative text-text-500 group=
-hover/btn:text-text-100"><div class=3D"transition-all opacity-100 scale-10=
0" style=3D"width: 20px; height: 20px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"tr=
ansition-all opacity-100 scale-100" aria-hidden=3D"true" style=3D"flex-shri=
nk: 0;"><path d=3D"M12.5 3C13.3284 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 =
6.67157 17 7.5V15.5C17 16.3284 16.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 =
6 15.5V14H4.5C3.67157 14 3 13.3284 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.=
5ZM14 12.5C14 13.3284 13.3284 14 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16=
H15.5C15.7761 16 16 15.7761 16 15.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5=
ZM4.5 4C4.22386 4 4 4.22386 4 4.5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.=
7761 13 13 12.7761 13 12.5V4.5C13 4.22386 12.7761 4 12.5 4H4.5Z"></path></s=
vg></div><div class=3D"absolute top-0 left-0 transition-all opacity-0 scale=
-50" style=3D"width: 20px; height: 20px; display: flex; align-items: center=
; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 =
20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"=
absolute top-0 left-0 transition-all opacity-0 scale-50" aria-hidden=3D"tru=
e" style=3D"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15=
.6346 4.96153 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.736=
05L15.8836 5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 =
14.9989C7.88203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.0=
8172 11.2752C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755=
 4.58105 10.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.=
1794L15.1883 5.10908Z"></path></svg></div></div></button></div><div class=
=3D"flex items-center"></div></div></div></div></div></div></div><div data-=
test-render-count=3D"1"><div class=3D"group" style=3D"height: auto; opacity=
: 1; transform: none;"><div class=3D"contents"><div data-is-streaming=3D"fa=
lse" class=3D"group relative relative pb-3" style=3D"opacity: 1; transform:=
 none;"><div class=3D"font-claude-response relative leading-[1.65rem] [&amp=
;_pre>div]:bg-bg-000/50 [&amp;_pre>div]:border-0.5 [&amp;_pre>div]:border-b=
order-400 [&amp;_.ignore-pre-bg>div]:bg-transparent [&amp;_.standard-markdo=
wn_:is(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&amp;_.standard-markdown_:is(=
p,blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8 [&amp;_.progressive-markdown_:i=
s(p,blockquote,h1,h2,h3,h4,h5,h6)]:pl-2 [&amp;_.progressive-markdown_:is(p,=
blockquote,ul,ol,h1,h2,h3,h4,h5,h6)]:pr-8"><div><div class=3D"standard-mark=
down grid-cols-1 grid [&amp;_>_*]:min-w-0 gap-3 standard-markdown"><h1 clas=
s=3D"text-text-100 mt-3 -mb-1 text-[1.375rem] font-bold">Complete System (C=
ontinued - Final Parts)</h1>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">11. Robot =
Controller</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># robot/r=
obot_controller.py</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">import</span><span> numpy </span><span class=3D"token token" =
style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> typing </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">import</span><span> Dict</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> O=
ptional</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>,</span><span> List
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> scipy</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>spatial</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>transfor=
m </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">imp=
ort</span><span> Rotation
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> time
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Isaac Sim imports (must be after SimulationApp creation)<=
/span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">try</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>franka =
</span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">impor=
t</span><span> Franka
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>core</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>controllers </span><span class=3D"token token" style=3D"color: rgb(129=
, 0, 194);">import</span><span> BaseController
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">from</span><span> omni</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>motion_=
generation </span><span class=3D"token token" style=3D"color: rgb(129, 0, 1=
94);">import</span><span> RmpFlow</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> ArticulationMotionPolicy
</span></span><span><span>    ISAAC_AVAILABLE </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">except</span><span> ImportError</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    ISAAC_AVAILABLE </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 0);">"Warning: Isaac Sim not available, robot controller will =
run in simulation mode only"</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">)</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">DishwashingRobotController</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Controls robot arm to execute grasps
</span><span>    Supports both Isaac Sim and real robot (with appropriate i=
nterface)
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        world</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        robot_type</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">str</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'franka=
'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</sp=
an><span>
</span></span><span><span>        use_motion_planning</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(179, 74, 0);">bool</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 12=
8);">True</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Initialize robot controller
</span><span>       =20
</span><span>        Args:
</span><span>            world: Isaac Sim World instance
</span><span>            robot_type: Type of robot ('franka', 'ur5', etc.)
</span><span>            use_motion_planning: Whether to use RMPflow motion=
 planning
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>world </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> world
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>robot_type </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> robot_t=
ype
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>use_motion_planning </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span=
> use_motion_planning
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Initialize robot</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">not</span><span> ISAAC_AVAILABLE</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span>=
<span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">raise</span><span> RuntimeError</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 0);">"Isaac Sim not availabl=
e - cannot initialize robot"</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpolatio=
n" style=3D"color: rgb(0, 128, 0);">f"Initializing </span><span class=3D"to=
ken token string-interpolation interpolation" style=3D"color: rgb(43, 48, 5=
9);">{</span><span class=3D"token token string-interpolation interpolation"=
>robot_type</span><span class=3D"token token string-interpolation interpola=
tion" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token =
string-interpolation" style=3D"color: rgb(0, 128, 0);"> robot..."</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> robot_type </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 0);">'franka'</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>robot </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Franka<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span>
</span></span><span><span>                prim_path</span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 0);">"/World/Franka"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                name</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token toke=
n" style=3D"color: rgb(0, 128, 0);">"franka_robot"</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                position</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.6</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>  </span>=
<span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Position=
 in front of sink</span><span>
</span></span><span><span>                orientation</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>np</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ar=
ray</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </=
span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128)=
;">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">raise</span><span> ValueError</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">f"Un=
supported robot type: </span><span class=3D"token token string-interpolatio=
n interpolation" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"t=
oken token string-interpolation interpolation">robot_type</span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">}</span><span class=3D"token token string-interpolation" style=
=3D"color: rgb(0, 128, 0);">"</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>scene</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>add</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.=
</span><span>robot</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Initialize motion planner</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> use_motion_planning</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"Initializing motion planner..."</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>motion_policy </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
ArticulationMotionPolicy</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                self</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>robot</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                physics_dt</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">1.0</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">/</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">60.0</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            self</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>rmp_flow </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> RmpFlow</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>
</span></span><span><span>                robot_articulation</span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>self<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span=
><span>robot</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">,</span><span>
</span></span><span><span>                urdf_path</span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>self</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ro=
bot</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>urdf_path</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">,</span><span>
</span></span><span><span>                rmp_flow_config_path</span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">None</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>  </span>=
<span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Use defa=
ult</span><span>
</span></span><span><span>                end_effector_frame_name</span><sp=
an class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 0);">"panda_hand"</span><=
span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Get gripper</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>gripper </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>robot</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>.</span><span>gripper
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Home position (joint angles)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>home_joint_positions </span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><spa=
n> np</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.=
</span><span>array</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128)=
;">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,<=
/span><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24,=
 31);">-</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128)=
;">0.785</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, =
128, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span> </span><span class=3D"token token" style=3D"color: rg=
b(20, 24, 31);">-</span><span class=3D"token token" style=3D"color: rgb(0, =
128, 128);">2.356</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 128, 128);">1.571</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 128);">0.785</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Reset to home</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>go_home</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"Robot initialized successfully"</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">go_home</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Move robot to home posit=
ion"""</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"Moving to home position..."</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>robot</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>set_joint_positions</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">.</span><span>home_joint_positions</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>gripper</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token=
 token" style=3D"color: rgb(179, 74, 0);">open</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Let physics settle</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> _ </span><span class=3D"toke=
n token" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span cl=
ass=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">30</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>step</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n>render</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);=
">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
True</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">execute_grasp</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        grasp_pose</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> Dict</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        pre_grasp_offset</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span cla=
ss=3D"token token" style=3D"color: rgb(179, 74, 0);">float</span><span> </s=
pan><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128)=
;">0.1</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span>
</span></span><span><span>        approach_speed</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">float</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><=
span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>0.05</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,=
</span><span>
</span></span><span><span>        lift_height</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(179, 74, 0);">float</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.=
15</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">bool</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Execute complete grasp sequence
</span><span>       =20
</span><span>        Args:
</span><span>            grasp_pose: Dictionary with 'position', 'orientati=
on', 'gripper_width', 'approach_vector'
</span><span>            pre_grasp_offset: Distance to stop before final gr=
asp (meters)
</span><span>            approach_speed: Speed of final approach (m/s)
</span><span>            lift_height: How high to lift after grasping (mete=
rs)
</span><span>           =20
</span><span>        Returns:
</span><span>            True if grasp succeeded, False otherwise
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"\nExecuting grasp sequence..."</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        target_pos </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp_pose</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        target_ori </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp_pose</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 0);">'orientation'</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        gripper_width </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp_pose</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 0);">'gripper_width'</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span>
</span></span><span><span>        approach_vec </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> grasp_pose</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span=
 class=3D"token token" style=3D"color: rgb(0, 128, 0);">'approach_vector'</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span>=
<span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 1: Move to pre-grasp position</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"  [1/6] Moving to pre-grasp position..."</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        pre_grasp_pos </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> target_pos </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><sp=
an> approach_vec </span><span class=3D"token token" style=3D"color: rgb(20,=
 24, 31);">*</span><span> pre_grasp_offset
</span></span><span>       =20
</span><span><span>        success </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>move_to_pose</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>pre_grasp_pos</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">,</span><span> target_ori</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> timeout</span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">5.0</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">not</span><span> success</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"  =E2=9C=97 Failed to reach pre-grasp position=
"</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</sp=
an><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 2: Open gripper</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"  [2/6] Opening gripper..."</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>gripper</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token=
 token" style=3D"color: rgb(179, 74, 0);">open</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>_wait_for_gripper</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>is_o=
pen</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">True<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 3: Approach grasp position</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"  [3/6] Approaching grasp position..."</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        success </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>move_to_po=
se</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>target_pos</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">,</span><span> target_ori</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">,</span><span> timeout</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">5.0</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">not</span><span> success</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"  =E2=9C=97 Failed to reach grasp position"</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 4: Close gripper</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"  [4/6] Closing gripper..."</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>gripper</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>close</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>_wait_for_gripper</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>is_o=
pen</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">False=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Check if we grasped something (simplified check)<=
/span><span>
</span></span><span><span>        grasped </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_check_gra=
sp_success</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">not</span><span> grasped</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"  =E2=9C=97 No object detected in gripper"</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>gripper</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"t=
oken token" style=3D"color: rgb(179, 74, 0);">open</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 5: Lift</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"  [5/6] Lifting object..."</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        lift_pos </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> target_pos</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>cop=
y</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span><span>        lift_pos</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">2</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> lift_height
</span></span><span>       =20
</span><span><span>        success </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>move_to_pose</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>lift_pos</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span> target_ori</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">,</span><span> timeout</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token toke=
n" style=3D"color: rgb(0, 128, 128);">3.0</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">not</span><span> success</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"  =E2=9C=97 Failed to lift"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Verify grasp still holds</span><span>
</span></span><span><span>        grasped </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_check_gra=
sp_success</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">not</span><span> grasped</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"  =E2=9C=97 Object slipped during lift"</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 6: Move to placement location (e.g., dish ra=
ck)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"  [6/6] Moving to placement location..."</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        place_pos </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span cl=
ass=3D"token token" style=3D"color: rgb(0, 128, 128);">0.4</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span =
class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.5</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.3</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>  </s=
pan><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Exam=
ple placement location</span><span>
</span></span><span><span>        place_ori </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_compute=
_orientation_from_vertical</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        success </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>move_to_pose</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>place_pos</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">,</span><span> place_ori</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">,</span><span> timeout</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token toke=
n" style=3D"color: rgb(0, 128, 128);">5.0</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">not</span><span> success</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"  =E2=9C=97 Failed to reach placement"</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Still release object</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Release</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"  Releasing object..."</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>gripper</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token=
 token" style=3D"color: rgb(179, 74, 0);">open</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>_wait_for_gripper</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>is_o=
pen</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">True<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Return to home</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"  Returning home..."</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>go_home</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"  =E2=9C=93 Grasp sequence completed successfully"</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">move_to_pose</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        target_position</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</spa=
n><span>
</span></span><span><span>        target_orientation</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndar=
ray</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span>
</span></span><span><span>        timeout</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(179, 74, 0);">float</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">10.0</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span>
</span></span><span><span>        position_threshold</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(179, 74, 0);">float</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 12=
8);">0.01</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">,</span><span>
</span></span><span><span>        orientation_threshold</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(179, 74, 0);">float</span><sp=
an> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, =
128, 128);">0.1</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">bool</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Move end effector to target pose using motion p=
lanning
</span><span>       =20
</span><span>        Args:
</span><span>            target_position: [x, y, z] target position
</span><span>            target_orientation: 3x3 rotation matrix or quatern=
ion [qw, qx, qy, qz]
</span><span>            timeout: Maximum time to reach target (seconds)
</span><span>            position_threshold: Position error threshold (mete=
rs)
</span><span>            orientation_threshold: Orientation error threshold=
 (radians)
</span><span>           =20
</span><span>        Returns:
</span><span>            True if reached target, False if timeout or collis=
ion
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Convert orientation to rotation matrix if needed<=
/span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> target_orientation</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>sha=
pe </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=
=3D</span><span> </span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, =
128);">4</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">,</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span>=
<span>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 13=
5);"># Quaternion</span><span>
</span></span><span><span>            qw</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> qx</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">,</span><span> qy</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> qz <=
/span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</sp=
an><span> target_orientation
</span></span><span><span>            rot </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Rotation</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from_q=
uat</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span>=
<span>qx</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">,</span><span> qy</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">,</span><span> qz</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">,</span><span> qw</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            target_orientation </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> rot</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>as_matrix</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">not</span><span> self</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>use_motion_pl=
anning</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Simple joint space control (no collisi=
on avoidance)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span> self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_move_to_p=
ose_simple</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">(</span><span>
</span></span><span><span>                target_position</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                target_orientation</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>                timeout</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span>                position_threshold
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Use RMPflow for collision-free motion</span><span=
>
</span></span><span><span>        start_time </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> time</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>time</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">while</span><span> </span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>time</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>time</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><spa=
n> start_time</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">)</span><span> </span><span class=3D"token token" style=3D"color: rg=
b(20, 24, 31);">&lt;</span><span> timeout</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Get current end effector pose</span><s=
pan>
</span></span><span><span>            current_pos</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> current_ori </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><=
span> self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>robot</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">.</span><span>end_effector</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">.</span><span>get_world_pose</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Check if reached target</span><span>
</span></span><span><span>            pos_error </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>linalg=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</spa=
n><span>norm</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">(</span><span>current_pos </span><span class=3D"token token" style=3D=
"color: rgb(20, 24, 31);">-</span><span> target_position</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Orientation error (angle between rotation mat=
rices)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> current_ori</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>shape <=
/span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D<=
/span><span> </span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128)=
;">4</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><spa=
n>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"=
># Convert quaternion to matrix</span><span>
</span></span><span><span>                qw</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">,</span><span> qx</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> qy</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
> qz </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D</span><span> current_ori
</span></span><span><span>                current_ori_mat </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Rotati=
on</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</s=
pan><span>from_quat</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">[</span><span>qx</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">,</span><span> qy</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> qz</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span> qw</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>as_matrix</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                current_ori_mat </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> curren=
t_ori
</span></span><span>           =20
</span><span><span>            ori_error </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>arccos</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>
</span></span><span><span>                np</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>clip</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>np</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>trace=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span>current_ori_mat</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">.</span><span>T @ target_orientation</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 12=
8);">2</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> </span><span class=3D"token token" style=3D"color: rgb(20, 2=
4, 31);">-</span><span class=3D"token token" style=3D"color: rgb(0, 128, 12=
8);">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">1</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">if</span><span> pos_error </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> position_th=
reshold </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194)=
;">and</span><span> ori_error </span><span class=3D"token token" style=3D"c=
olor: rgb(20, 24, 31);">&lt;</span><span> orientation_threshold</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Compute target joint positions using RMPflow<=
/span><span>
</span></span><span><span>            target_joint_positions </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> sel=
f</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>rmp_flow</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">.</span><span>compute_joint_targets</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                target_end_effector_position</spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><=
span>target_position</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">,</span><span>
</span></span><span><span>                target_end_effector_orientation</=
span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</spa=
n><span>target_orientation
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">if</span><span> target_joint_positions </span><sp=
an class=3D"token token" style=3D"color: rgb(129, 0, 194);">is</span><span>=
 </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">None=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(110, 118, 135);"># RMPflow couldn't find solution (co=
llision or unreachable)</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token stri=
ng-interpolation" style=3D"color: rgb(0, 128, 0);">f"    Warning: RMPflow r=
eturned None"</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">)</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Apply joint commands</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>robot</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>apply_acti=
on</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>target_joint_positions</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Step simulation</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>step</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n>render</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);=
">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
True</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Check for collisions</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> self</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>_check_collisi=
on</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 0);">"    Collision detected!"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Timeout</span><span>
</span></span><span><span>        current_pos</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> _ </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>robot</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>end_effector</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">.</span><span>get_world_pose</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        pos_error </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>linalg</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>norm</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">(</span><span>current_pos </span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">-</span><span> target_position</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"    Timeout reached. Position=
 error: </span><span class=3D"token token string-interpolation interpolatio=
n" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token str=
ing-interpolation interpolation">pos_error</span><span class=3D"token token=
 string-interpolation interpolation" style=3D"color: rgb(20, 24, 31);">*</s=
pan><span class=3D"token token string-interpolation interpolation" style=3D=
"color: rgb(0, 128, 128);">1000</span><span class=3D"token token string-int=
erpolation interpolation" style=3D"color: rgb(43, 48, 59);">:</span><span c=
lass=3D"token token string-interpolation interpolation format-spec">.1f</sp=
an><span class=3D"token token string-interpolation interpolation" style=3D"=
color: rgb(43, 48, 59);">}</span><span class=3D"token token string-interpol=
ation" style=3D"color: rgb(0, 128, 0);">mm"</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_move_to_pose_simple</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        target_position</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</spa=
n><span>
</span></span><span><span>        target_orientation</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndar=
ray</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</=
span><span>
</span></span><span><span>        timeout</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(179, 74, 0);">float</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        threshold</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(179, 74, 0);">float</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">&gt;</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">bool</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Simple pose control with=
out motion planning"""</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># This is a simplified controller</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># In practice, you'd use inverse kinematics=
</span><span>
</span></span><span>       =20
</span><span><span>        start_time </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> time</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>time</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">while</span><span> </span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>time</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>time</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><spa=
n> start_time</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">)</span><span> </span><span class=3D"token token" style=3D"color: rg=
b(20, 24, 31);">&lt;</span><span> timeout</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            current_pos</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> _ </span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</spa=
n><span>robot</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">.</span><span>end_effector</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>get_world_pose</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            error </span><span class=3D"token token" sty=
le=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>linalg</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>nor=
m</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span>current_pos </span><span class=3D"token token" style=3D"color: rgb=
(20, 24, 31);">-</span><span> target_position</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> error </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span><span> thresh=
old</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</=
span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Simple proportional control</span><span>
</span></span><span><span>            direction </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> target_position =
</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</spa=
n><span> current_pos
</span></span><span><span>            direction </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> direction </span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">/</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span>np</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">.</span><span>linalg</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">.</span><span>norm</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">(</span><span>direction</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1e-6<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span=
><span>
</span></span><span>           =20
</span><span><span>            step </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> direction </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(179, 74, 0);">min</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 128);">0.01</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> error</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 135)=
;"># Max 1cm per step</span><span>
</span></span><span><span>            new_pos </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> current_pos </span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><spa=
n> step
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Compute IK (simplified - you'd use proper IK =
solver)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># For now, just step simulation</span><s=
pan>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>step</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><spa=
n>render</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);=
">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
True</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_check_grasp_success</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><sp=
an class=3D"token token" style=3D"color: rgb(20, 24, 31);">&gt;</span><span=
> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">bool=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Check if gripper is holding an object
</span><span>       =20
</span><span>        Returns:
</span><span>            True if object detected in gripper
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Check gripper joint positions</span><span>
</span></span><span><span>        gripper_positions </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
gripper</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>.</span><span>get_joint_positions</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># If gripper is not fully closed, it's holding some=
thing</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># (This is a simplified check - real implem=
entation would use force sensors)</span><span>
</span></span><span><span>        gripper_width </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span class=
=3D"token token" style=3D"color: rgb(179, 74, 0);">sum</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>gripper_posit=
ions</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>  </span><span class=3D"token token" style=3D"color: rgb(110, 1=
18, 135);"># Approximate</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Gripper fully closed: ~0, fully open: ~0.08</span=
><span>
</span></span><span><span>        is_holding </span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0.01</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&lt;</span>=
<span> gripper_width </span><span class=3D"token token" style=3D"color: rgb=
(20, 24, 31);">&lt;</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">0.07</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> is_holding
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_check_collision</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">&gt;</span><span> </=
span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">bool</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><s=
pan>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Check for collisions
</span><span>       =20
</span><span>        Returns:
</span><span>            True if collision detected
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># This would use Isaac Sim's collision detection</s=
pan><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Simplified implementation</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Check if robot is in contact with sink walls or o=
ther objects</span><span>
</span></span><span><span>        contacts </span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>world</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>get_physics_context</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">.</span><span>get_contact_report</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">for</span><span> contact </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">in</span><span> contacts</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Check if robot is involved</span><span=
>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">"Franka"</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> =
contact </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194)=
;">or</span><span> </span><span class=3D"token token" style=3D"color: rgb(0=
, 128, 0);">"franka"</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">in</span><span> contact</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">return</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_wait_for_gripper</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> is_open<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span=
><span> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);=
">bool</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> timeout</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">:</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(179, 74, 0);">float</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">2.0</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Wait for gripper to reac=
h target state"""</span><span>
</span></span><span>       =20
</span><span><span>        start_time </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> time</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>time</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">while</span><span> </span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>time</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>time</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><spa=
n> start_time</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">)</span><span> </span><span class=3D"token token" style=3D"color: rg=
b(20, 24, 31);">&lt;</span><span> timeout</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            positions </span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>grip=
per</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>get_joint_positions</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            width </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"t=
oken token" style=3D"color: rgb(179, 74, 0);">sum</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>positions</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">if</span><span> is_open </span><span class=3D"tok=
en token" style=3D"color: rgb(129, 0, 194);">and</span><span> width </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&gt;</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">=
0.07</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:<=
/span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">break</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">elif</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(129, 0, 194);">not</span><span> is_open </sp=
an><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">and</span=
><span> width </span><span class=3D"token token" style=3D"color: rgb(20, 24=
, 31);">&lt;</span><span> </span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 128);">0.02</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">break</span><span>
</span></span><span>           =20
</span><span><span>            self</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>world</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">.</span><span>step</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>render<=
/span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">True</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_compute_orientation_from_vertical</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>self=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31)=
;">-</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">&g=
t;</span><span> np</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">.</span><span>ndarray</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Compute gripper orientat=
ion for vertical placement"""</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Gripper pointing down</span><span>
</span></span><span><span>        rot </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> Rotation</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from_euler=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'x'</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">180</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> degrees</span><span class=3D"token token" style=3D"color: rgb(20, 24=
, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 1=
28);">True</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">return</span><span> rot</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>as_matrix</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">get_current_pose</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">&gt;</span><span> Di=
ct</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</s=
pan><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Get current end effector pose
</span><span>       =20
</span><span>        Returns:
</span><span>            Dictionary with 'position' and 'orientation'
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        position</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> orientation </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>robot</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>end_effector</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">.</span><span>get_world_pose</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> </span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">{</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'position'</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">:</span><span> position</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'orientation'</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> orientation
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">}</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">emergency_stop</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Emergency stop - halt al=
l motion"""</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"EMERGENCY STOP"</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>robot</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>apply_action</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan>self</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">.</span><span>robot</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">.</span><span>get_joint_positions</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>gripper</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span class=3D"token=
 token" style=3D"color: rgb(179, 74, 0);">open</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">RealRobotController</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">(</span><span>DishwashingRobotCon=
troller</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>)</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</s=
pan><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Controller for real robot hardware
</span><span>    Inherits from simulation controller but overrides hardware=
-specific methods
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> robot_ip</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">str</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> robot_type</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">:</span><span> </span><span class=3D"token token" style=3D"color:=
 rgb(179, 74, 0);">str</span><span> </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 0);">'franka'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Initialize real robot controller
</span><span>       =20
</span><span>        Args:
</span><span>            robot_ip: IP address of robot
</span><span>            robot_type: Type of robot
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># This would initialize actual robot connection</sp=
an><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Example for Franka:</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># from frankapy import FrankaArm</span><spa=
n>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># self.robot =3D FrankaArm(robot_ip)</span>=
<span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">raise</span><span> NotImplementedError</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"Real robot controller requires hardware-spe=
cific implementation. "</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">"See frankapy, ur_rtde, or other robot SDKs.=
"</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">move_to_pose</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span> target_positi=
on</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> target_orientation</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">,</span><span> timeout</span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">10.0</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Override with real robot=
 motion"""</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># self.robot.goto_pose(target_position, tar=
get_orientation)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">pass</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">_check_grasp_success</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><sp=
an class=3D"token token" style=3D"color: rgb(20, 24, 31);">&gt;</span><span=
> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">bool=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Override with real force=
/torque sensors"""</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># return self.robot.get_gripper_force() &gt=
; threshold</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">pass</span></span></code></pre></div></div>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">12. Main E=
xecution Script</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># main.py=
</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">import</span><span> numpy </span><span class=3D"token token" =
style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> argparse
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> pathlib </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">import</span><span> Path
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> torch
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Vision modules</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> vision</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">.</span><span>hybrid_vision </span><=
span class=3D"token token" style=3D"color: rgb(129, 0, 194);">import</span>=
<span> HybridVisionSystem
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Grasp planning</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> grasp_planning</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>grasp_planner =
</span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">impor=
t</span><span> GraspPlanner
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Simulation</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> simulation</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>isaac_environment =
</span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">impor=
t</span><span> VirtualSinkEnvironment
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Robot control</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> robot</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>robot_controller </span=
><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">import</spa=
n><span> DishwashingRobotController
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># Training</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> training</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>dataset </span><span=
 class=3D"token token" style=3D"color: rgb(129, 0, 194);">import</span><spa=
n> generate_dataset_from_simulation
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> training</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>train_grasp_predicto=
r </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">imp=
ort</span><span> GraspPredictorTrainer
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">class</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">DishwashingRobotSystem</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Complete dishwashing robot system integrating all c=
omponents
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">__init__</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        mode</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">str</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'simulation'<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span=
><span>
</span></span><span><span>        use_qwen</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">True</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span>
</span></span><span><span>        predictor_checkpoint</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(179, 74, 0);">str</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</sp=
an><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 12=
8);">None</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">,</span><span>
</span></span><span><span>        headless</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(179, 74, 0);">bool</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> <=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">False<=
/span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Initialize complete system
</span><span>       =20
</span><span>        Args:
</span><span>            mode: 'simulation' or 'real'
</span><span>            use_qwen: Whether to use Qwen3-VL semantic underst=
anding
</span><span>            predictor_checkpoint: Path to trained predictor mo=
del
</span><span>            headless: Run Isaac Sim without GUI
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        self</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">.</span><span>mode </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> mode
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"=3D"</span><span class=3D"token token" style=3D"color: rgb(=
20, 24, 31);">*</span><span class=3D"token token" style=3D"color: rgb(0, 12=
8, 128);">60</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"Dishwashing Robot System"</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">*</span><span class=3D"token token" style=3D"color: r=
gb(0, 128, 128);">60</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Initialize Isaac Sim environment</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> mode </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 0);">'simulation'</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><sp=
an>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"\n[1/4] Initializing Isaac Sim environment..."=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>env </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> VirtualSin=
kEnvironment</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">(</span><span>headless</span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">=3D</span><span>headless</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 0);">"\n[2/4] Initializing robot controller..."</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>robot </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> Dishwas=
hingRobotController</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">(</span><span>
</span></span><span><span>                world</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>self</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>env</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>world</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">,</span><span>
</span></span><span><span>                robot_type</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 0);">'franka'</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            camera_intrinsics </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>env=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</spa=
n><span>camera_intrinsics
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">raise</span><span> NotImplementedError</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 0);">"Real robot mode=
 not yet implemented"</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Initialize vision system</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"\n[3/4] Initializing vision system..."</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>vision </span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> HybridVisio=
nSystem</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span>
</span></span><span><span>            camera_intrinsics</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>camera_i=
ntrinsics</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">,</span><span>
</span></span><span><span>            use_qwen</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>use_qwen
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Initialize grasp planner</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"\n[4/4] Initializing grasp planner..."</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>planner </span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> GraspPlann=
er</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</s=
pan><span>
</span></span><span><span>            predictor_model_path</span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>predict=
or_checkpoint</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span>
</span></span><span><span>            device</span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 0);">'cuda'</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(129, 0, 194);">if</span><span> torch</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>cuda</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>.</span><span>is_available</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">)</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">else</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">'cpu'</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            use_predictor</span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">(</span><span>predictor_checkpoin=
t </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">is<=
/span><span> </span><span class=3D"token token" style=3D"color: rgb(129, 0,=
 194);">not</span><span> </span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 128);">None</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"\n"</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">*</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">60</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"System initialization complete!"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">*</span><span class=3D"token token" style=3D"color: r=
gb(0, 128, 128);">60</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"\n"</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">run_single_task</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> visualize=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0)=
;">bool</span><span> </span><span class=3D"token token" style=3D"color: rgb=
(20, 24, 31);">=3D</span><span> </span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 128);">True</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Run a single dishwashing task
</span><span>       =20
</span><span>        Args:
</span><span>            visualize: Whether to visualize grasps
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"\n"</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">*</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">60</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"Starting dishwashing task"</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">*</span><span class=3D"token token" style=3D"color: r=
gb(0, 128, 128);">60</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 1: Capture scene</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"\n[Step 1/4] Capturing scene..."</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        rgb</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span> depth </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
env</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</=
span><span>get_camera_observation</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 2: Analyze scene</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"\n[Step 2/4] Analyzing scene with hybrid vision..."=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>
</span></span><span><span>        scene </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>vision</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><s=
pan>analyze_scene</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">(</span><span>rgb</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">,</span><span> depth</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpolatio=
n" style=3D"color: rgb(0, 128, 0);">f"\nScene analysis complete:"</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  - Detected </span><span cla=
ss=3D"token token string-interpolation interpolation" style=3D"color: rgb(4=
3, 48, 59);">{</span><span class=3D"token token string-interpolation interp=
olation">scene</span><span class=3D"token token string-interpolation interp=
olation" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token tok=
en string-interpolation interpolation" style=3D"color: rgb(0, 128, 0);">'nu=
m_dishes'</span><span class=3D"token token string-interpolation interpolati=
on" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token st=
ring-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</span=
><span class=3D"token token string-interpolation" style=3D"color: rgb(0, 12=
8, 0);"> dishes"</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">for</span><span> i</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> dish </span><span =
class=3D"token token" style=3D"color: rgb(129, 0, 194);">in</span><span> </=
span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">enumerat=
e</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</sp=
an><span>scene</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">[</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);=
">'dishes'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>  </span><=
span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Show top =
3</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-i=
nterpolation" style=3D"color: rgb(0, 128, 0);">f"  - Dish </span><span clas=
s=3D"token token string-interpolation interpolation" style=3D"color: rgb(43=
, 48, 59);">{</span><span class=3D"token token string-interpolation interpo=
lation">i</span><span class=3D"token token string-interpolation interpolati=
on" style=3D"color: rgb(20, 24, 31);">+</span><span class=3D"token token st=
ring-interpolation interpolation" style=3D"color: rgb(0, 128, 128);">1</spa=
n><span class=3D"token token string-interpolation interpolation" style=3D"c=
olor: rgb(43, 48, 59);">}</span><span class=3D"token token string-interpola=
tion" style=3D"color: rgb(0, 128, 0);">: </span><span class=3D"token token =
string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">{</sp=
an><span class=3D"token token string-interpolation interpolation">dish</spa=
n><span class=3D"token token string-interpolation interpolation" style=3D"c=
olor: rgb(43, 48, 59);">[</span><span class=3D"token token string-interpola=
tion interpolation" style=3D"color: rgb(0, 128, 0);">'type'</span><span cla=
ss=3D"token token string-interpolation interpolation" style=3D"color: rgb(4=
3, 48, 59);">]</span><span class=3D"token token string-interpolation interp=
olation" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token tok=
en string-interpolation" style=3D"color: rgb(0, 128, 0);"> "</span><span>
</span></span><span><span>                  </span><span class=3D"token tok=
en string-interpolation" style=3D"color: rgb(0, 128, 0);">f"(graspability: =
</span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(43, 48, 59);">{</span><span class=3D"token token string-inte=
rpolation interpolation">dish</span><span class=3D"token token string-inter=
polation interpolation" style=3D"color: rgb(43, 48, 59);">.</span><span cla=
ss=3D"token token string-interpolation interpolation">get</span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">(</span><span class=3D"token token string-interpolation interpol=
ation" style=3D"color: rgb(0, 128, 0);">'graspability_combined'</span><span=
 class=3D"token token string-interpolation interpolation" style=3D"color: r=
gb(43, 48, 59);">,</span><span class=3D"token token string-interpolation in=
terpolation"> </span><span class=3D"token token string-interpolation interp=
olation" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token to=
ken string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">)=
</span><span class=3D"token token string-interpolation interpolation" style=
=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token string-inte=
rpolation interpolation format-spec">.1f</span><span class=3D"token token s=
tring-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</spa=
n><span class=3D"token token string-interpolation" style=3D"color: rgb(0, 1=
28, 0);">/10)"</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> scene</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'num_dishes'</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </span><s=
pan class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"\nNo dishes detected. Task complete!"</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 3: Plan grasp</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"\n[Step 3/4] Planning grasp..."</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        grasp_result </span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>plann=
er</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</s=
pan><span>plan_grasp</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">(</span><span>
</span></span><span><span>            scene</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">=3D</span><span>scene</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            num_candidates</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">20</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">not</span><span> grasp_result</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'success'</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-i=
nterpolation" style=3D"color: rgb(0, 128, 0);">f"Grasp planning failed: </s=
pan><span class=3D"token token string-interpolation interpolation" style=3D=
"color: rgb(43, 48, 59);">{</span><span class=3D"token token string-interpo=
lation interpolation">grasp_result</span><span class=3D"token token string-=
interpolation interpolation" style=3D"color: rgb(43, 48, 59);">[</span><spa=
n class=3D"token token string-interpolation interpolation" style=3D"color: =
rgb(0, 128, 0);">'reason'</span><span class=3D"token token string-interpola=
tion interpolation" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">}</span><span class=3D"token token string-interpolation" style=
=3D"color: rgb(0, 128, 0);">"</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">return</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpolatio=
n" style=3D"color: rgb(0, 128, 0);">f"\nGrasp plan:"</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  - Target: </span><span clas=
s=3D"token token string-interpolation interpolation" style=3D"color: rgb(43=
, 48, 59);">{</span><span class=3D"token token string-interpolation interpo=
lation">grasp_result</span><span class=3D"token token string-interpolation =
interpolation" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"tok=
en token string-interpolation interpolation" style=3D"color: rgb(0, 128, 0)=
;">'target_dish'</span><span class=3D"token token string-interpolation inte=
rpolation" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token t=
oken string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">=
[</span><span class=3D"token token string-interpolation interpolation" styl=
e=3D"color: rgb(0, 128, 0);">'type'</span><span class=3D"token token string=
-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">]</span><sp=
an class=3D"token token string-interpolation interpolation" style=3D"color:=
 rgb(43, 48, 59);">}</span><span class=3D"token token string-interpolation"=
 style=3D"color: rgb(0, 128, 0);">"</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  - Strategy: </span><span cl=
ass=3D"token token string-interpolation interpolation" style=3D"color: rgb(=
43, 48, 59);">{</span><span class=3D"token token string-interpolation inter=
polation">grasp_result</span><span class=3D"token token string-interpolatio=
n interpolation" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token string-interpolation interpolation" style=3D"color: rgb(0, 128, =
0);">'grasp'</span><span class=3D"token token string-interpolation interpol=
ation" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token=
 string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">[</s=
pan><span class=3D"token token string-interpolation interpolation" style=3D=
"color: rgb(0, 128, 0);">'strategy'</span><span class=3D"token token string=
-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">]</span><sp=
an class=3D"token token string-interpolation interpolation" style=3D"color:=
 rgb(43, 48, 59);">}</span><span class=3D"token token string-interpolation"=
 style=3D"color: rgb(0, 128, 0);">"</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  - Confidence: </span><span =
class=3D"token token string-interpolation interpolation" style=3D"color: rg=
b(43, 48, 59);">{</span><span class=3D"token token string-interpolation int=
erpolation">grasp_result</span><span class=3D"token token string-interpolat=
ion interpolation" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D=
"token token string-interpolation interpolation" style=3D"color: rgb(0, 128=
, 0);">'score'</span><span class=3D"token token string-interpolation interp=
olation" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token tok=
en string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">:<=
/span><span class=3D"token token string-interpolation interpolation format-=
spec">.3f</span><span class=3D"token token string-interpolation interpolati=
on" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token st=
ring-interpolation" style=3D"color: rgb(0, 128, 0);">"</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Visualize if requested</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> visualize</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"\n  Visualizing grasp (close window to continu=
e)..."</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>planner</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>visualize_=
grasps</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
(</span><span>scene</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">,</span><span> grasp_result</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span> show_all</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">False</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Step 4: Execute grasp</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"\n[Step 4/4] Executing grasp..."</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        success </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>robot</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>execute_grasp</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">(</span><span>grasp_result</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"=
color: rgb(0, 128, 0);">'grasp'</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">if</span><span> success</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"\n"</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">"=3D"</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">60</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"=E2=9C=93 Task completed successfully!"</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">*</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 128);">60</span><span> </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 0);">"\n"</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"\n"</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">"=3D"</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">60</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"=E2=9C=97 Task failed"</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">*</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 128);">60</span><span> </span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 0);">"\n"</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">return</span><span> success
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">run_full_sink</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> max_attempts=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span> </span><span class=3D"token token" style=3D"color: rgb(179, 74, 0)=
;">int</span><span> </span><span class=3D"token token" style=3D"color: rgb(=
20, 24, 31);">=3D</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 128, 128);">10</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Empty entire sink by picking dishes one by one
</span><span>       =20
</span><span>        Args:
</span><span>            max_attempts: Maximum number of pick attempts
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"\n"</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">*</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">60</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"Starting full sink cleaning"</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">*</span><span class=3D"token token" style=3D"color: r=
gb(0, 128, 128);">60</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        successful_picks </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">for</span><span> attempt </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">in</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(179, 74, 0);">range</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>max_attemp=
ts</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><=
span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-i=
nterpolation" style=3D"color: rgb(0, 128, 0);">f"\n\n</span><span class=3D"=
token token string-interpolation interpolation" style=3D"color: rgb(43, 48,=
 59);">{</span><span class=3D"token token string-interpolation interpolatio=
n" style=3D"color: rgb(0, 128, 0);">'=3D'</span><span class=3D"token token =
string-interpolation interpolation" style=3D"color: rgb(20, 24, 31);">*</sp=
an><span class=3D"token token string-interpolation interpolation" style=3D"=
color: rgb(0, 128, 128);">60</span><span class=3D"token token string-interp=
olation interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span clas=
s=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">"</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-i=
nterpolation" style=3D"color: rgb(0, 128, 0);">f"Pick attempt </span><span =
class=3D"token token string-interpolation interpolation" style=3D"color: rg=
b(43, 48, 59);">{</span><span class=3D"token token string-interpolation int=
erpolation">attempt </span><span class=3D"token token string-interpolation =
interpolation" style=3D"color: rgb(20, 24, 31);">+</span><span class=3D"tok=
en token string-interpolation interpolation"> </span><span class=3D"token t=
oken string-interpolation interpolation" style=3D"color: rgb(0, 128, 128);"=
>1</span><span class=3D"token token string-interpolation interpolation" sty=
le=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token string-in=
terpolation" style=3D"color: rgb(0, 128, 0);">/</span><span class=3D"token =
token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);"=
>{</span><span class=3D"token token string-interpolation interpolation">max=
_attempts</span><span class=3D"token token string-interpolation interpolati=
on" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token st=
ring-interpolation" style=3D"color: rgb(0, 128, 0);">"</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">*</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 128);">60</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Check if sink is empty</span><span>
</span></span><span><span>            rgb</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span> depth </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><=
span>env</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">.</span><span>get_camera_observation</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>            scene </span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>vision</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>analyze_scene</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">(</span><span>rgb</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">,</span><span> depth</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">if</span><span> scene</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 0);">'num_dishes'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">]</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 0);">"\n=E2=9C=93 Sink is empty! Task complete."</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">break</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">(</span><span class=3D"token token string-interpol=
ation" style=3D"color: rgb(0, 128, 0);">f"\nRemaining dishes: </span><span =
class=3D"token token string-interpolation interpolation" style=3D"color: rg=
b(43, 48, 59);">{</span><span class=3D"token token string-interpolation int=
erpolation">scene</span><span class=3D"token token string-interpolation int=
erpolation" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token =
token string-interpolation interpolation" style=3D"color: rgb(0, 128, 0);">=
'num_dishes'</span><span class=3D"token token string-interpolation interpol=
ation" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token=
 string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</s=
pan><span class=3D"token token string-interpolation" style=3D"color: rgb(0,=
 128, 0);">"</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(110, 118, 135);"># Attempt to pick one dish</span><span>
</span></span><span><span>            success </span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span> self</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>run_si=
ngle_task</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span>visualize</span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: r=
gb(0, 128, 128);">False</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">)</span><span>
</span></span><span>           =20
</span><span><span>            </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">if</span><span> success</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                successful_picks </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">+=3D</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><=
span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(129, 0, 194);">else</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>                </span><span class=3D"token token=
" style=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 0);">"Pick failed, will try again..."</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"\n"</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">*</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">60</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"Full sink cleaning complete!"=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</spa=
n><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  - Successful picks: </span>=
<span class=3D"token token string-interpolation interpolation" style=3D"col=
or: rgb(43, 48, 59);">{</span><span class=3D"token token string-interpolati=
on interpolation">successful_picks</span><span class=3D"token token string-=
interpolation interpolation" style=3D"color: rgb(43, 48, 59);">}</span><spa=
n class=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0)=
;">"</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  - Total attempts: </span><s=
pan class=3D"token token string-interpolation interpolation" style=3D"color=
: rgb(43, 48, 59);">{</span><span class=3D"token token string-interpolation=
 interpolation">attempt </span><span class=3D"token token string-interpolat=
ion interpolation" style=3D"color: rgb(20, 24, 31);">+</span><span class=3D=
"token token string-interpolation interpolation"> </span><span class=3D"tok=
en token string-interpolation interpolation" style=3D"color: rgb(0, 128, 12=
8);">1</span><span class=3D"token token string-interpolation interpolation"=
 style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token token strin=
g-interpolation" style=3D"color: rgb(0, 128, 0);">"</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"  - Success rate: </span><spa=
n class=3D"token token string-interpolation interpolation" style=3D"color: =
rgb(43, 48, 59);">{</span><span class=3D"token token string-interpolation i=
nterpolation" style=3D"color: rgb(0, 128, 128);">100</span><span class=3D"t=
oken token string-interpolation interpolation" style=3D"color: rgb(20, 24, =
31);">*</span><span class=3D"token token string-interpolation interpolation=
">successful_picks</span><span class=3D"token token string-interpolation in=
terpolation" style=3D"color: rgb(20, 24, 31);">/</span><span class=3D"token=
 token string-interpolation interpolation" style=3D"color: rgb(43, 48, 59);=
">(</span><span class=3D"token token string-interpolation interpolation">at=
tempt</span><span class=3D"token token string-interpolation interpolation" =
style=3D"color: rgb(20, 24, 31);">+</span><span class=3D"token token string=
-interpolation interpolation" style=3D"color: rgb(0, 128, 128);">1</span><s=
pan class=3D"token token string-interpolation interpolation" style=3D"color=
: rgb(43, 48, 59);">)</span><span class=3D"token token string-interpolation=
 interpolation" style=3D"color: rgb(43, 48, 59);">:</span><span class=3D"to=
ken token string-interpolation interpolation format-spec">.1f</span><span c=
lass=3D"token token string-interpolation interpolation" style=3D"color: rgb=
(43, 48, 59);">}</span><span class=3D"token token string-interpolation" sty=
le=3D"color: rgb(0, 128, 0);">%"</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">*</span><span class=3D"token token" style=3D"color: r=
gb(0, 128, 128);">60</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"\n"</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">generate_training_data</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> num=
_samples</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">:</span><span> </span><span class=3D"token token" style=3D"color: rgb(179=
, 74, 0);">int</span><span> </span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">10000</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">,</span><span> output_dir</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(179, 74, 0);">str</span><spa=
n> </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 0);">'./data/grasp_dataset'</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Generate training data from simulation
</span><span>       =20
</span><span>        Args:
</span><span>            num_samples: Number of training samples
</span><span>            output_dir: Where to save dataset
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"\n"</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">*</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">60</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"Generating </span><span class=
=3D"token token string-interpolation interpolation" style=3D"color: rgb(43,=
 48, 59);">{</span><span class=3D"token token string-interpolation interpol=
ation">num_samples</span><span class=3D"token token string-interpolation in=
terpolation" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token=
 token string-interpolation" style=3D"color: rgb(0, 128, 0);"> training sam=
ples"</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">*</span><span class=3D"token token" style=3D"color: r=
gb(0, 128, 128);">60</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"\n"</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        generate_dataset_from_simulation</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            isaac_env</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>self</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>env</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>            output_dir</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>output_dir</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>            num_samples</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>num_samples</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><sp=
an>
</span></span><span><span>            samples_per_scene</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">10</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"\n=E2=9C=93 Dataset generation complete!"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">train_predictor</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        self</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        data_dir</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(179, 74, 0);">str</span><span> </span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> </=
span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'./data/g=
rasp_dataset'</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span>
</span></span><span><span>        output_dir</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">str</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'./chec=
kpoints'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">,</span><span>
</span></span><span><span>        num_epochs</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(179, 74, 0);">int</span><span> </span><spa=
n class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> =
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">50</s=
pan><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>        Train grasp success predictor
</span><span>       =20
</span><span>        Args:
</span><span>            data_dir: Directory containing dataset
</span><span>            output_dir: Where to save checkpoints
</span><span>            num_epochs: Number of training epochs
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">        """</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"\n"</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">*</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 128);">60</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"Training grasp success predictor"</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"=3D"</span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">*</span><span class=3D"token token" style=3D"color: r=
gb(0, 128, 128);">60</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">"\n"</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        trainer </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> GraspPredictorTrainer</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>            data_dir</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">=3D</span><span>data_dir</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            output_dir</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>output_dir</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>            batch_size</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 128);">16</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            learning_rate</span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 128);">1e-4</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            num_epochs</span><span class=3D"token=
 token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>num_epochs</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span=
>
</span></span><span><span>            device</span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 0);">'cuda'</span><span> </span><span class=3D=
"token token" style=3D"color: rgb(129, 0, 194);">if</span><span> torch</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>cuda</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>.</span><span>is_available</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">)</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(129, 0, 194);">else</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">'cpu'</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>            use_wandb</span><span class=3D"token =
token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        trainer</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>train</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 0);">"\n=E2=9C=93 Training complete!"</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token string-inte=
rpolation" style=3D"color: rgb(0, 128, 0);">f"Best model saved to: </span><=
span class=3D"token token string-interpolation interpolation" style=3D"colo=
r: rgb(43, 48, 59);">{</span><span class=3D"token token string-interpolatio=
n interpolation">output_dir</span><span class=3D"token token string-interpo=
lation interpolation" style=3D"color: rgb(43, 48, 59);">}</span><span class=
=3D"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">/che=
ckpoint_best.pth"</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">def</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 81, 194);">close</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token triple-=
quoted-string" style=3D"color: rgb(0, 128, 0);">"""Cleanup and shutdown"""<=
/span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"\nShutting down system..."</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(179, 74, 0);">hasattr</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span>self</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'env'</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>            self</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">.</span><span>env</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>close</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"=E2=9C=93 Shutdown complete"</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">def</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 81, 194);">main</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""Main entry point"""</span><s=
pan>
</span></span><span>   =20
</span><span><span>    parser </span><span class=3D"token token" style=3D"c=
olor: rgb(20, 24, 31);">=3D</span><span> argparse</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>ArgumentParser</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><s=
pan>description</span><span class=3D"token token" style=3D"color: rgb(20, 2=
4, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, =
0);">'Dishwashing Robot System'</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    parser</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">.</span><span>add_argument</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'--mode'</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        choices</span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'demo'</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 0);">'train_data'</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span clas=
s=3D"token token" style=3D"color: rgb(0, 128, 0);">'train_model'</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </=
span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'full_sin=
k'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>        default</span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'demo'</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">help</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 0);">'Operation mode'</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    parser</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">.</span><span>add_argument</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'--checkpoint'</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">type</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(179, 74, 0);">str</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        default</span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">None</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">help</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 0);">'Path to trained predictor checkpoint'</span><span=
>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    parser</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">.</span><span>add_argument</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'--no-qwen'</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        action</span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 0);">'store_true'</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">help</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 0);">'Disable Qwen3-VL (faster but less semantic unders=
tanding)'</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    parser</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">.</span><span>add_argument</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'--headless'</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        action</span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" sty=
le=3D"color: rgb(0, 128, 0);">'store_true'</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">help</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 0);">'Run Isaac Sim in headless mode'</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    parser</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">.</span><span>add_argument</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'--num-samples'</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">type</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(179, 74, 0);">int</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        default</span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">10000</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">help</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 0);">'Number of training samples to generate'</span><sp=
an>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    parser</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">.</span><span>add_argument</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'--num-epochs'</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">type</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(179, 74, 0);">int</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        default</span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">50</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">help</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 0);">'Number of training epochs'</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    parser</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">.</span><span>add_argument</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'--data-dir'</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">type</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(179, 74, 0);">str</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        default</span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'./data/grasp_dataset'</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">help</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 0);">'Dataset directory'</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    parser</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">.</span><span>add_argument</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'--output-dir'</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">type</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(179, 74, 0);">str</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        default</span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 0);">'./checkpoints'</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(179, 74, 0);">help</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 0);">'Output directory for checkpoints'</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    args </span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">=3D</span><span> parser</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">.</span><span>parse_args</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Initialize system</span><span>
</span></span><span><span>    system </span><span class=3D"token token" sty=
le=3D"color: rgb(20, 24, 31);">=3D</span><span> DishwashingRobotSystem</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>
</span></span><span><span>        mode</span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'simulation'</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        use_qwen</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(129, 0, 194);">not</span><span> args</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>no_qwen</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span>
</span></span><span><span>        predictor_checkpoint</span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>args</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>checkpoint</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span>
</span></span><span><span>        headless</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span>args</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>headless
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">try</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">if</span><span> args</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>mode </span><span=
 class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span=
> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'demo=
'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</sp=
an><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Run single task demonstration</span><s=
pan>
</span></span><span><span>            system</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>env</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>spawn_rand=
om_dishes</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span>num_dishes</span><span class=3D"token token" style=3D"colo=
r: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: =
rgb(0, 128, 128);">5</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">)</span><span>
</span></span><span><span>            system</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>run_single_task</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>=
visualize</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31)=
;">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);"=
>True</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">elif</span><span> args</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>mode </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'train_data=
'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</sp=
an><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Generate training data</span><span>
</span></span><span><span>            system</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>generate_training_data<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span>
</span></span><span><span>                num_samples</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>args</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>=
num_samples</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span>
</span></span><span><span>                output_dir</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>args</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>d=
ata_dir
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">elif</span><span> args</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>mode </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'train_mode=
l'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</s=
pan><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Train predictor model</span><span>
</span></span><span><span>            system</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>train_predictor</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>                data_dir</span><span class=3D"tok=
en token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>args</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>dat=
a_dir</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,=
</span><span>
</span></span><span><span>                output_dir</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>args</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>o=
utput_dir</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">,</span><span>
</span></span><span><span>                num_epochs</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>args</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>n=
um_epochs
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(129, 0, 194);">elif</span><span> args</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>mode </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'full_sink'=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span>
</span></span><span><span>            </span><span class=3D"token token" st=
yle=3D"color: rgb(110, 118, 135);"># Clean entire sink</span><span>
</span></span><span><span>            system</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>env</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>spawn_rand=
om_dishes</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">(</span><span>num_dishes</span><span class=3D"token token" style=3D"colo=
r: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: =
rgb(0, 128, 128);">8</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">)</span><span>
</span></span><span><span>            system</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>run_full_sink</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>ma=
x_attempts</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">15</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)<=
/span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">finally</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        system</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>close</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">if</span><span> __name__ </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'__main__'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    main</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span></span></code></pre></div></div>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">13. Utilit=
y Functions</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># utils/t=
ransforms.py</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">import</span><span> numpy </span><span class=3D"token token" =
style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> scipy</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>spatial</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>transfor=
m </span><span class=3D"token token" style=3D"color: rgb(129, 0, 194);">imp=
ort</span><span> Rotation
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> typing </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">import</span><span> Tuple
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">def</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 81, 194);">pose_to_transform_matrix</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>position</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> n=
p</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</sp=
an><span>ndarray</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">,</span><span> orientation</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">&gt;</span><spa=
n> np</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.=
</span><span>ndarray</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Convert position and orientation to 4x4 transformat=
ion matrix
</span><span>   =20
</span><span>    Args:
</span><span>        position: [x, y, z]
</span><span>        orientation: [qw, qx, qy, qz] or 3x3 rotation matrix
</span><span>       =20
</span><span>    Returns:
</span><span>        4x4 transformation matrix
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    T </span><span class=3D"token token" style=3D"color:=
 rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">.</span><span>eye</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token tok=
en" style=3D"color: rgb(0, 128, 128);">4</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Position</span><span>
</span></span><span><span>    T</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">:</span><span class=3D"token token" style=3D"color: rgb=
(0, 128, 128);">3</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"color=
: rgb(0, 128, 128);">3</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">]</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(20, 24, 31);">=3D</span><span> position
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Orientation</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">if</span><span> orientation</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>shape </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span><s=
pan> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(=
</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">4</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>  </sp=
an><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># Quate=
rnion</span><span>
</span></span><span><span>        qw</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span> qx</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> qy</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> qz </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><=
span> orientation
</span></span><span><span>        rot </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> Rotation</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>from_quat<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><spa=
n>qx</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,<=
/span><span> qy</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">,</span><span> qz</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">,</span><span> qw</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        T</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">:</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 128);">3</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">:</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 128);">3</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">]</span><span> </span><span class=3D"token token" style=3D"c=
olor: rgb(20, 24, 31);">=3D</span><span> rot</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>as_matrix</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">elif</span><span> orientation</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>shape </span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=3D</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>(</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span>=
<span> </span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">3</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span>=
<span>  </span><span class=3D"token token" style=3D"color: rgb(110, 118, 13=
5);"># Rotation matrix</span><span>
</span></span><span><span>        T</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">:</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 128);">3</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">:</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 128);">3</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">]</span><span> </span><span class=3D"token token" style=3D"c=
olor: rgb(20, 24, 31);">=3D</span><span> orientation
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">else</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">raise</span><span> ValueError</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D=
"token token string-interpolation" style=3D"color: rgb(0, 128, 0);">f"Inval=
id orientation shape: </span><span class=3D"token token string-interpolatio=
n interpolation" style=3D"color: rgb(43, 48, 59);">{</span><span class=3D"t=
oken token string-interpolation interpolation">orientation</span><span clas=
s=3D"token token string-interpolation interpolation" style=3D"color: rgb(43=
, 48, 59);">.</span><span class=3D"token token string-interpolation interpo=
lation">shape</span><span class=3D"token token string-interpolation interpo=
lation" style=3D"color: rgb(43, 48, 59);">}</span><span class=3D"token toke=
n string-interpolation" style=3D"color: rgb(0, 128, 0);">"</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">return</span><span> T
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">def</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 81, 194);">transform_matrix_to_pose</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span>T</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><spa=
n>ndarray</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59)=
;">)</span><span> </span><span class=3D"token token" style=3D"color: rgb(20=
, 24, 31);">-</span><span class=3D"token token" style=3D"color: rgb(20, 24,=
 31);">&gt;</span><span> Tuple</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">[</span><span>np</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> np</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>ndarray</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</=
span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Convert 4x4 transformation matrix to position and q=
uaternion
</span><span>   =20
</span><span>    Args:
</span><span>        T: 4x4 transformation matrix
</span><span>       =20
</span><span>    Returns:
</span><span>        position: [x, y, z]
</span><span>        orientation: [qw, qx, qy, qz]
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    position </span><span class=3D"token token" style=3D=
"color: rgb(20, 24, 31);">=3D</span><span> T</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">:</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">3</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 128);">3</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>   =20
</span><span><span>    rot </span><span class=3D"token token" style=3D"colo=
r: rgb(20, 24, 31);">=3D</span><span> Rotation</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">.</span><span>from_matrix</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>T<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><spa=
n class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    quat </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> rot</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>as_quat</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>  </span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># [qx, qy=
, qz, qw]</span><span>
</span></span><span><span>    orientation </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span>qu=
at</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</s=
pan><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> qua=
t</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</sp=
an><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span =
class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> quat=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</spa=
n><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> quat<=
/span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span=
><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>  </span><=
span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># [qw, qx, =
qy, qz]</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">return</span><span> position</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span> orientation
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">def</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 81, 194);">quaternion_multiply</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">(</span><span>q1</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>nd=
array</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,=
</span><span> q2</span><span class=3D"token token" style=3D"color: rgb(43, =
48, 59);">:</span><span> np</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">.</span><span>ndarray</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><span class=3D"to=
ken token" style=3D"color: rgb(20, 24, 31);">-</span><span class=3D"token t=
oken" style=3D"color: rgb(20, 24, 31);">&gt;</span><span> np</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndarray=
</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</spa=
n><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Multiply two quaternions
</span><span>   =20
</span><span>    Args:
</span><span>        q1, q2: [qw, qx, qy, qz]
</span><span>       =20
</span><span>    Returns:
</span><span>        Result quaternion [qw, qx, qy, qz]
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    w1</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">,</span><span> x1</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">,</span><span> y1</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">,</span><span> z1 </span><span cla=
ss=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span> q1
</span></span><span><span>    w2</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">,</span><span> x2</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">,</span><span> y2</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> z2 </span><s=
pan class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span=
> q2
</span></span><span>   =20
</span><span><span>    w </span><span class=3D"token token" style=3D"color:=
 rgb(20, 24, 31);">=3D</span><span> w1</span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">*</span><span>w2 </span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">-</span><span> x1</span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span>x2 </sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><s=
pan> y1</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);"=
>*</span><span>y2 </span><span class=3D"token token" style=3D"color: rgb(20=
, 24, 31);">-</span><span> z1</span><span class=3D"token token" style=3D"co=
lor: rgb(20, 24, 31);">*</span><span>z2
</span></span><span><span>    x </span><span class=3D"token token" style=3D=
"color: rgb(20, 24, 31);">=3D</span><span> w1</span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">*</span><span>x2 </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><span> x1</span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span=
>w2 </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">+<=
/span><span> y1</span><span class=3D"token token" style=3D"color: rgb(20, 2=
4, 31);">*</span><span>z2 </span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">-</span><span> z1</span><span class=3D"token token" sty=
le=3D"color: rgb(20, 24, 31);">*</span><span>y2
</span></span><span><span>    y </span><span class=3D"token token" style=3D=
"color: rgb(20, 24, 31);">=3D</span><span> w1</span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">*</span><span>y2 </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span> x1</span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span=
>z2 </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">+<=
/span><span> y1</span><span class=3D"token token" style=3D"color: rgb(20, 2=
4, 31);">*</span><span>w2 </span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">+</span><span> z1</span><span class=3D"token token" sty=
le=3D"color: rgb(20, 24, 31);">*</span><span>x2
</span></span><span><span>    z </span><span class=3D"token token" style=3D=
"color: rgb(20, 24, 31);">=3D</span><span> w1</span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">*</span><span>z2 </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><span> x1</span>=
<span class=3D"token token" style=3D"color: rgb(20, 24, 31);">*</span><span=
>y2 </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">-<=
/span><span> y1</span><span class=3D"token token" style=3D"color: rgb(20, 2=
4, 31);">*</span><span>x2 </span><span class=3D"token token" style=3D"color=
: rgb(20, 24, 31);">+</span><span> z1</span><span class=3D"token token" sty=
le=3D"color: rgb(20, 24, 31);">*</span><span>w2
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">return</span><span> np</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>array</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">[</span><span>w</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> x</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 y</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</s=
pan><span> z</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);"=
>)</span><span>
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">def</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 81, 194);">quaternion_inverse</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">(</span><span>q</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">:</span><span> np</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>ndar=
ray</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span> </span><span class=3D"token token" style=3D"color: rgb(20, 24, =
31);">-</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);"=
>&gt;</span><span> np</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">.</span><span>ndarray</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>    Compute quaternion inverse (conjugate for unit quat=
ernions)
</span><span>   =20
</span><span>    Args:
</span><span>        q: [qw, qx, qy, qz]
</span><span>       =20
</span><span>    Returns:
</span><span>        Inverse quaternion
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">    """</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">return</span><span> np</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>array</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">[</span><span>q</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"t=
oken token" style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">-</span><span>q</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span>q</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span c=
lass=3D"token token" style=3D"color: rgb(0, 128, 128);">2</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span c=
lass=3D"token token" style=3D"color: rgb(20, 24, 31);">-</span><span>q</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><sp=
an class=3D"token token" style=3D"color: rgb(0, 128, 128);">3</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># utils/visualization.py</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">import</span><span> matplotlib</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>pyplot </span><span cla=
ss=3D"token token" style=3D"color: rgb(129, 0, 194);">as</span><span> plt
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> numpy </span><span class=3D"token =
token" style=3D"color: rgb(129, 0, 194);">as</span><span> np
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">from</span><span> typing </span><span class=3D"token t=
oken" style=3D"color: rgb(129, 0, 194);">import</span><span> List</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> D=
ict
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">import</span><span> open3d </span><span class=3D"token=
 token" style=3D"color: rgb(129, 0, 194);">as</span><span> o3d
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">def</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 81, 194);">plot_training_curves</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">(</span><span>train_losses</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span> L=
ist</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">[</=
span><span class=3D"token token" style=3D"color: rgb(179, 74, 0);">float</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 val_losses</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">:</span><span> List</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(1=
79, 74, 0);">float</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span> val_accs</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">:</span><span> List</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token token" st=
yle=3D"color: rgb(179, 74, 0);">float</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"colo=
r: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""Plot training curves"""</spa=
n><span>
</span></span><span>   =20
</span><span><span>    fig</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span>ax1</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">,</span><span> ax2</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span> </span><=
span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><spa=
n> plt</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
.</span><span>subplots</span><span class=3D"token token" style=3D"color: rg=
b(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(0, =
128, 128);">1</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span> </span><span class=3D"token token" style=3D"color: rg=
b(0, 128, 128);">2</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">,</span><span> figsize</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"colo=
r: rgb(0, 128, 128);">12</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">4</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Loss</span><span>
</span></span><span><span>    ax1</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>plot</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span>train_losses</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>=
 label</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'Tra=
in Loss'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">,</span><span> alpha</span><span class=3D"token token" style=3D"color: rg=
b(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb(0=
, 128, 128);">0.7</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">)</span><span>
</span></span><span><span>    ax1</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>plot</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span>val_losses</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> l=
abel</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'Val=
 Loss'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> alpha</span><span class=3D"token token" style=3D"color: rgb(=
20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, =
128, 128);">0.7</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span><span>    ax1</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>set_xlabel</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 0);">'Epoch'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    ax1</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>set_ylabel</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 0);">'Loss'</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    ax1</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>set_title</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 0);">'Training and Validation Loss'</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><sp=
an>
</span></span><span><span>    ax1</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>legend</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    ax1</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>grid</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">True</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span> alpha</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0.3</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Accuracy</span><span>
</span></span><span><span>    ax2</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>plot</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span>val_accs</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> lab=
el</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 0);">'Val Acc=
uracy'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
,</span><span> color</span><span class=3D"token token" style=3D"color: rgb(=
20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, =
128, 0);">'green'</span><span class=3D"token token" style=3D"color: rgb(43,=
 48, 59);">,</span><span> alpha</span><span class=3D"token token" style=3D"=
color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"col=
or: rgb(0, 128, 128);">0.7</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    ax2</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>set_xlabel</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 0);">'Epoch'</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    ax2</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>set_ylabel</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token=
 token" style=3D"color: rgb(0, 128, 0);">'Accuracy'</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    ax2</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>set_title</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token =
token" style=3D"color: rgb(0, 128, 0);">'Validation Accuracy'</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    ax2</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>legend</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    ax2</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>grid</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">True</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span> alpha</span><span class=
=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D=
"token token" style=3D"color: rgb(0, 128, 128);">0.3</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    plt</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">.</span><span>tight_layout</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    plt</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">.</span><span>show</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">def</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 81, 194);">visualize_grasp_candidates</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>    pointcloud</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> o3d</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span=
>PointCloud</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">,</span><span>
</span></span><span><span>    candidates</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">:</span><span> List</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">[</span><span>Dict</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>    scores</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">:</span><span> List</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"token tok=
en" style=3D"color: rgb(179, 74, 0);">float</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>    best_idx</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">:</span><span> </span><span class=3D"token =
token" style=3D"color: rgb(179, 74, 0);">int</span><span>
</span></span><span><span></span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token triple-quot=
ed-string" style=3D"color: rgb(0, 128, 0);">"""Visualize grasp candidates w=
ith scores"""</span><span>
</span></span><span>   =20
</span><span><span>    geometries </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">[</span><span>pointcloud</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Add coordinate frame</span><span>
</span></span><span><span>    coord </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>T=
riangleMesh</span><span class=3D"token token" style=3D"color: rgb(43, 48, 5=
9);">.</span><span>create_coordinate_frame</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span>size</span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">0.1</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    geometries</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>coord</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Visualize each candidate</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">for</span><span> i</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>candidate</span=
><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><spa=
n> score</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);=
">)</span><span> </span><span class=3D"token token" style=3D"color: rgb(129=
, 0, 194);">in</span><span> </span><span class=3D"token token" style=3D"col=
or: rgb(179, 74, 0);">enumerate</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color=
: rgb(179, 74, 0);">zip</span><span class=3D"token token" style=3D"color: r=
gb(43, 48, 59);">(</span><span>candidates</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span> scores</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Color: red (bad) to green (good)</span><s=
pan>
</span></span><span><span>        color </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> np</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">.</span><span>array</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span c=
lass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">1</span><span class=3D"=
token token" style=3D"color: rgb(20, 24, 31);">-</span><span>score</span><s=
pan class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> =
score</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,=
</span><span> </span><span class=3D"token token" style=3D"color: rgb(0, 128=
, 128);">0</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">]</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)=
</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Highlight best grasp</span><span>
</span></span><span><span>        size </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D</span><span> </span><span class=3D"tok=
en token" style=3D"color: rgb(0, 128, 128);">0.05</span><span> </span><span=
 class=3D"token token" style=3D"color: rgb(129, 0, 194);">if</span><span> i=
 </span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D=
=3D</span><span> best_idx </span><span class=3D"token token" style=3D"color=
: rgb(129, 0, 194);">else</span><span> </span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">0.02</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Create grasp visualization</span><span>
</span></span><span><span>        pos </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> candidate</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'position'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        ori </span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span> candidate</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'orientation'</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Coordinate frame</span><span>
</span></span><span><span>        frame </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><sp=
an>TriangleMesh</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">.</span><span>create_coordinate_frame</span><span class=3D"token t=
oken" style=3D"color: rgb(43, 48, 59);">(</span><span>size</span><span clas=
s=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span>size</s=
pan><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><=
span> origin</span><span class=3D"token token" style=3D"color: rgb(20, 24, =
31);">=3D</span><span>pos</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        frame</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">.</span><span>rotate</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span>ori</span><spa=
n class=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> ce=
nter</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D</span><span>pos</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">)</span><span>
</span></span><span><span>        geometries</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>frame</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Gripper fingers</span><span>
</span></span><span><span>        width </span><span class=3D"token token" =
style=3D"color: rgb(20, 24, 31);">=3D</span><span> candidate</span><span cl=
ass=3D"token token" style=3D"color: rgb(43, 48, 59);">[</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 0);">'gripper_width'</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">]</span><span>
</span></span><span><span>        finger1 </span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span>=
<span>TriangleMesh</span><span class=3D"token token" style=3D"color: rgb(43=
, 48, 59);">.</span><span>create_box</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">(</span><span>width</span><span class=3D"toke=
n token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token t=
oken" style=3D"color: rgb(0, 128, 128);">0.01</span><span class=3D"token to=
ken" style=3D"color: rgb(43, 48, 59);">,</span><span> height</span><span cl=
ass=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=
=3D"token token" style=3D"color: rgb(0, 128, 128);">0.04</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">,</span><span> depth</sp=
an><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span>=
<span class=3D"token token" style=3D"color: rgb(0, 128, 128);">0.005</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span=
>
</span></span><span><span>        finger1</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">.</span><span>translate</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>pos </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><sp=
an> ori @ np</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">.</span><span>array</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">[</span><span>width</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">/</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 128);">2</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" =
style=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        finger1</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">.</span><span>paint_uniform_color</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>color</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span>
</span></span><span><span>        geometries</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>finger1</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span>
</span></span><span>       =20
</span><span><span>        finger2 </span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span> o3d</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">.</span><span>geometry</span><sp=
an class=3D"token token" style=3D"color: rgb(43, 48, 59);">.</span><span>Tr=
iangleMesh</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59=
);">.</span><span>create_box</span><span class=3D"token token" style=3D"col=
or: rgb(43, 48, 59);">(</span><span>width</span><span class=3D"token token"=
 style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">0.01</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">,</span><span> height</span><span class=3D"t=
oken token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"toke=
n token" style=3D"color: rgb(0, 128, 128);">0.04</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">,</span><span> depth</span><span =
class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span cla=
ss=3D"token token" style=3D"color: rgb(0, 128, 128);">0.005</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        finger2</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">.</span><span>translate</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>pos </spa=
n><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">+</span><sp=
an> ori @ np</span><span class=3D"token token" style=3D"color: rgb(43, 48, =
59);">.</span><span>array</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: rgb(=
43, 48, 59);">[</span><span class=3D"token token" style=3D"color: rgb(20, 2=
4, 31);">-</span><span>width</span><span class=3D"token token" style=3D"col=
or: rgb(20, 24, 31);">/</span><span class=3D"token token" style=3D"color: r=
gb(0, 128, 128);">2</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">,</span><span> </span><span class=3D"token token" style=3D"col=
or: rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">,</span><span> </span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 128);">0</span><span class=3D"token token" style=3D"=
color: rgb(43, 48, 59);">]</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">)</span><span>
</span></span><span><span>        finger2</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">.</span><span>paint_uniform_color</span>=
<span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span=
>color</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">=
)</span><span>
</span></span><span><span>        geometries</span><span class=3D"token tok=
en" style=3D"color: rgb(43, 48, 59);">.</span><span>append</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>finger2</=
span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span>=
<span>
</span></span><span>   =20
</span><span><span>    o3d</span><span class=3D"token token" style=3D"color=
: rgb(43, 48, 59);">.</span><span>visualization</span><span class=3D"token =
token" style=3D"color: rgb(43, 48, 59);">.</span><span>draw_geometries</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>geometries</span><span class=3D"token token" style=3D"color: rgb(43, 48,=
 59);">,</span><span> window_name</span><span class=3D"token token" style=
=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=3D=
"color: rgb(0, 128, 0);">"Grasp Candidates"</span><span class=3D"token toke=
n" style=3D"color: rgb(43, 48, 59);">)</span></span></code></pre></div></di=
v>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">14. Exampl=
e Usage Scripts</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">python</div><div><pre class=3D"cod=
e-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D"c=
olor: rgb(20, 24, 31); background: transparent; font-family: var(--font-mon=
o);"><code class=3D"language-python" style=3D"color: rgb(20, 24, 31); backg=
round: transparent; font-family: var(--font-mono); white-space: pre;"><span=
><span class=3D"token token" style=3D"color: rgb(110, 118, 135);"># example=
s/quick_demo.py</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token triple-quoted-string" =
style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>Quick demonstration of the system
</span><span>Run this after installing all dependencies
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">"""</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">from</span><span> main </span><span class=3D"token token" sty=
le=3D"color: rgb(129, 0, 194);">import</span><span> DishwashingRobotSystem
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">def</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 81, 194);">main</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 0);">"Initializing dishwashing robot demo..."</span><span clas=
s=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Initialize system (without Qwen for faster demo)</spa=
n><span>
</span></span><span><span>    system </span><span class=3D"token token" sty=
le=3D"color: rgb(20, 24, 31);">=3D</span><span> DishwashingRobotSystem</spa=
n><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><sp=
an>
</span></span><span><span>        mode</span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'simulation'</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        use_qwen</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">False</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span class=3D"toke=
n token" style=3D"color: rgb(110, 118, 135);"># Set True to enable semantic=
 understanding</span><span>
</span></span><span><span>        predictor_checkpoint</span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 128);">None</span><span class=3D"tok=
en token" style=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span cl=
ass=3D"token token" style=3D"color: rgb(110, 118, 135);"># Set path if you =
have trained model</span><span>
</span></span><span><span>        headless</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">try</span><span class=3D"token token" style=3D"color: rgb=
(43, 48, 59);">:</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(110, 118, 135);"># Spawn some dishes</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"\nSpawning dishes in sink..."</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        system</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>env</span><span class=3D"to=
ken token" style=3D"color: rgb(43, 48, 59);">.</span><span>spawn_random_dis=
hes</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</=
span><span>num_dishes</span><span class=3D"token token" style=3D"color: rgb=
(20, 24, 31);">=3D</span><span class=3D"token token" style=3D"color: rgb(0,=
 128, 128);">5</span><span class=3D"token token" style=3D"color: rgb(43, 48=
, 59);">)</span><span>
</span></span><span>       =20
</span><span><span>        </span><span class=3D"token token" style=3D"colo=
r: rgb(110, 118, 135);"># Run single pick task</span><span>
</span></span><span><span>        </span><span class=3D"token token" style=
=3D"color: rgb(129, 0, 194);">print</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(0, 128, 0);">"\nRunning single pick demonstration..."</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>        system</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>run_single_task</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>visu=
alize</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=
=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">Tr=
ue</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</s=
pan><span>
</span></span><span>       =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(129, 0, 194);">finally</span><span class=3D"token token" style=3D"color:=
 rgb(43, 48, 59);">:</span><span>
</span></span><span><span>        system</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>close</span><span class=3D"=
token token" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token=
 token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">if</span><span> __name__ </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'__main__'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    main</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>
</span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
10, 118, 135);"># examples/full_pipeline.py</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token triple-quoted-string" =
style=3D"color: rgb(0, 128, 0);">"""
</span></span><span>Complete pipeline: generate data, train model, test
</span><span><span class=3D"token token triple-quoted-string" style=3D"colo=
r: rgb(0, 128, 0);">"""</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">from</span><span> main </span><span class=3D"token token" sty=
le=3D"color: rgb(129, 0, 194);">import</span><span> DishwashingRobotSystem
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">def</span><span> </span><span class=3D"token token" style=3D"=
color: rgb(0, 81, 194);">main</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color: =
rgb(43, 48, 59);">)</span><span class=3D"token token" style=3D"color: rgb(4=
3, 48, 59);">:</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(110, 118, 135);"># Step 1: Generate training data</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 0);">"=3D"</span><span class=3D"token token" style=3D"color: r=
gb(20, 24, 31);">*</span><span class=3D"token token" style=3D"color: rgb(0,=
 128, 128);">60</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 0);">"STEP 1: Generating training data"</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 0);">"=3D"</span><span class=3D"token token" style=3D"color: r=
gb(20, 24, 31);">*</span><span class=3D"token token" style=3D"color: rgb(0,=
 128, 128);">60</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    system </span><span class=3D"token token" style=3D"c=
olor: rgb(20, 24, 31);">=3D</span><span> DishwashingRobotSystem</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        mode</span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'simulation'</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        use_qwen</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">False</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        headless</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">True</span><span>  </span><span class=3D"=
token token" style=3D"color: rgb(110, 118, 135);"># Faster without renderin=
g</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    system</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">.</span><span>generate_training_data</span><span cla=
ss=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        num_samples</span><span class=3D"token to=
ken" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token=
" style=3D"color: rgb(0, 128, 128);">1000</span><span class=3D"token token"=
 style=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span class=3D"to=
ken token" style=3D"color: rgb(110, 118, 135);"># Use 10000+ for real train=
ing</span><span>
</span></span><span><span>        output_dir</span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 0);">'./data/grasp_dataset'</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    system</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">.</span><span>close</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Step 2: Train model</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 0);">"\n"</span><span> </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 0);">"=3D"</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">*</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">60</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 0);">"STEP 2: Training grasp predictor"</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 0);">"=3D"</span><span class=3D"token token" style=3D"color: r=
gb(20, 24, 31);">*</span><span class=3D"token token" style=3D"color: rgb(0,=
 128, 128);">60</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    system </span><span class=3D"token token" style=3D"c=
olor: rgb(20, 24, 31);">=3D</span><span> DishwashingRobotSystem</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        mode</span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'simulation'</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        use_qwen</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">False</span><span class=3D"token token" s=
tyle=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        headless</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">True</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    system</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">.</span><span>train_predictor</span><span class=3D"t=
oken token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        data_dir</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 0);">'./data/grasp_dataset'</span><span class=3D=
"token token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        output_dir</span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 0);">'./checkpoints'</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        num_epochs</span><span class=3D"token tok=
en" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token"=
 style=3D"color: rgb(0, 128, 128);">10</span><span>  </span><span class=3D"=
token token" style=3D"color: rgb(110, 118, 135);"># Use 50+ for real traini=
ng</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    system</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">.</span><span>close</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    </span><span class=3D"token token" style=3D"color: r=
gb(110, 118, 135);"># Step 3: Test trained model</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 0);">"\n"</span><span> </span><span class=3D"token token" styl=
e=3D"color: rgb(20, 24, 31);">+</span><span> </span><span class=3D"token to=
ken" style=3D"color: rgb(0, 128, 0);">"=3D"</span><span class=3D"token toke=
n" style=3D"color: rgb(20, 24, 31);">*</span><span class=3D"token token" st=
yle=3D"color: rgb(0, 128, 128);">60</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 0);">"STEP 3: Testing trained model"</span><span class=3D"toke=
n token" style=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(129, 0, 194);">print</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"color:=
 rgb(0, 128, 0);">"=3D"</span><span class=3D"token token" style=3D"color: r=
gb(20, 24, 31);">*</span><span class=3D"token token" style=3D"color: rgb(0,=
 128, 128);">60</span><span class=3D"token token" style=3D"color: rgb(43, 4=
8, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    system </span><span class=3D"token token" style=3D"c=
olor: rgb(20, 24, 31);">=3D</span><span> DishwashingRobotSystem</span><span=
 class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>
</span></span><span><span>        mode</span><span class=3D"token token" st=
yle=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" style=
=3D"color: rgb(0, 128, 0);">'simulation'</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">,</span><span>
</span></span><span><span>        use_qwen</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">True</span><span class=3D"token token" st=
yle=3D"color: rgb(43, 48, 59);">,</span><span>  </span><span class=3D"token=
 token" style=3D"color: rgb(110, 118, 135);"># Enable Qwen for full capabil=
ity</span><span>
</span></span><span><span>        predictor_checkpoint</span><span class=3D=
"token token" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"to=
ken token" style=3D"color: rgb(0, 128, 0);">'./checkpoints/checkpoint_best.=
pth'</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">,<=
/span><span>
</span></span><span><span>        headless</span><span class=3D"token token=
" style=3D"color: rgb(20, 24, 31);">=3D</span><span class=3D"token token" s=
tyle=3D"color: rgb(0, 128, 128);">False</span><span>
</span></span><span><span>    </span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span><span>
</span></span><span>   =20
</span><span><span>    system</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">.</span><span>env</span><span class=3D"token token" =
style=3D"color: rgb(43, 48, 59);">.</span><span>spawn_random_dishes</span><=
span class=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>=
num_dishes</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31=
);">=3D</span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);=
">6</span><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</=
span><span>
</span></span><span><span>    system</span><span class=3D"token token" styl=
e=3D"color: rgb(43, 48, 59);">.</span><span>run_full_sink</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">(</span><span>max_attemp=
ts</span><span class=3D"token token" style=3D"color: rgb(20, 24, 31);">=3D<=
/span><span class=3D"token token" style=3D"color: rgb(0, 128, 128);">10</sp=
an><span class=3D"token token" style=3D"color: rgb(43, 48, 59);">)</span><s=
pan>
</span></span><span>   =20
</span><span><span>    system</span><span class=3D"token token" style=3D"co=
lor: rgb(43, 48, 59);">.</span><span>close</span><span class=3D"token token=
" style=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" sty=
le=3D"color: rgb(43, 48, 59);">)</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token" style=3D"color: rgb(1=
29, 0, 194);">if</span><span> __name__ </span><span class=3D"token token" s=
tyle=3D"color: rgb(20, 24, 31);">=3D=3D</span><span> </span><span class=3D"=
token token" style=3D"color: rgb(0, 128, 0);">'__main__'</span><span class=
=3D"token token" style=3D"color: rgb(43, 48, 59);">:</span><span>
</span></span><span><span>    main</span><span class=3D"token token" style=
=3D"color: rgb(43, 48, 59);">(</span><span class=3D"token token" style=3D"c=
olor: rgb(43, 48, 59);">)</span></span></code></pre></div></div>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<h2 class=3D"text-text-100 mt-3 -mb-1 text-[1.125rem] font-bold">15. README=
</h2>
<div class=3D"relative group/copy bg-bg-000/50 border-0.5 border-border-400=
 rounded-lg"><div class=3D"sticky opacity-0 group-hover/copy:opacity-100 to=
p-2 py-2 h-12 w-0 float-right"><div class=3D"absolute right-0 h-8 px-2 item=
s-center inline-flex z-10"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 backdrop-blur-md Button_ghost__BUAoh" type=3D"button" aria-label=
=3D"Copy to clipboard" data-state=3D"closed"><div class=3D"relative"><div c=
lass=3D"transition-all opacity-100 scale-100" style=3D"width: 20px; height:=
 20px; display: flex; align-items: center; justify-content: center;"><svg w=
idth=3D"20" height=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=
=3D"http://www.w3.org/2000/svg" class=3D"transition-all opacity-100 scale-1=
00" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D"M12.5 3C13.32=
84 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 6.67157 17 7.5V15.5C17 16.3284 1=
6.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 6 15.5V14H4.5C3.67157 14 3 13.32=
84 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.5ZM14 12.5C14 13.3284 13.3284 14=
 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16H15.5C15.7761 16 16 15.7761 16 1=
5.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5ZM4.5 4C4.22386 4 4 4.22386 4 4.=
5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.7761 13 13 12.7761 13 12.5V4.5C1=
3 4.22386 12.7761 4 12.5 4H4.5Z"></path></svg></div><div class=3D"absolute =
inset-0 flex items-center justify-center"><div class=3D"transition-all opac=
ity-0 scale-50" style=3D"width: 20px; height: 20px; display: flex; align-it=
ems: center; justify-content: center;"><svg width=3D"20" height=3D"20" view=
Box=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg=
" class=3D"transition-all opacity-0 scale-50" aria-hidden=3D"true" style=3D=
"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15.6346 4.961=
53 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.73605L15.8836 =
5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 14.9989C7.8=
8203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.08172 11.275=
2C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755 4.58105 10=
.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.1794L15.188=
3 5.10908Z"></path></svg></div></div></div></button></div></div><div class=
=3D"text-text-500 font-small p-3.5 pb-0">markdown</div><div><pre class=3D"c=
ode-block__code !my-0 !rounded-lg !text-sm !leading-relaxed p-3.5" style=3D=
"color: rgb(20, 24, 31); background: transparent; font-family: var(--font-m=
ono);"><code class=3D"language-markdown" style=3D"color: rgb(20, 24, 31); b=
ackground: transparent; font-family: var(--font-mono); white-space: pre;"><=
span><span class=3D"token token title" style=3D"color: rgb(43, 48, 59); fon=
t-weight: bold;">#</span><span class=3D"token token title" style=3D"color: =
rgb(184, 10, 24); font-weight: bold;"> Robotic Dishwashing System</span><sp=
an>
</span></span><span>
</span><span>Complete implementation of a robotic dishwashing system combin=
ing:
</span><span><span></span><span class=3D"token token list" style=3D"color: =
rgb(43, 48, 59);">-</span><span> </span><span class=3D"token token bold" st=
yle=3D"color: rgb(43, 48, 59);">**</span><span class=3D"token token bold co=
ntent">Qwen3-VL</span><span class=3D"token token bold" style=3D"color: rgb(=
43, 48, 59);">**</span><span> for semantic scene understanding
</span></span><span><span></span><span class=3D"token token list" style=3D"=
color: rgb(43, 48, 59);">-</span><span> </span><span class=3D"token token b=
old" style=3D"color: rgb(43, 48, 59);">**</span><span class=3D"token token =
bold content">3D geometry reconstruction</span><span class=3D"token token b=
old" style=3D"color: rgb(43, 48, 59);">**</span><span> from RGBD
</span></span><span><span></span><span class=3D"token token list" style=3D"=
color: rgb(43, 48, 59);">-</span><span> </span><span class=3D"token token b=
old" style=3D"color: rgb(43, 48, 59);">**</span><span class=3D"token token =
bold content">Neural grasp prediction</span><span class=3D"token token bold=
" style=3D"color: rgb(43, 48, 59);">**</span><span> with custom CNN
</span></span><span><span></span><span class=3D"token token list" style=3D"=
color: rgb(43, 48, 59);">-</span><span> </span><span class=3D"token token b=
old" style=3D"color: rgb(43, 48, 59);">**</span><span class=3D"token token =
bold content">Isaac Sim</span><span class=3D"token token bold" style=3D"col=
or: rgb(43, 48, 59);">**</span><span> for virtual training
</span></span><span><span></span><span class=3D"token token list" style=3D"=
color: rgb(43, 48, 59);">-</span><span> </span><span class=3D"token token b=
old" style=3D"color: rgb(43, 48, 59);">**</span><span class=3D"token token =
bold content">Robot arm control</span><span class=3D"token token bold" styl=
e=3D"color: rgb(43, 48, 59);">**</span><span> for execution
</span></span><span>
</span><span><span></span><span class=3D"token token title" style=3D"color:=
 rgb(43, 48, 59); font-weight: bold;">##</span><span class=3D"token token t=
itle" style=3D"color: rgb(184, 10, 24); font-weight: bold;"> Installation</=
span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token title" style=3D"color:=
 rgb(43, 48, 59); font-weight: bold;">###</span><span class=3D"token token =
title" style=3D"color: rgb(184, 10, 24); font-weight: bold;"> Prerequisites=
</span><span>
</span></span><span><span></span><span class=3D"token token list" style=3D"=
color: rgb(43, 48, 59);">-</span><span> NVIDIA GPU (RTX 3080+ recommended)
</span></span><span><span></span><span class=3D"token token list" style=3D"=
color: rgb(43, 48, 59);">-</span><span> Ubuntu 20.04/22.04
</span></span><span><span></span><span class=3D"token token list" style=3D"=
color: rgb(43, 48, 59);">-</span><span> Python 3.8+
</span></span><span><span></span><span class=3D"token token list" style=3D"=
color: rgb(43, 48, 59);">-</span><span> CUDA 11.8+
</span></span><span>
</span><span><span></span><span class=3D"token token title" style=3D"color:=
 rgb(43, 48, 59); font-weight: bold;">###</span><span class=3D"token token =
title" style=3D"color: rgb(184, 10, 24); font-weight: bold;"> Step 1: Insta=
ll Isaac Sim</span><span>
</span></span><span><span></span><span class=3D"token token code" style=3D"=
color: rgb(43, 48, 59);">```</span><span class=3D"token token code code-lan=
guage">bash</span><span class=3D"token token code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code code-block language-bash" style=3D"color: rgb(110, 118, 13=
5);"># Follow official guide:</span><span class=3D"token token code code-bl=
ock language-bash">
</span></span><span><span class=3D"token token code code-block language-bas=
h"></span><span class=3D"token token code code-block language-bash" style=
=3D"color: rgb(110, 118, 135);"># https://docs.omniverse.nvidia.com/isaacsi=
m/latest/installation.html</span><span class=3D"token token code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code" style=3D"color: rgb(43, 48, 59);">```</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token title" style=3D"color:=
 rgb(43, 48, 59); font-weight: bold;">###</span><span class=3D"token token =
title" style=3D"color: rgb(184, 10, 24); font-weight: bold;"> Step 2: Insta=
ll Python dependencies</span><span>
</span></span><span><span></span><span class=3D"token token code" style=3D"=
color: rgb(43, 48, 59);">```</span><span class=3D"token token code code-lan=
guage">bash</span><span class=3D"token token code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code code-block language-bash">pip </span><span class=3D"token =
token code code-block language-bash" style=3D"color: rgb(0, 81, 194);">inst=
all</span><span class=3D"token token code code-block language-bash"> -r req=
uirements.txt</span><span class=3D"token token code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code" style=3D"color: rgb(43, 48, 59);">```</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token title" style=3D"color:=
 rgb(43, 48, 59); font-weight: bold;">###</span><span class=3D"token token =
title" style=3D"color: rgb(184, 10, 24); font-weight: bold;"> Step 3: Insta=
ll Qwen3-VL</span><span>
</span></span><span><span></span><span class=3D"token token code" style=3D"=
color: rgb(43, 48, 59);">```</span><span class=3D"token token code code-lan=
guage">bash</span><span class=3D"token token code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code code-block language-bash">pip </span><span class=3D"token =
token code code-block language-bash" style=3D"color: rgb(0, 81, 194);">inst=
all</span><span class=3D"token token code code-block language-bash"> transf=
ormers accelerate peft</span><span class=3D"token token code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code" style=3D"color: rgb(43, 48, 59);">```</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token title" style=3D"color:=
 rgb(43, 48, 59); font-weight: bold;">##</span><span class=3D"token token t=
itle" style=3D"color: rgb(184, 10, 24); font-weight: bold;"> Quick Start</s=
pan><span>
</span></span><span>
</span><span><span></span><span class=3D"token token title" style=3D"color:=
 rgb(43, 48, 59); font-weight: bold;">###</span><span class=3D"token token =
title" style=3D"color: rgb(184, 10, 24); font-weight: bold;"> Demo (no trai=
ning required)</span><span>
</span></span><span><span></span><span class=3D"token token code" style=3D"=
color: rgb(43, 48, 59);">```</span><span class=3D"token token code code-lan=
guage">bash</span><span class=3D"token token code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code code-block language-bash">python examples/quick_demo.py</s=
pan><span class=3D"token token code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code" style=3D"color: rgb(43, 48, 59);">```</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token title" style=3D"color:=
 rgb(43, 48, 59); font-weight: bold;">###</span><span class=3D"token token =
title" style=3D"color: rgb(184, 10, 24); font-weight: bold;"> Full Pipeline=
</span><span>
</span></span><span><span></span><span class=3D"token token code" style=3D"=
color: rgb(43, 48, 59);">```</span><span class=3D"token token code code-lan=
guage">bash</span><span class=3D"token token code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code code-block language-bash" style=3D"color: rgb(110, 118, 13=
5);"># 1. Generate training data</span><span class=3D"token token code code=
-block language-bash">
</span></span><span><span class=3D"token token code code-block language-bas=
h">python main.py --mode train_data --num-samples </span><span class=3D"tok=
en token code code-block language-bash" style=3D"color: rgb(0, 128, 128);">=
10000</span><span class=3D"token token code code-block language-bash"> --he=
adless
</span></span><span>
</span><span><span class=3D"token token code code-block language-bash"></sp=
an><span class=3D"token token code code-block language-bash" style=3D"color=
: rgb(110, 118, 135);"># 2. Train model</span><span class=3D"token token co=
de code-block language-bash">
</span></span><span><span class=3D"token token code code-block language-bas=
h">python main.py --mode train_model --num-epochs </span><span class=3D"tok=
en token code code-block language-bash" style=3D"color: rgb(0, 128, 128);">=
50</span><span class=3D"token token code code-block language-bash"> --data-=
dir ./data/grasp_dataset
</span></span><span>
</span><span><span class=3D"token token code code-block language-bash"></sp=
an><span class=3D"token token code code-block language-bash" style=3D"color=
: rgb(110, 118, 135);"># 3. Run with trained model</span><span class=3D"tok=
en token code code-block language-bash">
</span></span><span><span class=3D"token token code code-block language-bas=
h">python main.py --mode demo --checkpoint ./checkpoints/checkpoint_best.pt=
h</span><span class=3D"token token code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code" style=3D"color: rgb(43, 48, 59);">```</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token title" style=3D"color:=
 rgb(43, 48, 59); font-weight: bold;">###</span><span class=3D"token token =
title" style=3D"color: rgb(184, 10, 24); font-weight: bold;"> Clean entire =
sink</span><span>
</span></span><span><span></span><span class=3D"token token code" style=3D"=
color: rgb(43, 48, 59);">```</span><span class=3D"token token code code-lan=
guage">bash</span><span class=3D"token token code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code code-block language-bash">python main.py --mode full_sink =
--checkpoint ./checkpoints/checkpoint_best.pth</span><span class=3D"token t=
oken code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code" style=3D"color: rgb(43, 48, 59);">```</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token title" style=3D"color:=
 rgb(43, 48, 59); font-weight: bold;">##</span><span class=3D"token token t=
itle" style=3D"color: rgb(184, 10, 24); font-weight: bold;"> Project Struct=
ure</span><span>
</span></span><span><span></span><span class=3D"token token code" style=3D"=
color: rgb(43, 48, 59);">```</span><span class=3D"token token code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code code-block">dishwashing_robot/
</span></span><span>=E2=94=9C=E2=94=80=E2=94=80 vision/              # Visi=
on processing
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 qwen_semantic.py
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 geometry_reconstructio=
n.py
</span><span>=E2=94=82   =E2=94=94=E2=94=80=E2=94=80 hybrid_vision.py
</span><span>=E2=94=9C=E2=94=80=E2=94=80 grasp_planning/      # Grasp plann=
ing
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 grasp_generator.py
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 grasp_predictor.py
</span><span>=E2=94=82   =E2=94=94=E2=94=80=E2=94=80 grasp_planner.py
</span><span>=E2=94=9C=E2=94=80=E2=94=80 simulation/          # Isaac Sim e=
nvironment
</span><span>=E2=94=82   =E2=94=94=E2=94=80=E2=94=80 isaac_environment.py
</span><span>=E2=94=9C=E2=94=80=E2=94=80 robot/               # Robot contr=
ol
</span><span>=E2=94=82   =E2=94=94=E2=94=80=E2=94=80 robot_controller.py
</span><span>=E2=94=9C=E2=94=80=E2=94=80 training/            # Training pi=
peline
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 dataset.py
</span><span>=E2=94=82   =E2=94=94=E2=94=80=E2=94=80 train_grasp_predictor.=
py
</span><span>=E2=94=9C=E2=94=80=E2=94=80 utils/               # Utilities
</span><span>=E2=94=82   =E2=94=9C=E2=94=80=E2=94=80 transforms.py
</span><span>=E2=94=82   =E2=94=94=E2=94=80=E2=94=80 visualization.py
</span><span>=E2=94=9C=E2=94=80=E2=94=80 examples/            # Example scr=
ipts
</span><span><span class=3D"token token code code-block">=E2=94=94=E2=94=80=
=E2=94=80 main.py              # Main entry point</span><span class=3D"toke=
n token code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code" style=3D"color: rgb(43, 48, 59);">```</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token title" style=3D"color:=
 rgb(43, 48, 59); font-weight: bold;">##</span><span class=3D"token token t=
itle" style=3D"color: rgb(184, 10, 24); font-weight: bold;"> System Archite=
cture</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token list" style=3D"color: =
rgb(43, 48, 59);">1.</span><span> </span><span class=3D"token token bold" s=
tyle=3D"color: rgb(43, 48, 59);">**</span><span class=3D"token token bold c=
ontent">Vision Pipeline</span><span class=3D"token token bold" style=3D"col=
or: rgb(43, 48, 59);">**</span><span> (Hybrid)
</span></span><span><span>   </span><span class=3D"token token list" style=
=3D"color: rgb(43, 48, 59);">-</span><span> Qwen3-VL: Semantic understandin=
g (dish types, materials, graspability)
</span></span><span><span>   </span><span class=3D"token token list" style=
=3D"color: rgb(43, 48, 59);">-</span><span> Geometry: 3D reconstruction, se=
gmentation, precise positions
</span></span><span>
</span><span><span></span><span class=3D"token token list" style=3D"color: =
rgb(43, 48, 59);">2.</span><span> </span><span class=3D"token token bold" s=
tyle=3D"color: rgb(43, 48, 59);">**</span><span class=3D"token token bold c=
ontent">Grasp Planning</span><span class=3D"token token bold" style=3D"colo=
r: rgb(43, 48, 59);">**</span><span>
</span></span><span><span>   </span><span class=3D"token token list" style=
=3D"color: rgb(43, 48, 59);">-</span><span> Smart candidate generation base=
d on dish type
</span></span><span><span>   </span><span class=3D"token token list" style=
=3D"color: rgb(43, 48, 59);">-</span><span> Neural network ranks candidates
</span></span><span><span>   </span><span class=3D"token token list" style=
=3D"color: rgb(43, 48, 59);">-</span><span> Outputs best grasp pose
</span></span><span>
</span><span><span></span><span class=3D"token token list" style=3D"color: =
rgb(43, 48, 59);">3.</span><span> </span><span class=3D"token token bold" s=
tyle=3D"color: rgb(43, 48, 59);">**</span><span class=3D"token token bold c=
ontent">Execution</span><span class=3D"token token bold" style=3D"color: rg=
b(43, 48, 59);">**</span><span>
</span></span><span><span>   </span><span class=3D"token token list" style=
=3D"color: rgb(43, 48, 59);">-</span><span> Motion planning with RMPflow (c=
ollision-free)
</span></span><span><span>   </span><span class=3D"token token list" style=
=3D"color: rgb(43, 48, 59);">-</span><span> Force-based grasp validation
</span></span><span><span>   </span><span class=3D"token token list" style=
=3D"color: rgb(43, 48, 59);">-</span><span> Robust error handling
</span></span><span>
</span><span><span></span><span class=3D"token token title" style=3D"color:=
 rgb(43, 48, 59); font-weight: bold;">##</span><span class=3D"token token t=
itle" style=3D"color: rgb(184, 10, 24); font-weight: bold;"> Performance</s=
pan><span>
</span></span><span>
</span><span>With trained model:
</span><span><span></span><span class=3D"token token list" style=3D"color: =
rgb(43, 48, 59);">-</span><span> Grasp success rate: </span><span class=3D"=
token token strike" style=3D"color: rgb(43, 48, 59);">~</span><span class=
=3D"token token strike content">85% on diverse dishes
</span></span><span><span class=3D"token token strike content">- Planning t=
ime: </span><span class=3D"token token strike" style=3D"color: rgb(43, 48, =
59);">~</span><span>200ms per grasp
</span></span><span><span></span><span class=3D"token token list" style=3D"=
color: rgb(43, 48, 59);">-</span><span> Full sink (8 dishes): ~5-7 minutes
</span></span><span>
</span><span><span></span><span class=3D"token token title" style=3D"color:=
 rgb(43, 48, 59); font-weight: bold;">##</span><span class=3D"token token t=
itle" style=3D"color: rgb(184, 10, 24); font-weight: bold;"> Citation</span=
><span>
</span></span><span>
</span><span>If you use this code, please cite:
</span><span><span></span><span class=3D"token token code" style=3D"color: =
rgb(43, 48, 59);">```</span><span class=3D"token token code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code code-block">@software{dishwashing_robot_2024,
</span></span><span>  title=3D{Robotic Dishwashing System with Vision-Langu=
age Models},
</span><span>  author=3D{Your Name},
</span><span>  year=3D{2024}
</span><span><span class=3D"token token code code-block">}</span><span clas=
s=3D"token token code">
</span></span><span><span class=3D"token token code"></span><span class=3D"=
token token code" style=3D"color: rgb(43, 48, 59);">```</span><span>
</span></span><span>
</span><span><span></span><span class=3D"token token title" style=3D"color:=
 rgb(43, 48, 59); font-weight: bold;">##</span><span class=3D"token token t=
itle" style=3D"color: rgb(184, 10, 24); font-weight: bold;"> License</span>=
<span>
</span></span><span>
</span><span>MIT License</span></code></pre></div></div>
<hr class=3D"border-border-200 border-t-0.5 my-3 mx-1.5">
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">That's the complete system! You now have:</p>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">=E2=9C=85 Full vision pipeline (Qwen3-VL + geometry)<br>
=E2=9C=85 Grasp planning with learned predictor<br>
=E2=9C=85 Isaac Sim virtual environment<br>
=E2=9C=85 Robot controller<br>
=E2=9C=85 Training pipeline<br>
=E2=9C=85 Complete integration</p>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">The system is modular, so you can:</p>
<ul class=3D"[li_&amp;]:mb-0 [li_&amp;]:mt-1 [li_&amp;]:gap-1 [&amp;:not(:l=
ast-child)_ul]:pb-1 [&amp;:not(:last-child)_ol]:pb-1 list-disc flex flex-co=
l gap-1 pl-8 mb-3">
<li class=3D"whitespace-normal break-words pl-2">Disable Qwen for faster te=
sting</li>
<li class=3D"whitespace-normal break-words pl-2">Use heuristics instead of =
learned predictor</li>
<li class=3D"whitespace-normal break-words pl-2">Swap robot types easily</l=
i>
<li class=3D"whitespace-normal break-words pl-2">Extend to real hardware</l=
i>
</ul>
<p class=3D"font-claude-response-body break-words whitespace-normal leading=
-[1.7]">Would you like me to explain any specific component in more detail,=
 or help you get started with running it?</p></div></div></div></div></div>=
<div class=3D"flex justify-start" role=3D"group" aria-label=3D"Message acti=
ons"><div class=3D"text-text-300"><div class=3D"text-text-300 flex items-st=
retch justify-between"><div class=3D"w-fit" data-state=3D"closed"><button c=
lass=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" data-testid=3D"acti=
on-bar-copy" aria-label=3D"Copy"><div class=3D"relative text-text-500 group=
-hover/btn:text-text-100"><div class=3D"transition-all opacity-100 scale-10=
0" style=3D"width: 20px; height: 20px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"tr=
ansition-all opacity-100 scale-100" aria-hidden=3D"true" style=3D"flex-shri=
nk: 0;"><path d=3D"M12.5 3C13.3284 3 14 3.67157 14 4.5V6H15.5C16.3284 6 17 =
6.67157 17 7.5V15.5C17 16.3284 16.3284 17 15.5 17H7.5C6.67157 17 6 16.3284 =
6 15.5V14H4.5C3.67157 14 3 13.3284 3 12.5V4.5C3 3.67157 3.67157 3 4.5 3H12.=
5ZM14 12.5C14 13.3284 13.3284 14 12.5 14H7V15.5C7 15.7761 7.22386 16 7.5 16=
H15.5C15.7761 16 16 15.7761 16 15.5V7.5C16 7.22386 15.7761 7 15.5 7H14V12.5=
ZM4.5 4C4.22386 4 4 4.22386 4 4.5V12.5C4 12.7761 4.22386 13 4.5 13H12.5C12.=
7761 13 13 12.7761 13 12.5V4.5C13 4.22386 12.7761 4 12.5 4H4.5Z"></path></s=
vg></div><div class=3D"absolute top-0 left-0 transition-all opacity-0 scale=
-50" style=3D"width: 20px; height: 20px; display: flex; align-items: center=
; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 =
20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"=
absolute top-0 left-0 transition-all opacity-0 scale-50" aria-hidden=3D"tru=
e" style=3D"flex-shrink: 0;"><path d=3D"M15.1883 5.10908C15.3699 4.96398 15=
.6346 4.96153 15.8202 5.11592C16.0056 5.27067 16.0504 5.53125 15.9403 5.736=
05L15.8836 5.82003L8.38354 14.8202C8.29361 14.9279 8.16242 14.9925 8.02221 =
14.9989C7.88203 15.0051 7.74545 14.9526 7.64622 14.8534L4.14617 11.3533L4.0=
8172 11.2752C3.95384 11.0811 3.97542 10.817 4.14617 10.6463C4.31693 10.4755=
 4.58105 10.4539 4.77509 10.5818L4.85321 10.6463L7.96556 13.7586L15.1161 5.=
1794L15.1883 5.10908Z"></path></svg></div></div></button></div><div class=
=3D"w-fit" data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Give =
positive feedback"><div class=3D"text-text-500 group-hover/btn:text-text-10=
0" style=3D"width: 16px; height: 16px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"te=
xt-text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"fl=
ex-shrink: 0;"><path d=3D"M9.56055 2C11.1381 2.00009 12.3211 3.44332 12.011=
7 4.99023L11.6094 7H13.8438C15.5431 7 16.836 8.52594 16.5566 10.2021L15.876=
 14.2842C15.6148 15.8513 14.2586 17 12.6699 17H4.5C3.67157 17 3 16.3284 3 1=
5.5V9.23828C3.00013 8.57996 3.4294 7.99838 4.05859 7.80469L5.19824 7.4541L5=
.33789 7.40723C6.02983 7.15302 6.59327 6.63008 6.89746 5.9541L8.41113 2.589=
84L8.48047 2.46094C8.66235 2.17643 8.97898 2.00002 9.32324 2H9.56055ZM7.809=
57 6.36523C7.39486 7.2867 6.62674 7.99897 5.68359 8.3457L5.49219 8.41016L4.=
35254 8.76074C4.14305 8.82539 4.00013 9.01904 4 9.23828V15.5C4 15.7761 4.22=
386 16 4.5 16H12.6699C13.7697 16 14.7087 15.2049 14.8896 14.1201L15.5703 10=
.0381C15.7481 8.97141 14.9251 8 13.8438 8H11C10.8503 8 10.7083 7.9331 10.61=
33 7.81738C10.5184 7.70164 10.4805 7.54912 10.5098 7.40234L11.0312 4.79395C=
11.2167 3.86589 10.507 3.00009 9.56055 3H9.32324L7.80957 6.36523Z"></path><=
/svg></div></button></div><div class=3D"w-fit" data-state=3D"closed"><butto=
n class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" aria-label=3D"Give =
negative feedback"><div class=3D"text-text-500 group-hover/btn:text-text-10=
0" style=3D"width: 16px; height: 16px; display: flex; align-items: center; =
justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20=
 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"te=
xt-text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"fl=
ex-shrink: 0;"><path d=3D"M12.6699 3C14.2586 3 15.6148 4.14871 15.876 5.715=
82L16.5566 9.79785C16.836 11.4741 15.5431 13 13.8438 13H11.6094L12.0117 15.=
0098C12.3211 16.5567 11.1381 17.9999 9.56055 18H9.32324C8.97898 18 8.66235 =
17.8236 8.48047 17.5391L8.41113 17.4102L6.89746 14.0459C6.59327 13.3699 6.0=
2983 12.847 5.33789 12.5928L5.19824 12.5459L4.05859 12.1953C3.4294 12.0016 =
3.00013 11.42 3 10.7617V4.5C3 3.67157 3.67157 3 4.5 3H12.6699ZM4.5 4C4.2238=
6 4 4 4.22386 4 4.5V10.7617C4.00013 10.981 4.14305 11.1746 4.35254 11.2393L=
5.49219 11.5898L5.68359 11.6543C6.62674 12.001 7.39486 12.7133 7.80957 13.6=
348L9.32324 17H9.56055C10.507 16.9999 11.2167 16.1341 11.0312 15.2061L10.50=
98 12.5977C10.4805 12.4509 10.5184 12.2984 10.6133 12.1826C10.7083 12.0669 =
10.8503 12 11 12H13.8438C14.9251 12 15.7481 11.0286 15.5703 9.96191L14.8896=
 5.87988C14.7087 4.79508 13.7697 4 12.6699 4H4.5Z"></path></svg></div></but=
ton></div><div class=3D"flex items-center"><div class=3D"w-fit" data-state=
=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 group/btn Button_ghost__BUAoh" type=3D"button" id=3D"radix-_r_l8_"=
 aria-haspopup=3D"menu" aria-expanded=3D"false" data-state=3D"closed" aria-=
label=3D"Retry"><div class=3D"text-text-500 group-hover/btn:text-text-100" =
style=3D"width: 20px; height: 20px; display: flex; align-items: center; jus=
tify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D"0 0 20 20=
" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" class=3D"text-=
text-500 group-hover/btn:text-text-100" aria-hidden=3D"true" style=3D"flex-=
shrink: 0;"><path d=3D"M10.3857 2.50977C14.3486 2.71054 17.5 5.98724 17.5 1=
0C17.5 14.1421 14.1421 17.5 10 17.5C5.85786 17.5 2.5 14.1421 2.5 10C2.5 7.5=
4619 3.67878 5.3677 5.49902 4H3C2.72386 4 2.5 3.77614 2.5 3.5C2.5 3.22386 2=
.72386 3 3 3H6.5C6.63261 3 6.75975 3.05272 6.85352 3.14648C6.92392 3.21689 =
6.97106 3.30611 6.99023 3.40234L7 3.5V7C7 7.27614 6.77614 7.5 6.5 7.5C6.223=
86 7.5 6 7.27614 6 7V4.87891C4.4782 6.06926 3.5 7.91979 3.5 10C3.5 13.5899 =
6.41015 16.5 10 16.5C13.5899 16.5 16.5 13.5899 16.5 10C16.5 6.5225 13.7691 =
3.68312 10.335 3.50879L10 3.5L9.89941 3.49023C9.67145 3.44371 9.5 3.24171 9=
.5 3C9.5 2.72386 9.72386 2.5 10 2.5L10.3857 2.50977Z"></path></svg></div></=
button></div></div></div></div></div></div></div><div aria-hidden=3D"true" =
class=3D"h-px w-full pointer-events-none"></div><div><div class=3D"ml-1 fle=
x items-center transition-transform duration-300 ease-out mt-6"><div class=
=3D"p-1 -translate-x-px"><div aria-hidden=3D"true"><div class=3D"w-8 text-a=
ccent-brand inline-block select-none" data-state=3D"closed" style=3D""><svg=
 xmlns=3D"http://www.w3.org/2000/svg" viewBox=3D"0 0 100 100" class=3D"w-fu=
ll fill-current"><path d=3D"m19.6 66.5 19.7-11 .3-1-.3-.5h-1l-3.3-.2-11.2-.=
3L14 53l-9.5-.5-2.4-.5L0 49l.2-1.5 2-1.3 2.9.2 6.3.5 9.5.6 6.9.4L38 49.1h1.=
6l.2-.7-.5-.4-.4-.4L29 41l-10.6-7-5.6-4.1-3-2-1.5-2-.6-4.2 2.7-3 3.7.3.9.2 =
3.7 2.9 8 6.1L37 36l1.5 1.2.6-.4.1-.3-.7-1.1L33 25l-6-10.4-2.7-4.3-.7-2.6c-=
.3-1-.4-2-.4-3l3-4.2L28 0l4.2.6L33.8 2l2.6 6 4.1 9.3L47 29.9l2 3.8 1 3.4.3 =
1h.7v-.5l.5-7.2 1-8.7 1-11.2.3-3.2 1.6-3.8 3-2L61 2.6l2 2.9-.3 1.8-1.1 7.7L=
59 27.1l-1.5 8.2h.9l1-1.1 4.1-5.4 6.9-8.6 3-3.5L77 13l2.3-1.8h4.3l3.1 4.7-1=
.4 4.9-4.4 5.6-3.7 4.7-5.3 7.1-3.2 5.7.3.4h.7l12-2.6 6.4-1.1 7.6-1.3 3.5 1.=
6.4 1.6-1.4 3.4-8.2 2-9.6 2-14.3 3.3-.2.1.2.3 6.4.6 2.8.2h6.8l12.6 1 3.3 2 =
1.9 2.7-.3 2-5.1 2.6-6.8-1.6-16-3.8-5.4-1.3h-.8v.4l4.6 4.5 8.3 7.5L89 80.1l=
.5 2.4-1.3 2-1.4-.2-9.2-7-3.6-3-8-6.8h-.5v.7l1.8 2.7 9.8 14.7.5 4.5-.7 1.4-=
2.6 1-2.7-.6-5.8-8-6-9-4.7-8.2-.5.4-2.9 30.2-1.3 1.5-3 1.2-2.5-2-1.4-3 1.4-=
6.2 1.6-8 1.3-6.4 1.2-7.9.7-2.6v-.2H49L43 72l-9 12.3-7.2 7.6-1.7.7-3-1.5.3-=
2.8L24 86l10-12.8 6-7.9 4-4.6-.1-.5h-.3L17.2 77.4l-4.7.6-2-2 .2-3 1-1 8-5.5=
Z"></path></svg></div></div></div></div></div><div class=3D"h-12"></div><di=
v aria-hidden=3D"true" style=3D"height: 0px;"></div></div><div data-chat-in=
put-container=3D"true" class=3D"sticky bottom-0 mx-auto w-full pt-6 relativ=
e z-[5]"><button aria-label=3D"Scroll to bottom" class=3D"z-[1] size-9 inli=
ne-flex items-center justify-center absolute -top-8 left-1/2 -translate-x-1=
/2 border-0.5 overflow-hidden !rounded-full p-1 shadow-md hover:shadow-lg b=
g-bg-000/80 hover:bg-bg-000 backdrop-blur transition-opacity duration-200 b=
order-border-300 opacity-100 pointer-events-auto"><div aria-hidden=3D"true"=
><div class=3D"absolute blur-md transition duration-300 pointer-events-none=
 opacity-0 w-8 text-accent-brand inline-block select-none" data-state=3D"cl=
osed" style=3D""><svg xmlns=3D"http://www.w3.org/2000/svg" viewBox=3D"0 0 1=
00 100" class=3D"w-full fill-current"><path d=3D"m19.6 66.5 19.7-11 .3-1-.3=
-.5h-1l-3.3-.2-11.2-.3L14 53l-9.5-.5-2.4-.5L0 49l.2-1.5 2-1.3 2.9.2 6.3.5 9=
.5.6 6.9.4L38 49.1h1.6l.2-.7-.5-.4-.4-.4L29 41l-10.6-7-5.6-4.1-3-2-1.5-2-.6=
-4.2 2.7-3 3.7.3.9.2 3.7 2.9 8 6.1L37 36l1.5 1.2.6-.4.1-.3-.7-1.1L33 25l-6-=
10.4-2.7-4.3-.7-2.6c-.3-1-.4-2-.4-3l3-4.2L28 0l4.2.6L33.8 2l2.6 6 4.1 9.3L4=
7 29.9l2 3.8 1 3.4.3 1h.7v-.5l.5-7.2 1-8.7 1-11.2.3-3.2 1.6-3.8 3-2L61 2.6l=
2 2.9-.3 1.8-1.1 7.7L59 27.1l-1.5 8.2h.9l1-1.1 4.1-5.4 6.9-8.6 3-3.5L77 13l=
2.3-1.8h4.3l3.1 4.7-1.4 4.9-4.4 5.6-3.7 4.7-5.3 7.1-3.2 5.7.3.4h.7l12-2.6 6=
.4-1.1 7.6-1.3 3.5 1.6.4 1.6-1.4 3.4-8.2 2-9.6 2-14.3 3.3-.2.1.2.3 6.4.6 2.=
8.2h6.8l12.6 1 3.3 2 1.9 2.7-.3 2-5.1 2.6-6.8-1.6-16-3.8-5.4-1.3h-.8v.4l4.6=
 4.5 8.3 7.5L89 80.1l.5 2.4-1.3 2-1.4-.2-9.2-7-3.6-3-8-6.8h-.5v.7l1.8 2.7 9=
.8 14.7.5 4.5-.7 1.4-2.6 1-2.7-.6-5.8-8-6-9-4.7-8.2-.5.4-2.9 30.2-1.3 1.5-3=
 1.2-2.5-2-1.4-3 1.4-6.2 1.6-8 1.3-6.4 1.2-7.9.7-2.6v-.2H49L43 72l-9 12.3-7=
.2 7.6-1.7.7-3-1.5.3-2.8L24 86l10-12.8 6-7.9 4-4.6-.1-.5h-.3L17.2 77.4l-4.7=
.6-2-2 .2-3 1-1 8-5.5Z"></path></svg></div></div><div class=3D"mix-blend-lu=
minosity" style=3D"width: 20px; height: 20px; display: flex; align-items: c=
enter; justify-content: center;"><svg width=3D"20" height=3D"20" viewBox=3D=
"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000/svg" clas=
s=3D"mix-blend-luminosity" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><=
path d=3D"M10 3C10.2761 3.00006 10.5 3.2239 10.5 3.5V15.293L14.6465 11.1465=
C14.8418 10.9514 15.1583 10.9513 15.3536 11.1465C15.5487 11.3417 15.5486 11=
.6583 15.3536 11.8535L10.3535 16.8535C10.2598 16.9473 10.1326 17 10 17C9.90=
062 17 9.8042 16.9703 9.72268 16.916L9.64651 16.8535L4.6465 11.8535C4.45138=
 11.6582 4.45128 11.3417 4.6465 11.1465C4.84172 10.9513 5.15827 10.9514 5.3=
5353 11.1465L9.50003 15.293V3.5C9.50003 3.22386 9.72389 3 10 3Z"></path></s=
vg></div></button><div class=3D"grid" data-testid=3D"chat-input-grid-contai=
ner"><div class=3D"[grid-area:1/1] min-w-0" data-testid=3D"chat-input-grid-=
area"><fieldset data-testid=3D"prompt-input-ssr-interactive" class=3D"flex =
w-full min-w-0 flex-col relative opacity-0 pointer-events-none" inert=3D"">=
<div class=3D"!box-content flex flex-col bg-bg-000 mx-2 md:mx-0 items-stret=
ch transition-all duration-200 relative z-10 rounded-[20px] cursor-text bor=
der border-transparent shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.=
5%),0_0_0_0.5px_hsla(var(--border-300)/0.15)] hover:shadow-[0_0.25rem_1.25r=
em_hsl(var(--always-black)/3.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)] f=
ocus-within:shadow-[0_0.25rem_1.25rem_hsl(var(--always-black)/7.5%),0_0_0_0=
.5px_hsla(var(--border-200)/0.3)] hover:focus-within:shadow-[0_0.25rem_1.25=
rem_hsl(var(--always-black)/7.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)]"=
><div class=3D"flex flex-col m-3.5 gap-3"><div class=3D"relative"><div clas=
s=3D"w-full overflow-y-auto font-large break-words transition-opacity durat=
ion-200 max-h-96 min-h-[1.5rem] pl-[6px] pt-[6px]"><textarea data-testid=3D=
"chat-input-ssr" aria-invalid=3D"false" aria-label=3D"Write your prompt to =
Claude" aria-multiline=3D"true" aria-required=3D"false" placeholder=3D"Repl=
y..." class=3D"block [outline:none!important] resize-none w-full bg-transpa=
rent text-text-100 placeholder:text-text-400 [field-sizing:content]"></text=
area></div></div><div class=3D"h-8 w-full" aria-hidden=3D"true"></div></div=
></div></fieldset></div><div class=3D"[grid-area:1/1] min-w-0" data-testid=
=3D"chat-input-grid-area"><fieldset class=3D"flex w-full min-w-0 flex-col">=
<input id=3D"chat-input-file-upload-bottom" data-testid=3D"file-upload" ari=
a-hidden=3D"true" tabindex=3D"-1" class=3D"absolute -z-10 h-0 w-0 overflow-=
hidden opacity-0 select-none" accept=3D"" multiple=3D"" aria-label=3D"Uploa=
d files" type=3D"file"><div class=3D"px-3 md:px-2" data-alert-band-wrapper=
=3D"true"></div><div class=3D"relative"><div class=3D"absolute bottom-0 lef=
t-1/2 -translate-x-1/2 z-0 pointer-events-none transition-opacity duration-=
500" style=3D"width: 150%; aspect-ratio: 4 / 1; opacity: 0;"></div><div cla=
ss=3D"!box-content flex flex-col bg-bg-000 mx-2 md:mx-0 items-stretch trans=
ition-all duration-200 relative z-10 rounded-[20px] cursor-text relative z-=
[1] border border-transparent md:w-full shadow-[0_0.25rem_1.25rem_hsl(var(-=
-always-black)/3.5%),0_0_0_0.5px_hsla(var(--border-300)/0.15)] hover:shadow=
-[0_0.25rem_1.25rem_hsl(var(--always-black)/3.5%),0_0_0_0.5px_hsla(var(--bo=
rder-200)/0.3)] focus-within:shadow-[0_0.25rem_1.25rem_hsl(var(--always-bla=
ck)/7.5%),0_0_0_0.5px_hsla(var(--border-200)/0.3)] hover:focus-within:shado=
w-[0_0.25rem_1.25rem_hsl(var(--always-black)/7.5%),0_0_0_0.5px_hsla(var(--b=
order-200)/0.3)]"><div class=3D"flex flex-col m-3.5 gap-3"><div class=3D"re=
lative"><div class=3D"w-full overflow-y-auto font-large break-words transit=
ion-opacity duration-200 max-h-96 min-h-[1.5rem] pl-[6px] pt-[6px]"><div co=
ntenteditable=3D"true" role=3D"textbox" enterkeyhint=3D"enter" data-testid=
=3D"chat-input" aria-label=3D"Write your prompt to Claude" aria-multiline=
=3D"true" aria-required=3D"false" aria-invalid=3D"false" translate=3D"no" c=
lass=3D"tiptap ProseMirror" tabindex=3D"0"><p data-placeholder=3D"Reply..."=
 class=3D"is-empty is-editor-empty before:!text-text-500 before:whitespace-=
nowrap"><br class=3D"ProseMirror-trailingBreak"></p></div></div></div><div =
class=3D"relative flex gap-2 w-full items-center"><div class=3D"relative fl=
ex-1 flex items-center shrink min-w-0 gap-1"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 w-8 rounded-md active:=
scale-95 !rounded-lg hover:!bg-bg-200 aria-expanded:!bg-bg-300 active:!scal=
e-100 ml-[2px] Button_ghost__BUAoh" type=3D"button" tabindex=3D"0" aria-has=
popup=3D"menu" aria-expanded=3D"false" id=3D"_r_dj_" aria-label=3D"Toggle m=
enu" data-state=3D"closed"><div style=3D"width: 20px; height: 20px; display=
: flex; align-items: center; justify-content: center;"><svg width=3D"20" he=
ight=3D"20" viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www=
.w3.org/2000/svg" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><path d=3D=
"M10 3C10.2761 3 10.5 3.22386 10.5 3.5V9.5H16.5L16.6006 9.50977C16.8286 9.5=
5629 17 9.75829 17 10C17 10.2417 16.8286 10.4437 16.6006 10.4902L16.5 10.5H=
10.5V16.5C10.5 16.7761 10.2761 17 10 17C9.72386 17 9.5 16.7761 9.5 16.5V10.=
5H3.5C3.22386 10.5 3 10.2761 3 10C3 9.72386 3.22386 9.5 3.5 9.5H9.5V3.5C9.5=
 3.22386 9.72386 3 10 3Z"></path></svg></div></button><div class=3D"flex fl=
ex-row items-center min-w-0 gap-1"></div><div class=3D"text-text-400 text-x=
s ml-2"></div></div><div class=3D"transition-all duration-200 ease-out"><di=
v class=3D"overflow-hidden shrink-0 p-1 -m-1" style=3D"opacity: 1; transfor=
m: none;"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none border-transparent
          transition
          font-base
          duration-300
          ease-[cubic-bezier(0.165,0.85,0.45,1)] h-8 rounded-md px-3 min-w-=
[4rem] active:scale-[0.985] whitespace-nowrap !text-xs pl-2.5 pr-2 gap-1 ho=
ver:!bg-bg-200 Button_ghost__BUAoh" type=3D"button" data-testid=3D"model-se=
lector-dropdown" tabindex=3D"0" aria-haspopup=3D"menu" aria-expanded=3D"fal=
se" id=3D"_r_dn_"><div class=3D"inline-flex gap-1.5 text-[14px] h-[14px] le=
ading-none items-baseline"><div class=3D"flex items-center gap-[4px]"><div =
class=3D"whitespace-nowrap select-none"> Sonnet 4.5</div></div></div><div c=
lass=3D"opacity-75" style=3D"width: 12px; height: 12px; display: flex; alig=
n-items: center; justify-content: center;"><svg width=3D"16" height=3D"16" =
viewBox=3D"0 0 20 20" fill=3D"currentColor" xmlns=3D"http://www.w3.org/2000=
/svg" class=3D"opacity-75" aria-hidden=3D"true" style=3D"flex-shrink: 0;"><=
path d=3D"M14.128 7.16482C14.3126 6.95983 14.6298 6.94336 14.835 7.12771C15=
.0402 7.31242 15.0567 7.62952 14.8721 7.83477L10.372 12.835L10.2939 12.9053=
C10.2093 12.9667 10.1063 13 9.99995 13C9.85833 12.9999 9.72264 12.9402 9.62=
788 12.835L5.12778 7.83477L5.0682 7.75273C4.95072 7.55225 4.98544 7.28926 5=
.16489 7.12771C5.34445 6.96617 5.60969 6.95939 5.79674 7.09744L5.87193 7.16=
482L9.99995 11.7519L14.128 7.16482Z"></path></svg></div></button></div></di=
v><div class=3D"shrink-0 flex items-center"><div style=3D"opacity: 1; trans=
form: none;"><div data-state=3D"closed"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none font-base-bold
          transition-colors h-8 w-8 rounded-md active:scale-95 !rounded-lg =
!h-8 disabled:cursor-default !w-8 Button_claude__c_hZy" disabled=3D"" type=
=3D"button" aria-label=3D"Send message"><svg xmlns=3D"http://www.w3.org/200=
0/svg" width=3D"16" height=3D"16" fill=3D"currentColor" viewBox=3D"0 0 256 =
256"><path d=3D"M208.49,120.49a12,12,0,0,1-17,0L140,69V216a12,12,0,0,1-24,0=
V69L64.49,120.49a12,12,0,0,1-17-17l72-72a12,12,0,0,1,17,0l72,72A12,12,0,0,1=
,208.49,120.49Z"></path></svg></button></div></div></div></div></div><div><=
/div></div></div></fieldset></div></div><div role=3D"note" data-disclaimer=
=3D"true" class=3D"bg-bg-100 text-text-500 text-center text-xs py-2"><span =
style=3D"visibility: visible;"><a target=3D"_blank" rel=3D"noopener norefer=
rer" class=3D"hover:text-text-300 transition" href=3D"https://support.anthr=
opic.com/en/articles/8525154-claude-is-providing-incorrect-or-misleading-re=
sponses-what-s-going-on">Claude is AI and can make mistakes. Please double-=
check responses.</a></span></div></div></div></div></div></div><div class=
=3D"max-md:hidden group w-2 relative h-full cursor-col-resize -mr-1 z-30 gr=
id place-items-center hidden"><div class=3D"absolute top-0 bottom-0 right-1=
 w-[0.5px] bg-border-300 transition-all group-hover:delay-75 group-hover:bg=
-accent-secondary-100 group-hover:w-px group-hover:translate-x-[0.5px]"></d=
iv><div class=3D"h-6 w-2 relative rounded-full border-0.5 bg-bg-100 shadow =
border-border-300 transition duration-200 group-hover:delay-75 group-hover:=
border-accent-secondary-900 group-hover:bg-accent-secondary-900 cursor-col-=
resize"></div></div><div class=3D"max-md:absolute top-0 right-0 bottom-0 le=
ft-0 z-20 md:flex-grow-0 md:flex-shrink-0 md:basis-0 overflow-hidden h-full=
 max-md:hidden" style=3D"flex: 0 0 0%;"><div class=3D"flex flex-col h-full =
overflow-hidden"><div class=3D"h-12 md:hidden bg-bg-000/30 backdrop-blur bo=
rder-b-0.5 border-border-300"></div><div class=3D"flex-1 overflow-hidden h-=
full bg-bg-100"></div></div></div><div class=3D"flex flex-col relative max-=
md:absolute max-md:inset-x-0 max-md:top-0 max-md:pointer-events-none max-md=
:absolute max-md:inset-0"><div class=3D"md:absolute md:right-0 md:top-0 z-2=
0 max-md:w-fit max-md:self-end max-md:pointer-events-auto flex justify-end =
shrink-0 min-w-0 pr-3 items-center gap-1 !h-12 transition-opacity duration-=
150 ease-in-out md:opacity-100 delay-300" data-testid=3D"wiggle-controls-ac=
tions"><button class=3D"inline-flex
  items-center
  justify-center
  relative
  shrink-0
  can-focus
  select-none
  disabled:pointer-events-none
  disabled:opacity-50
  disabled:shadow-none
  disabled:drop-shadow-none font-base-bold
          border-0.5
          relative
          overflow-hidden
          transition
          duration-100
          backface-hidden h-8 rounded-md px-3 min-w-[4rem] active:scale-[0.=
985] whitespace-nowrap !text-xs Button_secondary__Teecd" type=3D"button" da=
ta-testid=3D"wiggle-controls-actions-share">Share</button></div></div></div=
></div></div></div><div role=3D"region" aria-label=3D"Notifications (F8)" t=
abindex=3D"-1" style=3D"pointer-events:none"><ol tabindex=3D"-1" class=3D"f=
ixed right-0 top-0 z-toast flex flex-col gap-3 p-4" role=3D"status"></ol></=
div><!--$--><!--/$--><next-route-announcer style=3D"position: absolute;"><t=
emplate shadowmode=3D"open"><div aria-live=3D"assertive" id=3D"__next-route=
-announcer__" role=3D"alert" style=3D"position: absolute; border: 0px; heig=
ht: 1px; margin: -1px; padding: 0px; width: 1px; clip: rect(0px, 0px, 0px, =
0px); overflow: hidden; white-space: nowrap; overflow-wrap: normal;"></div>=
</template></next-route-announcer><iframe id=3D"intercom-frame" style=3D"po=
sition: absolute !important; opacity: 0 !important; width: 1px !important; =
height: 1px !important; top: 0 !important; left: 0 !important; border: none=
 !important; display: block !important; z-index: -1 !important; pointer-eve=
nts: none;" aria-hidden=3D"true" tabindex=3D"-1" title=3D"Intercom"></ifram=
e><div id=3D"g_a11y_announcement"></div><div class=3D"intercom-lightweight-=
app"></div><iframe src=3D"cid:frame-C2843BBD6A504116A121C1027C02F4E5@mhtml.=
blink" referrerpolicy=3D"no-referrer" sandbox=3D"allow-scripts allow-same-o=
rigin" title=3D"" style=3D"display: none;"></iframe></body></html>
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://accounts.google.com/gsi/style

@charset "utf-8";

#credential_picker_container { border: none; height: 330px; position: fixed=
; right: 20px; top: 20px; width: 391px; z-index: 9999; }

#credential_picker_container .L5Fo6c-PQbLGe { border: none; width: 391px; h=
eight: 330px; }

@media only screen and (max-width: 410px) {
  #credential_picker_container { overflow: hidden auto; right: 0px; width: =
100vw; }
  #credential_picker_container .L5Fo6c-PQbLGe { width: 100vw; }
}

#g_a11y_announcement { height: 1px; left: -10000px; overflow: hidden; posit=
ion: absolute; top: auto; width: 1px; }

.L5Fo6c-sM5MNb { border: 0px; display: block; left: 0px; position: relative=
; top: 0px; }

.L5Fo6c-bF1uUb { border-radius: 4px; inset: 0px; cursor: pointer; position:=
 absolute; }

.L5Fo6c-bF1uUb:focus { border: none; outline: none; }

sentinel { }
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://claude.ai/_next/static/css/608c281e38412b55.css

@charset "utf-8";

@keyframes VoiceVisualizer_voice-pulse__fU64e {=20
  0%, 100% { height: var(--pulse-min,8px); }
  50% { height: var(--pulse-max,32px); }
}

.VoiceVisualizer_voicePulse__w5Lzw { animation: 1s ease-in-out 0s infinite =
normal none running VoiceVisualizer_voice-pulse__fU64e; }
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://claude.ai/_next/static/css/16cce5c2e234666c.css

@charset "utf-8";

@keyframes timeline-fade-in {=20
  0% { opacity: 0; }
  100% { opacity: 1; }
}

@keyframes timeline-collapse {=20
  0% { grid-template-rows: 1fr; opacity: 1; }
  100% { grid-template-rows: 0fr; opacity: 0; }
}

.timeline-block-fade-exit { animation: 0.15s ease-out 0s 1 normal forwards =
running timeline-fade-out; }

@keyframes timeline-fade-out {=20
  0% { opacity: 1; }
  100% { opacity: 0; }
}

.timeline-block-exit { display: grid; overflow: hidden; animation: 0.1s eas=
e-out 0s 1 normal forwards running timeline-collapse; }

.timeline-block-exit > div { min-height: 0px; overflow: hidden; }
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://claude.ai/_next/static/css/acdaad1d23646914.css

@charset "utf-8";

@font-face { font-family: KaTeX_AMS; font-style: normal; font-weight: 400; =
src: url("/_next/static/media/KaTeX_AMS-Regular.a79f1c31.woff2") format("wo=
ff2"), url("/_next/static/media/KaTeX_AMS-Regular.1608a09b.woff") format("w=
off"), url("/_next/static/media/KaTeX_AMS-Regular.4aafdb68.ttf") format("tr=
uetype"); }

@font-face { font-family: KaTeX_Caligraphic; font-style: normal; font-weigh=
t: 700; src: url("/_next/static/media/KaTeX_Caligraphic-Bold.ec17d132.woff2=
") format("woff2"), url("/_next/static/media/KaTeX_Caligraphic-Bold.b677091=
8.woff") format("woff"), url("/_next/static/media/KaTeX_Caligraphic-Bold.cc=
e5b8ec.ttf") format("truetype"); }

@font-face { font-family: KaTeX_Caligraphic; font-style: normal; font-weigh=
t: 400; src: url("/_next/static/media/KaTeX_Caligraphic-Regular.55fac258.wo=
ff2") format("woff2"), url("/_next/static/media/KaTeX_Caligraphic-Regular.d=
ad44a7f.woff") format("woff"), url("/_next/static/media/KaTeX_Caligraphic-R=
egular.07ef19e7.ttf") format("truetype"); }

@font-face { font-family: KaTeX_Fraktur; font-style: normal; font-weight: 7=
00; src: url("/_next/static/media/KaTeX_Fraktur-Bold.d42a5579.woff2") forma=
t("woff2"), url("/_next/static/media/KaTeX_Fraktur-Bold.9f256b85.woff") for=
mat("woff"), url("/_next/static/media/KaTeX_Fraktur-Bold.b18f59e1.ttf") for=
mat("truetype"); }

@font-face { font-family: KaTeX_Fraktur; font-style: normal; font-weight: 4=
00; src: url("/_next/static/media/KaTeX_Fraktur-Regular.d3c882a6.woff2") fo=
rmat("woff2"), url("/_next/static/media/KaTeX_Fraktur-Regular.7c187121.woff=
") format("woff"), url("/_next/static/media/KaTeX_Fraktur-Regular.ed38e79f.=
ttf") format("truetype"); }

@font-face { font-family: KaTeX_Main; font-style: normal; font-weight: 700;=
 src: url("/_next/static/media/KaTeX_Main-Bold.c3fb5ac2.woff2") format("wof=
f2"), url("/_next/static/media/KaTeX_Main-Bold.d181c465.woff") format("woff=
"), url("/_next/static/media/KaTeX_Main-Bold.b74a1a8b.ttf") format("truetyp=
e"); }

@font-face { font-family: KaTeX_Main; font-style: italic; font-weight: 700;=
 src: url("/_next/static/media/KaTeX_Main-BoldItalic.6f2bb1df.woff2") forma=
t("woff2"), url("/_next/static/media/KaTeX_Main-BoldItalic.e3f82f9d.woff") =
format("woff"), url("/_next/static/media/KaTeX_Main-BoldItalic.70d8b0a5.ttf=
") format("truetype"); }

@font-face { font-family: KaTeX_Main; font-style: italic; font-weight: 400;=
 src: url("/_next/static/media/KaTeX_Main-Italic.8916142b.woff2") format("w=
off2"), url("/_next/static/media/KaTeX_Main-Italic.9024d815.woff") format("=
woff"), url("/_next/static/media/KaTeX_Main-Italic.47373d1e.ttf") format("t=
ruetype"); }

@font-face { font-family: KaTeX_Main; font-style: normal; font-weight: 400;=
 src: url("/_next/static/media/KaTeX_Main-Regular.0462f03b.woff2") format("=
woff2"), url("/_next/static/media/KaTeX_Main-Regular.7f51fe03.woff") format=
("woff"), url("/_next/static/media/KaTeX_Main-Regular.b7f8fe9b.ttf") format=
("truetype"); }

@font-face { font-family: KaTeX_Math; font-style: italic; font-weight: 700;=
 src: url("/_next/static/media/KaTeX_Math-BoldItalic.572d331f.woff2") forma=
t("woff2"), url("/_next/static/media/KaTeX_Math-BoldItalic.f1035d8d.woff") =
format("woff"), url("/_next/static/media/KaTeX_Math-BoldItalic.a879cf83.ttf=
") format("truetype"); }

@font-face { font-family: KaTeX_Math; font-style: italic; font-weight: 400;=
 src: url("/_next/static/media/KaTeX_Math-Italic.f28c23ac.woff2") format("w=
off2"), url("/_next/static/media/KaTeX_Math-Italic.5295ba48.woff") format("=
woff"), url("/_next/static/media/KaTeX_Math-Italic.939bc644.ttf") format("t=
ruetype"); }

@font-face { font-family: KaTeX_SansSerif; font-style: normal; font-weight:=
 700; src: url("/_next/static/media/KaTeX_SansSerif-Bold.8c5b5494.woff2") f=
ormat("woff2"), url("/_next/static/media/KaTeX_SansSerif-Bold.bf59d231.woff=
") format("woff"), url("/_next/static/media/KaTeX_SansSerif-Bold.94e1e8dc.t=
tf") format("truetype"); }

@font-face { font-family: KaTeX_SansSerif; font-style: italic; font-weight:=
 400; src: url("/_next/static/media/KaTeX_SansSerif-Italic.3b1e59b3.woff2")=
 format("woff2"), url("/_next/static/media/KaTeX_SansSerif-Italic.7c9bc82b.=
woff") format("woff"), url("/_next/static/media/KaTeX_SansSerif-Italic.b4c2=
0c84.ttf") format("truetype"); }

@font-face { font-family: KaTeX_SansSerif; font-style: normal; font-weight:=
 400; src: url("/_next/static/media/KaTeX_SansSerif-Regular.ba21ed5f.woff2"=
) format("woff2"), url("/_next/static/media/KaTeX_SansSerif-Regular.7404847=
8.woff") format("woff"), url("/_next/static/media/KaTeX_SansSerif-Regular.d=
4d7ba48.ttf") format("truetype"); }

@font-face { font-family: KaTeX_Script; font-style: normal; font-weight: 40=
0; src: url("/_next/static/media/KaTeX_Script-Regular.03e9641d.woff2") form=
at("woff2"), url("/_next/static/media/KaTeX_Script-Regular.07505710.woff") =
format("woff"), url("/_next/static/media/KaTeX_Script-Regular.fe9cbbe1.ttf"=
) format("truetype"); }

@font-face { font-family: KaTeX_Size1; font-style: normal; font-weight: 400=
; src: url("/_next/static/media/KaTeX_Size1-Regular.eae34984.woff2") format=
("woff2"), url("/_next/static/media/KaTeX_Size1-Regular.e1e279cb.woff") for=
mat("woff"), url("/_next/static/media/KaTeX_Size1-Regular.fabc004a.ttf") fo=
rmat("truetype"); }

@font-face { font-family: KaTeX_Size2; font-style: normal; font-weight: 400=
; src: url("/_next/static/media/KaTeX_Size2-Regular.5916a24f.woff2") format=
("woff2"), url("/_next/static/media/KaTeX_Size2-Regular.57727022.woff") for=
mat("woff"), url("/_next/static/media/KaTeX_Size2-Regular.d6b476ec.ttf") fo=
rmat("truetype"); }

@font-face { font-family: KaTeX_Size3; font-style: normal; font-weight: 400=
; src: url("/_next/static/media/KaTeX_Size3-Regular.b4230e7e.woff2") format=
("woff2"), url("/_next/static/media/KaTeX_Size3-Regular.9acaf01c.woff") for=
mat("woff"), url("/_next/static/media/KaTeX_Size3-Regular.a144ef58.ttf") fo=
rmat("truetype"); }

@font-face { font-family: KaTeX_Size4; font-style: normal; font-weight: 400=
; src: url("/_next/static/media/KaTeX_Size4-Regular.10d95fd3.woff2") format=
("woff2"), url("/_next/static/media/KaTeX_Size4-Regular.7a996c9d.woff") for=
mat("woff"), url("/_next/static/media/KaTeX_Size4-Regular.fbccdabe.ttf") fo=
rmat("truetype"); }

@font-face { font-family: KaTeX_Typewriter; font-style: normal; font-weight=
: 400; src: url("/_next/static/media/KaTeX_Typewriter-Regular.a8709e36.woff=
2") format("woff2"), url("/_next/static/media/KaTeX_Typewriter-Regular.6258=
592b.woff") format("woff"), url("/_next/static/media/KaTeX_Typewriter-Regul=
ar.d97aaf4a.ttf") format("truetype"); }

.katex { font: 1.21em / 1.2 KaTeX_Main, "Times New Roman", serif; text-inde=
nt: 0px; text-rendering: auto; }

.katex * { border-color: currentcolor; }

.katex .katex-version::after { content: "0.16.21"; }

.katex .katex-mathml { clip: rect(1px, 1px, 1px, 1px); border: 0px; height:=
 1px; overflow: hidden; padding: 0px; position: absolute; width: 1px; }

.katex .katex-html > .newline { display: block; }

.katex .base { position: relative; white-space: nowrap; width: min-content;=
 }

.katex .base, .katex .strut { display: inline-block; }

.katex .textbf { font-weight: 700; }

.katex .textit { font-style: italic; }

.katex .textrm { font-family: KaTeX_Main; }

.katex .textsf { font-family: KaTeX_SansSerif; }

.katex .texttt { font-family: KaTeX_Typewriter; }

.katex .mathnormal { font-family: KaTeX_Math; font-style: italic; }

.katex .mathit { font-family: KaTeX_Main; font-style: italic; }

.katex .mathrm { font-style: normal; }

.katex .mathbf { font-family: KaTeX_Main; font-weight: 700; }

.katex .boldsymbol { font-family: KaTeX_Math; font-style: italic; font-weig=
ht: 700; }

.katex .amsrm, .katex .mathbb, .katex .textbb { font-family: KaTeX_AMS; }

.katex .mathcal { font-family: KaTeX_Caligraphic; }

.katex .mathfrak, .katex .textfrak { font-family: KaTeX_Fraktur; }

.katex .mathboldfrak, .katex .textboldfrak { font-family: KaTeX_Fraktur; fo=
nt-weight: 700; }

.katex .mathtt { font-family: KaTeX_Typewriter; }

.katex .mathscr, .katex .textscr { font-family: KaTeX_Script; }

.katex .mathsf, .katex .textsf { font-family: KaTeX_SansSerif; }

.katex .mathboldsf, .katex .textboldsf { font-family: KaTeX_SansSerif; font=
-weight: 700; }

.katex .mathitsf, .katex .mathsfit, .katex .textitsf { font-family: KaTeX_S=
ansSerif; font-style: italic; }

.katex .mainrm { font-family: KaTeX_Main; font-style: normal; }

.katex .vlist-t { border-collapse: collapse; display: inline-table; table-l=
ayout: fixed; }

.katex .vlist-r { display: table-row; }

.katex .vlist { display: table-cell; position: relative; vertical-align: bo=
ttom; }

.katex .vlist > span { display: block; height: 0px; position: relative; }

.katex .vlist > span > span { display: inline-block; }

.katex .vlist > span > .pstrut { overflow: hidden; width: 0px; }

.katex .vlist-t2 { margin-right: -2px; }

.katex .vlist-s { display: table-cell; font-size: 1px; min-width: 2px; vert=
ical-align: bottom; width: 2px; }

.katex .vbox { align-items: baseline; display: inline-flex; flex-direction:=
 column; }

.katex .hbox { width: 100%; }

.katex .hbox, .katex .thinbox { display: inline-flex; flex-direction: row; =
}

.katex .thinbox { max-width: 0px; width: 0px; }

.katex .msupsub { text-align: left; }

.katex .mfrac > span > span { text-align: center; }

.katex .mfrac .frac-line { border-bottom-style: solid; display: inline-bloc=
k; width: 100%; }

.katex .hdashline, .katex .hline, .katex .mfrac .frac-line, .katex .overlin=
e .overline-line, .katex .rule, .katex .underline .underline-line { min-hei=
ght: 1px; }

.katex .mspace { display: inline-block; }

.katex .clap, .katex .llap, .katex .rlap { position: relative; width: 0px; =
}

.katex .clap > .inner, .katex .llap > .inner, .katex .rlap > .inner { posit=
ion: absolute; }

.katex .clap > .fix, .katex .llap > .fix, .katex .rlap > .fix { display: in=
line-block; }

.katex .llap > .inner { right: 0px; }

.katex .clap > .inner, .katex .rlap > .inner { left: 0px; }

.katex .clap > .inner > span { margin-left: -50%; margin-right: 50%; }

.katex .rule { border: 0px solid; display: inline-block; position: relative=
; }

.katex .hline, .katex .overline .overline-line, .katex .underline .underlin=
e-line { border-bottom-style: solid; display: inline-block; width: 100%; }

.katex .hdashline { border-bottom-style: dashed; display: inline-block; wid=
th: 100%; }

.katex .sqrt > .root { margin-left: 0.277778em; margin-right: -0.555556em; =
}

.katex .fontsize-ensurer.reset-size1.size1, .katex .sizing.reset-size1.size=
1 { font-size: 1em; }

.katex .fontsize-ensurer.reset-size1.size2, .katex .sizing.reset-size1.size=
2 { font-size: 1.2em; }

.katex .fontsize-ensurer.reset-size1.size3, .katex .sizing.reset-size1.size=
3 { font-size: 1.4em; }

.katex .fontsize-ensurer.reset-size1.size4, .katex .sizing.reset-size1.size=
4 { font-size: 1.6em; }

.katex .fontsize-ensurer.reset-size1.size5, .katex .sizing.reset-size1.size=
5 { font-size: 1.8em; }

.katex .fontsize-ensurer.reset-size1.size6, .katex .sizing.reset-size1.size=
6 { font-size: 2em; }

.katex .fontsize-ensurer.reset-size1.size7, .katex .sizing.reset-size1.size=
7 { font-size: 2.4em; }

.katex .fontsize-ensurer.reset-size1.size8, .katex .sizing.reset-size1.size=
8 { font-size: 2.88em; }

.katex .fontsize-ensurer.reset-size1.size9, .katex .sizing.reset-size1.size=
9 { font-size: 3.456em; }

.katex .fontsize-ensurer.reset-size1.size10, .katex .sizing.reset-size1.siz=
e10 { font-size: 4.148em; }

.katex .fontsize-ensurer.reset-size1.size11, .katex .sizing.reset-size1.siz=
e11 { font-size: 4.976em; }

.katex .fontsize-ensurer.reset-size2.size1, .katex .sizing.reset-size2.size=
1 { font-size: 0.833333em; }

.katex .fontsize-ensurer.reset-size2.size2, .katex .sizing.reset-size2.size=
2 { font-size: 1em; }

.katex .fontsize-ensurer.reset-size2.size3, .katex .sizing.reset-size2.size=
3 { font-size: 1.16667em; }

.katex .fontsize-ensurer.reset-size2.size4, .katex .sizing.reset-size2.size=
4 { font-size: 1.33333em; }

.katex .fontsize-ensurer.reset-size2.size5, .katex .sizing.reset-size2.size=
5 { font-size: 1.5em; }

.katex .fontsize-ensurer.reset-size2.size6, .katex .sizing.reset-size2.size=
6 { font-size: 1.66667em; }

.katex .fontsize-ensurer.reset-size2.size7, .katex .sizing.reset-size2.size=
7 { font-size: 2em; }

.katex .fontsize-ensurer.reset-size2.size8, .katex .sizing.reset-size2.size=
8 { font-size: 2.4em; }

.katex .fontsize-ensurer.reset-size2.size9, .katex .sizing.reset-size2.size=
9 { font-size: 2.88em; }

.katex .fontsize-ensurer.reset-size2.size10, .katex .sizing.reset-size2.siz=
e10 { font-size: 3.45667em; }

.katex .fontsize-ensurer.reset-size2.size11, .katex .sizing.reset-size2.siz=
e11 { font-size: 4.14667em; }

.katex .fontsize-ensurer.reset-size3.size1, .katex .sizing.reset-size3.size=
1 { font-size: 0.714286em; }

.katex .fontsize-ensurer.reset-size3.size2, .katex .sizing.reset-size3.size=
2 { font-size: 0.857143em; }

.katex .fontsize-ensurer.reset-size3.size3, .katex .sizing.reset-size3.size=
3 { font-size: 1em; }

.katex .fontsize-ensurer.reset-size3.size4, .katex .sizing.reset-size3.size=
4 { font-size: 1.14286em; }

.katex .fontsize-ensurer.reset-size3.size5, .katex .sizing.reset-size3.size=
5 { font-size: 1.28571em; }

.katex .fontsize-ensurer.reset-size3.size6, .katex .sizing.reset-size3.size=
6 { font-size: 1.42857em; }

.katex .fontsize-ensurer.reset-size3.size7, .katex .sizing.reset-size3.size=
7 { font-size: 1.71429em; }

.katex .fontsize-ensurer.reset-size3.size8, .katex .sizing.reset-size3.size=
8 { font-size: 2.05714em; }

.katex .fontsize-ensurer.reset-size3.size9, .katex .sizing.reset-size3.size=
9 { font-size: 2.46857em; }

.katex .fontsize-ensurer.reset-size3.size10, .katex .sizing.reset-size3.siz=
e10 { font-size: 2.96286em; }

.katex .fontsize-ensurer.reset-size3.size11, .katex .sizing.reset-size3.siz=
e11 { font-size: 3.55429em; }

.katex .fontsize-ensurer.reset-size4.size1, .katex .sizing.reset-size4.size=
1 { font-size: 0.625em; }

.katex .fontsize-ensurer.reset-size4.size2, .katex .sizing.reset-size4.size=
2 { font-size: 0.75em; }

.katex .fontsize-ensurer.reset-size4.size3, .katex .sizing.reset-size4.size=
3 { font-size: 0.875em; }

.katex .fontsize-ensurer.reset-size4.size4, .katex .sizing.reset-size4.size=
4 { font-size: 1em; }

.katex .fontsize-ensurer.reset-size4.size5, .katex .sizing.reset-size4.size=
5 { font-size: 1.125em; }

.katex .fontsize-ensurer.reset-size4.size6, .katex .sizing.reset-size4.size=
6 { font-size: 1.25em; }

.katex .fontsize-ensurer.reset-size4.size7, .katex .sizing.reset-size4.size=
7 { font-size: 1.5em; }

.katex .fontsize-ensurer.reset-size4.size8, .katex .sizing.reset-size4.size=
8 { font-size: 1.8em; }

.katex .fontsize-ensurer.reset-size4.size9, .katex .sizing.reset-size4.size=
9 { font-size: 2.16em; }

.katex .fontsize-ensurer.reset-size4.size10, .katex .sizing.reset-size4.siz=
e10 { font-size: 2.5925em; }

.katex .fontsize-ensurer.reset-size4.size11, .katex .sizing.reset-size4.siz=
e11 { font-size: 3.11em; }

.katex .fontsize-ensurer.reset-size5.size1, .katex .sizing.reset-size5.size=
1 { font-size: 0.555556em; }

.katex .fontsize-ensurer.reset-size5.size2, .katex .sizing.reset-size5.size=
2 { font-size: 0.666667em; }

.katex .fontsize-ensurer.reset-size5.size3, .katex .sizing.reset-size5.size=
3 { font-size: 0.777778em; }

.katex .fontsize-ensurer.reset-size5.size4, .katex .sizing.reset-size5.size=
4 { font-size: 0.888889em; }

.katex .fontsize-ensurer.reset-size5.size5, .katex .sizing.reset-size5.size=
5 { font-size: 1em; }

.katex .fontsize-ensurer.reset-size5.size6, .katex .sizing.reset-size5.size=
6 { font-size: 1.11111em; }

.katex .fontsize-ensurer.reset-size5.size7, .katex .sizing.reset-size5.size=
7 { font-size: 1.33333em; }

.katex .fontsize-ensurer.reset-size5.size8, .katex .sizing.reset-size5.size=
8 { font-size: 1.6em; }

.katex .fontsize-ensurer.reset-size5.size9, .katex .sizing.reset-size5.size=
9 { font-size: 1.92em; }

.katex .fontsize-ensurer.reset-size5.size10, .katex .sizing.reset-size5.siz=
e10 { font-size: 2.30444em; }

.katex .fontsize-ensurer.reset-size5.size11, .katex .sizing.reset-size5.siz=
e11 { font-size: 2.76444em; }

.katex .fontsize-ensurer.reset-size6.size1, .katex .sizing.reset-size6.size=
1 { font-size: 0.5em; }

.katex .fontsize-ensurer.reset-size6.size2, .katex .sizing.reset-size6.size=
2 { font-size: 0.6em; }

.katex .fontsize-ensurer.reset-size6.size3, .katex .sizing.reset-size6.size=
3 { font-size: 0.7em; }

.katex .fontsize-ensurer.reset-size6.size4, .katex .sizing.reset-size6.size=
4 { font-size: 0.8em; }

.katex .fontsize-ensurer.reset-size6.size5, .katex .sizing.reset-size6.size=
5 { font-size: 0.9em; }

.katex .fontsize-ensurer.reset-size6.size6, .katex .sizing.reset-size6.size=
6 { font-size: 1em; }

.katex .fontsize-ensurer.reset-size6.size7, .katex .sizing.reset-size6.size=
7 { font-size: 1.2em; }

.katex .fontsize-ensurer.reset-size6.size8, .katex .sizing.reset-size6.size=
8 { font-size: 1.44em; }

.katex .fontsize-ensurer.reset-size6.size9, .katex .sizing.reset-size6.size=
9 { font-size: 1.728em; }

.katex .fontsize-ensurer.reset-size6.size10, .katex .sizing.reset-size6.siz=
e10 { font-size: 2.074em; }

.katex .fontsize-ensurer.reset-size6.size11, .katex .sizing.reset-size6.siz=
e11 { font-size: 2.488em; }

.katex .fontsize-ensurer.reset-size7.size1, .katex .sizing.reset-size7.size=
1 { font-size: 0.416667em; }

.katex .fontsize-ensurer.reset-size7.size2, .katex .sizing.reset-size7.size=
2 { font-size: 0.5em; }

.katex .fontsize-ensurer.reset-size7.size3, .katex .sizing.reset-size7.size=
3 { font-size: 0.583333em; }

.katex .fontsize-ensurer.reset-size7.size4, .katex .sizing.reset-size7.size=
4 { font-size: 0.666667em; }

.katex .fontsize-ensurer.reset-size7.size5, .katex .sizing.reset-size7.size=
5 { font-size: 0.75em; }

.katex .fontsize-ensurer.reset-size7.size6, .katex .sizing.reset-size7.size=
6 { font-size: 0.833333em; }

.katex .fontsize-ensurer.reset-size7.size7, .katex .sizing.reset-size7.size=
7 { font-size: 1em; }

.katex .fontsize-ensurer.reset-size7.size8, .katex .sizing.reset-size7.size=
8 { font-size: 1.2em; }

.katex .fontsize-ensurer.reset-size7.size9, .katex .sizing.reset-size7.size=
9 { font-size: 1.44em; }

.katex .fontsize-ensurer.reset-size7.size10, .katex .sizing.reset-size7.siz=
e10 { font-size: 1.72833em; }

.katex .fontsize-ensurer.reset-size7.size11, .katex .sizing.reset-size7.siz=
e11 { font-size: 2.07333em; }

.katex .fontsize-ensurer.reset-size8.size1, .katex .sizing.reset-size8.size=
1 { font-size: 0.347222em; }

.katex .fontsize-ensurer.reset-size8.size2, .katex .sizing.reset-size8.size=
2 { font-size: 0.416667em; }

.katex .fontsize-ensurer.reset-size8.size3, .katex .sizing.reset-size8.size=
3 { font-size: 0.486111em; }

.katex .fontsize-ensurer.reset-size8.size4, .katex .sizing.reset-size8.size=
4 { font-size: 0.555556em; }

.katex .fontsize-ensurer.reset-size8.size5, .katex .sizing.reset-size8.size=
5 { font-size: 0.625em; }

.katex .fontsize-ensurer.reset-size8.size6, .katex .sizing.reset-size8.size=
6 { font-size: 0.694444em; }

.katex .fontsize-ensurer.reset-size8.size7, .katex .sizing.reset-size8.size=
7 { font-size: 0.833333em; }

.katex .fontsize-ensurer.reset-size8.size8, .katex .sizing.reset-size8.size=
8 { font-size: 1em; }

.katex .fontsize-ensurer.reset-size8.size9, .katex .sizing.reset-size8.size=
9 { font-size: 1.2em; }

.katex .fontsize-ensurer.reset-size8.size10, .katex .sizing.reset-size8.siz=
e10 { font-size: 1.44028em; }

.katex .fontsize-ensurer.reset-size8.size11, .katex .sizing.reset-size8.siz=
e11 { font-size: 1.72778em; }

.katex .fontsize-ensurer.reset-size9.size1, .katex .sizing.reset-size9.size=
1 { font-size: 0.289352em; }

.katex .fontsize-ensurer.reset-size9.size2, .katex .sizing.reset-size9.size=
2 { font-size: 0.347222em; }

.katex .fontsize-ensurer.reset-size9.size3, .katex .sizing.reset-size9.size=
3 { font-size: 0.405093em; }

.katex .fontsize-ensurer.reset-size9.size4, .katex .sizing.reset-size9.size=
4 { font-size: 0.462963em; }

.katex .fontsize-ensurer.reset-size9.size5, .katex .sizing.reset-size9.size=
5 { font-size: 0.520833em; }

.katex .fontsize-ensurer.reset-size9.size6, .katex .sizing.reset-size9.size=
6 { font-size: 0.578704em; }

.katex .fontsize-ensurer.reset-size9.size7, .katex .sizing.reset-size9.size=
7 { font-size: 0.694444em; }

.katex .fontsize-ensurer.reset-size9.size8, .katex .sizing.reset-size9.size=
8 { font-size: 0.833333em; }

.katex .fontsize-ensurer.reset-size9.size9, .katex .sizing.reset-size9.size=
9 { font-size: 1em; }

.katex .fontsize-ensurer.reset-size9.size10, .katex .sizing.reset-size9.siz=
e10 { font-size: 1.20023em; }

.katex .fontsize-ensurer.reset-size9.size11, .katex .sizing.reset-size9.siz=
e11 { font-size: 1.43981em; }

.katex .fontsize-ensurer.reset-size10.size1, .katex .sizing.reset-size10.si=
ze1 { font-size: 0.24108em; }

.katex .fontsize-ensurer.reset-size10.size2, .katex .sizing.reset-size10.si=
ze2 { font-size: 0.289296em; }

.katex .fontsize-ensurer.reset-size10.size3, .katex .sizing.reset-size10.si=
ze3 { font-size: 0.337512em; }

.katex .fontsize-ensurer.reset-size10.size4, .katex .sizing.reset-size10.si=
ze4 { font-size: 0.385728em; }

.katex .fontsize-ensurer.reset-size10.size5, .katex .sizing.reset-size10.si=
ze5 { font-size: 0.433944em; }

.katex .fontsize-ensurer.reset-size10.size6, .katex .sizing.reset-size10.si=
ze6 { font-size: 0.48216em; }

.katex .fontsize-ensurer.reset-size10.size7, .katex .sizing.reset-size10.si=
ze7 { font-size: 0.578592em; }

.katex .fontsize-ensurer.reset-size10.size8, .katex .sizing.reset-size10.si=
ze8 { font-size: 0.694311em; }

.katex .fontsize-ensurer.reset-size10.size9, .katex .sizing.reset-size10.si=
ze9 { font-size: 0.833173em; }

.katex .fontsize-ensurer.reset-size10.size10, .katex .sizing.reset-size10.s=
ize10 { font-size: 1em; }

.katex .fontsize-ensurer.reset-size10.size11, .katex .sizing.reset-size10.s=
ize11 { font-size: 1.19961em; }

.katex .fontsize-ensurer.reset-size11.size1, .katex .sizing.reset-size11.si=
ze1 { font-size: 0.200965em; }

.katex .fontsize-ensurer.reset-size11.size2, .katex .sizing.reset-size11.si=
ze2 { font-size: 0.241158em; }

.katex .fontsize-ensurer.reset-size11.size3, .katex .sizing.reset-size11.si=
ze3 { font-size: 0.28135em; }

.katex .fontsize-ensurer.reset-size11.size4, .katex .sizing.reset-size11.si=
ze4 { font-size: 0.321543em; }

.katex .fontsize-ensurer.reset-size11.size5, .katex .sizing.reset-size11.si=
ze5 { font-size: 0.361736em; }

.katex .fontsize-ensurer.reset-size11.size6, .katex .sizing.reset-size11.si=
ze6 { font-size: 0.401929em; }

.katex .fontsize-ensurer.reset-size11.size7, .katex .sizing.reset-size11.si=
ze7 { font-size: 0.482315em; }

.katex .fontsize-ensurer.reset-size11.size8, .katex .sizing.reset-size11.si=
ze8 { font-size: 0.578778em; }

.katex .fontsize-ensurer.reset-size11.size9, .katex .sizing.reset-size11.si=
ze9 { font-size: 0.694534em; }

.katex .fontsize-ensurer.reset-size11.size10, .katex .sizing.reset-size11.s=
ize10 { font-size: 0.833601em; }

.katex .fontsize-ensurer.reset-size11.size11, .katex .sizing.reset-size11.s=
ize11 { font-size: 1em; }

.katex .delimsizing.size1 { font-family: KaTeX_Size1; }

.katex .delimsizing.size2 { font-family: KaTeX_Size2; }

.katex .delimsizing.size3 { font-family: KaTeX_Size3; }

.katex .delimsizing.size4 { font-family: KaTeX_Size4; }

.katex .delimsizing.mult .delim-size1 > span { font-family: KaTeX_Size1; }

.katex .delimsizing.mult .delim-size4 > span { font-family: KaTeX_Size4; }

.katex .nulldelimiter { display: inline-block; width: 0.12em; }

.katex .delimcenter, .katex .op-symbol { position: relative; }

.katex .op-symbol.small-op { font-family: KaTeX_Size1; }

.katex .op-symbol.large-op { font-family: KaTeX_Size2; }

.katex .accent > .vlist-t, .katex .op-limits > .vlist-t { text-align: cente=
r; }

.katex .accent .accent-body { position: relative; }

.katex .accent .accent-body:not(.accent-full) { width: 0px; }

.katex .overlay { display: block; }

.katex .mtable .vertical-separator { display: inline-block; min-width: 1px;=
 }

.katex .mtable .arraycolsep { display: inline-block; }

.katex .mtable .col-align-c > .vlist-t { text-align: center; }

.katex .mtable .col-align-l > .vlist-t { text-align: left; }

.katex .mtable .col-align-r > .vlist-t { text-align: right; }

.katex .svg-align { text-align: left; }

.katex svg { fill: currentcolor; stroke: currentcolor; fill-rule: nonzero; =
fill-opacity: 1; stroke-width: 1; stroke-linecap: butt; stroke-linejoin: mi=
ter; stroke-miterlimit: 4; stroke-dasharray: none; stroke-dashoffset: 0; st=
roke-opacity: 1; display: block; height: inherit; position: absolute; width=
: 100%; }

.katex svg path { stroke: none; }

.katex img { border-style: none; max-height: none; max-width: none; min-hei=
ght: 0px; min-width: 0px; }

.katex .stretchy { display: block; overflow: hidden; position: relative; wi=
dth: 100%; }

.katex .stretchy::after, .katex .stretchy::before { content: ""; }

.katex .hide-tail { overflow: hidden; position: relative; width: 100%; }

.katex .halfarrow-left { left: 0px; overflow: hidden; position: absolute; w=
idth: 50.2%; }

.katex .halfarrow-right { overflow: hidden; position: absolute; right: 0px;=
 width: 50.2%; }

.katex .brace-left { left: 0px; overflow: hidden; position: absolute; width=
: 25.1%; }

.katex .brace-center { left: 25%; overflow: hidden; position: absolute; wid=
th: 50%; }

.katex .brace-right { overflow: hidden; position: absolute; right: 0px; wid=
th: 25.1%; }

.katex .x-arrow-pad { padding: 0px 0.5em; }

.katex .cd-arrow-pad { padding: 0px 0.55556em 0px 0.27778em; }

.katex .mover, .katex .munder, .katex .x-arrow { text-align: center; }

.katex .boxpad { padding: 0px 0.3em; }

.katex .fbox, .katex .fcolorbox { border: 0.04em solid; box-sizing: border-=
box; }

.katex .cancel-pad { padding: 0px 0.2em; }

.katex .cancel-lap { margin-left: -0.2em; margin-right: -0.2em; }

.katex .sout { border-bottom-style: solid; border-bottom-width: 0.08em; }

.katex .angl { border-right: 0.049em solid; border-top: 0.049em solid; box-=
sizing: border-box; margin-right: 0.03889em; }

.katex .anglpad { padding: 0px 0.03889em; }

.katex .eqn-num::before { content: "(" counter(katexEqnNo) ")"; counter-inc=
rement: katexEqnNo 1; }

.katex .mml-eqn-num::before { content: "(" counter(mmlEqnNo) ")"; counter-i=
ncrement: mmlEqnNo 1; }

.katex .mtr-glue { width: 50%; }

.katex .cd-vert-arrow { display: inline-block; position: relative; }

.katex .cd-label-left { display: inline-block; position: absolute; right: c=
alc(50% + 0.3em); text-align: left; }

.katex .cd-label-right { display: inline-block; left: calc(50% + 0.3em); po=
sition: absolute; text-align: right; }

.katex-display { display: block; margin: 1em 0px; text-align: center; }

.katex-display > .katex { display: block; text-align: center; white-space: =
nowrap; }

.katex-display > .katex > .katex-html { display: block; position: relative;=
 }

.katex-display > .katex > .katex-html > .tag { position: absolute; right: 0=
px; }

.katex-display.leqno > .katex > .katex-html > .tag { left: 0px; right: auto=
; }

.katex-display.fleqn > .katex { padding-left: 2em; text-align: left; }

body { counter-reset: katexEqnNo 0 mmlEqnNo 0; }
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://claude.ai/_next/static/css/6c432c275096a856.css

@charset "utf-8";

.navbar-dropdown-content { animation: 0.6s cubic-bezier(0.22, 1, 0.36, 1) 0=
s 1 normal none running curtainDown; transform-origin: center top; border: =
none !important; }

[data-theme=3D"claude"]:not([data-mode]) .navbar-dropdown-content a:hover, =
[data-theme=3D"claude"][data-mode=3D"dark"] .navbar-dropdown-content a:hove=
r { background-color: hsl(var(--bg-000)) !important; }

.navbar-dropdown-content[data-state=3D"closed"] { animation: 0.6s cubic-bez=
ier(0.22, 1, 0.36, 1) 0s 1 normal none running curtainUp; }

@keyframes curtainDown {=20
  0% { clip-path: inset(0px 0px 100%); opacity: 0; }
  100% { clip-path: inset(0px); opacity: 1; }
}

@keyframes curtainUp {=20
  0% { clip-path: inset(0px); opacity: 1; }
  100% { clip-path: inset(0px 0px 100%); opacity: 0; }
}
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://claude.ai/_next/static/css/1e0cea0e83952274.css

@charset "utf-8";

*, ::after, ::before { box-sizing: border-box; border: 0px solid; }

::after, ::before { --tw-content: ""; }

:host, html { line-height: 1.5; text-size-adjust: 100%; tab-size: 4; font-f=
amily: var(--font-ui); font-feature-settings: normal; font-variation-settin=
gs: normal; -webkit-tap-highlight-color: transparent; }

body { margin: 0px; line-height: inherit; }

hr { height: 0px; color: inherit; border-top-width: 1px; }

abbr:where([title]) { text-decoration: underline dotted; }

h1, h2, h3, h4, h5, h6 { font-size: inherit; font-weight: inherit; }

a { text-decoration: inherit; }

b, strong { font-weight: bolder; }

code, kbd, pre, samp { font-family: var(--font-mono); font-feature-settings=
: normal; font-variation-settings: normal; font-size: 1em; }

small { font-size: 80%; }

sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-ali=
gn: baseline; }

sub { bottom: -0.25em; }

sup { top: -0.5em; }

table { text-indent: 0px; border-color: inherit; border-collapse: collapse;=
 }

button, input, optgroup, select, textarea { font-family: inherit; font-feat=
ure-settings: inherit; font-variation-settings: inherit; font-size: 100%; f=
ont-weight: inherit; line-height: inherit; letter-spacing: inherit; color: =
inherit; margin: 0px; padding: 0px; }

button, select { text-transform: none; }

button, input:where([type=3D"button"]), input:where([type=3D"reset"]), inpu=
t:where([type=3D"submit"]) { appearance: button; background-color: transpar=
ent; background-image: none; }

progress { vertical-align: baseline; }

::-webkit-inner-spin-button, ::-webkit-outer-spin-button { height: auto; }

[type=3D"search"] { appearance: textfield; outline-offset: -2px; }

::-webkit-search-decoration { appearance: none; }

::-webkit-file-upload-button { appearance: button; font: inherit; }

summary { display: list-item; }

blockquote, dd, dl, figure, h1, h2, h3, h4, h5, h6, hr, p, pre { margin: 0p=
x; }

fieldset { margin: 0px; }

fieldset, legend { padding: 0px; }

menu, ol, ul { list-style: none; margin: 0px; padding: 0px; }

dialog { padding: 0px; }

textarea { resize: vertical; }

input::placeholder, textarea::placeholder { opacity: 1; color: rgb(156, 163=
, 175); }

[role=3D"button"], button { cursor: pointer; }

:disabled { cursor: default; }

audio, canvas, embed, iframe, img, object, svg, video { display: block; ver=
tical-align: middle; }

img, video { max-width: 100%; height: auto; }

[hidden] { display: none; }

b, strong { font-weight: 600; }

*, ::after, ::before { --tw-border-spacing-x: 0; --tw-border-spacing-y: 0; =
--tw-translate-x: 0; --tw-translate-y: 0; --tw-rotate: 0; --tw-skew-x: 0; -=
-tw-skew-y: 0; --tw-scale-x: 1; --tw-scale-y: 1; --tw-pan-x: ; --tw-pan-y: =
; --tw-pinch-zoom: ; --tw-scroll-snap-strictness: proximity; --tw-gradient-=
from-position: ; --tw-gradient-via-position: ; --tw-gradient-to-position: ;=
 --tw-ordinal: ; --tw-slashed-zero: ; --tw-numeric-figure: ; --tw-numeric-s=
pacing: ; --tw-numeric-fraction: ; --tw-ring-inset: ; --tw-ring-offset-widt=
h: 0px; --tw-ring-offset-color: #fff; --tw-ring-color: hsl(var(--accent-sec=
ondary-100)/1); --tw-ring-offset-shadow: 0 0 #0000; --tw-ring-shadow: 0 0 #=
0000; --tw-shadow: 0 0 #0000; --tw-shadow-colored: 0 0 #0000; --tw-blur: ; =
--tw-brightness: ; --tw-contrast: ; --tw-grayscale: ; --tw-hue-rotate: ; --=
tw-invert: ; --tw-saturate: ; --tw-sepia: ; --tw-drop-shadow: ; --tw-backdr=
op-blur: ; --tw-backdrop-brightness: ; --tw-backdrop-contrast: ; --tw-backd=
rop-grayscale: ; --tw-backdrop-hue-rotate: ; --tw-backdrop-invert: ; --tw-b=
ackdrop-opacity: ; --tw-backdrop-saturate: ; --tw-backdrop-sepia: ; --tw-co=
ntain-size: ; --tw-contain-layout: ; --tw-contain-paint: ; --tw-contain-sty=
le: ; }

::backdrop { --tw-border-spacing-x: 0; --tw-border-spacing-y: 0; --tw-trans=
late-x: 0; --tw-translate-y: 0; --tw-rotate: 0; --tw-skew-x: 0; --tw-skew-y=
: 0; --tw-scale-x: 1; --tw-scale-y: 1; --tw-pan-x: ; --tw-pan-y: ; --tw-pin=
ch-zoom: ; --tw-scroll-snap-strictness: proximity; --tw-gradient-from-posit=
ion: ; --tw-gradient-via-position: ; --tw-gradient-to-position: ; --tw-ordi=
nal: ; --tw-slashed-zero: ; --tw-numeric-figure: ; --tw-numeric-spacing: ; =
--tw-numeric-fraction: ; --tw-ring-inset: ; --tw-ring-offset-width: 0px; --=
tw-ring-offset-color: #fff; --tw-ring-color: hsl(var(--accent-secondary-100=
)/1); --tw-ring-offset-shadow: 0 0 #0000; --tw-ring-shadow: 0 0 #0000; --tw=
-shadow: 0 0 #0000; --tw-shadow-colored: 0 0 #0000; --tw-blur: ; --tw-brigh=
tness: ; --tw-contrast: ; --tw-grayscale: ; --tw-hue-rotate: ; --tw-invert:=
 ; --tw-saturate: ; --tw-sepia: ; --tw-drop-shadow: ; --tw-backdrop-blur: ;=
 --tw-backdrop-brightness: ; --tw-backdrop-contrast: ; --tw-backdrop-graysc=
ale: ; --tw-backdrop-hue-rotate: ; --tw-backdrop-invert: ; --tw-backdrop-op=
acity: ; --tw-backdrop-saturate: ; --tw-backdrop-sepia: ; --tw-contain-size=
: ; --tw-contain-layout: ; --tw-contain-paint: ; --tw-contain-style: ; }

.\!container { width: 100% !important; }

.container { width: 100%; }

@media (min-width: 640px) {
  .\!container { max-width: 640px !important; }
  .container { max-width: 640px; }
}

@media (min-width: 768px) {
  .\!container { max-width: 768px !important; }
  .container { max-width: 768px; }
}

@media (min-width: 1024px) {
  .\!container { max-width: 1024px !important; }
  .container { max-width: 1024px; }
}

@media (min-width: 1280px) {
  .\!container { max-width: 1280px !important; }
  .container { max-width: 1280px; }
}

@media (min-width: 1536px) {
  .\!container { max-width: 1536px !important; }
  .container { max-width: 1536px; }
}

.sr-only { position: absolute; width: 1px; height: 1px; padding: 0px; margi=
n: -1px; overflow: hidden; clip: rect(0px, 0px, 0px, 0px); white-space: now=
rap; border-width: 0px; }

.\!pointer-events-none { pointer-events: none !important; }

.pointer-events-none { pointer-events: none; }

.\!pointer-events-auto { pointer-events: auto !important; }

.pointer-events-auto { pointer-events: auto; }

.visible { visibility: visible; }

.invisible { visibility: hidden; }

.collapse { visibility: collapse; }

.static { position: static; }

.fixed { position: fixed; }

.\!absolute { position: absolute !important; }

.absolute { position: absolute; }

.relative { position: relative; }

.sticky { position: sticky; }

.-inset-px { inset: -1px; }

.inset-0 { inset: 0px; }

.inset-1 { inset: 0.25rem; }

.inset-2 { inset: 0.5rem; }

.inset-3 { inset: 0.75rem; }

.inset-4 { inset: 1rem; }

.inset-\[-1px\] { inset: -1px; }

.inset-\[50px_8px_8px_8px\] { inset: 50px 8px 8px; }

.-inset-y-0 { top: 0px; bottom: 0px; }

.-inset-y-0\.5 { top: -0.125rem; bottom: -0.125rem; }

.inset-x-0 { left: 0px; right: 0px; }

.inset-y-0 { top: 0px; bottom: 0px; }

.\!top-0 { top: 0px !important; }

.-bottom-0 { bottom: 0px; }

.-bottom-0\.5 { bottom: -0.125rem; }

.-bottom-1 { bottom: -0.25rem; }

.-bottom-1\.5 { bottom: -0.375rem; }

.-bottom-16 { bottom: -4rem; }

.-bottom-2 { bottom: -0.5rem; }

.-bottom-5 { bottom: -1.25rem; }

.-bottom-px { bottom: -1px; }

.-left-0 { left: 0px; }

.-left-0\.5 { left: -0.125rem; }

.-left-1 { left: -0.25rem; }

.-left-16 { left: -4rem; }

.-left-2 { left: -0.5rem; }

.-left-4 { left: -1rem; }

.-left-8 { left: -2rem; }

.-right-0 { right: 0px; }

.-right-0\.5 { right: -0.125rem; }

.-right-1 { right: -0.25rem; }

.-right-1\.5 { right: -0.375rem; }

.-right-10 { right: -2.5rem; }

.-right-16 { right: -4rem; }

.-right-2 { right: -0.5rem; }

.-right-8 { right: -2rem; }

.-right-px { right: -1px; }

.-top-0 { top: 0px; }

.-top-0\.5 { top: -0.125rem; }

.-top-1 { top: -0.25rem; }

.-top-1\.5 { top: -0.375rem; }

.-top-10 { top: -2.5rem; }

.-top-16 { top: -4rem; }

.-top-2 { top: -0.5rem; }

.-top-4 { top: -1rem; }

.-top-8 { top: -2rem; }

.-top-\[52px\] { top: -52px; }

.-top-px { top: -1px; }

.bottom-0 { bottom: 0px; }

.bottom-1 { bottom: 0.25rem; }

.bottom-1\.5 { bottom: 0.375rem; }

.bottom-10 { bottom: 2.5rem; }

.bottom-12 { bottom: 3rem; }

.bottom-16 { bottom: 4rem; }

.bottom-2 { bottom: 0.5rem; }

.bottom-20 { bottom: 5rem; }

.bottom-3 { bottom: 0.75rem; }

.bottom-4 { bottom: 1rem; }

.bottom-5 { bottom: 1.25rem; }

.bottom-6 { bottom: 1.5rem; }

.bottom-8 { bottom: 2rem; }

.bottom-9 { bottom: 2.25rem; }

.bottom-\[0\.5px\] { bottom: 0.5px; }

.bottom-\[15px\] { bottom: 15px; }

.bottom-\[1px\] { bottom: 1px; }

.bottom-\[2px\] { bottom: 2px; }

.bottom-\[calc\(50\%-320px\)\] { bottom: calc(50% - 320px); }

.bottom-full { bottom: 100%; }

.end-3 { inset-inline-end: 0.75rem; }

.left-0 { left: 0px; }

.left-1 { left: 0.25rem; }

.left-1\.5 { left: 0.375rem; }

.left-1\/2 { left: 50%; }

.left-12 { left: 3rem; }

.left-2 { left: 0.5rem; }

.left-20 { left: 5rem; }

.left-3 { left: 0.75rem; }

.left-3\.5 { left: 0.875rem; }

.left-4 { left: 1rem; }

.left-5 { left: 1.25rem; }

.left-\[-12px\] { left: -12px; }

.left-\[-24px\] { left: -24px; }

.left-\[134px\] { left: 134px; }

.left-\[20px\] { left: 20px; }

.left-\[5\.5rem\] { left: 5.5rem; }

.left-full { left: 100%; }

.right-0 { right: 0px; }

.right-1 { right: 0.25rem; }

.right-1\.5 { right: 0.375rem; }

.right-10 { right: 2.5rem; }

.right-12 { right: 3rem; }

.right-16 { right: 4rem; }

.right-2 { right: 0.5rem; }

.right-2\.5 { right: 0.625rem; }

.right-20 { right: 5rem; }

.right-3 { right: 0.75rem; }

.right-3\.5 { right: 0.875rem; }

.right-4 { right: 1rem; }

.right-5 { right: 1.25rem; }

.right-6 { right: 1.5rem; }

.right-8 { right: 2rem; }

.right-\[-24px\] { right: -24px; }

.right-\[0\.5px\] { right: 0.5px; }

.right-\[174px\] { right: 174px; }

.right-\[17px\] { right: 17px; }

.right-full { right: 100%; }

.start-\[2px\] { inset-inline-start: 2px; }

.top-0 { top: 0px; }

.top-1 { top: 0.25rem; }

.top-1\.5 { top: 0.375rem; }

.top-1\/2 { top: 50%; }

.top-1\/3 { top: 33.3333%; }

.top-10 { top: 2.5rem; }

.top-12 { top: 3rem; }

.top-14 { top: 3.5rem; }

.top-2 { top: 0.5rem; }

.top-2\.5 { top: 0.625rem; }

.top-3 { top: 0.75rem; }

.top-3\.5 { top: 0.875rem; }

.top-32 { top: 8rem; }

.top-4 { top: 1rem; }

.top-48 { top: 12rem; }

.top-5 { top: 1.25rem; }

.top-6 { top: 1.5rem; }

.top-8 { top: 2rem; }

.top-\[0\.5px\] { top: 0.5px; }

.top-\[1\%\] { top: 1%; }

.top-\[1\.4rem\] { top: 1.4rem; }

.top-\[1px\] { top: 1px; }

.top-\[2\%\] { top: 2%; }

.top-\[2px\] { top: 2px; }

.top-\[40\%\] { top: 40%; }

.top-full { top: 100%; }

.top-px { top: 1px; }

.isolate { isolation: isolate; }

.\!z-\[10000\] { z-index: 10000 !important; }

.-z-10 { z-index: -10; }

.-z-20 { z-index: -20; }

.-z-\[1\] { z-index: -1; }

.z-0 { z-index: 0; }

.z-10 { z-index: 10; }

.z-20 { z-index: 20; }

.z-30 { z-index: 30; }

.z-40 { z-index: 40; }

.z-50 { z-index: 50; }

.z-\[-1\] { z-index: -1; }

.z-\[10000\] { z-index: 10000; }

.z-\[10001\] { z-index: 10001; }

.z-\[1000\] { z-index: 1000; }

.z-\[100\] { z-index: 100; }

.z-\[10\] { z-index: 10; }

.z-\[15\] { z-index: 15; }

.z-\[1\] { z-index: 1; }

.z-\[2\] { z-index: 2; }

.z-\[31\] { z-index: 31; }

.z-\[3\] { z-index: 3; }

.z-\[5\] { z-index: 5; }

.z-\[60\] { z-index: 60; }

.z-\[9999\] { z-index: 9999; }

.z-\[999\] { z-index: 999; }

.z-dropdown { z-index: 50; }

.z-header { z-index: 20; }

.z-modal { z-index: 40; }

.z-overlay { z-index: 50; }

.z-sidebar { z-index: 30; }

.z-toast { z-index: 60; }

.z-tooltip { z-index: 50; }

.-order-1 { order: -1; }

.col-span-1 { grid-column: span 1 / span 1; }

.col-span-10 { grid-column: span 10 / span 10; }

.col-span-2 { grid-column: span 2 / span 2; }

.col-span-3 { grid-column: span 3 / span 3; }

.col-span-7 { grid-column: span 7 / span 7; }

.col-start-1 { grid-column-start: 1; }

.col-end-2 { grid-column-end: 2; }

.row-start-1 { grid-row-start: 1; }

.row-start-2 { grid-row-start: 2; }

.row-end-2 { grid-row-end: 2; }

.float-right { float: right; }

.\!m-0 { margin: 0px !important; }

.-m-1 { margin: -0.25rem; }

.-m-2 { margin: -0.5rem; }

.-m-32 { margin: -8rem; }

.-m-\[1px\] { margin: -1px; }

.m-0 { margin: 0px; }

.m-0\.5 { margin: 0.125rem; }

.m-2 { margin: 0.5rem; }

.m-3 { margin: 0.75rem; }

.m-3\.5 { margin: 0.875rem; }

.m-6 { margin: 1.5rem; }

.m-auto { margin: auto; }

.\!my-0 { margin-top: 0px !important; margin-bottom: 0px !important; }

.\!my-3 { margin-top: 0.75rem !important; margin-bottom: 0.75rem !important=
; }

.-mx-0 { margin-left: 0px; margin-right: 0px; }

.-mx-0\.5 { margin-left: -0.125rem; margin-right: -0.125rem; }

.-mx-1 { margin-left: -0.25rem; margin-right: -0.25rem; }

.-mx-1\.5 { margin-left: -0.375rem; margin-right: -0.375rem; }

.-mx-2 { margin-left: -0.5rem; margin-right: -0.5rem; }

.-mx-3 { margin-left: -0.75rem; margin-right: -0.75rem; }

.-mx-3\.5 { margin-left: -0.875rem; margin-right: -0.875rem; }

.-mx-4 { margin-left: -1rem; margin-right: -1rem; }

.-mx-5 { margin-left: -1.25rem; margin-right: -1.25rem; }

.-mx-6 { margin-left: -1.5rem; margin-right: -1.5rem; }

.-mx-\[0\.2rem\] { margin-left: -0.2rem; margin-right: -0.2rem; }

.-my-1 { margin-top: -0.25rem; margin-bottom: -0.25rem; }

.-my-1\.5 { margin-top: -0.375rem; margin-bottom: -0.375rem; }

.-my-2 { margin-top: -0.5rem; margin-bottom: -0.5rem; }

.-my-3 { margin-top: -0.75rem; margin-bottom: -0.75rem; }

.-my-\[0\.225em\] { margin-top: -0.225em; margin-bottom: -0.225em; }

.mx-0 { margin-left: 0px; margin-right: 0px; }

.mx-0\.5 { margin-left: 0.125rem; margin-right: 0.125rem; }

.mx-1 { margin-left: 0.25rem; margin-right: 0.25rem; }

.mx-1\.5 { margin-left: 0.375rem; margin-right: 0.375rem; }

.mx-2 { margin-left: 0.5rem; margin-right: 0.5rem; }

.mx-2\.5 { margin-left: 0.625rem; margin-right: 0.625rem; }

.mx-3 { margin-left: 0.75rem; margin-right: 0.75rem; }

.mx-3\.5 { margin-left: 0.875rem; margin-right: 0.875rem; }

.mx-4 { margin-left: 1rem; margin-right: 1rem; }

.mx-5 { margin-left: 1.25rem; margin-right: 1.25rem; }

.mx-8 { margin-left: 2rem; margin-right: 2rem; }

.mx-auto { margin-left: auto; margin-right: auto; }

.my-0 { margin-top: 0px; margin-bottom: 0px; }

.my-0\.5 { margin-top: 0.125rem; margin-bottom: 0.125rem; }

.my-1 { margin-top: 0.25rem; margin-bottom: 0.25rem; }

.my-1\.5 { margin-top: 0.375rem; margin-bottom: 0.375rem; }

.my-2 { margin-top: 0.5rem; margin-bottom: 0.5rem; }

.my-3 { margin-top: 0.75rem; margin-bottom: 0.75rem; }

.my-4 { margin-top: 1rem; margin-bottom: 1rem; }

.my-6 { margin-top: 1.5rem; margin-bottom: 1.5rem; }

.my-7 { margin-top: 1.75rem; margin-bottom: 1.75rem; }

.my-8 { margin-top: 2rem; margin-bottom: 2rem; }

.my-\[0\.35rem\] { margin-top: 0.35rem; margin-bottom: 0.35rem; }

.my-auto { margin-top: auto; margin-bottom: auto; }

.\!mb-2 { margin-bottom: 0.5rem !important; }

.\!ml-0 { margin-left: 0px !important; }

.\!ml-0\.5 { margin-left: 0.125rem !important; }

.\!ml-1 { margin-left: 0.25rem !important; }

.\!mt-0 { margin-top: 0px !important; }

.-mb-1 { margin-bottom: -0.25rem; }

.-mb-1\.5 { margin-bottom: -0.375rem; }

.-mb-2 { margin-bottom: -0.5rem; }

.-mb-20 { margin-bottom: -5rem; }

.-mb-3 { margin-bottom: -0.75rem; }

.-mb-4 { margin-bottom: -1rem; }

.-mb-px { margin-bottom: -1px; }

.-ml-0 { margin-left: 0px; }

.-ml-0\.5 { margin-left: -0.125rem; }

.-ml-1 { margin-left: -0.25rem; }

.-ml-2 { margin-left: -0.5rem; }

.-ml-3 { margin-left: -0.75rem; }

.-ml-4 { margin-left: -1rem; }

.-ml-8 { margin-left: -2rem; }

.-ml-9 { margin-left: -2.25rem; }

.-mr-1 { margin-right: -0.25rem; }

.-mr-1\.5 { margin-right: -0.375rem; }

.-mr-2 { margin-right: -0.5rem; }

.-mr-2\.5 { margin-right: -0.625rem; }

.-mr-24 { margin-right: -6rem; }

.-mr-\[2px\] { margin-right: -2px; }

.-mt-0 { margin-top: 0px; }

.-mt-0\.5 { margin-top: -0.125rem; }

.-mt-1 { margin-top: -0.25rem; }

.-mt-1\.5 { margin-top: -0.375rem; }

.-mt-10 { margin-top: -2.5rem; }

.-mt-2 { margin-top: -0.5rem; }

.-mt-20 { margin-top: -5rem; }

.-mt-3 { margin-top: -0.75rem; }

.-mt-4 { margin-top: -1rem; }

.-mt-6 { margin-top: -1.5rem; }

.-mt-7 { margin-top: -1.75rem; }

.-mt-\[0\.5px\] { margin-top: -0.5px; }

.-mt-px { margin-top: -1px; }

.mb-0 { margin-bottom: 0px; }

.mb-0\.5 { margin-bottom: 0.125rem; }

.mb-1 { margin-bottom: 0.25rem; }

.mb-1\.5 { margin-bottom: 0.375rem; }

.mb-10 { margin-bottom: 2.5rem; }

.mb-11 { margin-bottom: 2.75rem; }

.mb-12 { margin-bottom: 3rem; }

.mb-14 { margin-bottom: 3.5rem; }

.mb-16 { margin-bottom: 4rem; }

.mb-2 { margin-bottom: 0.5rem; }

.mb-2\.5 { margin-bottom: 0.625rem; }

.mb-20 { margin-bottom: 5rem; }

.mb-24 { margin-bottom: 6rem; }

.mb-3 { margin-bottom: 0.75rem; }

.mb-3\.5 { margin-bottom: 0.875rem; }

.mb-32 { margin-bottom: 8rem; }

.mb-4 { margin-bottom: 1rem; }

.mb-5 { margin-bottom: 1.25rem; }

.mb-6 { margin-bottom: 1.5rem; }

.mb-7 { margin-bottom: 1.75rem; }

.mb-8 { margin-bottom: 2rem; }

.mb-\[15px\] { margin-bottom: 15px; }

.mb-\[40px\] { margin-bottom: 40px; }

.mb-px { margin-bottom: 1px; }

.ml-0 { margin-left: 0px; }

.ml-0\.5 { margin-left: 0.125rem; }

.ml-1 { margin-left: 0.25rem; }

.ml-1\.5 { margin-left: 0.375rem; }

.ml-10 { margin-left: 2.5rem; }

.ml-11 { margin-left: 2.75rem; }

.ml-2 { margin-left: 0.5rem; }

.ml-2\.5 { margin-left: 0.625rem; }

.ml-3 { margin-left: 0.75rem; }

.ml-4 { margin-left: 1rem; }

.ml-5 { margin-left: 1.25rem; }

.ml-6 { margin-left: 1.5rem; }

.ml-7 { margin-left: 1.75rem; }

.ml-8 { margin-left: 2rem; }

.ml-\[0\.875rem\] { margin-left: 0.875rem; }

.ml-\[28px\] { margin-left: 28px; }

.ml-\[2px\] { margin-left: 2px; }

.ml-\[clamp\(1\.5rem\,10vw\,3rem\)\] { margin-left: clamp(1.5rem, 10vw, 3re=
m); }

.ml-auto { margin-left: auto; }

.mr-0 { margin-right: 0px; }

.mr-0\.5 { margin-right: 0.125rem; }

.mr-1 { margin-right: 0.25rem; }

.mr-1\.5 { margin-right: 0.375rem; }

.mr-10 { margin-right: 2.5rem; }

.mr-2 { margin-right: 0.5rem; }

.mr-2\.5 { margin-right: 0.625rem; }

.mr-3 { margin-right: 0.75rem; }

.mr-4 { margin-right: 1rem; }

.mr-6 { margin-right: 1.5rem; }

.mr-8 { margin-right: 2rem; }

.mr-auto { margin-right: auto; }

.mr-px { margin-right: 1px; }

.ms-1 { margin-inline-start: 0.25rem; }

.ms-auto { margin-inline-start: auto; }

.mt-0 { margin-top: 0px; }

.mt-0\.5 { margin-top: 0.125rem; }

.mt-1 { margin-top: 0.25rem; }

.mt-1\.5 { margin-top: 0.375rem; }

.mt-10 { margin-top: 2.5rem; }

.mt-12 { margin-top: 3rem; }

.mt-14 { margin-top: 3.5rem; }

.mt-16 { margin-top: 4rem; }

.mt-2 { margin-top: 0.5rem; }

.mt-2\.5 { margin-top: 0.625rem; }

.mt-20 { margin-top: 5rem; }

.mt-3 { margin-top: 0.75rem; }

.mt-3\.5 { margin-top: 0.875rem; }

.mt-32 { margin-top: 8rem; }

.mt-4 { margin-top: 1rem; }

.mt-40 { margin-top: 10rem; }

.mt-5 { margin-top: 1.25rem; }

.mt-6 { margin-top: 1.5rem; }

.mt-7 { margin-top: 1.75rem; }

.mt-8 { margin-top: 2rem; }

.mt-9 { margin-top: 2.25rem; }

.mt-\[-24rem\] { margin-top: -24rem; }

.mt-\[-8rem\] { margin-top: -8rem; }

.mt-\[0\.25em\] { margin-top: 0.25em; }

.mt-\[0\.25rem\] { margin-top: 0.25rem; }

.mt-\[0\.35rem\] { margin-top: 0.35rem; }

.mt-\[1\.125rem\] { margin-top: 1.125rem; }

.mt-\[15vh\] { margin-top: 15vh; }

.mt-\[22px\] { margin-top: 22px; }

.mt-\[30px\] { margin-top: 30px; }

.mt-\[5px\] { margin-top: 5px; }

.mt-\[80px\] { margin-top: 80px; }

.mt-\[90px\] { margin-top: 90px; }

.mt-\[9px\] { margin-top: 9px; }

.mt-\[clamp\(1\.5rem\,10vw\,3rem\)\] { margin-top: clamp(1.5rem, 10vw, 3rem=
); }

.mt-auto { margin-top: auto; }

.mt-px { margin-top: 1px; }

.box-border { box-sizing: border-box; }

.\!box-content { box-sizing: content-box !important; }

.line-clamp-1 { -webkit-line-clamp: 1; }

.line-clamp-1, .line-clamp-2 { overflow: hidden; display: -webkit-box; -web=
kit-box-orient: vertical; }

.line-clamp-2 { -webkit-line-clamp: 2; }

.line-clamp-3 { -webkit-line-clamp: 3; }

.line-clamp-3, .line-clamp-4 { overflow: hidden; display: -webkit-box; -web=
kit-box-orient: vertical; }

.line-clamp-4 { -webkit-line-clamp: 4; }

.line-clamp-5 { -webkit-line-clamp: 5; }

.line-clamp-5, .line-clamp-\[6\] { overflow: hidden; display: -webkit-box; =
-webkit-box-orient: vertical; }

.line-clamp-\[6\] { -webkit-line-clamp: 6; }

.line-clamp-\[7\] { overflow: hidden; display: -webkit-box; -webkit-box-ori=
ent: vertical; -webkit-line-clamp: 7; }

.\!block { display: block !important; }

.block { display: block; }

.\!inline-block { display: inline-block !important; }

.inline-block { display: inline-block; }

.\!inline { display: inline !important; }

.inline { display: inline; }

.\!flex { display: flex !important; }

.flex { display: flex; }

.inline-flex { display: inline-flex; }

.table { display: table; }

.grid { display: grid; }

.inline-grid { display: inline-grid; }

.contents { display: contents; }

.\!hidden { display: none !important; }

.hidden { display: none; }

.aspect-\[258\/240\] { aspect-ratio: 258 / 240; }

.aspect-\[280\/140\] { aspect-ratio: 280 / 140; }

.aspect-\[3\/2\] { aspect-ratio: 3 / 2; }

.aspect-\[4\/3\] { aspect-ratio: 4 / 3; }

.aspect-square { aspect-ratio: 1 / 1; }

.aspect-video { aspect-ratio: 16 / 9; }

.size-10 { width: 2.5rem; height: 2.5rem; }

.size-11 { width: 2.75rem; height: 2.75rem; }

.size-16 { width: 4rem; height: 4rem; }

.size-2 { width: 0.5rem; height: 0.5rem; }

.size-2\.5 { width: 0.625rem; height: 0.625rem; }

.size-20 { width: 5rem; height: 5rem; }

.size-3 { width: 0.75rem; height: 0.75rem; }

.size-4 { width: 1rem; height: 1rem; }

.size-5 { width: 1.25rem; height: 1.25rem; }

.size-6 { width: 1.5rem; height: 1.5rem; }

.size-7 { width: 1.75rem; height: 1.75rem; }

.size-8 { width: 2rem; height: 2rem; }

.size-9 { width: 2.25rem; height: 2.25rem; }

.size-\[1\.1rem\] { width: 1.1rem; height: 1.1rem; }

.size-\[1\.4rem\] { width: 1.4rem; height: 1.4rem; }

.size-\[142px\] { width: 142px; height: 142px; }

.size-\[18px\] { width: 18px; height: 18px; }

.size-\[220px\] { width: 220px; height: 220px; }

.size-\[30px\] { width: 30px; height: 30px; }

.size-\[3px\] { width: 3px; height: 3px; }

.size-\[61px\] { width: 61px; height: 61px; }

.size-\[62px\] { width: 62px; height: 62px; }

.size-\[6px\] { width: 6px; height: 6px; }

.size-\[8px\] { width: 8px; height: 8px; }

.size-full { width: 100%; height: 100%; }

.\!h-10 { height: 2.5rem !important; }

.\!h-11 { height: 2.75rem !important; }

.\!h-12 { height: 3rem !important; }

.\!h-3 { height: 0.75rem !important; }

.\!h-5 { height: 1.25rem !important; }

.\!h-6 { height: 1.5rem !important; }

.\!h-7 { height: 1.75rem !important; }

.\!h-8 { height: 2rem !important; }

.\!h-9 { height: 2.25rem !important; }

.\!h-\[10rem\] { height: 10rem !important; }

.\!h-\[18px\] { height: 18px !important; }

.\!h-\[3\.25rem\] { height: 3.25rem !important; }

.\!h-\[36px\] { height: 36px !important; }

.\!h-\[44px\] { height: 44px !important; }

.\!h-\[52px\] { height: 52px !important; }

.\!h-\[calc\(52px-1rem\)\] { height: calc(52px - 1rem) !important; }

.\!h-auto { height: auto !important; }

.h-0 { height: 0px; }

.h-0\.5 { height: 0.125rem; }

.h-1 { height: 0.25rem; }

.h-1\.5 { height: 0.375rem; }

.h-10 { height: 2.5rem; }

.h-11 { height: 2.75rem; }

.h-12 { height: 3rem; }

.h-14 { height: 3.5rem; }

.h-16 { height: 4rem; }

.h-2 { height: 0.5rem; }

.h-2\.5 { height: 0.625rem; }

.h-20 { height: 5rem; }

.h-24 { height: 6rem; }

.h-3 { height: 0.75rem; }

.h-3\.5 { height: 0.875rem; }

.h-32 { height: 8rem; }

.h-36 { height: 9rem; }

.h-4 { height: 1rem; }

.h-40 { height: 10rem; }

.h-44 { height: 11rem; }

.h-48 { height: 12rem; }

.h-5 { height: 1.25rem; }

.h-6 { height: 1.5rem; }

.h-60 { height: 15rem; }

.h-64 { height: 16rem; }

.h-7 { height: 1.75rem; }

.h-72 { height: 18rem; }

.h-8 { height: 2rem; }

.h-80 { height: 20rem; }

.h-9 { height: 2.25rem; }

.h-96 { height: 24rem; }

.h-\[0\.5px\] { height: 0.5px; }

.h-\[0\.975em\] { height: 0.975em; }

.h-\[1\.07em\] { height: 1.07em; }

.h-\[1\.125rem\] { height: 1.125rem; }

.h-\[1\.5em\] { height: 1.5em; }

.h-\[1\.625rem\] { height: 1.625rem; }

.h-\[10\.25rem\] { height: 10.25rem; }

.h-\[100\%\] { height: 100%; }

.h-\[100px\] { height: 100px; }

.h-\[108\.7\%\] { height: 108.7%; }

.h-\[10px\] { height: 10px; }

.h-\[10rem\] { height: 10rem; }

.h-\[111px\] { height: 111px; }

.h-\[12\.5rem\] { height: 12.5rem; }

.h-\[120px\] { height: 120px; }

.h-\[123px\] { height: 123px; }

.h-\[130px\] { height: 130px; }

.h-\[13px\] { height: 13px; }

.h-\[140px\] { height: 140px; }

.h-\[14px\] { height: 14px; }

.h-\[160px\] { height: 160px; }

.h-\[164px\] { height: 164px; }

.h-\[16px\] { height: 16px; }

.h-\[17px\] { height: 17px; }

.h-\[180px\] { height: 180px; }

.h-\[18px\] { height: 18px; }

.h-\[1px\] { height: 1px; }

.h-\[2\.25rem\] { height: 2.25rem; }

.h-\[2\.625rem\] { height: 2.625rem; }

.h-\[200px\] { height: 200px; }

.h-\[220px\] { height: 220px; }

.h-\[22px\] { height: 22px; }

.h-\[22rem\] { height: 22rem; }

.h-\[232px\] { height: 232px; }

.h-\[240px\] { height: 240px; }

.h-\[24rem\] { height: 24rem; }

.h-\[250px\] { height: 250px; }

.h-\[276px\] { height: 276px; }

.h-\[280px\] { height: 280px; }

.h-\[28px\] { height: 28px; }

.h-\[29px\] { height: 29px; }

.h-\[2px\] { height: 2px; }

.h-\[2rem\] { height: 2rem; }

.h-\[3\.25rem\] { height: 3.25rem; }

.h-\[3\.5rem\] { height: 3.5rem; }

.h-\[30px\] { height: 30px; }

.h-\[320px\] { height: 320px; }

.h-\[32px\] { height: 32px; }

.h-\[32rem\] { height: 32rem; }

.h-\[34px\] { height: 34px; }

.h-\[35rem\] { height: 35rem; }

.h-\[360px\] { height: 360px; }

.h-\[36px\] { height: 36px; }

.h-\[38px\] { height: 38px; }

.h-\[3rem\] { height: 3rem; }

.h-\[4\.5rem\] { height: 4.5rem; }

.h-\[419px\] { height: 419px; }

.h-\[42px\] { height: 42px; }

.h-\[450px\] { height: 450px; }

.h-\[460px\] { height: 460px; }

.h-\[46px\] { height: 46px; }

.h-\[471px\] { height: 471px; }

.h-\[5\.5rem\] { height: 5.5rem; }

.h-\[500px\] { height: 500px; }

.h-\[50vh\] { height: 50vh; }

.h-\[52px\] { height: 52px; }

.h-\[550px\] { height: 550px; }

.h-\[55px\] { height: 55px; }

.h-\[56px\] { height: 56px; }

.h-\[5vh\] { height: 5vh; }

.h-\[60\%\] { height: 60%; }

.h-\[600px\] { height: 600px; }

.h-\[60px\] { height: 60px; }

.h-\[65px\] { height: 65px; }

.h-\[70px\] { height: 70px; }

.h-\[71px\] { height: 71px; }

.h-\[72px\] { height: 72px; }

.h-\[80px\] { height: 80px; }

.h-\[82px\] { height: 82px; }

.h-\[84px\] { height: 84px; }

.h-\[85vh\] { height: 85vh; }

.h-\[8px\] { height: 8px; }

.h-\[90px\] { height: 90px; }

.h-\[96\%\] { height: 96%; }

.h-\[98\%\] { height: 98%; }

.h-\[99px\] { height: 99px; }

.h-\[calc\(100vh-12\.5rem\)\] { height: calc(-12.5rem + 100vh); }

.h-\[calc\(100vh-224px\)\] { height: calc(-224px + 100vh); }

.h-\[calc\(100vh-6rem\)\] { height: calc(-6rem + 100vh); }

.h-\[calc\(100vh-74px\)\] { height: calc(-74px + 100vh); }

.h-\[clamp\(10\.5rem\,28\.1vw\,23\.45rem\)\] { height: clamp(10.5rem, 28.1v=
w, 23.45rem); }

.h-\[clamp\(10rem\,62vw\,30\.75rem\)\] { height: clamp(10rem, 62vw, 30.75re=
m); }

.h-auto { height: auto; }

.h-fit { height: fit-content; }

.h-full { height: 100%; }

.h-px { height: 1px; }

.\!max-h-\[238px\] { max-height: 238px !important; }

.\!max-h-none { max-height: none !important; }

.max-h-0 { max-height: 0px; }

.max-h-12 { max-height: 3rem; }

.max-h-20 { max-height: 5rem; }

.max-h-28 { max-height: 7rem; }

.max-h-32 { max-height: 8rem; }

.max-h-36 { max-height: 9rem; }

.max-h-40 { max-height: 10rem; }

.max-h-48 { max-height: 12rem; }

.max-h-52 { max-height: 13rem; }

.max-h-60 { max-height: 15rem; }

.max-h-64 { max-height: 16rem; }

.max-h-80 { max-height: 20rem; }

.max-h-96 { max-height: 24rem; }

.max-h-\[10\.625rem\] { max-height: 10.625rem; }

.max-h-\[10rem\] { max-height: 10rem; }

.max-h-\[124px\] { max-height: 124px; }

.max-h-\[140px\] { max-height: 140px; }

.max-h-\[150px\] { max-height: 150px; }

.max-h-\[160px\] { max-height: 160px; }

.max-h-\[16rem\] { max-height: 16rem; }

.max-h-\[200px\] { max-height: 200px; }

.max-h-\[220px\] { max-height: 220px; }

.max-h-\[238px\] { max-height: 238px; }

.max-h-\[23rem\] { max-height: 23rem; }

.max-h-\[280px\] { max-height: 280px; }

.max-h-\[288px\] { max-height: 288px; }

.max-h-\[292px\] { max-height: 292px; }

.max-h-\[300px\] { max-height: 300px; }

.max-h-\[324px\] { max-height: 324px; }

.max-h-\[400px\] { max-height: 400px; }

.max-h-\[40vh\] { max-height: 40vh; }

.max-h-\[450px\] { max-height: 450px; }

.max-h-\[500px\] { max-height: 500px; }

.max-h-\[50vh\] { max-height: 50vh; }

.max-h-\[550px\] { max-height: 550px; }

.max-h-\[6\.5rem\] { max-height: 6.5rem; }

.max-h-\[600px\] { max-height: 600px; }

.max-h-\[65vh\] { max-height: 65vh; }

.max-h-\[730px\] { max-height: 730px; }

.max-h-\[8rem\] { max-height: 8rem; }

.max-h-\[calc\(100vh-16px\)\] { max-height: calc(-16px + 100vh); }

.max-h-\[calc\(100vh-1rem\)\] { max-height: calc(-1rem + 100vh); }

.max-h-\[calc\(100vh-4rem\)\] { max-height: calc(-4rem + 100vh); }

.max-h-\[min\(56rem\,100\%\)\] { max-height: min(56rem, 100%); }

.max-h-\[min\(var\(--radix-dropdown-menu-content-available-height\)\,var\(-=
-dropdown-max-height\)\)\] { max-height: min(var(--radix-dropdown-menu-cont=
ent-available-height),var(--dropdown-max-height)); }

.max-h-\[min\(var\(--radix-select-content-available-height\,var\(--radix-dr=
opdown-menu-content-available-height\)\)\,var\(--dropdown-max-height\,24rem=
\)\)\] { max-height: min(var(--radix-select-content-available-height,var(--=
radix-dropdown-menu-content-available-height)),var(--dropdown-max-height,24=
rem)); }

.max-h-\[var\(--available-height\)\] { max-height: var(--available-height);=
 }

.max-h-full { max-height: 100%; }

.max-h-screen { max-height: 100vh; }

.\!min-h-0 { min-height: 0px !important; }

.\!min-h-\[450px\] { min-height: 450px !important; }

.min-h-0 { min-height: 0px; }

.min-h-10 { min-height: 2.5rem; }

.min-h-12 { min-height: 3rem; }

.min-h-14 { min-height: 3.5rem; }

.min-h-16 { min-height: 4rem; }

.min-h-4 { min-height: 1rem; }

.min-h-48 { min-height: 12rem; }

.min-h-5 { min-height: 1.25rem; }

.min-h-8 { min-height: 2rem; }

.min-h-\[0px\] { min-height: 0px; }

.min-h-\[1\.5rem\] { min-height: 1.5rem; }

.min-h-\[100px\] { min-height: 100px; }

.min-h-\[120px\] { min-height: 120px; }

.min-h-\[16px\] { min-height: 16px; }

.min-h-\[18px\] { min-height: 18px; }

.min-h-\[2\.125rem\] { min-height: 2.125rem; }

.min-h-\[2\.5rem\] { min-height: 2.5rem; }

.min-h-\[2\.625rem\] { min-height: 2.625rem; }

.min-h-\[200px\] { min-height: 200px; }

.min-h-\[20rem\] { min-height: 20rem; }

.min-h-\[22px\] { min-height: 22px; }

.min-h-\[250px\] { min-height: 250px; }

.min-h-\[25rem\] { min-height: 25rem; }

.min-h-\[3\.5rem\] { min-height: 3.5rem; }

.min-h-\[300px\] { min-height: 300px; }

.min-h-\[3rem\] { min-height: 3rem; }

.min-h-\[400px\] { min-height: 400px; }

.min-h-\[44px\] { min-height: 44px; }

.min-h-\[4rem\] { min-height: 4rem; }

.min-h-\[500px\] { min-height: 500px; }

.min-h-\[512px\] { min-height: 512px; }

.min-h-\[550px\] { min-height: 550px; }

.min-h-\[5rem\] { min-height: 5rem; }

.min-h-\[6\.125rem\] { min-height: 6.125rem; }

.min-h-\[600px\] { min-height: 600px; }

.min-h-\[628px\] { min-height: 628px; }

.min-h-\[62px\] { min-height: 62px; }

.min-h-\[68px\] { min-height: 68px; }

.min-h-\[768px\] { min-height: 768px; }

.min-h-\[89vh\] { min-height: 89vh; }

.min-h-\[99px\] { min-height: 99px; }

.min-h-\[calc\(\.\.\.\)\] { }

.min-h-\[calc\(100vh-80px\)\] { min-height: calc(-80px + 100vh); }

.min-h-full { min-height: 100%; }

.min-h-min { min-height: min-content; }

.min-h-px { min-height: 1px; }

.\!w-10 { width: 2.5rem !important; }

.\!w-11 { width: 2.75rem !important; }

.\!w-16 { width: 4rem !important; }

.\!w-3 { width: 0.75rem !important; }

.\!w-5 { width: 1.25rem !important; }

.\!w-6 { width: 1.5rem !important; }

.\!w-7 { width: 1.75rem !important; }

.\!w-72 { width: 18rem !important; }

.\!w-8 { width: 2rem !important; }

.\!w-80 { width: 20rem !important; }

.\!w-\[18px\] { width: 18px !important; }

.\!w-\[337px\] { width: 337px !important; }

.\!w-\[8rem\] { width: 8rem !important; }

.\!w-auto { width: auto !important; }

.\!w-fit { width: fit-content !important; }

.\!w-full { width: 100% !important; }

.w-0 { width: 0px; }

.w-0\.5 { width: 0.125rem; }

.w-1 { width: 0.25rem; }

.w-1\.5 { width: 0.375rem; }

.w-1\/12 { width: 8.33333%; }

.w-1\/2 { width: 50%; }

.w-1\/3 { width: 33.3333%; }

.w-1\/6 { width: 16.6667%; }

.w-10 { width: 2.5rem; }

.w-10\/12 { width: 83.3333%; }

.w-11 { width: 2.75rem; }

.w-11\/12 { width: 91.6667%; }

.w-12 { width: 3rem; }

.w-14 { width: 3.5rem; }

.w-16 { width: 4rem; }

.w-2 { width: 0.5rem; }

.w-2\.5 { width: 0.625rem; }

.w-2\/12 { width: 16.6667%; }

.w-2\/3 { width: 66.6667%; }

.w-20 { width: 5rem; }

.w-24 { width: 6rem; }

.w-28 { width: 7rem; }

.w-3 { width: 0.75rem; }

.w-3\.5 { width: 0.875rem; }

.w-3\/4 { width: 75%; }

.w-32 { width: 8rem; }

.w-36 { width: 9rem; }

.w-4 { width: 1rem; }

.w-4\/12 { width: 33.3333%; }

.w-40 { width: 10rem; }

.w-44 { width: 11rem; }

.w-48 { width: 12rem; }

.w-5 { width: 1.25rem; }

.w-5\/12 { width: 41.6667%; }

.w-5\/6 { width: 83.3333%; }

.w-6 { width: 1.5rem; }

.w-6\/12 { width: 50%; }

.w-60 { width: 15rem; }

.w-64 { width: 16rem; }

.w-7 { width: 1.75rem; }

.w-72 { width: 18rem; }

.w-8 { width: 2rem; }

.w-8\/12 { width: 66.6667%; }

.w-80 { width: 20rem; }

.w-9 { width: 2.25rem; }

.w-9\/12 { width: 75%; }

.w-96 { width: 24rem; }

.w-\[0\.5px\] { width: 0.5px; }

.w-\[1\.125rem\] { width: 1.125rem; }

.w-\[1\.5px\] { width: 1.5px; }

.w-\[1\.875rem\] { width: 1.875rem; }

.w-\[100\%\] { width: 100%; }

.w-\[108\.7\%\] { width: 108.7%; }

.w-\[10px\] { width: 10px; }

.w-\[128px\] { width: 128px; }

.w-\[130px\] { width: 130px; }

.w-\[133px\] { width: 133px; }

.w-\[13rem\] { width: 13rem; }

.w-\[14px\] { width: 14px; }

.w-\[150px\] { width: 150px; }

.w-\[15rem\] { width: 15rem; }

.w-\[160px\] { width: 160px; }

.w-\[16px\] { width: 16px; }

.w-\[17rem\] { width: 17rem; }

.w-\[18px\] { width: 18px; }

.w-\[190px\] { width: 190px; }

.w-\[192px\] { width: 192px; }

.w-\[1px\] { width: 1px; }

.w-\[200px\] { width: 200px; }

.w-\[203px\] { width: 203px; }

.w-\[20px\] { width: 20px; }

.w-\[20rem\] { width: 20rem; }

.w-\[220px\] { width: 220px; }

.w-\[22px\] { width: 22px; }

.w-\[253px\] { width: 253px; }

.w-\[256px\] { width: 256px; }

.w-\[27rem\] { width: 27rem; }

.w-\[280px\] { width: 280px; }

.w-\[2px\] { width: 2px; }

.w-\[30\%\] { width: 30%; }

.w-\[300px\] { width: 300px; }

.w-\[324px\] { width: 324px; }

.w-\[32px\] { width: 32px; }

.w-\[332px\] { width: 332px; }

.w-\[348px\] { width: 348px; }

.w-\[34px\] { width: 34px; }

.w-\[38\%\] { width: 38%; }

.w-\[38px\] { width: 38px; }

.w-\[3px\] { width: 3px; }

.w-\[3rem\] { width: 3rem; }

.w-\[400px\] { width: 400px; }

.w-\[40rem\] { width: 40rem; }

.w-\[460px\] { width: 460px; }

.w-\[52px\] { width: 52px; }

.w-\[560px\] { width: 560px; }

.w-\[640px\] { width: 640px; }

.w-\[68px\] { width: 68px; }

.w-\[69px\] { width: 69px; }

.w-\[6px\] { width: 6px; }

.w-\[7\.5rem\] { width: 7.5rem; }

.w-\[70\%\] { width: 70%; }

.w-\[80\%\] { width: 80%; }

.w-\[85\%\] { width: 85%; }

.w-\[8px\] { width: 8px; }

.w-\[90\%\] { width: 90%; }

.w-\[calc\(100\%-1\.75rem\)\] { width: calc(100% - 1.75rem); }

.w-\[calc\(100\%-2\.5rem\)\] { width: calc(100% - 2.5rem); }

.w-\[calc\(100vw-32px\)\] { width: calc(-32px + 100vw); }

.w-\[calc\(100vw-40px\)\] { width: calc(-40px + 100vw); }

.w-\[calc\(60\%-2rem\)\] { width: calc(60% - 2rem); }

.w-\[calc\(var\(--radix-dropdown-menu-trigger-width\)\+8px\)\] { width: cal=
c(var(--radix-dropdown-menu-trigger-width) + 8px); }

.w-auto { width: auto; }

.w-fit { width: fit-content; }

.w-full { width: 100%; }

.w-max { width: max-content; }

.w-px { width: 1px; }

.w-screen { width: 100vw; }

.\!min-w-0 { min-width: 0px !important; }

.\!min-w-10 { min-width: 2.5rem !important; }

.\!min-w-52 { min-width: 13rem !important; }

.\!min-w-8 { min-width: 2rem !important; }

.\!min-w-9 { min-width: 2.25rem !important; }

.min-w-0 { min-width: 0px; }

.min-w-10 { min-width: 2.5rem; }

.min-w-24 { min-width: 6rem; }

.min-w-28 { min-width: 7rem; }

.min-w-36 { min-width: 9rem; }

.min-w-4 { min-width: 1rem; }

.min-w-40 { min-width: 10rem; }

.min-w-48 { min-width: 12rem; }

.min-w-5 { min-width: 1.25rem; }

.min-w-60 { min-width: 15rem; }

.min-w-7 { min-width: 1.75rem; }

.min-w-72 { min-width: 18rem; }

.min-w-8 { min-width: 2rem; }

.min-w-80 { min-width: 20rem; }

.min-w-\[1\.25rem\] { min-width: 1.25rem; }

.min-w-\[100px\] { min-width: 100px; }

.min-w-\[12\.5ch\] { min-width: 12.5ch; }

.min-w-\[120px\] { min-width: 120px; }

.min-w-\[12rem\] { min-width: 12rem; }

.min-w-\[13rem\] { min-width: 13rem; }

.min-w-\[140px\] { min-width: 140px; }

.min-w-\[150px\] { min-width: 150px; }

.min-w-\[15rem\] { min-width: 15rem; }

.min-w-\[160px\] { min-width: 160px; }

.min-w-\[16rem\] { min-width: 16rem; }

.min-w-\[172px\] { min-width: 172px; }

.min-w-\[175px\] { min-width: 175px; }

.min-w-\[180px\] { min-width: 180px; }

.min-w-\[18rem\] { min-width: 18rem; }

.min-w-\[200px\] { min-width: 200px; }

.min-w-\[220px\] { min-width: 220px; }

.min-w-\[240px\] { min-width: 240px; }

.min-w-\[256px\] { min-width: 256px; }

.min-w-\[290px\] { min-width: 290px; }

.min-w-\[300px\] { min-width: 300px; }

.min-w-\[350px\] { min-width: 350px; }

.min-w-\[38px\] { min-width: 38px; }

.min-w-\[4rem\] { min-width: 4rem; }

.min-w-\[5\.5rem\] { min-width: 5.5rem; }

.min-w-\[50px\] { min-width: 50px; }

.min-w-\[5rem\] { min-width: 5rem; }

.min-w-\[640px\] { min-width: 640px; }

.min-w-\[6rem\] { min-width: 6rem; }

.min-w-\[80px\] { min-width: 80px; }

.min-w-\[85px\] { min-width: 85px; }

.min-w-\[8rem\] { min-width: 8rem; }

.min-w-fit { min-width: fit-content; }

.min-w-full { min-width: 100%; }

.min-w-max { min-width: max-content; }

.min-w-px { min-width: 1px; }

.\!max-w-72 { max-width: 18rem !important; }

.\!max-w-96 { max-width: 24rem !important; }

.\!max-w-\[10rem\] { max-width: 10rem !important; }

.\!max-w-\[13rem\] { max-width: 13rem !important; }

.\!max-w-\[14\.5rem\] { max-width: 14.5rem !important; }

.\!max-w-\[16rem\] { max-width: 16rem !important; }

.\!max-w-\[280px\] { max-width: 280px !important; }

.\!max-w-\[282px\] { max-width: 282px !important; }

.\!max-w-\[310px\] { max-width: 310px !important; }

.\!max-w-\[33\.5rem\] { max-width: 33.5rem !important; }

.\!max-w-\[750px\] { max-width: 750px !important; }

.\!max-w-none { max-width: none !important; }

.\!max-w-xl { max-width: 36rem !important; }

.\!max-w-xs { max-width: 20rem !important; }

.max-w-0 { max-width: 0px; }

.max-w-20 { max-width: 5rem; }

.max-w-24 { max-width: 6rem; }

.max-w-2xl { max-width: 42rem; }

.max-w-32 { max-width: 8rem; }

.max-w-3xl { max-width: 48rem; }

.max-w-40 { max-width: 10rem; }

.max-w-48 { max-width: 12rem; }

.max-w-4xl { max-width: 56rem; }

.max-w-5xl { max-width: 64rem; }

.max-w-60 { max-width: 15rem; }

.max-w-64 { max-width: 16rem; }

.max-w-6xl { max-width: 72rem; }

.max-w-72 { max-width: 18rem; }

.max-w-7xl { max-width: 80rem; }

.max-w-96 { max-width: 24rem; }

.max-w-\[100px\] { max-width: 100px; }

.max-w-\[1100px\] { max-width: 1100px; }

.max-w-\[1120px\] { max-width: 1120px; }

.max-w-\[1200px\] { max-width: 1200px; }

.max-w-\[120px\] { max-width: 120px; }

.max-w-\[13rem\] { max-width: 13rem; }

.max-w-\[14\.5rem\] { max-width: 14.5rem; }

.max-w-\[1400px\] { max-width: 1400px; }

.max-w-\[150px\] { max-width: 150px; }

.max-w-\[16\.6rem\] { max-width: 16.6rem; }

.max-w-\[16rem\] { max-width: 16rem; }

.max-w-\[170px\] { max-width: 170px; }

.max-w-\[180px\] { max-width: 180px; }

.max-w-\[200px\] { max-width: 200px; }

.max-w-\[20rem\] { max-width: 20rem; }

.max-w-\[220px\] { max-width: 220px; }

.max-w-\[250px\] { max-width: 250px; }

.max-w-\[280px\] { max-width: 280px; }

.max-w-\[30\%\] { max-width: 30%; }

.max-w-\[300px\] { max-width: 300px; }

.max-w-\[312px\] { max-width: 312px; }

.max-w-\[315px\] { max-width: 315px; }

.max-w-\[320px\] { max-width: 320px; }

.max-w-\[32rem\] { max-width: 32rem; }

.max-w-\[33\.333\%\] { max-width: 33.333%; }

.max-w-\[337px\] { max-width: 337px; }

.max-w-\[340px\] { max-width: 340px; }

.max-w-\[356px\] { max-width: 356px; }

.max-w-\[35ch\] { max-width: 35ch; }

.max-w-\[360px\] { max-width: 360px; }

.max-w-\[400px\] { max-width: 400px; }

.max-w-\[40rem\] { max-width: 40rem; }

.max-w-\[450px\] { max-width: 450px; }

.max-w-\[456px\] { max-width: 456px; }

.max-w-\[480px\] { max-width: 480px; }

.max-w-\[500px\] { max-width: 500px; }

.max-w-\[50rem\] { max-width: 50rem; }

.max-w-\[536px\] { max-width: 536px; }

.max-w-\[550px\] { max-width: 550px; }

.max-w-\[569px\] { max-width: 569px; }

.max-w-\[60\%\] { max-width: 60%; }

.max-w-\[600px\] { max-width: 600px; }

.max-w-\[601px\] { max-width: 601px; }

.max-w-\[640px\] { max-width: 640px; }

.max-w-\[744px\] { max-width: 744px; }

.max-w-\[75\%\] { max-width: 75%; }

.max-w-\[75ch\] { max-width: 75ch; }

.max-w-\[80\%\] { max-width: 80%; }

.max-w-\[800px\] { max-width: 800px; }

.max-w-\[80px\] { max-width: 80px; }

.max-w-\[85\%\] { max-width: 85%; }

.max-w-\[90rem\] { max-width: 90rem; }

.max-w-\[920px\] { max-width: 920px; }

.max-w-\[960px\] { max-width: 960px; }

.max-w-\[calc\(100\%-2rem\)\] { max-width: calc(100% - 2rem); }

.max-w-\[calc\(100vw-16px\)\] { max-width: calc(-16px + 100vw); }

.max-w-\[calc\(100vw-1rem\)\] { max-width: calc(-1rem + 100vw); }

.max-w-\[calc\(100vw-2rem\)\] { max-width: calc(-2rem + 100vw); }

.max-w-\[calc\(33\.333\%-0\.5rem\)\] { max-width: calc(33.333% - 0.5rem); }

.max-w-full { max-width: 100%; }

.max-w-lg { max-width: 32rem; }

.max-w-md { max-width: 28rem; }

.max-w-min { max-width: min-content; }

.max-w-none { max-width: none; }

.max-w-sm { max-width: 24rem; }

.max-w-xl { max-width: 36rem; }

.max-w-xs { max-width: 20rem; }

.\!flex-1 { flex: 1 1 0% !important; }

.\!flex-\[2\] { flex: 2 1 0% !important; }

.flex-1 { flex: 1 1 0%; }

.flex-\[1_0_0\] { flex: 1 0 0px; }

.flex-\[1_1_350px\] { flex: 1 1 350px; }

.flex-\[1_1_400px\] { flex: 1 1 400px; }

.flex-\[2\] { flex: 2 1 0%; }

.flex-\[3\] { flex: 3 1 0%; }

.flex-\[5\] { flex: 5 1 0%; }

.flex-auto { flex: 1 1 auto; }

.flex-initial { flex: 0 1 auto; }

.flex-none { flex: 0 0 auto; }

.\!flex-shrink { flex-shrink: 1 !important; }

.flex-shrink { flex-shrink: 1; }

.flex-shrink-0 { flex-shrink: 0; }

.\!shrink { flex-shrink: 1 !important; }

.\!shrink-0 { flex-shrink: 0 !important; }

.\!shrink-\[2\] { flex-shrink: 2 !important; }

.shrink { flex-shrink: 1; }

.shrink-0 { flex-shrink: 0; }

.shrink-\[4\] { flex-shrink: 4; }

.flex-grow, .grow { flex-grow: 1; }

.grow-\[3\] { flex-grow: 3; }

.basis-0 { flex-basis: 0px; }

.table-auto { table-layout: auto; }

.table-fixed { table-layout: fixed; }

.border-collapse { border-collapse: collapse; }

.border-separate { border-collapse: separate; }

.border-spacing-0 { --tw-border-spacing-x: 0px; --tw-border-spacing-y: 0px;=
 border-spacing: var(--tw-border-spacing-x) var(--tw-border-spacing-y); }

.origin-center { transform-origin: center center; }

.origin-left { transform-origin: left center; }

.origin-top-left { transform-origin: left top; }

.-translate-x-0 { --tw-translate-x: -0px; }

.-translate-x-0, .-translate-x-0\.5 { transform: translate(var(--tw-transla=
te-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x=
)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-=
y)); }

.-translate-x-0\.5 { --tw-translate-x: -0.125rem; }

.-translate-x-1 { --tw-translate-x: -0.25rem; }

.-translate-x-1, .-translate-x-1\/2 { transform: translate(var(--tw-transla=
te-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x=
)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-=
y)); }

.-translate-x-1\/2 { --tw-translate-x: -50%; }

.-translate-x-2 { --tw-translate-x: -0.5rem; }

.-translate-x-2, .-translate-x-4 { transform: translate(var(--tw-translate-=
x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) =
skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))=
; }

.-translate-x-4 { --tw-translate-x: -1rem; }

.-translate-x-8 { --tw-translate-x: -2rem; }

.-translate-x-8, .-translate-x-full { transform: translate(var(--tw-transla=
te-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x=
)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-=
y)); }

.-translate-x-full { --tw-translate-x: -100%; }

.-translate-x-px { --tw-translate-x: -1px; }

.-translate-x-px, .-translate-y-0 { transform: translate(var(--tw-translate=
-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x))=
 skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)=
); }

.-translate-y-0 { --tw-translate-y: -0px; }

.-translate-y-0\.5 { --tw-translate-y: -0.125rem; }

.-translate-y-0\.5, .-translate-y-1 { transform: translate(var(--tw-transla=
te-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x=
)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-=
y)); }

.-translate-y-1 { --tw-translate-y: -0.25rem; }

.-translate-y-1\.5 { --tw-translate-y: -0.375rem; }

.-translate-y-1\.5, .-translate-y-1\/2 { transform: translate(var(--tw-tran=
slate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-ske=
w-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-sca=
le-y)); }

.-translate-y-1\/2 { --tw-translate-y: -50%; }

.-translate-y-1\/4 { --tw-translate-y: -25%; }

.-translate-y-1\/4, .-translate-y-2 { transform: translate(var(--tw-transla=
te-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x=
)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-=
y)); }

.-translate-y-2 { --tw-translate-y: -0.5rem; }

.-translate-y-2\.5 { --tw-translate-y: -0.625rem; }

.-translate-y-2\.5, .-translate-y-\[0\.75px\] { transform: translate(var(--=
tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(-=
-tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(-=
-tw-scale-y)); }

.-translate-y-\[0\.75px\] { --tw-translate-y: -0.75px; }

.-translate-y-px { --tw-translate-y: -1px; }

.-translate-y-px, .translate-x-0 { transform: translate(var(--tw-translate-=
x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) =
skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))=
; }

.translate-x-0 { --tw-translate-x: 0px; }

.translate-x-1 { --tw-translate-x: 0.25rem; }

.translate-x-1, .translate-x-1\/4 { transform: translate(var(--tw-translate=
-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x))=
 skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)=
); }

.translate-x-1\/4 { --tw-translate-x: 25%; }

.translate-x-2 { --tw-translate-x: 0.5rem; }

.translate-x-2, .translate-x-4 { transform: translate(var(--tw-translate-x)=
,var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) sk=
ewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); =
}

.translate-x-4 { --tw-translate-x: 1rem; }

.translate-x-full { --tw-translate-x: 100%; }

.translate-x-full, .translate-y-0 { transform: translate(var(--tw-translate=
-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x))=
 skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)=
); }

.translate-y-0 { --tw-translate-y: 0px; }

.translate-y-0\.5 { --tw-translate-y: 0.125rem; }

.translate-y-0\.5, .translate-y-1 { transform: translate(var(--tw-translate=
-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x))=
 skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)=
); }

.translate-y-1 { --tw-translate-y: 0.25rem; }

.translate-y-1\.5 { --tw-translate-y: 0.375rem; }

.translate-y-1\.5, .translate-y-2 { transform: translate(var(--tw-translate=
-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x))=
 skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)=
); }

.translate-y-2 { --tw-translate-y: 0.5rem; }

.translate-y-4 { --tw-translate-y: 1rem; }

.translate-y-4, .translate-y-5 { transform: translate(var(--tw-translate-x)=
,var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) sk=
ewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); =
}

.translate-y-5 { --tw-translate-y: 1.25rem; }

.translate-y-\[-0\.05em\] { --tw-translate-y: -0.05em; }

.translate-y-\[-0\.05em\], .translate-y-\[0\.05em\] { transform: translate(=
var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX=
(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY=
(var(--tw-scale-y)); }

.translate-y-\[0\.05em\] { --tw-translate-y: 0.05em; }

.translate-y-\[0\.5px\] { --tw-translate-y: 0.5px; }

.translate-y-\[0\.5px\], .translate-y-\[10px\] { transform: translate(var(-=
-tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(=
--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(=
--tw-scale-y)); }

.translate-y-\[10px\] { --tw-translate-y: 10px; }

.translate-y-\[120\%\] { --tw-translate-y: 120%; }

.translate-y-\[120\%\], .translate-y-\[19\%\] { transform: translate(var(--=
tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(-=
-tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(-=
-tw-scale-y)); }

.translate-y-\[19\%\] { --tw-translate-y: 19%; }

.translate-y-\[2px\] { --tw-translate-y: 2px; }

.translate-y-\[2px\], .translate-y-\[3px\] { transform: translate(var(--tw-=
translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw=
-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw=
-scale-y)); }

.translate-y-\[3px\] { --tw-translate-y: 3px; }

.translate-y-full { --tw-translate-y: 100%; }

.translate-y-full, .translate-y-px { transform: translate(var(--tw-translat=
e-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)=
) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y=
)); }

.translate-y-px { --tw-translate-y: 1px; }

.-rotate-12 { --tw-rotate: -12deg; }

.-rotate-12, .-rotate-180 { transform: translate(var(--tw-translate-x),var(=
--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(v=
ar(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.-rotate-180 { --tw-rotate: -180deg; }

.-rotate-3 { --tw-rotate: -3deg; }

.-rotate-3, .-rotate-45 { transform: translate(var(--tw-translate-x),var(--=
tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var=
(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.-rotate-45 { --tw-rotate: -45deg; }

.-rotate-6 { --tw-rotate: -6deg; }

.-rotate-6, .-rotate-90 { transform: translate(var(--tw-translate-x),var(--=
tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var=
(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.-rotate-90 { --tw-rotate: -90deg; }

.-rotate-\[0\.1rad\] { --tw-rotate: -0.1rad; }

.-rotate-\[0\.1rad\], .-rotate-\[36deg\] { transform: translate(var(--tw-tr=
anslate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-s=
kew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-s=
cale-y)); }

.-rotate-\[36deg\] { --tw-rotate: -36deg; }

.rotate-0 { --tw-rotate: 0deg; }

.rotate-0, .rotate-12 { transform: translate(var(--tw-translate-x),var(--tw=
-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(-=
-tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.rotate-12 { --tw-rotate: 12deg; }

.rotate-180 { --tw-rotate: 180deg; }

.rotate-180, .rotate-2 { transform: translate(var(--tw-translate-x),var(--t=
w-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(=
--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.rotate-2 { --tw-rotate: 2deg; }

.rotate-45 { --tw-rotate: 45deg; }

.rotate-45, .rotate-6 { transform: translate(var(--tw-translate-x),var(--tw=
-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(-=
-tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.rotate-6 { --tw-rotate: 6deg; }

.rotate-90 { --tw-rotate: 90deg; }

.rotate-90, .rotate-\[-3deg\] { transform: translate(var(--tw-translate-x),=
var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) ske=
wY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.rotate-\[-3deg\] { --tw-rotate: -3deg; }

.rotate-\[0\.1rad\] { --tw-rotate: 0.1rad; }

.rotate-\[0\.1rad\], .rotate-\[20deg\] { transform: translate(var(--tw-tran=
slate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-ske=
w-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-sca=
le-y)); }

.rotate-\[20deg\] { --tw-rotate: 20deg; }

.rotate-\[36deg\] { --tw-rotate: 36deg; }

.rotate-\[36deg\], .rotate-\[3deg\] { transform: translate(var(--tw-transla=
te-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x=
)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-=
y)); }

.rotate-\[3deg\] { --tw-rotate: 3deg; }

.\!scale-100 { --tw-scale-x: 1 !important; --tw-scale-y: 1 !important; tran=
sform: translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--=
tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw=
-scale-x)) scaleY(var(--tw-scale-y)) !important; }

.scale-100 { --tw-scale-x: 1; --tw-scale-y: 1; }

.scale-100, .scale-110 { transform: translate(var(--tw-translate-x),var(--t=
w-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(=
--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.scale-110 { --tw-scale-x: 1.1; --tw-scale-y: 1.1; }

.scale-125 { --tw-scale-x: 1.25; --tw-scale-y: 1.25; }

.scale-125, .scale-50 { transform: translate(var(--tw-translate-x),var(--tw=
-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(-=
-tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.scale-50 { --tw-scale-x: .5; --tw-scale-y: .5; }

.scale-75 { --tw-scale-x: .75; --tw-scale-y: .75; }

.scale-75, .scale-95 { transform: translate(var(--tw-translate-x),var(--tw-=
translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--=
tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.scale-95 { --tw-scale-x: .95; --tw-scale-y: .95; }

.scale-\[0\.92\] { --tw-scale-x: 0.92; --tw-scale-y: 0.92; }

.scale-\[0\.92\], .scale-\[0\.975\] { transform: translate(var(--tw-transla=
te-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x=
)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-=
y)); }

.scale-\[0\.975\] { --tw-scale-x: 0.975; --tw-scale-y: 0.975; }

.scale-\[1\] { --tw-scale-x: 1; --tw-scale-y: 1; }

.scale-\[1\], .scale-\[80\%\] { transform: translate(var(--tw-translate-x),=
var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) ske=
wY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.scale-\[80\%\] { --tw-scale-x: 80%; --tw-scale-y: 80%; }

.-scale-x-100 { --tw-scale-x: -1; }

.-scale-x-100, .scale-x-\[1\.0025\] { transform: translate(var(--tw-transla=
te-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x=
)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-=
y)); }

.scale-x-\[1\.0025\] { --tw-scale-x: 1.0025; }

.scale-y-\[1\.015\] { --tw-scale-y: 1.015; transform: translate(var(--tw-tr=
anslate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-s=
kew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-s=
cale-y)); }

.\!transform { transform: translate(var(--tw-translate-x),var(--tw-translat=
e-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-=
y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)) !important; }

.transform { transform: translate(var(--tw-translate-x),var(--tw-translate-=
y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)=
) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.animate-\[accordion-close_150ms_ease-out\] { animation: 0.15s ease-out 0s =
1 normal none running accordion-close; }

.animate-\[accordion-open_150ms_ease-out\] { animation: 0.15s ease-out 0s 1=
 normal none running accordion-open; }

.animate-\[fade_300ms_ease-out\] { animation: 0.3s ease-out 0s 1 normal non=
e running fade; }

.animate-\[planMinimize_150ms_ease-out\] { animation: 0.15s ease-out 0s 1 n=
ormal none running planMinimize; }

.animate-\[planRestore_200ms_ease-out\] { animation: 0.2s ease-out 0s 1 nor=
mal none running planRestore; }

@keyframes shimmertext {=20
  0% { background-position: 100% 0px; }
  65% { background-position: 0px 0px; }
  100% { background-position: 0px 0px; }
}

.animate-\[shimmertext_2\.25s_infinite\] { animation: 2.25s ease 0s infinit=
e normal none running shimmertext; }

.animate-\[slideDown_0\.5s_ease-out\] { animation: 0.5s ease-out 0s 1 norma=
l none running slideDown; }

.animate-\[spin_1\.5s_linear_infinite\] { animation: 1.5s linear 0s infinit=
e normal none running spin; }

.animate-blink { animation: 1s linear 0s infinite normal none running blink=
; }

@keyframes ping {=20
  75%, 100% { transform: scale(2); opacity: 0; }
}

.animate-ping { animation: 1s cubic-bezier(0, 0, 0.2, 1) 0s infinite normal=
 none running ping; }

@keyframes pulse {=20
  50% { opacity: 0.5; }
}

.animate-pulse { animation: 2s cubic-bezier(0.4, 0, 0.6, 1) 0s infinite nor=
mal none running pulse; }

@keyframes pulse-dot {=20
  0%, 100% { transform: scale(0.75); }
  50% { transform: scale(1); }
}

.animate-pulse-dot { animation: 1.5s ease-in-out 0s infinite normal none ru=
nning pulse-dot; }

@keyframes spin {=20
  100% { transform: rotate(1turn); }
}

.animate-spin { animation: 1s linear 0s infinite normal none running spin; =
}

.\!cursor-default { cursor: default !important; }

.\!cursor-not-allowed { cursor: not-allowed !important; }

.\!cursor-pointer { cursor: pointer !important; }

.cursor-col-resize { cursor: col-resize; }

.cursor-crosshair { cursor: crosshair; }

.cursor-default { cursor: default; }

.cursor-grab { cursor: grab; }

.cursor-help { cursor: help; }

.cursor-move { cursor: move; }

.cursor-not-allowed { cursor: not-allowed; }

.cursor-pointer { cursor: pointer; }

.cursor-row-resize { cursor: row-resize; }

.cursor-text { cursor: text; }

.cursor-wait { cursor: wait; }

.touch-none { touch-action: none; }

.touch-manipulation { touch-action: manipulation; }

.select-none { user-select: none; }

.select-all { user-select: all; }

.resize-none { resize: none; }

.resize { resize: both; }

.snap-x { scroll-snap-type: x var(--tw-scroll-snap-strictness); }

.snap-mandatory { --tw-scroll-snap-strictness: mandatory; }

.scroll-py-1 { scroll-padding-top: 0.25rem; scroll-padding-bottom: 0.25rem;=
 }

.scroll-py-1\.5 { scroll-padding-top: 0.375rem; scroll-padding-bottom: 0.37=
5rem; }

.scroll-pb-6 { scroll-padding-bottom: 1.5rem; }

.list-inside { list-style-position: inside; }

.list-outside { list-style-position: outside; }

.list-decimal { list-style-type: decimal; }

.list-disc { list-style-type: disc; }

.list-none { list-style-type: none; }

.appearance-none { appearance: none; }

.break-inside-avoid { break-inside: avoid; }

.auto-rows-fr { grid-auto-rows: minmax(0px, 1fr); }

.auto-rows-min { grid-auto-rows: min-content; }

.\!grid-cols-\[max-content_auto\] { grid-template-columns: max-content auto=
 !important; }

.grid-cols-1 { grid-template-columns: repeat(1, minmax(0px, 1fr)); }

.grid-cols-12 { grid-template-columns: repeat(12, minmax(0px, 1fr)); }

.grid-cols-2 { grid-template-columns: repeat(2, minmax(0px, 1fr)); }

.grid-cols-3 { grid-template-columns: repeat(3, minmax(0px, 1fr)); }

.grid-cols-4 { grid-template-columns: repeat(4, minmax(0px, 1fr)); }

.grid-cols-5 { grid-template-columns: repeat(5, minmax(0px, 1fr)); }

.grid-cols-7 { grid-template-columns: repeat(7, minmax(0px, 1fr)); }

.grid-cols-\[1fr_auto_1fr\] { grid-template-columns: 1fr auto 1fr; }

.grid-cols-\[20px_1fr\] { grid-template-columns: 20px 1fr; }

.grid-cols-\[28px_repeat\(5\,1fr\)\] { grid-template-columns: 28px repeat(5=
, 1fr); }

.grid-cols-\[3fr_1fr_3fr\] { grid-template-columns: 3fr 1fr 3fr; }

.grid-cols-\[auto_1fr\] { grid-template-columns: auto 1fr; }

.grid-cols-\[minmax\(0\,_1fr\)_auto\] { grid-template-columns: minmax(0px, =
1fr) auto; }

.grid-cols-\[repeat\(auto-fill\,minmax\(120px\,1fr\)\)\] { grid-template-co=
lumns: repeat(auto-fill, minmax(120px, 1fr)); }

.grid-rows-1 { grid-template-rows: repeat(1, minmax(0px, 1fr)); }

.grid-rows-2 { grid-template-rows: repeat(2, minmax(0px, 1fr)); }

.grid-rows-3 { grid-template-rows: repeat(3, minmax(0px, 1fr)); }

.grid-rows-\[0fr\] { grid-template-rows: 0fr; }

.grid-rows-\[1fr\] { grid-template-rows: 1fr; }

.grid-rows-\[auto_auto\] { grid-template-rows: auto auto; }

.flex-row { flex-direction: row; }

.flex-row-reverse { flex-direction: row-reverse; }

.flex-col { flex-direction: column; }

.flex-col-reverse { flex-direction: column-reverse; }

.flex-wrap { flex-wrap: wrap; }

.flex-nowrap { flex-wrap: nowrap; }

.place-content-center { place-content: center; }

.place-items-center { place-items: center; }

.content-start { align-content: flex-start; }

.\!items-start { align-items: flex-start !important; }

.items-start { align-items: flex-start; }

.items-end { align-items: flex-end; }

.\!items-center { align-items: center !important; }

.items-center { align-items: center; }

.items-baseline { align-items: baseline; }

.items-stretch { align-items: stretch; }

.\!justify-start { justify-content: flex-start !important; }

.justify-start { justify-content: flex-start; }

.justify-end { justify-content: flex-end; }

.\!justify-center { justify-content: center !important; }

.justify-center { justify-content: center; }

.justify-between { justify-content: space-between; }

.justify-stretch { justify-content: stretch; }

.justify-items-center { justify-items: center; }

.justify-items-stretch { justify-items: stretch; }

.\!gap-0 { gap: 0px !important; }

.\!gap-0\.5 { gap: 0.125rem !important; }

.\!gap-1 { gap: 0.25rem !important; }

.\!gap-1\.5 { gap: 0.375rem !important; }

.\!gap-2 { gap: 0.5rem !important; }

.\!gap-3 { gap: 0.75rem !important; }

.\!gap-3\.5 { gap: 0.875rem !important; }

.\!gap-4 { gap: 1rem !important; }

.gap-0 { gap: 0px; }

.gap-0\.5 { gap: 0.125rem; }

.gap-1 { gap: 0.25rem; }

.gap-1\.5 { gap: 0.375rem; }

.gap-10 { gap: 2.5rem; }

.gap-16 { gap: 4rem; }

.gap-2 { gap: 0.5rem; }

.gap-2\.5 { gap: 0.625rem; }

.gap-20 { gap: 5rem; }

.gap-3 { gap: 0.75rem; }

.gap-3\.5 { gap: 0.875rem; }

.gap-4 { gap: 1rem; }

.gap-5 { gap: 1.25rem; }

.gap-6 { gap: 1.5rem; }

.gap-7 { gap: 1.75rem; }

.gap-8 { gap: 2rem; }

.gap-\[0\.3em\] { gap: 0.3em; }

.gap-\[1\.2rem\] { gap: 1.2rem; }

.gap-\[10px\] { gap: 10px; }

.gap-\[13px\] { gap: 13px; }

.gap-\[1px\] { gap: 1px; }

.gap-\[4px\] { gap: 4px; }

.gap-\[60px\] { gap: 60px; }

.gap-\[6px\] { gap: 6px; }

.gap-\[7px\] { gap: 7px; }

.gap-px { gap: 1px; }

.gap-x-1 { column-gap: 0.25rem; }

.gap-x-1\.5 { column-gap: 0.375rem; }

.gap-x-12 { column-gap: 3rem; }

.gap-x-2 { column-gap: 0.5rem; }

.gap-x-3 { column-gap: 0.75rem; }

.gap-x-4 { column-gap: 1rem; }

.gap-x-6 { column-gap: 1.5rem; }

.gap-x-8, .gap-x-\[2rem\] { column-gap: 2rem; }

.gap-y-0 { row-gap: 0px; }

.gap-y-0\.5 { row-gap: 0.125rem; }

.gap-y-1 { row-gap: 0.25rem; }

.gap-y-12 { row-gap: 3rem; }

.gap-y-2 { row-gap: 0.5rem; }

.gap-y-20 { row-gap: 5rem; }

.gap-y-3 { row-gap: 0.75rem; }

.gap-y-4 { row-gap: 1rem; }

.gap-y-6 { row-gap: 1.5rem; }

.gap-y-8 { row-gap: 2rem; }

.gap-y-\[2\.5rem\] { row-gap: 2.5rem; }

.\!space-y-0 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0 !i=
mportant; margin-top: calc(0px * calc(1 - var(--tw-space-y-reverse))) !impo=
rtant; margin-bottom: calc(0px * var(--tw-space-y-reverse)) !important; }

.-space-x-2 > :not([hidden]) ~ :not([hidden]) { --tw-space-x-reverse: 0; ma=
rgin-right: calc(-.5rem * var(--tw-space-x-reverse)); margin-left: calc(-.5=
rem * calc(1 - var(--tw-space-x-reverse))); }

.space-x-2 > :not([hidden]) ~ :not([hidden]) { --tw-space-x-reverse: 0; mar=
gin-right: calc(.5rem * var(--tw-space-x-reverse)); margin-left: calc(.5rem=
 * calc(1 - var(--tw-space-x-reverse))); }

.space-x-3 > :not([hidden]) ~ :not([hidden]) { --tw-space-x-reverse: 0; mar=
gin-right: calc(.75rem * var(--tw-space-x-reverse)); margin-left: calc(.75r=
em * calc(1 - var(--tw-space-x-reverse))); }

.space-x-4 > :not([hidden]) ~ :not([hidden]) { --tw-space-x-reverse: 0; mar=
gin-right: calc(1rem * var(--tw-space-x-reverse)); margin-left: calc(1rem *=
 calc(1 - var(--tw-space-x-reverse))); }

.space-x-6 > :not([hidden]) ~ :not([hidden]) { --tw-space-x-reverse: 0; mar=
gin-right: calc(1.5rem * var(--tw-space-x-reverse)); margin-left: calc(1.5r=
em * calc(1 - var(--tw-space-x-reverse))); }

.space-y-0 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; mar=
gin-top: calc(0px * calc(1 - var(--tw-space-y-reverse))); margin-bottom: ca=
lc(0px * var(--tw-space-y-reverse)); }

.space-y-0\.5 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; =
margin-top: calc(.125rem * calc(1 - var(--tw-space-y-reverse))); margin-bot=
tom: calc(.125rem * var(--tw-space-y-reverse)); }

.space-y-1 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; mar=
gin-top: calc(.25rem * calc(1 - var(--tw-space-y-reverse))); margin-bottom:=
 calc(.25rem * var(--tw-space-y-reverse)); }

.space-y-1\.5 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; =
margin-top: calc(.375rem * calc(1 - var(--tw-space-y-reverse))); margin-bot=
tom: calc(.375rem * var(--tw-space-y-reverse)); }

.space-y-10 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; ma=
rgin-top: calc(2.5rem * calc(1 - var(--tw-space-y-reverse))); margin-bottom=
: calc(2.5rem * var(--tw-space-y-reverse)); }

.space-y-2 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; mar=
gin-top: calc(.5rem * calc(1 - var(--tw-space-y-reverse))); margin-bottom: =
calc(.5rem * var(--tw-space-y-reverse)); }

.space-y-2\.5 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; =
margin-top: calc(.625rem * calc(1 - var(--tw-space-y-reverse))); margin-bot=
tom: calc(.625rem * var(--tw-space-y-reverse)); }

.space-y-20 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; ma=
rgin-top: calc(5rem * calc(1 - var(--tw-space-y-reverse))); margin-bottom: =
calc(5rem * var(--tw-space-y-reverse)); }

.space-y-3 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; mar=
gin-top: calc(.75rem * calc(1 - var(--tw-space-y-reverse))); margin-bottom:=
 calc(.75rem * var(--tw-space-y-reverse)); }

.space-y-4 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; mar=
gin-top: calc(1rem * calc(1 - var(--tw-space-y-reverse))); margin-bottom: c=
alc(1rem * var(--tw-space-y-reverse)); }

.space-y-5 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; mar=
gin-top: calc(1.25rem * calc(1 - var(--tw-space-y-reverse))); margin-bottom=
: calc(1.25rem * var(--tw-space-y-reverse)); }

.space-y-6 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; mar=
gin-top: calc(1.5rem * calc(1 - var(--tw-space-y-reverse))); margin-bottom:=
 calc(1.5rem * var(--tw-space-y-reverse)); }

.space-y-7 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; mar=
gin-top: calc(1.75rem * calc(1 - var(--tw-space-y-reverse))); margin-bottom=
: calc(1.75rem * var(--tw-space-y-reverse)); }

.space-y-8 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; mar=
gin-top: calc(2rem * calc(1 - var(--tw-space-y-reverse))); margin-bottom: c=
alc(2rem * var(--tw-space-y-reverse)); }

.divide-y > :not([hidden]) ~ :not([hidden]) { --tw-divide-y-reverse: 0; bor=
der-top-width: calc(1px * calc(1 - var(--tw-divide-y-reverse))); border-bot=
tom-width: calc(1px * var(--tw-divide-y-reverse)); }

.divide-y-0 > :not([hidden]) ~ :not([hidden]) { --tw-divide-y-reverse: 0; b=
order-top-width: calc(0px * calc(1 - var(--tw-divide-y-reverse))); border-b=
ottom-width: calc(0px * var(--tw-divide-y-reverse)); }

.divide-y-0\.5 > :not([hidden]) ~ :not([hidden]), .divide-y-\[0\.5px\] > :n=
ot([hidden]) ~ :not([hidden]) { --tw-divide-y-reverse: 0; border-top-width:=
 calc(.5px * calc(1 - var(--tw-divide-y-reverse))); border-bottom-width: ca=
lc(.5px * var(--tw-divide-y-reverse)); }

.divide-\[0\.5px\] > :not([hidden]) ~ :not([hidden]) { }

.divide-border-300 > :not([hidden]) ~ :not([hidden]) { border-color: hsl(va=
r(--border-300)/.15); }

.divide-text-300\/20 > :not([hidden]) ~ :not([hidden]) { border-color: hsl(=
var(--text-300)/.2); }

.place-self-center { place-self: center; }

.self-start { align-self: flex-start; }

.self-end { align-self: flex-end; }

.self-center { align-self: center; }

.self-stretch { align-self: stretch; }

.overflow-auto { overflow: auto; }

.\!overflow-hidden { overflow: hidden !important; }

.overflow-hidden { overflow: hidden; }

.overflow-clip { overflow: clip; }

.\!overflow-visible { overflow: visible !important; }

.overflow-visible { overflow: visible; }

.overflow-scroll { overflow: scroll; }

.overflow-x-auto { overflow-x: auto; }

.overflow-y-auto { overflow-y: auto; }

.overflow-x-hidden { overflow-x: hidden; }

.overflow-y-hidden { overflow-y: hidden; }

.overflow-x-clip { overflow-x: clip; }

.overflow-x-visible { overflow-x: visible; }

.overflow-y-visible { overflow-y: visible; }

.overflow-y-scroll { overflow-y: scroll; }

.overscroll-auto { overscroll-behavior: auto; }

.overscroll-contain { overscroll-behavior: contain; }

.overscroll-y-contain { overscroll-behavior-y: contain; }

.scroll-smooth { scroll-behavior: smooth; }

.\!truncate { overflow: hidden !important; text-overflow: ellipsis !importa=
nt; white-space: nowrap !important; }

.truncate { overflow: hidden; white-space: nowrap; }

.overflow-ellipsis, .text-ellipsis, .truncate { text-overflow: ellipsis; }

.hyphens-auto { hyphens: auto; }

.\!whitespace-normal { white-space: normal !important; }

.whitespace-normal { white-space: normal; }

.whitespace-nowrap { white-space: nowrap; }

.whitespace-pre { white-space: pre; }

.whitespace-pre-line { white-space: pre-line; }

.whitespace-pre-wrap { white-space: pre-wrap; }

.whitespace-break-spaces { white-space: break-spaces; }

.text-wrap { text-wrap: wrap; }

.text-nowrap { text-wrap: nowrap; }

.text-balance { text-wrap: balance; }

.text-pretty { text-wrap: pretty; }

.break-words { overflow-wrap: break-word; }

.break-all { word-break: break-all; }

.\!rounded { border-radius: 0.25rem !important; }

.\!rounded-2xl { border-radius: 1rem !important; }

.\!rounded-\[0\.9rem\] { border-radius: 0.9rem !important; }

.\!rounded-\[32px\] { border-radius: 32px !important; }

.\!rounded-full { border-radius: 9999px !important; }

.\!rounded-lg { border-radius: 0.5rem !important; }

.\!rounded-md { border-radius: 0.375rem !important; }

.\!rounded-none { border-radius: 0px !important; }

.\!rounded-xl { border-radius: 0.75rem !important; }

.rounded { border-radius: 0.25rem; }

.rounded-2xl { border-radius: 1rem; }

.rounded-3xl { border-radius: 1.5rem; }

.rounded-\[\.625rem\] { border-radius: 0.625rem; }

.rounded-\[0\.4rem\] { border-radius: 0.4rem; }

.rounded-\[0\.6rem\] { border-radius: 0.6rem; }

.rounded-\[0\.9rem\] { border-radius: 0.9rem; }

.rounded-\[10px\] { border-radius: 10px; }

.rounded-\[12px\] { border-radius: 12px; }

.rounded-\[14px\] { border-radius: 14px; }

.rounded-\[20px\] { border-radius: 20px; }

.rounded-\[24px\] { border-radius: 24px; }

.rounded-\[27\%\] { border-radius: 27%; }

.rounded-\[2rem\] { border-radius: 2rem; }

.rounded-\[30px\] { border-radius: 30px; }

.rounded-\[52px\] { border-radius: 52px; }

.rounded-\[6px\] { border-radius: 6px; }

.rounded-\[inherit\] { border-radius: inherit; }

.rounded-full { border-radius: 9999px; }

.rounded-lg { border-radius: 0.5rem; }

.rounded-md { border-radius: 0.375rem; }

.rounded-none { border-radius: 0px; }

.rounded-sm { border-radius: 0.125rem; }

.rounded-xl { border-radius: 0.75rem; }

.\!rounded-l-none { border-top-left-radius: 0px !important; border-bottom-l=
eft-radius: 0px !important; }

.\!rounded-r-none { border-top-right-radius: 0px !important; border-bottom-=
right-radius: 0px !important; }

.rounded-b-2xl { border-bottom-right-radius: 1rem; border-bottom-left-radiu=
s: 1rem; }

.rounded-b-\[20px\] { border-bottom-right-radius: 20px; border-bottom-left-=
radius: 20px; }

.rounded-b-lg { border-bottom-right-radius: 0.5rem; border-bottom-left-radi=
us: 0.5rem; }

.rounded-b-xl { border-bottom-right-radius: 0.75rem; border-bottom-left-rad=
ius: 0.75rem; }

.rounded-e-2xl { border-start-end-radius: 1rem; border-end-end-radius: 1rem=
; }

.rounded-l { border-top-left-radius: 0.25rem; border-bottom-left-radius: 0.=
25rem; }

.rounded-l-\[24px\] { border-top-left-radius: 24px; border-bottom-left-radi=
us: 24px; }

.rounded-l-\[inherit\] { border-top-left-radius: inherit; border-bottom-lef=
t-radius: inherit; }

.rounded-l-lg { border-top-left-radius: 0.5rem; border-bottom-left-radius: =
0.5rem; }

.rounded-l-sm { border-top-left-radius: 0.125rem; border-bottom-left-radius=
: 0.125rem; }

.rounded-r { border-top-right-radius: 0.25rem; border-bottom-right-radius: =
0.25rem; }

.rounded-r-\[24px\] { border-top-right-radius: 24px; border-bottom-right-ra=
dius: 24px; }

.rounded-r-full { border-top-right-radius: 9999px; border-bottom-right-radi=
us: 9999px; }

.rounded-r-lg { border-top-right-radius: 0.5rem; border-bottom-right-radius=
: 0.5rem; }

.rounded-r-md { border-top-right-radius: 0.375rem; border-bottom-right-radi=
us: 0.375rem; }

.rounded-r-sm { border-top-right-radius: 0.125rem; border-bottom-right-radi=
us: 0.125rem; }

.rounded-t-2xl { border-top-left-radius: 1rem; border-top-right-radius: 1re=
m; }

.rounded-t-3xl { border-top-left-radius: 1.5rem; border-top-right-radius: 1=
.5rem; }

.rounded-t-\[10px\] { border-top-left-radius: 10px; border-top-right-radius=
: 10px; }

.rounded-t-\[20px\] { border-top-left-radius: 20px; border-top-right-radius=
: 20px; }

.rounded-t-\[24px\] { border-top-left-radius: 24px; border-top-right-radius=
: 24px; }

.rounded-t-\[2rem\] { border-top-left-radius: 2rem; border-top-right-radius=
: 2rem; }

.rounded-t-\[6px\] { border-top-left-radius: 6px; border-top-right-radius: =
6px; }

.rounded-t-lg { border-top-left-radius: 0.5rem; border-top-right-radius: 0.=
5rem; }

.rounded-t-none { border-top-left-radius: 0px; border-top-right-radius: 0px=
; }

.rounded-t-sm { border-top-left-radius: 0.125rem; border-top-right-radius: =
0.125rem; }

.rounded-t-xl { border-top-left-radius: 0.75rem; border-top-right-radius: 0=
.75rem; }

.rounded-bl { border-bottom-left-radius: 0.25rem; }

.rounded-bl-xl { border-bottom-left-radius: 0.75rem; }

.rounded-br-sm { border-bottom-right-radius: 0.125rem; }

.rounded-br-xl { border-bottom-right-radius: 0.75rem; }

.rounded-ee-lg { border-end-end-radius: 0.5rem; }

.rounded-ss-md { border-start-start-radius: 0.375rem; }

.rounded-tl-\[0px\] { border-top-left-radius: 0px; }

.rounded-tl-xl { border-top-left-radius: 0.75rem; }

.rounded-tr-\[0px\] { border-top-right-radius: 0px; }

.rounded-tr-xl { border-top-right-radius: 0.75rem; }

.\!border { border-width: 1px !important; }

.\!border-0 { border-width: 0px !important; }

.\!border-0\.5 { border-width: 0.5px !important; }

.border { border-width: 1px; }

.border-0 { border-width: 0px; }

.border-0\.5 { border-width: 0.5px; }

.border-1\.5 { border-width: 1.5px; }

.border-2 { border-width: 2px; }

.border-4 { border-width: 4px; }

.border-8 { border-width: 8px; }

.border-\[0\.2px\] { border-width: 0.2px; }

.border-\[0\.5px\] { border-width: 0.5px; }

.border-\[1\.5px\] { border-width: 1.5px; }

.border-\[1\.5rem\] { border-width: 1.5rem; }

.border-\[1px\] { border-width: 1px; }

.border-\[8px\] { border-width: 8px; }

.border-x { border-left-width: 1px; border-right-width: 1px; }

.border-x-0 { border-left-width: 0px; border-right-width: 0px; }

.border-x-0\.5 { border-left-width: 0.5px; border-right-width: 0.5px; }

.border-y { border-top-width: 1px; border-bottom-width: 1px; }

.border-y-0 { border-top-width: 0px; border-bottom-width: 0px; }

.border-y-0\.5 { border-top-width: 0.5px; border-bottom-width: 0.5px; }

.border-b { border-bottom-width: 1px; }

.border-b-0 { border-bottom-width: 0px; }

.border-b-0\.5 { border-bottom-width: 0.5px; }

.border-b-1\.5 { border-bottom-width: 1.5px; }

.border-b-2 { border-bottom-width: 2px; }

.border-b-\[0\.5px\] { border-bottom-width: 0.5px; }

.border-l { border-left-width: 1px; }

.border-l-0 { border-left-width: 0px; }

.border-l-0\.5 { border-left-width: 0.5px; }

.border-l-2 { border-left-width: 2px; }

.border-l-4 { border-left-width: 4px; }

.border-l-\[3px\] { border-left-width: 3px; }

.border-r { border-right-width: 1px; }

.border-r-0 { border-right-width: 0px; }

.border-r-0\.5, .border-r-\[0\.5px\] { border-right-width: 0.5px; }

.border-t { border-top-width: 1px; }

.border-t-0 { border-top-width: 0px; }

.border-t-0\.5 { border-top-width: 0.5px; }

.border-t-2 { border-top-width: 2px; }

.border-t-\[0\.5px\] { border-top-width: 0.5px; }

.border-solid { border-style: solid; }

.border-dashed { border-style: dashed; }

.border-dotted { border-style: dotted; }

.\!border-none { border-style: none !important; }

.border-none { border-style: none; }

.\!border-\[\#d29922\]\/20 { border-color: rgba(210, 153, 34, 0.2) !importa=
nt; }

.\!border-accent-main-900 { --tw-border-opacity: 1 !important; border-color=
: hsl(var(--accent-main-900)/var(--tw-border-opacity)) !important; }

.\!border-accent-secondary-000 { --tw-border-opacity: 1 !important; border-=
color: hsl(var(--accent-secondary-000)/var(--tw-border-opacity)) !important=
; }

.\!border-accent-secondary-100 { --tw-border-opacity: 1 !important; border-=
color: hsl(var(--accent-secondary-100)/var(--tw-border-opacity)) !important=
; }

.\!border-accent-secondary-100\/20 { border-color: hsl(var(--accent-seconda=
ry-100)/.2) !important; }

.\!border-accent-secondary-100\/50 { border-color: hsl(var(--accent-seconda=
ry-100)/.5) !important; }

.\!border-accent-secondary-100\/80 { border-color: hsl(var(--accent-seconda=
ry-100)/.8) !important; }

.\!border-accent-secondary-200 { --tw-border-opacity: 1 !important; border-=
color: hsl(var(--accent-secondary-200)/var(--tw-border-opacity)) !important=
; }

.\!border-accent-secondary-200\/30 { border-color: hsl(var(--accent-seconda=
ry-200)/.3) !important; }

.\!border-accent-secondary-900 { --tw-border-opacity: 1 !important; border-=
color: hsl(var(--accent-secondary-900)/var(--tw-border-opacity)) !important=
; }

.\!border-border-200 { border-color: hsl(var(--border-200)/.3) !important; =
}

.\!border-border-300 { border-color: hsl(var(--border-300)/.15) !important;=
 }

.\!border-border-300\/25 { border-color: hsl(var(--border-300)/.25) !import=
ant; }

.\!border-danger-000 { --tw-border-opacity: 1 !important; border-color: hsl=
(var(--danger-000)/var(--tw-border-opacity)) !important; }

.\!border-danger-200 { --tw-border-opacity: 1 !important; border-color: hsl=
(var(--danger-200)/var(--tw-border-opacity)) !important; }

.\!border-danger-200\/50 { border-color: hsl(var(--danger-200)/.5) !importa=
nt; }

.\!border-text-100 { --tw-border-opacity: 1 !important; border-color: hsl(v=
ar(--text-100)/var(--tw-border-opacity)) !important; }

.\!border-transparent { border-color: transparent !important; }

.border-\[\#2a2a2a\] { --tw-border-opacity: 1; border-color: rgb(42 42 42/v=
ar(--tw-border-opacity)); }

.border-\[\#3a3a3a\] { --tw-border-opacity: 1; border-color: rgb(58 58 58/v=
ar(--tw-border-opacity)); }

.border-accent-brand\/20 { border-color: hsl(var(--accent-brand)/.2); }

.border-accent-brand\/30 { border-color: hsl(var(--accent-brand)/.3); }

.border-accent-main-100 { --tw-border-opacity: 1; border-color: hsl(var(--a=
ccent-main-100)/var(--tw-border-opacity)); }

.border-accent-main-100\/30 { border-color: hsl(var(--accent-main-100)/.3);=
 }

.border-accent-main-200 { --tw-border-opacity: 1; border-color: hsl(var(--a=
ccent-main-200)/var(--tw-border-opacity)); }

.border-accent-main-200\/30 { border-color: hsl(var(--accent-main-200)/.3);=
 }

.border-accent-pro-000\/20 { border-color: hsl(var(--accent-pro-000)/.2); }

.border-accent-pro-100 { --tw-border-opacity: 1; border-color: hsl(var(--ac=
cent-pro-100)/var(--tw-border-opacity)); }

.border-accent-pro-100\/10 { border-color: hsl(var(--accent-pro-100)/.1); }

.border-accent-pro-100\/20 { border-color: hsl(var(--accent-pro-100)/.2); }

.border-accent-pro-100\/50 { border-color: hsl(var(--accent-pro-100)/.5); }

.border-accent-secondary-000 { --tw-border-opacity: 1; border-color: hsl(va=
r(--accent-secondary-000)/var(--tw-border-opacity)); }

.border-accent-secondary-000\/20 { border-color: hsl(var(--accent-secondary=
-000)/.2); }

.border-accent-secondary-000\/40 { border-color: hsl(var(--accent-secondary=
-000)/.4); }

.border-accent-secondary-100 { --tw-border-opacity: 1; border-color: hsl(va=
r(--accent-secondary-100)/var(--tw-border-opacity)); }

.border-accent-secondary-100\/20 { border-color: hsl(var(--accent-secondary=
-100)/.2); }

.border-accent-secondary-100\/30 { border-color: hsl(var(--accent-secondary=
-100)/.3); }

.border-accent-secondary-100\/50 { border-color: hsl(var(--accent-secondary=
-100)/.5); }

.border-accent-secondary-200 { --tw-border-opacity: 1; border-color: hsl(va=
r(--accent-secondary-200)/var(--tw-border-opacity)); }

.border-accent-secondary-200\/20 { border-color: hsl(var(--accent-secondary=
-200)/.2); }

.border-accent-secondary-900 { --tw-border-opacity: 1; border-color: hsl(va=
r(--accent-secondary-900)/var(--tw-border-opacity)); }

.border-always-black\/10 { border-color: hsl(var(--always-black)/.1); }

.border-always-white { --tw-border-opacity: 1; border-color: hsl(var(--alwa=
ys-white)/var(--tw-border-opacity)); }

.border-always-white\/10 { border-color: hsl(var(--always-white)/.1); }

.border-always-white\/20 { border-color: hsl(var(--always-white)/.2); }

.border-bg-000 { --tw-border-opacity: 1; border-color: hsl(var(--bg-000)/va=
r(--tw-border-opacity)); }

.border-bg-200 { --tw-border-opacity: 1; border-color: hsl(var(--bg-200)/va=
r(--tw-border-opacity)); }

.border-bg-300 { --tw-border-opacity: 1; border-color: hsl(var(--bg-300)/va=
r(--tw-border-opacity)); }

.border-bg-400 { --tw-border-opacity: 1; border-color: hsl(var(--bg-400)/va=
r(--tw-border-opacity)); }

.border-border-100 { border-color: hsl(var(--border-100)/.4); }

.border-border-100\/15 { border-color: hsl(var(--border-100)/.15); }

.border-border-200, .border-border-200\/30 { border-color: hsl(var(--border=
-200)/.3); }

.border-border-300 { border-color: hsl(var(--border-300)/.15); }

.border-border-300\/10 { border-color: hsl(var(--border-300)/.1); }

.border-border-300\/15 { border-color: hsl(var(--border-300)/.15); }

.border-border-300\/20 { border-color: hsl(var(--border-300)/.2); }

.border-border-300\/25 { border-color: hsl(var(--border-300)/.25); }

.border-border-300\/30 { border-color: hsl(var(--border-300)/.3); }

.border-border-300\/50 { border-color: hsl(var(--border-300)/.5); }

.border-border-300\/60 { border-color: hsl(var(--border-300)/.6); }

.border-border-400 { border-color: hsl(var(--border-400)/.15); }

.border-border-400\/10 { border-color: hsl(var(--border-400)/.1); }

.border-border-400\/20 { border-color: hsl(var(--border-400)/.2); }

.border-border-400\/30 { border-color: hsl(var(--border-400)/.3); }

.border-current { border-color: currentcolor; }

.border-danger-000 { --tw-border-opacity: 1; border-color: hsl(var(--danger=
-000)/var(--tw-border-opacity)); }

.border-danger-000\/10 { border-color: hsl(var(--danger-000)/.1); }

.border-danger-000\/20 { border-color: hsl(var(--danger-000)/.2); }

.border-danger-000\/30 { border-color: hsl(var(--danger-000)/.3); }

.border-danger-100 { --tw-border-opacity: 1; border-color: hsl(var(--danger=
-100)/var(--tw-border-opacity)); }

.border-danger-200 { --tw-border-opacity: 1; border-color: hsl(var(--danger=
-200)/var(--tw-border-opacity)); }

.border-danger-200\/50 { border-color: hsl(var(--danger-200)/.5); }

.border-success-000 { --tw-border-opacity: 1; border-color: hsl(var(--succe=
ss-000)/var(--tw-border-opacity)); }

.border-success-100 { --tw-border-opacity: 1; border-color: hsl(var(--succe=
ss-100)/var(--tw-border-opacity)); }

.border-success-100\/20 { border-color: hsl(var(--success-100)/.2); }

.border-success-100\/30 { border-color: hsl(var(--success-100)/.3); }

.border-text-000 { --tw-border-opacity: 1; border-color: hsl(var(--text-000=
)/var(--tw-border-opacity)); }

.border-text-000\/30 { border-color: hsl(var(--text-000)/.3); }

.border-text-100 { --tw-border-opacity: 1; border-color: hsl(var(--text-100=
)/var(--tw-border-opacity)); }

.border-text-200 { --tw-border-opacity: 1; border-color: hsl(var(--text-200=
)/var(--tw-border-opacity)); }

.border-text-300 { --tw-border-opacity: 1; border-color: hsl(var(--text-300=
)/var(--tw-border-opacity)); }

.border-text-400 { --tw-border-opacity: 1; border-color: hsl(var(--text-400=
)/var(--tw-border-opacity)); }

.border-text-500 { --tw-border-opacity: 1; border-color: hsl(var(--text-500=
)/var(--tw-border-opacity)); }

.border-transparent { border-color: transparent; }

.border-warning-000 { --tw-border-opacity: 1; border-color: hsl(var(--warni=
ng-000)/var(--tw-border-opacity)); }

.border-warning-000\/30 { border-color: hsl(var(--warning-000)/.3); }

.border-warning-100\/20 { border-color: hsl(var(--warning-100)/.2); }

.border-warning-200 { --tw-border-opacity: 1; border-color: hsl(var(--warni=
ng-200)/var(--tw-border-opacity)); }

.border-warning-200\/50 { border-color: hsl(var(--warning-200)/.5); }

.border-x-bg-200 { --tw-border-opacity: 1; border-left-color: hsl(var(--bg-=
200)/var(--tw-border-opacity)); border-right-color: hsl(var(--bg-200)/var(-=
-tw-border-opacity)); }

.border-y-border-400 { border-top-color: hsl(var(--border-400)/.15); border=
-bottom-color: hsl(var(--border-400)/.15); }

.\!border-b-transparent { border-bottom-color: transparent !important; }

.\!border-t-transparent { border-top-color: transparent !important; }

.border-b-bg-200 { --tw-border-opacity: 1; border-bottom-color: hsl(var(--b=
g-200)/var(--tw-border-opacity)); }

.border-l-\[hsl\(210\,70\%\,50\%\)\] { --tw-border-opacity: 1; border-left-=
color: hsl(210 70% 50%/var(--tw-border-opacity)); }

.border-l-danger-100 { --tw-border-opacity: 1; border-left-color: hsl(var(-=
-danger-100)/var(--tw-border-opacity)); }

.border-l-success-100 { --tw-border-opacity: 1; border-left-color: hsl(var(=
--success-100)/var(--tw-border-opacity)); }

.border-l-transparent { border-left-color: transparent; }

.border-r-transparent { border-right-color: transparent; }

.border-t-accent-main-100 { --tw-border-opacity: 1; border-top-color: hsl(v=
ar(--accent-main-100)/var(--tw-border-opacity)); }

.border-t-bg-200 { --tw-border-opacity: 1; border-top-color: hsl(var(--bg-2=
00)/var(--tw-border-opacity)); }

.border-t-text-200 { --tw-border-opacity: 1; border-top-color: hsl(var(--te=
xt-200)/var(--tw-border-opacity)); }

.border-t-transparent { border-top-color: transparent; }

.\!border-opacity-100 { --tw-border-opacity: 1 !important; }

.\!border-opacity-40 { --tw-border-opacity: 0.4 !important; }

.border-opacity-100 { --tw-border-opacity: 1; }

.border-opacity-25 { --tw-border-opacity: 0.25; }

.border-opacity-30 { --tw-border-opacity: 0.3; }

.\!bg-\[\#d29922\]\/10 { background-color: rgba(210, 153, 34, 0.1) !importa=
nt; }

.\!bg-accent-brand { --tw-bg-opacity: 1 !important; background-color: hsl(v=
ar(--accent-brand)/var(--tw-bg-opacity)) !important; }

.\!bg-accent-main-100\/10 { background-color: hsl(var(--accent-main-100)/.1=
) !important; }

.\!bg-accent-main-900 { --tw-bg-opacity: 1 !important; background-color: hs=
l(var(--accent-main-900)/var(--tw-bg-opacity)) !important; }

.\!bg-accent-secondary-000 { --tw-bg-opacity: 1 !important; background-colo=
r: hsl(var(--accent-secondary-000)/var(--tw-bg-opacity)) !important; }

.\!bg-accent-secondary-100 { --tw-bg-opacity: 1 !important; background-colo=
r: hsl(var(--accent-secondary-100)/var(--tw-bg-opacity)) !important; }

.\!bg-accent-secondary-100\/\[8\%\] { background-color: hsl(var(--accent-se=
condary-100)/8%) !important; }

.\!bg-accent-secondary-200\/20 { background-color: hsl(var(--accent-seconda=
ry-200)/.2) !important; }

.\!bg-accent-secondary-900 { --tw-bg-opacity: 1 !important; background-colo=
r: hsl(var(--accent-secondary-900)/var(--tw-bg-opacity)) !important; }

.\!bg-accent-secondary-900\/50 { background-color: hsl(var(--accent-seconda=
ry-900)/.5) !important; }

.\!bg-bg-000 { --tw-bg-opacity: 1 !important; background-color: hsl(var(--b=
g-000)/var(--tw-bg-opacity)) !important; }

.\!bg-bg-000\/50 { background-color: hsl(var(--bg-000)/.5) !important; }

.\!bg-bg-100 { background-color: hsl(var(--bg-100)/var(--tw-bg-opacity)) !i=
mportant; }

.\!bg-bg-100, .\!bg-bg-200 { --tw-bg-opacity: 1 !important; }

.\!bg-bg-200 { background-color: hsl(var(--bg-200)/var(--tw-bg-opacity)) !i=
mportant; }

.\!bg-bg-300 { --tw-bg-opacity: 1 !important; background-color: hsl(var(--b=
g-300)/var(--tw-bg-opacity)) !important; }

.\!bg-bg-300\/60 { background-color: hsl(var(--bg-300)/.6) !important; }

.\!bg-bg-400 { background-color: hsl(var(--bg-400)/var(--tw-bg-opacity)) !i=
mportant; }

.\!bg-bg-400, .\!bg-bg-500 { --tw-bg-opacity: 1 !important; }

.\!bg-bg-500 { background-color: hsl(var(--bg-500)/var(--tw-bg-opacity)) !i=
mportant; }

.\!bg-border-400 { background-color: hsl(var(--border-400)/.15) !important;=
 }

.\!bg-danger-900 { --tw-bg-opacity: 1 !important; background-color: hsl(var=
(--danger-900)/var(--tw-bg-opacity)) !important; }

.\!bg-text-100 { --tw-bg-opacity: 1 !important; background-color: hsl(var(-=
-text-100)/var(--tw-bg-opacity)) !important; }

.\!bg-transparent { background-color: transparent !important; }

.bg-\[\#007AFF\] { --tw-bg-opacity: 1; background-color: rgb(0 122 255/var(=
--tw-bg-opacity)); }

.bg-\[\#1a1a1a\] { --tw-bg-opacity: 1; background-color: rgb(26 26 26/var(-=
-tw-bg-opacity)); }

.bg-\[\#1a5c3a\] { --tw-bg-opacity: 1; background-color: rgb(26 92 58/var(-=
-tw-bg-opacity)); }

.bg-\[\#1e1e1e\] { --tw-bg-opacity: 1; background-color: rgb(30 30 30/var(-=
-tw-bg-opacity)); }

.bg-\[\#252525\] { --tw-bg-opacity: 1; background-color: rgb(37 37 37/var(-=
-tw-bg-opacity)); }

.bg-\[\#282c34\] { --tw-bg-opacity: 1; background-color: rgb(40 44 52/var(-=
-tw-bg-opacity)); }

.bg-\[\#28c840\] { --tw-bg-opacity: 1; background-color: rgb(40 200 64/var(=
--tw-bg-opacity)); }

.bg-\[\#2a2a2a\] { --tw-bg-opacity: 1; background-color: rgb(42 42 42/var(-=
-tw-bg-opacity)); }

.bg-\[\#2d2d2d\] { --tw-bg-opacity: 1; background-color: rgb(45 45 45/var(-=
-tw-bg-opacity)); }

.bg-\[\#3B82F6\] { --tw-bg-opacity: 1; background-color: rgb(59 130 246/var=
(--tw-bg-opacity)); }

.bg-\[\#4a5568\] { --tw-bg-opacity: 1; background-color: rgb(74 85 104/var(=
--tw-bg-opacity)); }

.bg-\[\#4ade80\] { --tw-bg-opacity: 1; background-color: rgb(74 222 128/var=
(--tw-bg-opacity)); }

.bg-\[\#CBCADB\] { --tw-bg-opacity: 1; background-color: rgb(203 202 219/va=
r(--tw-bg-opacity)); }

.bg-\[\#F5DB9A\] { --tw-bg-opacity: 1; background-color: rgb(245 219 154/va=
r(--tw-bg-opacity)); }

.bg-\[\#febc2e\] { --tw-bg-opacity: 1; background-color: rgb(254 188 46/var=
(--tw-bg-opacity)); }

.bg-\[\#ff5f57\] { --tw-bg-opacity: 1; background-color: rgb(255 95 87/var(=
--tw-bg-opacity)); }

.bg-\[hsl\(210\,70\%\,50\%\)\]\/10 { background-color: rgba(38, 128, 217, 0=
.1); }

.bg-\[hsl\(var\(--always-white\)\/80\%\)\] { background-color: hsl(var(--al=
ways-white)/80%); }

.bg-\[hsla\(130\,35\%\,88\%\,0\.45\)\] { background-color: rgba(214, 235, 2=
17, 0.45); }

.bg-\[rgba\(212\,165\,116\,0\.2\)\] { background-color: rgba(212, 165, 116,=
 0.2); }

.bg-\[rgba\(34\,197\,94\,0\.15\)\] { background-color: rgba(34, 197, 94, 0.=
15); }

.bg-accent-brand { --tw-bg-opacity: 1; background-color: hsl(var(--accent-b=
rand)/var(--tw-bg-opacity)); }

.bg-accent-main-000 { --tw-bg-opacity: 1; background-color: hsl(var(--accen=
t-main-000)/var(--tw-bg-opacity)); }

.bg-accent-main-000\/10 { background-color: hsl(var(--accent-main-000)/.1);=
 }

.bg-accent-main-100 { --tw-bg-opacity: 1; background-color: hsl(var(--accen=
t-main-100)/var(--tw-bg-opacity)); }

.bg-accent-main-100\/10 { background-color: hsl(var(--accent-main-100)/.1);=
 }

.bg-accent-main-100\/20 { background-color: hsl(var(--accent-main-100)/.2);=
 }

.bg-accent-main-100\/30 { background-color: hsl(var(--accent-main-100)/.3);=
 }

.bg-accent-main-100\/5 { background-color: hsl(var(--accent-main-100)/.05);=
 }

.bg-accent-main-200 { --tw-bg-opacity: 1; background-color: hsl(var(--accen=
t-main-200)/var(--tw-bg-opacity)); }

.bg-accent-main-900 { --tw-bg-opacity: 1; background-color: hsl(var(--accen=
t-main-900)/var(--tw-bg-opacity)); }

.bg-accent-main-900\/20 { background-color: hsl(var(--accent-main-900)/.2);=
 }

.bg-accent-pro-000 { --tw-bg-opacity: 1; background-color: hsl(var(--accent=
-pro-000)/var(--tw-bg-opacity)); }

.bg-accent-pro-100 { --tw-bg-opacity: 1; background-color: hsl(var(--accent=
-pro-100)/var(--tw-bg-opacity)); }

.bg-accent-pro-100\/10 { background-color: hsl(var(--accent-pro-100)/.1); }

.bg-accent-pro-100\/5 { background-color: hsl(var(--accent-pro-100)/.05); }

.bg-accent-pro-100\/90 { background-color: hsl(var(--accent-pro-100)/.9); }

.bg-accent-pro-900 { --tw-bg-opacity: 1; background-color: hsl(var(--accent=
-pro-900)/var(--tw-bg-opacity)); }

.bg-accent-secondary-000 { --tw-bg-opacity: 1; background-color: hsl(var(--=
accent-secondary-000)/var(--tw-bg-opacity)); }

.bg-accent-secondary-000\/10 { background-color: hsl(var(--accent-secondary=
-000)/.1); }

.bg-accent-secondary-000\/5 { background-color: hsl(var(--accent-secondary-=
000)/.05); }

.bg-accent-secondary-100 { --tw-bg-opacity: 1; background-color: hsl(var(--=
accent-secondary-100)/var(--tw-bg-opacity)); }

.bg-accent-secondary-100\/10 { background-color: hsl(var(--accent-secondary=
-100)/.1); }

.bg-accent-secondary-100\/20 { background-color: hsl(var(--accent-secondary=
-100)/.2); }

.bg-accent-secondary-100\/30 { background-color: hsl(var(--accent-secondary=
-100)/.3); }

.bg-accent-secondary-100\/50 { background-color: hsl(var(--accent-secondary=
-100)/.5); }

.bg-accent-secondary-100\/\[8\%\] { background-color: hsl(var(--accent-seco=
ndary-100)/8%); }

.bg-accent-secondary-200 { --tw-bg-opacity: 1; background-color: hsl(var(--=
accent-secondary-200)/var(--tw-bg-opacity)); }

.bg-accent-secondary-200\/10 { background-color: hsl(var(--accent-secondary=
-200)/.1); }

.bg-accent-secondary-900 { --tw-bg-opacity: 1; background-color: hsl(var(--=
accent-secondary-900)/var(--tw-bg-opacity)); }

.bg-accent-secondary-900\/40 { background-color: hsl(var(--accent-secondary=
-900)/.4); }

.bg-accent-secondary-900\/50 { background-color: hsl(var(--accent-secondary=
-900)/.5); }

.bg-accent-secondary-900\/75 { background-color: hsl(var(--accent-secondary=
-900)/.75); }

.bg-always-black { --tw-bg-opacity: 1; background-color: hsl(var(--always-b=
lack)/var(--tw-bg-opacity)); }

.bg-always-black\/10 { background-color: hsl(var(--always-black)/.1); }

.bg-always-black\/20 { background-color: hsl(var(--always-black)/.2); }

.bg-always-black\/30 { background-color: hsl(var(--always-black)/.3); }

.bg-always-black\/50 { background-color: hsl(var(--always-black)/.5); }

.bg-always-black\/75 { background-color: hsl(var(--always-black)/.75); }

.bg-always-black\/80 { background-color: hsl(var(--always-black)/.8); }

.bg-always-black\/\[5\%\] { background-color: hsl(var(--always-black)/5%); =
}

.bg-always-white { --tw-bg-opacity: 1; background-color: hsl(var(--always-w=
hite)/var(--tw-bg-opacity)); }

.bg-always-white\/20 { background-color: hsl(var(--always-white)/.2); }

.bg-always-white\/50 { background-color: hsl(var(--always-white)/.5); }

.bg-bg-000 { --tw-bg-opacity: 1; background-color: hsl(var(--bg-000)/var(--=
tw-bg-opacity)); }

.bg-bg-000\/20 { background-color: hsl(var(--bg-000)/.2); }

.bg-bg-000\/25 { background-color: hsl(var(--bg-000)/.25); }

.bg-bg-000\/30 { background-color: hsl(var(--bg-000)/.3); }

.bg-bg-000\/50 { background-color: hsl(var(--bg-000)/.5); }

.bg-bg-000\/60 { background-color: hsl(var(--bg-000)/.6); }

.bg-bg-000\/70 { background-color: hsl(var(--bg-000)/.7); }

.bg-bg-000\/80 { background-color: hsl(var(--bg-000)/.8); }

.bg-bg-000\/85 { background-color: hsl(var(--bg-000)/.85); }

.bg-bg-000\/90 { background-color: hsl(var(--bg-000)/.9); }

.bg-bg-000\/95 { background-color: hsl(var(--bg-000)/.95); }

.bg-bg-000\/\[10\%\] { background-color: hsl(var(--bg-000)/10%); }

.bg-bg-000\/\[98\%\] { background-color: hsl(var(--bg-000)/98%); }

.bg-bg-100 { --tw-bg-opacity: 1; background-color: hsl(var(--bg-100)/var(--=
tw-bg-opacity)); }

.bg-bg-100\/20 { background-color: hsl(var(--bg-100)/.2); }

.bg-bg-100\/5 { background-color: hsl(var(--bg-100)/.05); }

.bg-bg-100\/50 { background-color: hsl(var(--bg-100)/.5); }

.bg-bg-100\/60 { background-color: hsl(var(--bg-100)/.6); }

.bg-bg-100\/80 { background-color: hsl(var(--bg-100)/.8); }

.bg-bg-100\/90 { background-color: hsl(var(--bg-100)/.9); }

.bg-bg-100\/95 { background-color: hsl(var(--bg-100)/.95); }

.bg-bg-200 { --tw-bg-opacity: 1; background-color: hsl(var(--bg-200)/var(--=
tw-bg-opacity)); }

.bg-bg-200\/20 { background-color: hsl(var(--bg-200)/.2); }

.bg-bg-200\/50 { background-color: hsl(var(--bg-200)/.5); }

.bg-bg-200\/60 { background-color: hsl(var(--bg-200)/.6); }

.bg-bg-200\/70 { background-color: hsl(var(--bg-200)/.7); }

.bg-bg-200\/80 { background-color: hsl(var(--bg-200)/.8); }

.bg-bg-300 { --tw-bg-opacity: 1; background-color: hsl(var(--bg-300)/var(--=
tw-bg-opacity)); }

.bg-bg-300\/30 { background-color: hsl(var(--bg-300)/.3); }

.bg-bg-300\/50 { background-color: hsl(var(--bg-300)/.5); }

.bg-bg-300\/60 { background-color: hsl(var(--bg-300)/.6); }

.bg-bg-300\/80 { background-color: hsl(var(--bg-300)/.8); }

.bg-bg-300\/90 { background-color: hsl(var(--bg-300)/.9); }

.bg-bg-400 { --tw-bg-opacity: 1; background-color: hsl(var(--bg-400)/var(--=
tw-bg-opacity)); }

.bg-bg-400\/50 { background-color: hsl(var(--bg-400)/.5); }

.bg-bg-500 { --tw-bg-opacity: 1; background-color: hsl(var(--bg-500)/var(--=
tw-bg-opacity)); }

.bg-bg-500\/10 { background-color: hsl(var(--bg-500)/.1); }

.bg-bg-500\/20 { background-color: hsl(var(--bg-500)/.2); }

.bg-bg-500\/25 { background-color: hsl(var(--bg-500)/.25); }

.bg-bg-500\/40 { background-color: hsl(var(--bg-500)/.4); }

.bg-bg-500\/70 { background-color: hsl(var(--bg-500)/.7); }

.bg-bg-500\/80 { background-color: hsl(var(--bg-500)/.8); }

.bg-border-100 { background-color: hsl(var(--border-100)/.4); }

.bg-border-200 { background-color: hsl(var(--border-200)/.3); }

.bg-border-300 { background-color: hsl(var(--border-300)/.15); }

.bg-border-300\/20 { background-color: hsl(var(--border-300)/.2); }

.bg-border-300\/60 { background-color: hsl(var(--border-300)/.6); }

.bg-border-400 { background-color: hsl(var(--border-400)/.15); }

.bg-border-400\/\[0\.03\] { background-color: hsl(var(--border-400)/.03); }

.bg-current { background-color: currentcolor; }

.bg-danger-000 { --tw-bg-opacity: 1; background-color: hsl(var(--danger-000=
)/var(--tw-bg-opacity)); }

.bg-danger-000\/10 { background-color: hsl(var(--danger-000)/.1); }

.bg-danger-000\/30 { background-color: hsl(var(--danger-000)/.3); }

.bg-danger-100 { --tw-bg-opacity: 1; background-color: hsl(var(--danger-100=
)/var(--tw-bg-opacity)); }

.bg-danger-100\/10 { background-color: hsl(var(--danger-100)/.1); }

.bg-danger-100\/15 { background-color: hsl(var(--danger-100)/.15); }

.bg-danger-100\/20 { background-color: hsl(var(--danger-100)/.2); }

.bg-danger-100\/50 { background-color: hsl(var(--danger-100)/.5); }

.bg-danger-200 { --tw-bg-opacity: 1; background-color: hsl(var(--danger-200=
)/var(--tw-bg-opacity)); }

.bg-danger-200\/5 { background-color: hsl(var(--danger-200)/.05); }

.bg-danger-900 { --tw-bg-opacity: 1; background-color: hsl(var(--danger-900=
)/var(--tw-bg-opacity)); }

.bg-danger-900\/20 { background-color: hsl(var(--danger-900)/.2); }

.bg-danger-900\/25 { background-color: hsl(var(--danger-900)/.25); }

.bg-danger-900\/45 { background-color: hsl(var(--danger-900)/.45); }

.bg-inherit { background-color: inherit; }

.bg-oncolor-100\/10 { background-color: hsl(var(--oncolor-100)/.1); }

.bg-success-000 { --tw-bg-opacity: 1; background-color: hsl(var(--success-0=
00)/var(--tw-bg-opacity)); }

.bg-success-100 { --tw-bg-opacity: 1; background-color: hsl(var(--success-1=
00)/var(--tw-bg-opacity)); }

.bg-success-100\/10 { background-color: hsl(var(--success-100)/.1); }

.bg-success-100\/15 { background-color: hsl(var(--success-100)/.15); }

.bg-success-100\/20 { background-color: hsl(var(--success-100)/.2); }

.bg-success-900 { --tw-bg-opacity: 1; background-color: hsl(var(--success-9=
00)/var(--tw-bg-opacity)); }

.bg-text-000 { --tw-bg-opacity: 1; background-color: hsl(var(--text-000)/va=
r(--tw-bg-opacity)); }

.bg-text-100 { --tw-bg-opacity: 1; background-color: hsl(var(--text-100)/va=
r(--tw-bg-opacity)); }

.bg-text-100\/30 { background-color: hsl(var(--text-100)/.3); }

.bg-text-100\/80 { background-color: hsl(var(--text-100)/.8); }

.bg-text-200 { --tw-bg-opacity: 1; background-color: hsl(var(--text-200)/va=
r(--tw-bg-opacity)); }

.bg-text-200\/5 { background-color: hsl(var(--text-200)/.05); }

.bg-text-300 { --tw-bg-opacity: 1; background-color: hsl(var(--text-300)/va=
r(--tw-bg-opacity)); }

.bg-text-300\/5 { background-color: hsl(var(--text-300)/.05); }

.bg-text-400 { --tw-bg-opacity: 1; background-color: hsl(var(--text-400)/va=
r(--tw-bg-opacity)); }

.bg-text-500 { --tw-bg-opacity: 1; background-color: hsl(var(--text-500)/va=
r(--tw-bg-opacity)); }

.bg-text-500\/10 { background-color: hsl(var(--text-500)/.1); }

.bg-text-500\/15 { background-color: hsl(var(--text-500)/.15); }

.bg-text-500\/20 { background-color: hsl(var(--text-500)/.2); }

.bg-text-500\/30 { background-color: hsl(var(--text-500)/.3); }

.bg-text-500\/50 { background-color: hsl(var(--text-500)/.5); }

.bg-transparent { background-color: transparent; }

.bg-warning-000 { --tw-bg-opacity: 1; background-color: hsl(var(--warning-0=
00)/var(--tw-bg-opacity)); }

.bg-warning-000\/10 { background-color: hsl(var(--warning-000)/.1); }

.bg-warning-100 { --tw-bg-opacity: 1; background-color: hsl(var(--warning-1=
00)/var(--tw-bg-opacity)); }

.bg-warning-100\/10 { background-color: hsl(var(--warning-100)/.1); }

.bg-warning-100\/50 { background-color: hsl(var(--warning-100)/.5); }

.bg-warning-200 { --tw-bg-opacity: 1; background-color: hsl(var(--warning-2=
00)/var(--tw-bg-opacity)); }

.bg-warning-900 { --tw-bg-opacity: 1; background-color: hsl(var(--warning-9=
00)/var(--tw-bg-opacity)); }

.bg-white { --tw-bg-opacity: 1; background-color: rgb(255 255 255/var(--tw-=
bg-opacity)); }

.bg-opacity-0 { --tw-bg-opacity: 0; }

.bg-opacity-10 { --tw-bg-opacity: 0.1; }

.bg-opacity-20 { --tw-bg-opacity: 0.2; }

.bg-opacity-5 { --tw-bg-opacity: 0.05; }

.bg-opacity-50 { --tw-bg-opacity: 0.5; }

.bg-opacity-80 { --tw-bg-opacity: 0.8; }

.\!bg-gradient-to-b { background-image: linear-gradient(to bottom,var(--tw-=
gradient-stops)) !important; }

.bg-\[radial-gradient\(ellipse\,_var\(--tw-gradient-stops\)\)\] { backgroun=
d-image: radial-gradient(ellipse,var(--tw-gradient-stops)); }

.bg-gradient-to-b { background-image: linear-gradient(to bottom,var(--tw-gr=
adient-stops)); }

.bg-gradient-to-bl { background-image: linear-gradient(to bottom left,var(-=
-tw-gradient-stops)); }

.bg-gradient-to-br { background-image: linear-gradient(to bottom right,var(=
--tw-gradient-stops)); }

.bg-gradient-to-l { background-image: linear-gradient(to left,var(--tw-grad=
ient-stops)); }

.bg-gradient-to-r { background-image: linear-gradient(to right,var(--tw-gra=
dient-stops)); }

.bg-gradient-to-t { background-image: linear-gradient(to top,var(--tw-gradi=
ent-stops)); }

.bg-none { background-image: none; }

.from-\[\#dc6038\] { --tw-gradient-from: #dc6038 var(--tw-gradient-from-pos=
ition); --tw-gradient-to: rgb(220 96 56/0) var(--tw-gradient-to-position); =
--tw-gradient-stops: var(--tw-gradient-from),var(--tw-gradient-to); }

.from-accent-brand { --tw-gradient-from: hsl(var(--accent-brand)/1) var(--t=
w-gradient-from-position); --tw-gradient-to: hsl(var(--accent-brand)/0) var=
(--tw-gradient-to-position); --tw-gradient-stops: var(--tw-gradient-from),v=
ar(--tw-gradient-to); }

.from-accent-main-200\/50 { --tw-gradient-from: hsl(var(--accent-main-200)/=
0.5) var(--tw-gradient-from-position); --tw-gradient-to: hsl(var(--accent-m=
ain-200)/0) var(--tw-gradient-to-position); --tw-gradient-stops: var(--tw-g=
radient-from),var(--tw-gradient-to); }

.from-accent-main-200\/70 { --tw-gradient-from: hsl(var(--accent-main-200)/=
0.7) var(--tw-gradient-from-position); --tw-gradient-to: hsl(var(--accent-m=
ain-200)/0) var(--tw-gradient-to-position); --tw-gradient-stops: var(--tw-g=
radient-from),var(--tw-gradient-to); }

.from-accent-pro-200 { --tw-gradient-from: hsl(var(--accent-pro-200)/1) var=
(--tw-gradient-from-position); --tw-gradient-to: hsl(var(--accent-pro-200)/=
0) var(--tw-gradient-to-position); --tw-gradient-stops: var(--tw-gradient-f=
rom),var(--tw-gradient-to); }

.from-accent-pro-900\/20 { --tw-gradient-from: hsl(var(--accent-pro-900)/0.=
2) var(--tw-gradient-from-position); --tw-gradient-to: hsl(var(--accent-pro=
-900)/0) var(--tw-gradient-to-position); --tw-gradient-stops: var(--tw-grad=
ient-from),var(--tw-gradient-to); }

.from-accent-secondary-100\/0 { --tw-gradient-from: hsl(var(--accent-second=
ary-100)/0) var(--tw-gradient-from-position); --tw-gradient-to: hsl(var(--a=
ccent-secondary-100)/0) var(--tw-gradient-to-position); --tw-gradient-stops=
: var(--tw-gradient-from),var(--tw-gradient-to); }

.from-accent-secondary-200\/5 { --tw-gradient-from: hsl(var(--accent-second=
ary-200)/0.05) var(--tw-gradient-from-position); --tw-gradient-to: hsl(var(=
--accent-secondary-200)/0) var(--tw-gradient-to-position); --tw-gradient-st=
ops: var(--tw-gradient-from),var(--tw-gradient-to); }

.from-accent-secondary-200\/\[0\.01\] { --tw-gradient-from: hsl(var(--accen=
t-secondary-200)/0.01) var(--tw-gradient-from-position); --tw-gradient-to: =
hsl(var(--accent-secondary-200)/0) var(--tw-gradient-to-position); --tw-gra=
dient-stops: var(--tw-gradient-from),var(--tw-gradient-to); }

.from-accent-secondary-900\/0 { --tw-gradient-from: hsl(var(--accent-second=
ary-900)/0) var(--tw-gradient-from-position); --tw-gradient-to: hsl(var(--a=
ccent-secondary-900)/0) var(--tw-gradient-to-position); --tw-gradient-stops=
: var(--tw-gradient-from),var(--tw-gradient-to); }

.from-accent-secondary-900\/50 { --tw-gradient-from: hsl(var(--accent-secon=
dary-900)/0.5) var(--tw-gradient-from-position); --tw-gradient-to: hsl(var(=
--accent-secondary-900)/0) var(--tw-gradient-to-position); --tw-gradient-st=
ops: var(--tw-gradient-from),var(--tw-gradient-to); }

.from-accent-secondary-900\/75 { --tw-gradient-from: hsl(var(--accent-secon=
dary-900)/0.75) var(--tw-gradient-from-position); --tw-gradient-to: hsl(var=
(--accent-secondary-900)/0) var(--tw-gradient-to-position); --tw-gradient-s=
tops: var(--tw-gradient-from),var(--tw-gradient-to); }

.from-always-black\/0 { --tw-gradient-from: hsl(var(--always-black)/0) var(=
--tw-gradient-from-position); --tw-gradient-to: hsl(var(--always-black)/0) =
var(--tw-gradient-to-position); --tw-gradient-stops: var(--tw-gradient-from=
),var(--tw-gradient-to); }

.from-bg-000 { --tw-gradient-from: hsl(var(--bg-000)/1) var(--tw-gradient-f=
rom-position); --tw-gradient-to: hsl(var(--bg-000)/0) var(--tw-gradient-to-=
position); --tw-gradient-stops: var(--tw-gradient-from),var(--tw-gradient-t=
o); }

.from-bg-000\/50 { --tw-gradient-from: hsl(var(--bg-000)/0.5) var(--tw-grad=
ient-from-position); --tw-gradient-to: hsl(var(--bg-000)/0) var(--tw-gradie=
nt-to-position); --tw-gradient-stops: var(--tw-gradient-from),var(--tw-grad=
ient-to); }

.from-bg-100 { --tw-gradient-from: hsl(var(--bg-100)/1) var(--tw-gradient-f=
rom-position); --tw-gradient-to: hsl(var(--bg-100)/0) var(--tw-gradient-to-=
position); --tw-gradient-stops: var(--tw-gradient-from),var(--tw-gradient-t=
o); }

.from-bg-200 { --tw-gradient-from: hsl(var(--bg-200)/1) var(--tw-gradient-f=
rom-position); --tw-gradient-to: hsl(var(--bg-200)/0) var(--tw-gradient-to-=
position); --tw-gradient-stops: var(--tw-gradient-from),var(--tw-gradient-t=
o); }

.from-bg-200\/5 { --tw-gradient-from: hsl(var(--bg-200)/0.05) var(--tw-grad=
ient-from-position); --tw-gradient-to: hsl(var(--bg-200)/0) var(--tw-gradie=
nt-to-position); --tw-gradient-stops: var(--tw-gradient-from),var(--tw-grad=
ient-to); }

.from-bg-300 { --tw-gradient-from: hsl(var(--bg-300)/1) var(--tw-gradient-f=
rom-position); --tw-gradient-to: hsl(var(--bg-300)/0) var(--tw-gradient-to-=
position); --tw-gradient-stops: var(--tw-gradient-from),var(--tw-gradient-t=
o); }

.from-bg-300\/0 { --tw-gradient-from: hsl(var(--bg-300)/0) var(--tw-gradien=
t-from-position); --tw-gradient-to: hsl(var(--bg-300)/0) var(--tw-gradient-=
to-position); --tw-gradient-stops: var(--tw-gradient-from),var(--tw-gradien=
t-to); }

.from-bg-400\/10 { --tw-gradient-from: hsl(var(--bg-400)/0.1) var(--tw-grad=
ient-from-position); --tw-gradient-to: hsl(var(--bg-400)/0) var(--tw-gradie=
nt-to-position); --tw-gradient-stops: var(--tw-gradient-from),var(--tw-grad=
ient-to); }

.from-bg-500\/10 { --tw-gradient-from: hsl(var(--bg-500)/0.1) var(--tw-grad=
ient-from-position); --tw-gradient-to: hsl(var(--bg-500)/0) var(--tw-gradie=
nt-to-position); --tw-gradient-stops: var(--tw-gradient-from),var(--tw-grad=
ient-to); }

.from-bg-500\/30 { --tw-gradient-from: hsl(var(--bg-500)/0.3) var(--tw-grad=
ient-from-position); --tw-gradient-to: hsl(var(--bg-500)/0) var(--tw-gradie=
nt-to-position); --tw-gradient-stops: var(--tw-gradient-from),var(--tw-grad=
ient-to); }

.from-text-100 { --tw-gradient-from: hsl(var(--text-100)/1) var(--tw-gradie=
nt-from-position); --tw-gradient-to: hsl(var(--text-100)/0) var(--tw-gradie=
nt-to-position); --tw-gradient-stops: var(--tw-gradient-from),var(--tw-grad=
ient-to); }

.from-text-200 { --tw-gradient-from: hsl(var(--text-200)/1) var(--tw-gradie=
nt-from-position); --tw-gradient-to: hsl(var(--text-200)/0) var(--tw-gradie=
nt-to-position); --tw-gradient-stops: var(--tw-gradient-from),var(--tw-grad=
ient-to); }

.from-text-300 { --tw-gradient-from: hsl(var(--text-300)/1) var(--tw-gradie=
nt-from-position); --tw-gradient-to: hsl(var(--text-300)/0) var(--tw-gradie=
nt-to-position); --tw-gradient-stops: var(--tw-gradient-from),var(--tw-grad=
ient-to); }

.from-text-400 { --tw-gradient-from: hsl(var(--text-400)/1) var(--tw-gradie=
nt-from-position); --tw-gradient-to: hsl(var(--text-400)/0) var(--tw-gradie=
nt-to-position); --tw-gradient-stops: var(--tw-gradient-from),var(--tw-grad=
ient-to); }

.from-transparent { --tw-gradient-from: transparent var(--tw-gradient-from-=
position); --tw-gradient-to: rgb(0 0 0/0) var(--tw-gradient-to-position); -=
-tw-gradient-stops: var(--tw-gradient-from),var(--tw-gradient-to); }

.from-30\% { --tw-gradient-from-position: 30%; }

.from-50\% { --tw-gradient-from-position: 50%; }

.via-accent-secondary-900\/100 { --tw-gradient-to: hsl(var(--accent-seconda=
ry-900)/0) var(--tw-gradient-to-position); --tw-gradient-stops: var(--tw-gr=
adient-from),hsl(var(--accent-secondary-900)/1) var(--tw-gradient-via-posit=
ion),var(--tw-gradient-to); }

.via-always-white\/20 { --tw-gradient-to: hsl(var(--always-white)/0) var(--=
tw-gradient-to-position); --tw-gradient-stops: var(--tw-gradient-from),hsl(=
var(--always-white)/0.2) var(--tw-gradient-via-position),var(--tw-gradient-=
to); }

.via-always-white\/70 { --tw-gradient-to: hsl(var(--always-white)/0) var(--=
tw-gradient-to-position); --tw-gradient-stops: var(--tw-gradient-from),hsl(=
var(--always-white)/0.7) var(--tw-gradient-via-position),var(--tw-gradient-=
to); }

.via-bg-000\/80 { --tw-gradient-to: hsl(var(--bg-000)/0) var(--tw-gradient-=
to-position); --tw-gradient-stops: var(--tw-gradient-from),hsl(var(--bg-000=
)/0.8) var(--tw-gradient-via-position),var(--tw-gradient-to); }

.via-bg-000\/90 { --tw-gradient-to: hsl(var(--bg-000)/0) var(--tw-gradient-=
to-position); --tw-gradient-stops: var(--tw-gradient-from),hsl(var(--bg-000=
)/0.9) var(--tw-gradient-via-position),var(--tw-gradient-to); }

.via-bg-100 { --tw-gradient-to: hsl(var(--bg-100)/0) var(--tw-gradient-to-p=
osition); --tw-gradient-stops: var(--tw-gradient-from),hsl(var(--bg-100)/1)=
 var(--tw-gradient-via-position),var(--tw-gradient-to); }

.via-bg-300\/80 { --tw-gradient-to: hsl(var(--bg-300)/0) var(--tw-gradient-=
to-position); --tw-gradient-stops: var(--tw-gradient-from),hsl(var(--bg-300=
)/0.8) var(--tw-gradient-via-position),var(--tw-gradient-to); }

.via-30\% { --tw-gradient-via-position: 30%; }

.via-65\% { --tw-gradient-via-position: 65%; }

.via-70\% { --tw-gradient-via-position: 70%; }

.via-80\% { --tw-gradient-via-position: 80%; }

.to-\[\#d97757\] { --tw-gradient-to: #d97757 var(--tw-gradient-to-position)=
; }

.to-accent-brand { --tw-gradient-to: hsl(var(--accent-brand)/1) var(--tw-gr=
adient-to-position); }

.to-accent-main-100 { --tw-gradient-to: hsl(var(--accent-main-100)/1) var(-=
-tw-gradient-to-position); }

.to-accent-main-200\/0 { --tw-gradient-to: hsl(var(--accent-main-200)/0) va=
r(--tw-gradient-to-position); }

.to-accent-pro-100 { --tw-gradient-to: hsl(var(--accent-pro-100)/1) var(--t=
w-gradient-to-position); }

.to-accent-pro-900\/50 { --tw-gradient-to: hsl(var(--accent-pro-900)/0.5) v=
ar(--tw-gradient-to-position); }

.to-accent-secondary-100\/5 { --tw-gradient-to: hsl(var(--accent-secondary-=
100)/0.05) var(--tw-gradient-to-position); }

.to-accent-secondary-200\/\[0\.02\] { --tw-gradient-to: hsl(var(--accent-se=
condary-200)/0.02) var(--tw-gradient-to-position); }

.to-accent-secondary-200\/\[0\.04\] { --tw-gradient-to: hsl(var(--accent-se=
condary-200)/0.04) var(--tw-gradient-to-position); }

.to-accent-secondary-900\/10 { --tw-gradient-to: hsl(var(--accent-secondary=
-900)/0.1) var(--tw-gradient-to-position); }

.to-accent-secondary-900\/100 { --tw-gradient-to: hsl(var(--accent-secondar=
y-900)/1) var(--tw-gradient-to-position); }

.to-accent-secondary-900\/25 { --tw-gradient-to: hsl(var(--accent-secondary=
-900)/0.25) var(--tw-gradient-to-position); }

.to-always-black\/5 { --tw-gradient-to: hsl(var(--always-black)/0.05) var(-=
-tw-gradient-to-position); }

.to-bg-000\/0 { --tw-gradient-to: hsl(var(--bg-000)/0) var(--tw-gradient-to=
-position); }

.to-bg-000\/20 { --tw-gradient-to: hsl(var(--bg-000)/0.2) var(--tw-gradient=
-to-position); }

.to-bg-000\/75 { --tw-gradient-to: hsl(var(--bg-000)/0.75) var(--tw-gradien=
t-to-position); }

.to-bg-100 { --tw-gradient-to: hsl(var(--bg-100)/1) var(--tw-gradient-to-po=
sition); }

.to-bg-100\/0 { --tw-gradient-to: hsl(var(--bg-100)/0) var(--tw-gradient-to=
-position); }

.to-bg-100\/30 { --tw-gradient-to: hsl(var(--bg-100)/0.3) var(--tw-gradient=
-to-position); }

.to-bg-200 { --tw-gradient-to: hsl(var(--bg-200)/1) var(--tw-gradient-to-po=
sition); }

.to-bg-200\/30 { --tw-gradient-to: hsl(var(--bg-200)/0.3) var(--tw-gradient=
-to-position); }

.to-bg-300 { --tw-gradient-to: hsl(var(--bg-300)/1) var(--tw-gradient-to-po=
sition); }

.to-bg-300\/50 { --tw-gradient-to: hsl(var(--bg-300)/0.5) var(--tw-gradient=
-to-position); }

.to-bg-400\/30 { --tw-gradient-to: hsl(var(--bg-400)/0.3) var(--tw-gradient=
-to-position); }

.to-bg-500\/30 { --tw-gradient-to: hsl(var(--bg-500)/0.3) var(--tw-gradient=
-to-position); }

.to-bg-500\/70 { --tw-gradient-to: hsl(var(--bg-500)/0.7) var(--tw-gradient=
-to-position); }

.to-text-200 { --tw-gradient-to: hsl(var(--text-200)/1) var(--tw-gradient-t=
o-position); }

.to-text-300 { --tw-gradient-to: hsl(var(--text-300)/1) var(--tw-gradient-t=
o-position); }

.to-text-400 { --tw-gradient-to: hsl(var(--text-400)/1) var(--tw-gradient-t=
o-position); }

.to-transparent { --tw-gradient-to: transparent var(--tw-gradient-to-positi=
on); }

.to-60\% { --tw-gradient-to-position: 60%; }

.to-80\% { --tw-gradient-to-position: 80%; }

.bg-\[length\:400\%_100\%\] { background-size: 400% 100%; }

.bg-clip-padding { background-clip: padding-box; }

.bg-clip-text { background-clip: text; }

.bg-no-repeat { background-repeat: no-repeat; }

.fill-\[\#BCD1CA\] { fill: rgb(188, 209, 202); }

.fill-accent-brand { fill: hsl(var(--accent-brand)/1); }

.fill-accent-secondary-100\/50 { fill: hsl(var(--accent-secondary-100)/.5);=
 }

.fill-accent-secondary-900 { fill: hsl(var(--accent-secondary-900)/1); }

.fill-bg-000 { fill: hsl(var(--bg-000)/1); }

.fill-bg-100 { fill: hsl(var(--bg-100)/1); }

.fill-bg-200 { fill: hsl(var(--bg-200)/1); }

.fill-bg-300 { fill: hsl(var(--bg-300)/1); }

.fill-border-300 { fill: hsl(var(--border-300)/.15); }

.fill-current { fill: currentcolor; }

.fill-none { fill: none; }

.fill-pictogram-100 { fill: hsl(var(--pictogram-100)/1); }

.fill-pictogram-200 { fill: hsl(var(--pictogram-200)/1); }

.fill-pictogram-300 { fill: hsl(var(--pictogram-300)/1); }

.fill-pictogram-400 { fill: hsl(var(--pictogram-400)/1); }

.fill-text-100 { fill: hsl(var(--text-100)/1); }

.fill-text-200 { fill: hsl(var(--text-200)/1); }

.stroke-none { stroke: none; }

.stroke-text-200 { stroke: hsl(var(--text-200)/1); }

.stroke-text-400 { stroke: hsl(var(--text-400)/1); }

.object-contain { object-fit: contain; }

.object-cover { object-fit: cover; }

.object-center { object-position: center center; }

.object-left-top { object-position: left top; }

.object-right-bottom { object-position: right bottom; }

.object-top { object-position: center top; }

.\!p-0 { padding: 0px !important; }

.\!p-6 { padding: 1.5rem !important; }

.\!p-8 { padding: 2rem !important; }

.p-0 { padding: 0px; }

.p-0\.5 { padding: 0.125rem; }

.p-1 { padding: 0.25rem; }

.p-1\.5 { padding: 0.375rem; }

.p-10 { padding: 2.5rem; }

.p-12 { padding: 3rem; }

.p-2 { padding: 0.5rem; }

.p-2\.5 { padding: 0.625rem; }

.p-3 { padding: 0.75rem; }

.p-3\.5 { padding: 0.875rem; }

.p-32 { padding: 8rem; }

.p-4 { padding: 1rem; }

.p-5 { padding: 1.25rem; }

.p-6 { padding: 1.5rem; }

.p-7 { padding: 1.75rem; }

.p-8 { padding: 2rem; }

.p-\[0\.5px\] { padding: 0.5px; }

.p-\[1px\] { padding: 1px; }

.p-\[2px\] { padding: 2px; }

.p-\[32px\] { padding: 32px; }

.p-\[3px\] { padding: 3px; }

.p-px { padding: 1px; }

.\!px-0 { padding-left: 0px !important; padding-right: 0px !important; }

.\!px-1 { padding-left: 0.25rem !important; padding-right: 0.25rem !importa=
nt; }

.\!px-1\.5 { padding-left: 0.375rem !important; padding-right: 0.375rem !im=
portant; }

.\!px-12 { padding-left: 3rem !important; padding-right: 3rem !important; }

.\!px-2 { padding-left: 0.5rem !important; padding-right: 0.5rem !important=
; }

.\!px-3 { padding-left: 0.75rem !important; padding-right: 0.75rem !importa=
nt; }

.\!px-4 { padding-left: 1rem !important; padding-right: 1rem !important; }

.\!px-6 { padding-left: 1.5rem !important; padding-right: 1.5rem !important=
; }

.\!px-8 { padding-left: 2rem !important; padding-right: 2rem !important; }

.\!py-0 { padding-top: 0px !important; padding-bottom: 0px !important; }

.\!py-0\.5 { padding-top: 0.125rem !important; padding-bottom: 0.125rem !im=
portant; }

.\!py-1 { padding-top: 0.25rem !important; padding-bottom: 0.25rem !importa=
nt; }

.\!py-3 { padding-top: 0.75rem !important; padding-bottom: 0.75rem !importa=
nt; }

.\!py-3\.5 { padding-top: 0.875rem !important; padding-bottom: 0.875rem !im=
portant; }

.\!py-6 { padding-top: 1.5rem !important; padding-bottom: 1.5rem !important=
; }

.\!py-8 { padding-top: 2rem !important; padding-bottom: 2rem !important; }

.px-0 { padding-left: 0px; padding-right: 0px; }

.px-0\.5 { padding-left: 0.125rem; padding-right: 0.125rem; }

.px-1 { padding-left: 0.25rem; padding-right: 0.25rem; }

.px-1\.5 { padding-left: 0.375rem; padding-right: 0.375rem; }

.px-10 { padding-left: 2.5rem; padding-right: 2.5rem; }

.px-12 { padding-left: 3rem; padding-right: 3rem; }

.px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }

.px-2\.5 { padding-left: 0.625rem; padding-right: 0.625rem; }

.px-24 { padding-left: 6rem; padding-right: 6rem; }

.px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }

.px-3\.5 { padding-left: 0.875rem; padding-right: 0.875rem; }

.px-4 { padding-left: 1rem; padding-right: 1rem; }

.px-5 { padding-left: 1.25rem; padding-right: 1.25rem; }

.px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }

.px-8 { padding-left: 2rem; padding-right: 2rem; }

.px-\[0\.3125rem\] { padding-left: 0.3125rem; padding-right: 0.3125rem; }

.px-\[1\.375rem\] { padding-left: 1.375rem; padding-right: 1.375rem; }

.px-\[10px\] { padding-left: 10px; padding-right: 10px; }

.px-\[4px\] { padding-left: 4px; padding-right: 4px; }

.px-\[8\%\] { padding-left: 8%; padding-right: 8%; }

.py-0 { padding-top: 0px; padding-bottom: 0px; }

.py-0\.5 { padding-top: 0.125rem; padding-bottom: 0.125rem; }

.py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }

.py-1\.5 { padding-top: 0.375rem; padding-bottom: 0.375rem; }

.py-10 { padding-top: 2.5rem; padding-bottom: 2.5rem; }

.py-12 { padding-top: 3rem; padding-bottom: 3rem; }

.py-16 { padding-top: 4rem; padding-bottom: 4rem; }

.py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }

.py-2\.5 { padding-top: 0.625rem; padding-bottom: 0.625rem; }

.py-20 { padding-top: 5rem; padding-bottom: 5rem; }

.py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }

.py-3\.5 { padding-top: 0.875rem; padding-bottom: 0.875rem; }

.py-4 { padding-top: 1rem; padding-bottom: 1rem; }

.py-5 { padding-top: 1.25rem; padding-bottom: 1.25rem; }

.py-6 { padding-top: 1.5rem; padding-bottom: 1.5rem; }

.py-7 { padding-top: 1.75rem; padding-bottom: 1.75rem; }

.py-8 { padding-top: 2rem; padding-bottom: 2rem; }

.py-9 { padding-top: 2.25rem; padding-bottom: 2.25rem; }

.py-\[22px\] { padding-top: 22px; padding-bottom: 22px; }

.py-\[2px\] { padding-top: 2px; padding-bottom: 2px; }

.py-\[3px\] { padding-top: 3px; padding-bottom: 3px; }

.py-\[5\.5px\] { padding-top: 5.5px; padding-bottom: 5.5px; }

.py-\[5px\] { padding-top: 5px; padding-bottom: 5px; }

.py-\[65px\] { padding-top: 65px; padding-bottom: 65px; }

.py-px { padding-top: 1px; padding-bottom: 1px; }

.\!pb-0 { padding-bottom: 0px !important; }

.\!pb-2 { padding-bottom: 0.5rem !important; }

.\!pb-7 { padding-bottom: 1.75rem !important; }

.\!pb-8 { padding-bottom: 2rem !important; }

.\!pl-1 { padding-left: 0.25rem !important; }

.\!pl-1\.5 { padding-left: 0.375rem !important; }

.\!pl-3 { padding-left: 0.75rem !important; }

.\!pr-1 { padding-right: 0.25rem !important; }

.\!pr-2 { padding-right: 0.5rem !important; }

.\!pt-0 { padding-top: 0px !important; }

.\!pt-10 { padding-top: 2.5rem !important; }

.\!pt-5 { padding-top: 1.25rem !important; }

.\!pt-8 { padding-top: 2rem !important; }

.pb-0 { padding-bottom: 0px; }

.pb-0\.5 { padding-bottom: 0.125rem; }

.pb-1 { padding-bottom: 0.25rem; }

.pb-1\.5 { padding-bottom: 0.375rem; }

.pb-10 { padding-bottom: 2.5rem; }

.pb-12 { padding-bottom: 3rem; }

.pb-14 { padding-bottom: 3.5rem; }

.pb-16 { padding-bottom: 4rem; }

.pb-2 { padding-bottom: 0.5rem; }

.pb-2\.5 { padding-bottom: 0.625rem; }

.pb-20 { padding-bottom: 5rem; }

.pb-24 { padding-bottom: 6rem; }

.pb-3 { padding-bottom: 0.75rem; }

.pb-3\.5 { padding-bottom: 0.875rem; }

.pb-32 { padding-bottom: 8rem; }

.pb-4 { padding-bottom: 1rem; }

.pb-5 { padding-bottom: 1.25rem; }

.pb-6 { padding-bottom: 1.5rem; }

.pb-7 { padding-bottom: 1.75rem; }

.pb-8 { padding-bottom: 2rem; }

.pb-\[0\.9rem\] { padding-bottom: 0.9rem; }

.pb-\[3\.75rem\] { padding-bottom: 3.75rem; }

.pb-\[3rem\] { padding-bottom: 3rem; }

.pb-px { padding-bottom: 1px; }

.pe-1 { padding-inline-end: 0.25rem; }

.pl-0 { padding-left: 0px; }

.pl-0\.5 { padding-left: 0.125rem; }

.pl-1 { padding-left: 0.25rem; }

.pl-1\.5 { padding-left: 0.375rem; }

.pl-10 { padding-left: 2.5rem; }

.pl-11 { padding-left: 2.75rem; }

.pl-12 { padding-left: 3rem; }

.pl-16 { padding-left: 4rem; }

.pl-2 { padding-left: 0.5rem; }

.pl-2\.5 { padding-left: 0.625rem; }

.pl-24 { padding-left: 6rem; }

.pl-3 { padding-left: 0.75rem; }

.pl-3\.5 { padding-left: 0.875rem; }

.pl-4 { padding-left: 1rem; }

.pl-5 { padding-left: 1.25rem; }

.pl-6 { padding-left: 1.5rem; }

.pl-7 { padding-left: 1.75rem; }

.pl-8 { padding-left: 2rem; }

.pl-\[1\.5rem\] { padding-left: 1.5rem; }

.pl-\[133px\] { padding-left: 133px; }

.pl-\[5\.5rem\] { padding-left: 5.5rem; }

.pl-\[6px\] { padding-left: 6px; }

.pl-\[clamp\(1\.5rem\,3\.5vw\,3\.125rem\)\] { padding-left: clamp(1.5rem, 3=
.5vw, 3.125rem); }

.pr-0 { padding-right: 0px; }

.pr-0\.5 { padding-right: 0.125rem; }

.pr-1 { padding-right: 0.25rem; }

.pr-1\.5 { padding-right: 0.375rem; }

.pr-10 { padding-right: 2.5rem; }

.pr-12 { padding-right: 3rem; }

.pr-14 { padding-right: 3.5rem; }

.pr-16 { padding-right: 4rem; }

.pr-2 { padding-right: 0.5rem; }

.pr-2\.5 { padding-right: 0.625rem; }

.pr-20 { padding-right: 5rem; }

.pr-3 { padding-right: 0.75rem; }

.pr-3\.5 { padding-right: 0.875rem; }

.pr-4 { padding-right: 1rem; }

.pr-5 { padding-right: 1.25rem; }

.pr-6 { padding-right: 1.5rem; }

.pr-7 { padding-right: 1.75rem; }

.pr-8 { padding-right: 2rem; }

.pr-9 { padding-right: 2.25rem; }

.pr-\[100px\] { padding-right: 100px; }

.pr-\[140px\] { padding-right: 140px; }

.pr-\[18px\] { padding-right: 18px; }

.pr-\[3\.5rem\] { padding-right: 3.5rem; }

.ps-4 { padding-inline-start: 1rem; }

.ps-6 { padding-inline-start: 1.5rem; }

.pt-0 { padding-top: 0px; }

.pt-0\.5 { padding-top: 0.125rem; }

.pt-1 { padding-top: 0.25rem; }

.pt-1\.5 { padding-top: 0.375rem; }

.pt-10 { padding-top: 2.5rem; }

.pt-12 { padding-top: 3rem; }

.pt-16 { padding-top: 4rem; }

.pt-2 { padding-top: 0.5rem; }

.pt-2\.5 { padding-top: 0.625rem; }

.pt-20 { padding-top: 5rem; }

.pt-24 { padding-top: 6rem; }

.pt-3 { padding-top: 0.75rem; }

.pt-3\.5 { padding-top: 0.875rem; }

.pt-4 { padding-top: 1rem; }

.pt-5 { padding-top: 1.25rem; }

.pt-6 { padding-top: 1.5rem; }

.pt-7 { padding-top: 1.75rem; }

.pt-8 { padding-top: 2rem; }

.pt-\[1\.1rem\] { padding-top: 1.1rem; }

.pt-\[10vh\] { padding-top: 10vh; }

.pt-\[5px\] { padding-top: 5px; }

.pt-\[60px\] { padding-top: 60px; }

.pt-\[6px\] { padding-top: 6px; }

.pt-\[72px\] { padding-top: 72px; }

.pt-\[8\%\] { padding-top: 8%; }

.pt-\[clamp\(1\.5rem\,3\.5vw\,3\.125rem\)\] { padding-top: clamp(1.5rem, 3.=
5vw, 3.125rem); }

.pt-px { padding-top: 1px; }

.\!text-left { text-align: left !important; }

.text-left { text-align: left; }

.text-center { text-align: center; }

.text-right { text-align: right; }

.text-start { text-align: start; }

.align-top { vertical-align: top; }

.align-middle { vertical-align: middle; }

.align-\[-0\.125em\] { vertical-align: -0.125em; }

.align-\[1px\] { vertical-align: 1px; }

.font-sans { font-family: var(--font-ui); }

.font-serif { font-family: var(--font-ui-serif); }

.\!text-4xl { font-size: 2.25rem !important; line-height: 2.5rem !important=
; }

.\!text-6xl { font-size: 3.75rem !important; line-height: 1 !important; }

.\!text-\[0\.6875rem\] { font-size: 0.6875rem !important; }

.\!text-base { font-size: 1rem !important; line-height: 1.5rem !important; =
}

.\!text-sm { font-size: 0.875rem !important; line-height: 1.25rem !importan=
t; }

.\!text-xl { font-size: 1.25rem !important; line-height: 1.75rem !important=
; }

.\!text-xs { font-size: 0.75rem !important; line-height: 1rem !important; }

.text-2xl { font-size: 1.5rem; line-height: 2rem; }

.text-3xl { font-size: 1.875rem; line-height: 2.25rem; }

.text-4xl { font-size: 2.25rem; line-height: 2.5rem; }

.text-5xl { font-size: 3rem; line-height: 1; }

.text-\[0\.3rem\] { font-size: 0.3rem; }

.text-\[0\.4rem\] { font-size: 0.4rem; }

.text-\[0\.5625rem\] { font-size: 0.5625rem; }

.text-\[0\.625rem\] { font-size: 0.625rem; }

.text-\[0\.65rem\] { font-size: 0.65rem; }

.text-\[0\.6875rem\] { font-size: 0.6875rem; }

.text-\[0\.6rem\] { font-size: 0.6rem; }

.text-\[0\.75rem\] { font-size: 0.75rem; }

.text-\[0\.8125rem\] { font-size: 0.8125rem; }

.text-\[0\.875rem\] { font-size: 0.875rem; }

.text-\[0\.9375rem\] { font-size: 0.9375rem; }

.text-\[0\.9rem\] { font-size: 0.9rem; }

.text-\[1\.125rem\] { font-size: 1.125rem; }

.text-\[1\.375rem\] { font-size: 1.375rem; }

.text-\[1\.75rem\] { font-size: 1.75rem; }

.text-\[10px\] { font-size: 10px; }

.text-\[11px\] { font-size: 11px; }

.text-\[12px\] { font-size: 12px; }

.text-\[13px\] { font-size: 13px; }

.text-\[14px\] { font-size: 14px; }

.text-\[15px\] { font-size: 15px; }

.text-\[16px\] { font-size: 16px; }

.text-\[17px\] { font-size: 17px; }

.text-\[2\.375rem\] { font-size: 2.375rem; }

.text-\[20px\] { font-size: 20px; }

.text-\[24px\] { font-size: 24px; }

.text-\[28px\] { font-size: 28px; }

.text-\[3\.5rem\] { font-size: 3.5rem; }

.text-\[32px\] { font-size: 32px; }

.text-\[36px\] { font-size: 36px; }

.text-\[38px\] { font-size: 38px; }

.text-\[7px\] { font-size: 7px; }

.text-\[8px\] { font-size: 8px; }

.text-\[9px\] { font-size: 9px; }

.text-base { font-size: 1rem; line-height: 1.5rem; }

.text-lg { font-size: 1.125rem; line-height: 1.75rem; }

.text-sm { font-size: 0.875rem; line-height: 1.25rem; }

.text-xl { font-size: 1.25rem; line-height: 1.75rem; }

.text-xs { font-size: 0.75rem; line-height: 1rem; }

.\!font-medium { font-weight: 500 !important; }

.\!font-normal { font-weight: 400 !important; }

.\!font-semibold { font-weight: 600 !important; }

.font-\[450\] { font-weight: 450; }

.font-black { font-weight: 900; }

.font-bold { font-weight: 700; }

.font-extrabold { font-weight: 800; }

.font-extralight { font-weight: 200; }

.font-light { font-weight: 300; }

.font-medium { font-weight: 500; }

.font-normal { font-weight: 400; }

.font-semibold { font-weight: 600; }

.font-thin { font-weight: 100; }

.uppercase { text-transform: uppercase; }

.lowercase { text-transform: lowercase; }

.capitalize { text-transform: capitalize; }

.\!normal-case { text-transform: none !important; }

.italic { font-style: italic; }

.ordinal { --tw-ordinal: ordinal; }

.lining-nums, .ordinal { font-variant-numeric: var(--tw-ordinal) var(--tw-s=
lashed-zero) var(--tw-numeric-figure) var(--tw-numeric-spacing) var(--tw-nu=
meric-fraction); }

.lining-nums { --tw-numeric-figure: lining-nums; }

.proportional-nums { --tw-numeric-spacing: proportional-nums; }

.proportional-nums, .tabular-nums { font-variant-numeric: var(--tw-ordinal)=
 var(--tw-slashed-zero) var(--tw-numeric-figure) var(--tw-numeric-spacing) =
var(--tw-numeric-fraction); }

.tabular-nums { --tw-numeric-spacing: tabular-nums; }

.\!leading-4 { line-height: 1rem !important; }

.\!leading-relaxed { line-height: 1.625 !important; }

.leading-3 { line-height: 0.75rem; }

.leading-4 { line-height: 1rem; }

.leading-5 { line-height: 1.25rem; }

.leading-6 { line-height: 1.5rem; }

.leading-7 { line-height: 1.75rem; }

.leading-\[0\.8rem\] { line-height: 0.8rem; }

.leading-\[0\.9em\] { line-height: 0.9em; }

.leading-\[1\.2\] { line-height: 1.2; }

.leading-\[1\.3\] { line-height: 1.3; }

.leading-\[1\.40\], .leading-\[1\.4\] { line-height: 1.4; }

.leading-\[1\.65rem\] { line-height: 1.65rem; }

.leading-\[1\.6\] { line-height: 1.6; }

.leading-\[1\.7\] { line-height: 1.7; }

.leading-\[109\%\] { line-height: 109%; }

.leading-\[130\%\] { line-height: 130%; }

.leading-\[13px\] { line-height: 13px; }

.leading-\[14\.5px\] { line-height: 14.5px; }

.leading-\[140\%\] { line-height: 140%; }

.leading-\[1em\] { line-height: 1em; }

.leading-none { line-height: 1; }

.leading-normal { line-height: 1.5; }

.leading-relaxed { line-height: 1.625; }

.leading-snug { line-height: 1.375; }

.leading-tight { line-height: 1.25; }

.tracking-\[0\.2em\] { letter-spacing: 0.2em; }

.tracking-normal { letter-spacing: 0px; }

.tracking-tight { letter-spacing: -0.025em; }

.tracking-wide { letter-spacing: 0.025em; }

.tracking-wider { letter-spacing: 0.05em; }

.tracking-widest { letter-spacing: 0.1em; }

.\!text-\[\#d29922\] { --tw-text-opacity: 1 !important; color: rgb(210 153 =
34/var(--tw-text-opacity)) !important; }

.\!text-accent-main-000 { --tw-text-opacity: 1 !important; color: hsl(var(-=
-accent-main-000)/var(--tw-text-opacity)) !important; }

.\!text-accent-main-200 { --tw-text-opacity: 1 !important; color: hsl(var(-=
-accent-main-200)/var(--tw-text-opacity)) !important; }

.\!text-accent-secondary-000 { --tw-text-opacity: 1 !important; color: hsl(=
var(--accent-secondary-000)/var(--tw-text-opacity)) !important; }

.\!text-accent-secondary-100 { --tw-text-opacity: 1 !important; color: hsl(=
var(--accent-secondary-100)/var(--tw-text-opacity)) !important; }

.\!text-accent-secondary-200 { --tw-text-opacity: 1 !important; color: hsl(=
var(--accent-secondary-200)/var(--tw-text-opacity)) !important; }

.\!text-always-white { --tw-text-opacity: 1 !important; color: hsl(var(--al=
ways-white)/var(--tw-text-opacity)) !important; }

.\!text-always-white\/70 { color: hsl(var(--always-white)/.7) !important; }

.\!text-bg-000 { --tw-text-opacity: 1 !important; color: hsl(var(--bg-000)/=
var(--tw-text-opacity)) !important; }

.\!text-bg-100 { --tw-text-opacity: 1 !important; color: hsl(var(--bg-100)/=
var(--tw-text-opacity)) !important; }

.\!text-danger-000 { --tw-text-opacity: 1 !important; color: hsl(var(--dang=
er-000)/var(--tw-text-opacity)) !important; }

.\!text-danger-100 { --tw-text-opacity: 1 !important; color: hsl(var(--dang=
er-100)/var(--tw-text-opacity)) !important; }

.\!text-danger-200 { --tw-text-opacity: 1 !important; color: hsl(var(--dang=
er-200)/var(--tw-text-opacity)) !important; }

.\!text-inherit { color: inherit !important; }

.\!text-oncolor-100 { --tw-text-opacity: 1 !important; color: hsl(var(--onc=
olor-100)/var(--tw-text-opacity)) !important; }

.\!text-text-000 { --tw-text-opacity: 1 !important; color: hsl(var(--text-0=
00)/var(--tw-text-opacity)) !important; }

.\!text-text-100 { --tw-text-opacity: 1 !important; color: hsl(var(--text-1=
00)/var(--tw-text-opacity)) !important; }

.\!text-text-200 { --tw-text-opacity: 1 !important; color: hsl(var(--text-2=
00)/var(--tw-text-opacity)) !important; }

.\!text-text-300 { --tw-text-opacity: 1 !important; color: hsl(var(--text-3=
00)/var(--tw-text-opacity)) !important; }

.\!text-text-400 { --tw-text-opacity: 1 !important; color: hsl(var(--text-4=
00)/var(--tw-text-opacity)) !important; }

.\!text-text-500 { --tw-text-opacity: 1 !important; color: hsl(var(--text-5=
00)/var(--tw-text-opacity)) !important; }

.\!text-text-500\/50 { color: hsl(var(--text-500)/.5) !important; }

.\!text-transparent { color: transparent !important; }

.text-\[\#4ade80\] { --tw-text-opacity: 1; color: rgb(74 222 128/var(--tw-t=
ext-opacity)); }

.text-\[\#60a5fa\] { --tw-text-opacity: 1; color: rgb(96 165 250/var(--tw-t=
ext-opacity)); }

.text-\[\#888\] { --tw-text-opacity: 1; color: rgb(136 136 136/var(--tw-tex=
t-opacity)); }

.text-\[\#A29F95\] { --tw-text-opacity: 1; color: rgb(162 159 149/var(--tw-=
text-opacity)); }

.text-\[\#D97757\] { --tw-text-opacity: 1; color: rgb(217 119 87/var(--tw-t=
ext-opacity)); }

.text-\[\#a371f7\] { --tw-text-opacity: 1; color: rgb(163 113 247/var(--tw-=
text-opacity)); }

.text-\[\#abb2bf\] { --tw-text-opacity: 1; color: rgb(171 178 191/var(--tw-=
text-opacity)); }

.text-\[\#d29922\] { --tw-text-opacity: 1; color: rgb(210 153 34/var(--tw-t=
ext-opacity)); }

.text-\[\#d4a574\] { --tw-text-opacity: 1; color: rgb(212 165 116/var(--tw-=
text-opacity)); }

.text-\[\#d4d4d4\] { --tw-text-opacity: 1; color: rgb(212 212 212/var(--tw-=
text-opacity)); }

.text-accent-brand { --tw-text-opacity: 1; color: hsl(var(--accent-brand)/v=
ar(--tw-text-opacity)); }

.text-accent-main-000 { --tw-text-opacity: 1; color: hsl(var(--accent-main-=
000)/var(--tw-text-opacity)); }

.text-accent-main-100 { --tw-text-opacity: 1; color: hsl(var(--accent-main-=
100)/var(--tw-text-opacity)); }

.text-accent-main-100\/70 { color: hsl(var(--accent-main-100)/.7); }

.text-accent-main-200 { --tw-text-opacity: 1; color: hsl(var(--accent-main-=
200)/var(--tw-text-opacity)); }

.text-accent-main-900 { --tw-text-opacity: 1; color: hsl(var(--accent-main-=
900)/var(--tw-text-opacity)); }

.text-accent-pro-000 { --tw-text-opacity: 1; color: hsl(var(--accent-pro-00=
0)/var(--tw-text-opacity)); }

.text-accent-secondary-000 { --tw-text-opacity: 1; color: hsl(var(--accent-=
secondary-000)/var(--tw-text-opacity)); }

.text-accent-secondary-100 { --tw-text-opacity: 1; color: hsl(var(--accent-=
secondary-100)/var(--tw-text-opacity)); }

.text-accent-secondary-100\/70 { color: hsl(var(--accent-secondary-100)/.7)=
; }

.text-accent-secondary-200 { --tw-text-opacity: 1; color: hsl(var(--accent-=
secondary-200)/var(--tw-text-opacity)); }

.text-accent-secondary-200\/75 { color: hsl(var(--accent-secondary-200)/.75=
); }

.text-always-black\/60 { color: hsl(var(--always-black)/.6); }

.text-always-black\/80 { color: hsl(var(--always-black)/.8); }

.text-always-white { --tw-text-opacity: 1; color: hsl(var(--always-white)/v=
ar(--tw-text-opacity)); }

.text-always-white\/0 { color: hsl(var(--always-white)/0); }

.text-always-white\/30 { color: hsl(var(--always-white)/.3); }

.text-always-white\/50 { color: hsl(var(--always-white)/.5); }

.text-always-white\/60 { color: hsl(var(--always-white)/.6); }

.text-always-white\/80 { color: hsl(var(--always-white)/.8); }

.text-always-white\/90 { color: hsl(var(--always-white)/.9); }

.text-bg-000 { --tw-text-opacity: 1; color: hsl(var(--bg-000)/var(--tw-text=
-opacity)); }

.text-bg-100 { --tw-text-opacity: 1; color: hsl(var(--bg-100)/var(--tw-text=
-opacity)); }

.text-bg-300 { --tw-text-opacity: 1; color: hsl(var(--bg-300)/var(--tw-text=
-opacity)); }

.text-black { --tw-text-opacity: 1; color: rgb(0 0 0/var(--tw-text-opacity)=
); }

.text-border-200 { color: hsl(var(--border-200)/.3); }

.text-border-300 { color: hsl(var(--border-300)/.15); }

.text-danger-000 { --tw-text-opacity: 1; color: hsl(var(--danger-000)/var(-=
-tw-text-opacity)); }

.text-forest-green { --tw-text-opacity: 1; color: rgb(54 136 74/var(--tw-te=
xt-opacity)); }

.text-inherit { color: inherit; }

.text-oncolor-100 { --tw-text-opacity: 1; color: hsl(var(--oncolor-100)/var=
(--tw-text-opacity)); }

.text-oncolor-200 { color: hsl(var(--oncolor-200)/.75); }

.text-success-000 { --tw-text-opacity: 1; color: hsl(var(--success-000)/var=
(--tw-text-opacity)); }

.text-success-100 { --tw-text-opacity: 1; color: hsl(var(--success-100)/var=
(--tw-text-opacity)); }

.text-success-200 { --tw-text-opacity: 1; color: hsl(var(--success-200)/var=
(--tw-text-opacity)); }

.text-text-000 { --tw-text-opacity: 1; color: hsl(var(--text-000)/var(--tw-=
text-opacity)); }

.text-text-000\/40 { color: hsl(var(--text-000)/.4); }

.text-text-100 { --tw-text-opacity: 1; color: hsl(var(--text-100)/var(--tw-=
text-opacity)); }

.text-text-100\/30 { color: hsl(var(--text-100)/.3); }

.text-text-100\/50 { color: hsl(var(--text-100)/.5); }

.text-text-100\/90 { color: hsl(var(--text-100)/.9); }

.text-text-200 { --tw-text-opacity: 1; color: hsl(var(--text-200)/var(--tw-=
text-opacity)); }

.text-text-300 { --tw-text-opacity: 1; color: hsl(var(--text-300)/var(--tw-=
text-opacity)); }

.text-text-400 { --tw-text-opacity: 1; color: hsl(var(--text-400)/var(--tw-=
text-opacity)); }

.text-text-400\/40 { color: hsl(var(--text-400)/.4); }

.text-text-500 { --tw-text-opacity: 1; color: hsl(var(--text-500)/var(--tw-=
text-opacity)); }

.text-text-500\/50 { color: hsl(var(--text-500)/.5); }

.text-text-500\/70 { color: hsl(var(--text-500)/.7); }

.text-text-500\/75 { color: hsl(var(--text-500)/.75); }

.text-text-500\/80 { color: hsl(var(--text-500)/.8); }

.text-warning-000 { --tw-text-opacity: 1; color: hsl(var(--warning-000)/var=
(--tw-text-opacity)); }

.text-warning-100 { --tw-text-opacity: 1; color: hsl(var(--warning-100)/var=
(--tw-text-opacity)); }

.text-warning-200 { --tw-text-opacity: 1; color: hsl(var(--warning-200)/var=
(--tw-text-opacity)); }

.text-white { --tw-text-opacity: 1; color: rgb(255 255 255/var(--tw-text-op=
acity)); }

.underline { text-decoration-line: underline; }

.line-through { text-decoration-line: line-through; }

.\!no-underline { text-decoration-line: none !important; }

.no-underline { text-decoration-line: none; }

.decoration-text-300 { text-decoration-color: hsl(var(--text-300)/1); }

.decoration-1 { text-decoration-thickness: 1px; }

.underline-offset-2 { text-underline-offset: 2px; }

.underline-offset-\[3px\] { text-underline-offset: 3px; }

.antialiased { -webkit-font-smoothing: antialiased; }

.placeholder-text-400::placeholder { --tw-placeholder-opacity: 1; color: hs=
l(var(--text-400)/var(--tw-placeholder-opacity)); }

.placeholder-text-500::placeholder { --tw-placeholder-opacity: 1; color: hs=
l(var(--text-500)/var(--tw-placeholder-opacity)); }

.placeholder-text-500\/80::placeholder { color: hsl(var(--text-500)/.8); }

.accent-accent-main-100 { accent-color: hsl(var(--accent-main-100)/1); }

.accent-text-200 { accent-color: hsl(var(--text-200)/1); }

.\!opacity-0 { opacity: 0 !important; }

.\!opacity-100 { opacity: 1 !important; }

.opacity-0 { opacity: 0; }

.opacity-10 { opacity: 0.1; }

.opacity-100 { opacity: 1; }

.opacity-15 { opacity: 0.15; }

.opacity-20 { opacity: 0.2; }

.opacity-25 { opacity: 0.25; }

.opacity-30 { opacity: 0.3; }

.opacity-40 { opacity: 0.4; }

.opacity-50 { opacity: 0.5; }

.opacity-60 { opacity: 0.6; }

.opacity-65 { opacity: 0.65; }

.opacity-70 { opacity: 0.7; }

.opacity-75 { opacity: 0.75; }

.opacity-80 { opacity: 0.8; }

.opacity-90 { opacity: 0.9; }

.opacity-\[0\%\] { opacity: 0; }

.opacity-\[0\.02\] { opacity: 0.02; }

.opacity-\[0\.08\] { opacity: 0.08; }

.mix-blend-normal { mix-blend-mode: normal; }

.mix-blend-darken { mix-blend-mode: darken; }

.mix-blend-lighten { mix-blend-mode: lighten; }

.mix-blend-luminosity { mix-blend-mode: luminosity; }

.\!shadow-\[0_2px_8px_0_hsl\(var\(--accent-secondary-200\)\/16\%\)\] { --tw=
-shadow: 0 2px 8px 0 hsl(var(--accent-secondary-200)/16%) !important; --tw-=
shadow-colored: 0 2px 8px 0 var(--tw-shadow-color) !important; box-shadow: =
var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(=
--tw-shadow) !important; }

.\!shadow-\[0_4px_24px_0_hsl\(var\(--accent-secondary-200\)\/22\%\)\] { --t=
w-shadow: 0 4px 24px 0 hsl(var(--accent-secondary-200)/22%) !important; --t=
w-shadow-colored: 0 4px 24px 0 var(--tw-shadow-color) !important; box-shado=
w: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),v=
ar(--tw-shadow) !important; }

.\!shadow-\[0px_2px_8px_0px_hsl\(var\(--always-black\)\/8\%\)\] { --tw-shad=
ow: 0px 2px 8px 0px hsl(var(--always-black)/8%) !important; --tw-shadow-col=
ored: 0px 2px 8px 0px var(--tw-shadow-color) !important; }

.\!shadow-\[0px_2px_8px_0px_hsl\(var\(--always-black\)\/8\%\)\], .\!shadow-=
none { box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-sha=
dow,0 0 #0000),var(--tw-shadow) !important; }

.\!shadow-none { --tw-shadow: 0 0 #0000 !important; --tw-shadow-colored: 0 =
0 #0000 !important; }

.\!shadow-sm { --tw-shadow: 0 1px 2px 0 rgb(0 0 0/0.05) !important; --tw-sh=
adow-colored: 0 1px 2px 0 var(--tw-shadow-color) !important; box-shadow: va=
r(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--=
tw-shadow) !important; }

.shadow { --tw-shadow: 0 1px 3px 0 rgb(0 0 0/0.1),0 1px 2px -1px rgb(0 0 0/=
0.1); --tw-shadow-colored: 0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1p=
x var(--tw-shadow-color); }

.shadow, .shadow-2xl { box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),v=
ar(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-2xl { --tw-shadow: 0 25px 50px -12px rgb(0 0 0/0.25); --tw-shadow-c=
olored: 0 25px 50px -12px var(--tw-shadow-color); }

.shadow-\[0_0\.25rem_1\.25rem_hsl\(var\(--always-black\)\/3\.5\%\)\,0_0_0_0=
\.5px_hsla\(var\(--border-300\)\/0\.15\)\] { --tw-shadow: 0 0.25rem 1.25rem=
 hsl(var(--always-black)/3.5%),0 0 0 0.5px hsla(var(--border-300)/0.15); --=
tw-shadow-colored: 0 0.25rem 1.25rem var(--tw-shadow-color),0 0 0 0.5px var=
(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var=
(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0_0\.25rem_1\.25rem_hsl\(var\(--always-black\)\/3\.5\%\)\] { --tw=
-shadow: 0 0.25rem 1.25rem hsl(var(--always-black)/3.5%); --tw-shadow-color=
ed: 0 0.25rem 1.25rem var(--tw-shadow-color); box-shadow: var(--tw-ring-off=
set-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0_0\.25rem_1\.25rem_hsl\(var\(--always-black\)\/7\.5\%\)\,0_0_0_0=
\.5px_hsla\(var\(--border-200\)\/0\.3\)\] { --tw-shadow: 0 0.25rem 1.25rem =
hsl(var(--always-black)/7.5%),0 0 0 0.5px hsla(var(--border-200)/0.3); --tw=
-shadow-colored: 0 0.25rem 1.25rem var(--tw-shadow-color),0 0 0 0.5px var(-=
-tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(-=
-tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0_0\.8px_1\.6px_0_hsl\(var\(--always-black\)\/5\%\)\] { --tw-shad=
ow: 0 0.8px 1.6px 0 hsl(var(--always-black)/5%); --tw-shadow-colored: 0 0.8=
px 1.6px 0 var(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,=
0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0_0_0_100px_hsl\(var\(--text-000\)\)\] { --tw-shadow: 0 0 0 100px=
 hsl(var(--text-000)); --tw-shadow-colored: 0 0 0 100px var(--tw-shadow-col=
or); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shado=
w,0 0 #0000),var(--tw-shadow); }

.shadow-\[0_0_0_1px_hsl\(var\(--accent-secondary-100\)\)\] { --tw-shadow: 0=
 0 0 1px hsl(var(--accent-secondary-100)); --tw-shadow-colored: 0 0 0 1px v=
ar(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),v=
ar(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0_0_15px_hsl\(var\(--always-black\)\/8\%\)\] { --tw-shadow: 0 0 1=
5px hsl(var(--always-black)/8%); --tw-shadow-colored: 0 0 15px var(--tw-sha=
dow-color); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-rin=
g-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0_11px_23px_0_rgba\(0\,0\,0\,0\.15\)\] { --tw-shadow: 0 11px 23px=
 0 rgba(0,0,0,0.15); --tw-shadow-colored: 0 11px 23px 0 var(--tw-shadow-col=
or); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shado=
w,0 0 #0000),var(--tw-shadow); }

.shadow-\[0_17px_35px_0_rgba\(0\,0\,0\,0\.15\)\] { --tw-shadow: 0 17px 35px=
 0 rgba(0,0,0,0.15); --tw-shadow-colored: 0 17px 35px 0 var(--tw-shadow-col=
or); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shado=
w,0 0 #0000),var(--tw-shadow); }

.shadow-\[0_1px_2px_0_hsl\(var\(--always-black\)\/5\%\)\] { --tw-shadow: 0 =
1px 2px 0 hsl(var(--always-black)/5%); --tw-shadow-colored: 0 1px 2px 0 var=
(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var=
(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0_20px_40px_rgba\(0\,0\,0\,0\.4\)\] { --tw-shadow: 0 20px 40px rg=
ba(0,0,0,0.4); --tw-shadow-colored: 0 20px 40px var(--tw-shadow-color); box=
-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0=
000),var(--tw-shadow); }

.shadow-\[0_2px_8px_0_hsl\(var\(--always-black\)\/4\%\)\] { --tw-shadow: 0 =
2px 8px 0 hsl(var(--always-black)/4%); --tw-shadow-colored: 0 2px 8px 0 var=
(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var=
(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0_2px_8px_hsl\(var\(--always-black\)\/6\%\)\] { --tw-shadow: 0 2p=
x 8px hsl(var(--always-black)/6%); --tw-shadow-colored: 0 2px 8px var(--tw-=
shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-=
ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0_2px_8px_hsl\(var\(--always-black\)\/8\%\)\] { --tw-shadow: 0 2p=
x 8px hsl(var(--always-black)/8%); --tw-shadow-colored: 0 2px 8px var(--tw-=
shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-=
ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0_40px_80px_hsl\(var\(--always-black\)\/10\%\)\] { --tw-shadow: 0=
 40px 80px hsl(var(--always-black)/10%); --tw-shadow-colored: 0 40px 80px v=
ar(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),v=
ar(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0_4px_20px_0_hsl\(var\(--always-black\)\/4\%\)\] { --tw-shadow: 0=
 4px 20px 0 hsl(var(--always-black)/4%); --tw-shadow-colored: 0 4px 20px 0 =
var(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),=
var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0_4px_20px_0_rgba\(0\,0\,0\,0\.04\)\] { --tw-shadow: 0 4px 20px 0=
 rgba(0,0,0,0.04); --tw-shadow-colored: 0 4px 20px 0 var(--tw-shadow-color)=
; box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0=
 0 #0000),var(--tw-shadow); }

.shadow-\[0_4px_24px_0_hsl\(var\(--always-black\)\/1\.57\%\)\,0_4px_32px_0_=
hsl\(var\(--always-black\)\/1\.57\%\)\,0_2px_64px_0_hsl\(var\(--always-blac=
k\)\/1\.18\%\)\,0_16px_32px_0_hsl\(var\(--always-black\)\/1\.18\%\)\] { --t=
w-shadow: 0 4px 24px 0 hsl(var(--always-black)/1.57%),0 4px 32px 0 hsl(var(=
--always-black)/1.57%),0 2px 64px 0 hsl(var(--always-black)/1.18%),0 16px 3=
2px 0 hsl(var(--always-black)/1.18%); --tw-shadow-colored: 0 4px 24px 0 var=
(--tw-shadow-color),0 4px 32px 0 var(--tw-shadow-color),0 2px 64px 0 var(--=
tw-shadow-color),0 16px 32px 0 var(--tw-shadow-color); box-shadow: var(--tw=
-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-sha=
dow); }

.shadow-\[0_4px_32px_hsl\(var\(--always-black\)\/30\%\)\,_0_0_0_0\.5px_hsl\=
(var\(--always-black\)\/25\%\)\] { --tw-shadow: 0 4px 32px hsl(var(--always=
-black)/30%),0 0 0 0.5px hsl(var(--always-black)/25%); --tw-shadow-colored:=
 0 4px 32px var(--tw-shadow-color),0 0 0 0.5px var(--tw-shadow-color); box-=
shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #00=
00),var(--tw-shadow); }

.shadow-\[0_6px_22px_0_hsl\(var\(--always-black\)\/5\%\)\] { --tw-shadow: 0=
 6px 22px 0 hsl(var(--always-black)/5%); --tw-shadow-colored: 0 6px 22px 0 =
var(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),=
var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0px_0px_32px_0px_hsl\(var\(--accent-main-900\)\/12\%\)\] { --tw-s=
hadow: 0px 0px 32px 0px hsl(var(--accent-main-900)/12%); --tw-shadow-colore=
d: 0px 0px 32px 0px var(--tw-shadow-color); box-shadow: var(--tw-ring-offse=
t-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0px_1px_0px_0px_theme\(colors\.border-300\)\] { --tw-shadow: 0px =
1px 0px 0px hsl(var(--border-300)/0.15); --tw-shadow-colored: 0px 1px 0px 0=
px var(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0 #000=
0),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0px_1px_2px_0px_hsl\(var\(--always-black\)\/5\%\)\] { --tw-shadow=
: 0px 1px 2px 0px hsl(var(--always-black)/5%); --tw-shadow-colored: 0px 1px=
 2px 0px var(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 =
0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0px_1px_2px_0px_hsl\(var\(--always-black\)\/5\.1\%\)\] { --tw-sha=
dow: 0px 1px 2px 0px hsl(var(--always-black)/5.1%); --tw-shadow-colored: 0p=
x 1px 2px 0px var(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shad=
ow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0px_2px_8px_0px_hsl\(var\(--always-black\)\/8\%\)\] { --tw-shadow=
: 0px 2px 8px 0px hsl(var(--always-black)/8%); --tw-shadow-colored: 0px 2px=
 8px 0px var(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 =
0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0px_4px_20px_0px_hsl\(var\(--always-black\)\/20\%\)\] { --tw-shad=
ow: 0px 4px 20px 0px hsl(var(--always-black)/20%); --tw-shadow-colored: 0px=
 4px 20px 0px var(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shad=
ow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0px_4px_20px_0px_hsl\(var\(--always-black\)\/4\%\)\] { --tw-shado=
w: 0px 4px 20px 0px hsl(var(--always-black)/4%); --tw-shadow-colored: 0px 4=
px 20px 0px var(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow=
,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0px_4px_20px_0px_rgba\(0\,0\,0\,0\.04\)\] { --tw-shadow: 0px 4px =
20px 0px rgba(0,0,0,0.04); --tw-shadow-colored: 0px 4px 20px 0px var(--tw-s=
hadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-r=
ing-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[0px_8px_28px_0px_hsl\(var\(--always-black\)\/25\%\)\] { --tw-shad=
ow: 0px 8px 28px 0px hsl(var(--always-black)/25%); --tw-shadow-colored: 0px=
 8px 28px 0px var(--tw-shadow-color); }

.shadow-\[0px_8px_28px_0px_hsl\(var\(--always-black\)\/25\%\)\], .shadow-di=
ffused { box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-s=
hadow,0 0 #0000),var(--tw-shadow); }

.shadow-diffused { --tw-shadow: 0 4px 24px var(--tw-shadow-color); --tw-sha=
dow-colored: 0 4px 24px var(--tw-shadow-color); }

.shadow-element { --tw-shadow: 0 0 0 0.5px rgba(0,0,0,0.1),0 0 20px rgba(0,=
0,0,0.05),0 1px 5px rgba(0,0,0,0.1); --tw-shadow-colored: 0 0 0 0.5px var(-=
-tw-shadow-color),0 0 20px var(--tw-shadow-color),0 1px 5px var(--tw-shadow=
-color); }

.shadow-element, .shadow-inset-border-0\.5 { box-shadow: var(--tw-ring-offs=
et-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-inset-border-0\.5 { --tw-shadow: inset 0 0 0 0.5px var(--tw-shadow-=
color); --tw-shadow-colored: inset 0 0 0 0.5px var(--tw-shadow-color); }

.shadow-lg { --tw-shadow: 0 10px 15px -3px rgb(0 0 0/0.1),0 4px 6px -4px rg=
b(0 0 0/0.1); --tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color),=
0 4px 6px -4px var(--tw-shadow-color); }

.shadow-lg, .shadow-md { box-shadow: var(--tw-ring-offset-shadow,0 0 #0000)=
,var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-md { --tw-shadow: 0 4px 6px -1px rgb(0 0 0/0.1),0 2px 4px -2px rgb(=
0 0 0/0.1); --tw-shadow-colored: 0 4px 6px -1px var(--tw-shadow-color),0 2p=
x 4px -2px var(--tw-shadow-color); }

.shadow-none { --tw-shadow: 0 0 #0000; --tw-shadow-colored: 0 0 #0000; }

.shadow-none, .shadow-sm { box-shadow: var(--tw-ring-offset-shadow,0 0 #000=
0),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-sm { --tw-shadow: 0 1px 2px 0 rgb(0 0 0/0.05); --tw-shadow-colored:=
 0 1px 2px 0 var(--tw-shadow-color); }

.shadow-xl { --tw-shadow: 0 20px 25px -5px rgb(0 0 0/0.1),0 8px 10px -6px r=
gb(0 0 0/0.1); --tw-shadow-colored: 0 20px 25px -5px var(--tw-shadow-color)=
,0 8px 10px -6px var(--tw-shadow-color); box-shadow: var(--tw-ring-offset-s=
hadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.shadow-\[hsl\(var\(--accent-secondary-000\)\/10\%\)\] { --tw-shadow-color:=
 hsl(var(--accent-secondary-000)/10%); --tw-shadow: var(--tw-shadow-colored=
); }

.shadow-\[hsl\(var\(--always-black\)\/4\%\)\] { --tw-shadow-color: hsl(var(=
--always-black)/4%); --tw-shadow: var(--tw-shadow-colored); }

.shadow-\[hsl\(var\(--always-black\)\/6\%\)\] { --tw-shadow-color: hsl(var(=
--always-black)/6%); --tw-shadow: var(--tw-shadow-colored); }

.shadow-accent-main-100\/50 { --tw-shadow-color: hsl(var(--accent-main-100)=
/0.5); --tw-shadow: var(--tw-shadow-colored); }

.shadow-accent-pro-100\/50 { --tw-shadow-color: hsl(var(--accent-pro-100)/0=
.5); --tw-shadow: var(--tw-shadow-colored); }

.shadow-accent-secondary-100\/50 { --tw-shadow-color: hsl(var(--accent-seco=
ndary-100)/0.5); --tw-shadow: var(--tw-shadow-colored); }

.shadow-always-black\/5 { --tw-shadow-color: hsl(var(--always-black)/0.05);=
 --tw-shadow: var(--tw-shadow-colored); }

.shadow-border-100 { --tw-shadow-color: hsl(var(--border-100)/0.40); --tw-s=
hadow: var(--tw-shadow-colored); }

.shadow-danger-100\/50 { --tw-shadow-color: hsl(var(--danger-100)/0.5); --t=
w-shadow: var(--tw-shadow-colored); }

.shadow-text-400\/50 { --tw-shadow-color: hsl(var(--text-400)/0.5); --tw-sh=
adow: var(--tw-shadow-colored); }

.\!outline-none { outline: transparent solid 2px !important; outline-offset=
: 2px !important; }

.outline-none { outline: transparent solid 2px; outline-offset: 2px; }

.outline { outline-style: solid; }

.outline-1 { outline-width: 1px; }

.outline-\[0\.50px\] { outline-width: 0.5px; }

.\!-outline-offset-2 { outline-offset: -2px !important; }

.\!-outline-offset-4 { outline-offset: -4px !important; }

.\!outline-offset-1 { outline-offset: 1px !important; }

.-outline-offset-2 { outline-offset: -2px; }

.outline-offset-\[-0\.50px\] { outline-offset: -0.5px; }

.outline-border-300\/25 { outline-color: hsl(var(--border-300)/.25); }

.\!ring-0 { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ri=
ng-offset-width) var(--tw-ring-offset-color) !important; --tw-ring-shadow: =
var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw=
-ring-color) !important; box-shadow: var(--tw-ring-offset-shadow),var(--tw-=
ring-shadow),var(--tw-shadow,0 0 #0000) !important; }

.ring { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-o=
ffset-width) var(--tw-ring-offset-color); --tw-ring-shadow: var(--tw-ring-i=
nset) 0 0 0 calc(3px + var(--tw-ring-offset-width)) var(--tw-ring-color); }

.ring, .ring-0 { box-shadow: var(--tw-ring-offset-shadow),var(--tw-ring-sha=
dow),var(--tw-shadow,0 0 #0000); }

.ring-0 { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring=
-offset-width) var(--tw-ring-offset-color); --tw-ring-shadow: var(--tw-ring=
-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);=
 }

.ring-1 { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring=
-offset-width) var(--tw-ring-offset-color); --tw-ring-shadow: var(--tw-ring=
-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);=
 }

.ring-1, .ring-2 { box-shadow: var(--tw-ring-offset-shadow),var(--tw-ring-s=
hadow),var(--tw-shadow,0 0 #0000); }

.ring-2 { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring=
-offset-width) var(--tw-ring-offset-color); --tw-ring-shadow: var(--tw-ring=
-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);=
 }

.ring-\[0\.5px\] { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(=
--tw-ring-offset-width) var(--tw-ring-offset-color); --tw-ring-shadow: var(=
--tw-ring-inset) 0 0 0 calc(0.5px + var(--tw-ring-offset-width)) var(--tw-r=
ing-color); box-shadow: var(--tw-ring-offset-shadow),var(--tw-ring-shadow),=
var(--tw-shadow,0 0 #0000); }

.ring-inset { --tw-ring-inset: inset; }

.\!ring-border-200 { --tw-ring-color: hsl(var(--border-200)/0.30) !importan=
t; }

.ring-accent-main-100 { --tw-ring-opacity: 1; --tw-ring-color: hsl(var(--ac=
cent-main-100)/var(--tw-ring-opacity)); }

.ring-accent-secondary-100 { --tw-ring-opacity: 1; --tw-ring-color: hsl(var=
(--accent-secondary-100)/var(--tw-ring-opacity)); }

.ring-accent-secondary-100\/30 { --tw-ring-color: hsl(var(--accent-secondar=
y-100)/0.3); }

.ring-accent-secondary-100\/60 { --tw-ring-color: hsl(var(--accent-secondar=
y-100)/0.6); }

.ring-accent-secondary-100\/70 { --tw-ring-color: hsl(var(--accent-secondar=
y-100)/0.7); }

.ring-always-white { --tw-ring-opacity: 1; --tw-ring-color: hsl(var(--alway=
s-white)/var(--tw-ring-opacity)); }

.ring-always-white\/30 { --tw-ring-color: hsl(var(--always-white)/0.3); }

.ring-bg-000 { --tw-ring-opacity: 1; --tw-ring-color: hsl(var(--bg-000)/var=
(--tw-ring-opacity)); }

.ring-border-200 { --tw-ring-color: hsl(var(--border-200)/0.30); }

.ring-border-300 { --tw-ring-color: hsl(var(--border-300)/0.15); }

.ring-border-300\/50 { --tw-ring-color: hsl(var(--border-300)/0.5); }

.ring-text-000 { --tw-ring-opacity: 1; --tw-ring-color: hsl(var(--text-000)=
/var(--tw-ring-opacity)); }

.ring-text-100 { --tw-ring-opacity: 1; --tw-ring-color: hsl(var(--text-100)=
/var(--tw-ring-opacity)); }

.\!ring-offset-0 { --tw-ring-offset-width: 0px !important; }

.ring-offset-1 { --tw-ring-offset-width: 1px; }

.ring-offset-2 { --tw-ring-offset-width: 2px; }

.ring-offset-bg-000 { --tw-ring-offset-color: hsl(var(--bg-000)/1); }

.ring-offset-bg-100 { --tw-ring-offset-color: hsl(var(--bg-100)/1); }

.ring-offset-bg-300 { --tw-ring-offset-color: hsl(var(--bg-300)/1); }

.blur { --tw-blur: blur(8px); }

.blur, .blur-\[2px\] { filter: var(--tw-blur) var(--tw-brightness) var(--tw=
-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--=
tw-saturate) var(--tw-sepia) var(--tw-drop-shadow); }

.blur-\[2px\] { --tw-blur: blur(2px); }

.blur-md { --tw-blur: blur(12px); }

.blur-md, .blur-sm { filter: var(--tw-blur) var(--tw-brightness) var(--tw-c=
ontrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw=
-saturate) var(--tw-sepia) var(--tw-drop-shadow); }

.blur-sm { --tw-blur: blur(4px); }

.blur-xl { --tw-blur: blur(24px); }

.blur-xl, .drop-shadow { filter: var(--tw-blur) var(--tw-brightness) var(--=
tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(=
--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow); }

.drop-shadow { --tw-drop-shadow: drop-shadow(0 1px 2px rgb(0 0 0/0.1)) drop=
-shadow(0 1px 1px rgb(0 0 0/0.06)); }

.drop-shadow-\[0_2px_8px_hsl\(var\(--always-black\)\/8\%\)\] { --tw-drop-sh=
adow: drop-shadow(0 2px 8px hsl(var(--always-black)/8%)); }

.drop-shadow-\[0_2px_8px_hsl\(var\(--always-black\)\/8\%\)\], .drop-shadow-=
lg { filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--t=
w-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(-=
-tw-sepia) var(--tw-drop-shadow); }

.drop-shadow-lg { --tw-drop-shadow: drop-shadow(0 10px 8px rgb(0 0 0/0.04))=
 drop-shadow(0 4px 3px rgb(0 0 0/0.1)); }

.drop-shadow-md { --tw-drop-shadow: drop-shadow(0 4px 3px rgb(0 0 0/0.07)) =
drop-shadow(0 2px 2px rgb(0 0 0/0.06)); }

.drop-shadow-md, .drop-shadow-sm { filter: var(--tw-blur) var(--tw-brightne=
ss) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-in=
vert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow); }

.drop-shadow-sm { --tw-drop-shadow: drop-shadow(0 1px 1px rgb(0 0 0/0.05));=
 }

.grayscale { --tw-grayscale: grayscale(100%); }

.grayscale, .invert { filter: var(--tw-blur) var(--tw-brightness) var(--tw-=
contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--t=
w-saturate) var(--tw-sepia) var(--tw-drop-shadow); }

.invert { --tw-invert: invert(100%); }

.filter { filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) va=
r(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) =
var(--tw-sepia) var(--tw-drop-shadow); }

.backdrop-blur { --tw-backdrop-blur: blur(8px); }

.backdrop-blur, .backdrop-blur-2xl { backdrop-filter: var(--tw-backdrop-blu=
r) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backd=
rop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(=
--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)=
; }

.backdrop-blur-2xl { --tw-backdrop-blur: blur(40px); }

.backdrop-blur-\[1px\] { --tw-backdrop-blur: blur(1px); }

.backdrop-blur-\[1px\], .backdrop-blur-\[2px\] { backdrop-filter: var(--tw-=
backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) va=
r(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-=
invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-bac=
kdrop-sepia); }

.backdrop-blur-\[2px\] { --tw-backdrop-blur: blur(2px); }

.backdrop-blur-\[6px\] { --tw-backdrop-blur: blur(6px); }

.backdrop-blur-\[6px\], .backdrop-blur-lg { backdrop-filter: var(--tw-backd=
rop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--t=
w-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-inver=
t) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop=
-sepia); }

.backdrop-blur-lg { --tw-backdrop-blur: blur(16px); }

.backdrop-blur-md { --tw-backdrop-blur: blur(12px); }

.backdrop-blur-md, .backdrop-blur-sm { backdrop-filter: var(--tw-backdrop-b=
lur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-bac=
kdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) va=
r(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepi=
a); }

.backdrop-blur-sm { --tw-backdrop-blur: blur(4px); }

.backdrop-blur-xl { --tw-backdrop-blur: blur(24px); }

.backdrop-blur-xl, .backdrop-brightness-75 { backdrop-filter: var(--tw-back=
drop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--=
tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-inve=
rt) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdro=
p-sepia); }

.backdrop-brightness-75 { --tw-backdrop-brightness: brightness(.75); }

.\!transition-none { transition-property: none !important; }

.transition { transition-property: color, background-color, border-color, t=
ext-decoration-color, fill, stroke, opacity, box-shadow, transform, filter,=
 backdrop-filter; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);=
 transition-duration: 0.15s; }

.transition-\[background-color\,border-color\,box-shadow\] { transition-pro=
perty: background-color, border-color, box-shadow; transition-timing-functi=
on: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }

.transition-\[border-color\] { transition-property: border-color; transitio=
n-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s=
; }

.transition-\[border\] { transition-property: border; transition-timing-fun=
ction: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }

.transition-\[clip-path\] { transition-property: clip-path; transition-timi=
ng-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }

.transition-\[color\,background\] { transition-property: color, background;=
 transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-durat=
ion: 0.15s; }

.transition-\[gap\] { transition-property: gap; transition-timing-function:=
 cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }

.transition-\[grid-template-columns\] { transition-property: grid-template-=
columns; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transiti=
on-duration: 0.15s; }

.transition-\[grid-template-rows\,opacity\] { transition-property: grid-tem=
plate-rows, opacity; transition-timing-function: cubic-bezier(0.4, 0, 0.2, =
1); transition-duration: 0.15s; }

.transition-\[grid-template-rows\] { transition-property: grid-template-row=
s; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-dur=
ation: 0.15s; }

.transition-\[height\] { transition-property: height; transition-timing-fun=
ction: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }

.transition-\[mask-image\] { transition-property: mask-image, -webkit-mask-=
image; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition=
-duration: 0.15s; }

.transition-\[max-height\,opacity\,margin\] { transition-property: max-heig=
ht, opacity, margin; transition-timing-function: cubic-bezier(0.4, 0, 0.2, =
1); transition-duration: 0.15s; }

.transition-\[max-height\] { transition-property: max-height; transition-ti=
ming-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }

.transition-\[opacity\] { transition-property: opacity; transition-timing-f=
unction: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }

.transition-\[width\] { transition-property: width; transition-timing-funct=
ion: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }

.transition-all { transition-property: all; transition-timing-function: cub=
ic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }

.transition-colors { transition-property: color, background-color, border-c=
olor, text-decoration-color, fill, stroke; transition-timing-function: cubi=
c-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }

.transition-none { transition-property: none; }

.transition-opacity { transition-property: opacity; transition-timing-funct=
ion: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }

.transition-shadow { transition-property: box-shadow; transition-timing-fun=
ction: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }

.transition-transform { transition-property: transform; transition-timing-f=
unction: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }

.delay-150 { transition-delay: 0.15s; }

.delay-300 { transition-delay: 0.3s; }

.delay-75 { transition-delay: 75ms; }

.\!duration-75 { transition-duration: 75ms !important; }

.duration-0 { transition-duration: 0s; }

.duration-100 { transition-duration: 0.1s; }

.duration-1000 { transition-duration: 1s; }

.duration-150 { transition-duration: 0.15s; }

.duration-200 { transition-duration: 0.2s; }

.duration-300 { transition-duration: 0.3s; }

.duration-500 { transition-duration: 0.5s; }

.duration-700 { transition-duration: 0.7s; }

.duration-75 { transition-duration: 75ms; }

.duration-\[250ms\] { transition-duration: 0.25s; }

.duration-\[35ms\] { transition-duration: 35ms; }

.duration-\[500ms\] { transition-duration: 0.5s; }

.\!ease-out { transition-timing-function: cubic-bezier(0, 0, 0.2, 1) !impor=
tant; }

.ease-\[cubic-bezier\(0\.165\,0\.85\,0\.45\,1\)\] { transition-timing-funct=
ion: cubic-bezier(0.165, 0.85, 0.45, 1); }

.ease-\[cubic-bezier\(0\.17\,0\.67\,0\.3\,1\.2\)\] { transition-timing-func=
tion: cubic-bezier(0.17, 0.67, 0.3, 1.2); }

.ease-in { transition-timing-function: cubic-bezier(0.4, 0, 1, 1); }

.ease-in-out { transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); }

.ease-linear { transition-timing-function: linear; }

.ease-out { transition-timing-function: cubic-bezier(0, 0, 0.2, 1); }

.ease-snappy-out { transition-timing-function: cubic-bezier(0.19, 1, 0.22, =
1); }

.will-change-transform { will-change: transform; }

.font-mono { font-family: var(--font-mono); }

.font-ui { font-family: var(--font-ui); }

.font-ui-serif { font-family: var(--font-ui-serif); }

.\!font-user-message { font-family: var(--font-user-message) !important; }

.font-user-message { font-family: var(--font-user-message); }

.font-claude-response { font-family: var(--font-claude-response); }

.\!font-base { font-family: var(--font-ui) !important; font-size: 0.875rem =
!important; font-weight: 430 !important; line-height: 1.4 !important; }

.font-base { font-weight: 430; }

.font-base, .font-base-bold { font-family: var(--font-ui); font-size: 0.875=
rem; line-height: 1.4; }

.font-base-bold { font-weight: 500; }

.font-display { font-family: var(--font-ui-serif); font-size: 2.375rem; fon=
t-weight: 330; line-height: 1.2; font-variation-settings: "opsz" 48; }

.font-heading { font-family: var(--font-ui-serif); font-size: 1.5rem; font-=
weight: 500; line-height: 1.3; font-variation-settings: "opsz" 24; }

.font-large { font-weight: 430; }

.font-large, .font-large-bold { font-family: var(--font-ui); font-size: 1re=
m; line-height: 1.4; }

.font-large-bold { font-weight: 600; }

.font-small { font-weight: 430; }

.font-small, .font-small-bold { font-family: var(--font-ui); font-size: 0.7=
5rem; line-height: 1.4; }

.font-small-bold { font-weight: 600; }

.font-title { font-family: var(--font-ui-serif); font-size: 1.75rem; font-w=
eight: 500; line-height: 1.3; font-variation-settings: "opsz" 28; }

.font-xl { font-weight: 400; font-variation-settings: "opsz" 20; }

.font-xl, .font-xl-bold { font-family: var(--font-ui); font-size: 1.25rem; =
line-height: 1.4; }

.font-xl-bold { font-weight: 600; font-variation-settings: "opsz" 20; }

.font-claude-response-body { font-weight: 400; }

.font-claude-response-body, .font-claude-response-body-bold { font-family: =
var(--font-claude-response); font-size: 1rem; line-height: 1.5; }

.font-claude-response-body-bold { font-weight: 600; }

.font-claude-response-code { font-size: 0.813rem; }

.font-claude-response-code, .font-claude-response-code-small { font-family:=
 var(--font-mono); font-weight: 400; line-height: 1.5; }

.font-claude-response-code-small { font-size: 0.688rem; }

.font-claude-response-heading { font-family: var(--font-claude-response); f=
ont-size: 1.25rem; font-weight: 600; line-height: 1.4; font-variation-setti=
ngs: "opsz" 20; }

.font-claude-response-small { font-weight: 400; }

.font-claude-response-small, .font-claude-response-small-bold { font-family=
: var(--font-claude-response); font-size: 0.875rem; line-height: 1.5; }

.font-claude-response-small-bold { font-weight: 600; }

.font-claude-response-subheading { font-family: var(--font-claude-response)=
; font-size: 1rem; font-weight: 600; line-height: 1.35; }

.font-claude-response-title { font-family: var(--font-claude-response); fon=
t-size: 1.75rem; font-weight: 600; line-height: 1.3; font-variation-setting=
s: "opsz" 28; }

.font-bold { font-weight: 600; }

.\[-webkit-overflow-scrolling\:touch\] { }

.\[animation-name\:shimmertext\] { animation-name: shimmertext; }

.\[animation-play-state\:paused\] { animation-play-state: paused; }

.\[animation\:fade_var\(--modal-animation-duration\,250ms\)_ease-out_forwar=
ds\] { animation: fade var(--modal-animation-duration,.25s) ease-out forwar=
ds; }

.\[animation\:fade_var\(--modal-close-duration\,125ms\)_ease-in_reverse_for=
wards\] { animation: fade var(--modal-close-duration,125ms) ease-in reverse=
 forwards; }

.\[animation\:zoom_var\(--modal-animation-duration\,250ms\)_ease-out_forwar=
ds\] { animation: zoom var(--modal-animation-duration,.25s) ease-out forwar=
ds; }

.\[animation\:zoom_var\(--modal-close-duration\,125ms\)_ease-in_reverse_for=
wards\] { animation: zoom var(--modal-close-duration,125ms) ease-in reverse=
 forwards; }

.\[appearance\:textfield\] { appearance: textfield; }

.\!\[backdrop-filter\:none\] { backdrop-filter: none !important; }

.\[background-color\:hsl\(var\(--always-black\)\/var\(--modal-overlay-opaci=
ty\,0\.5\)\)\] { background-color: hsl(var(--always-black)/var(--modal-over=
lay-opacity,.5)); }

.\!\[background-color\:rgba\(0\,0\,0\,0\.05\)\] { background-color: rgba(0,=
 0, 0, 0.05) !important; }

.\[background-image\:linear-gradient\(to_right\,hsl\(var\(--bg-200\)\)_1px\=
,transparent_1px\)\,linear-gradient\(to_bottom\,hsl\(var\(--bg-200\)\)_1px\=
,transparent_1px\)\] { background-image: linear-gradient(to right,hsl(var(-=
-bg-200)) 1px,transparent 1px),linear-gradient(to bottom,hsl(var(--bg-200))=
 1px,transparent 1px); }

.\[background-size\:32px_32px\] { background-size: 32px 32px; }

.\[contain-intrinsic-size\:auto_500px\] { contain-intrinsic-size: auto 500p=
x; }

.\[content-visibility\:auto\] { content-visibility: auto; }

.\[field-sizing\:content\] { field-sizing: content; }

.\[font-feature-settings\:\'liga\'_1\] { font-feature-settings: "liga"; }

.\[font-feature-settings\:\'salt\'_on\] { font-feature-settings: "salt"; }

.\[grid-area\:1\/1\] { grid-area: 1 / 1; }

.\[letter-spacing\:-0\.03em\] { letter-spacing: -0.03em; }

.\[mask-image\:linear-gradient\(to_bottom\,_hsl\(var\(--always-black\)\/100=
\%\)_0\%\,_hsl\(var\(--always-black\)\/0\%\)_100\%\)\] { mask-image: linear=
-gradient(to bottom,hsl(var(--always-black)/100%) 0,hsl(var(--always-black)=
/0%) 100%); }

.\[mask-image\:linear-gradient\(to_bottom\,black_70\%\,transparent_100\%\)\=
] { mask-image: linear-gradient(black 70%, transparent); }

.\[mask-image\:linear-gradient\(to_right\,hsl\(var\(--always-black\)\)_78\%=
\,transparent_95\%\)\] { mask-image: linear-gradient(to right,hsl(var(--alw=
ays-black)) 78%,transparent 95%); }

.\[mask-image\:linear-gradient\(to_right\,hsl\(var\(--always-black\)\)_85\%=
\,transparent_98\%\)\] { mask-image: linear-gradient(to right,hsl(var(--alw=
ays-black)) 85%,transparent 98%); }

.\[mask-image\:linear-gradient\(to_top\,_hsl\(var\(--always-black\)\/0\%\)_=
0\%\,hsl\(var\(--always-black\)\/100\%\)_75\%\,_hsl\(var\(--always-black\)\=
/0\%\)_100\%\)\] { mask-image: linear-gradient(to top,hsl(var(--always-blac=
k)/0%) 0,hsl(var(--always-black)/100%) 75%,hsl(var(--always-black)/0%) 100%=
); }

.\[mask-image\:linear-gradient\(to_top\,hsl\(var\(--always-black\)\/0\%\)_0=
\%\,_hsl\(var\(--always-black\)\/100\%\)_3\%\)\] { mask-image: linear-gradi=
ent(to top,hsl(var(--always-black)/0%) 0,hsl(var(--always-black)/100%) 3%);=
 }

.\[mask-size\:100\%_100\%\] { mask-size: 100% 100%; }

.\[outline\:none\!important\] { outline: none !important; }

.\[overflow-wrap\:anywhere\] { overflow-wrap: anywhere; }

.\[overflow-y\:overlay\] { overflow-y: overlay; }

.\[scrollbar-color\:hsl\(var\(--border-400\)\)_transparent\] { scrollbar-co=
lor: hsl(var(--border-400)) transparent; }

.\[scrollbar-color\:hsl\(var\(--text-500\)\)\] { scrollbar-color: hsl(var(-=
-text-500)); }

.\[scrollbar-color\:transparent_transparent\] { scrollbar-color: transparen=
t transparent; }

.\[scrollbar-gutter\:stable\] { scrollbar-gutter: stable; }

.\[scrollbar-width\:none\] { scrollbar-width: none; }

.\[scrollbar-width\:thin\] { scrollbar-width: thin; }

.\!\[text-shadow\:_none\] { text-shadow: none !important; }

.\[text-wrap\:pretty\] { text-wrap: pretty; }

*, ::after, ::before { border-color: hsl(var(--border-100)); }

.chat-ui-core .standard-markdown hr + h1, .chat-ui-core .standard-markdown =
hr + h2, .chat-ui-core .standard-markdown hr + h3, .chat-ui-core .standard-=
markdown hr + h4 { margin-top: 0px !important; }

.chat-ui-core .standard-markdown div:has(> table) + hr { display: none; }

.chat-ui-core .max-w-3xl.px-6 :is(p, h1, h2, h3, h4, h5, h6) { padding-left=
: 0.5rem; }

.root { isolation: isolate; }

.can-focus, a, button, input, textarea { outline: 2px solid hsla(var(--acce=
nt-secondary-000)/0%); outline-offset: 2px; }

.can-focus-within:focus-within, .can-focus:focus-visible, .peer:focus-visib=
le ~ .peer\:can-focus, a:not([role=3D"menuitem"]):not(.hide-focus-ring):foc=
us-visible, button:not([role=3D"menuitem"]):not(.hide-focus-ring):focus-vis=
ible, input:not(.hide-focus-ring):focus-visible, textarea:not(.hide-focus-r=
ing):focus-visible { outline: 2px solid hsl(var(--accent-secondary-000)/70%=
); transition: outline 0.2s !important; }

.PhoneInput .PhoneInputInput { outline: none !important; }

[data-mode=3D"dark"] .PhoneInputCountrySelect { background-color: hsl(var(-=
-bg-200)); color: hsl(var(--text-000)); }

.h-screen { height: 100dvh; }

.min-h-screen { min-height: 100dvh; }

[data-headlessui-portal] + [data-headlessui-portal]:last-child .dialog-pane=
l--enter { border-top: 0.5px solid rgba(0, 0, 0, 0.25); transition-timing-f=
unction: cubic-bezier(0.75, 0, 0, 1.15); transition-duration: 0.5s; }

[data-headlessui-portal]:not(:last-child) .dialog-panel--enter { filter: br=
ightness(0.75); transform: scale(0.975) translateY(-16px); overflow: hidden=
; }

[data-headlessui-portal]:not(:last-child) .dialog-panel--enter .dialog-pane=
l__inner { opacity: 0.25; filter: blur(2px); }

img, svg { flex-shrink: 0; }

body, html { padding: 0px; margin: 0px; }

a { color: inherit; text-decoration: none; }

.inline-link { text-decoration-line: underline; text-underline-offset: 3px;=
 }

.inline-link:not(:is(:hover, :focus)) { text-decoration-color: color-mix(in=
 srgb, currentcolor 40%, transparent); }

* { box-sizing: border-box; outline-color: hsl(var(--accent-secondary-100))=
; scrollbar-width: thin; scrollbar-color: hsla(var(--border-300)/35%) trans=
parent; }

.ProseMirror { font-feature-settings: inherit !important; font-variant-liga=
tures: inherit !important; }

.ProseMirror:focus { outline: none; }

.ProseMirror p.is-editor-empty:first-child::before { color: rgb(173, 181, 1=
89); content: attr(data-placeholder); float: left; height: 0px; pointer-eve=
nts: none; }

.swagger-ui { width: 100%; }

div.ProseMirror h1 { font-size: 1.6rem; }

div.ProseMirror h1, div.ProseMirror h2 { margin: 0.1rem 0px 0.3rem; font-we=
ight: 600; }

div.ProseMirror h3 { margin: 0.1rem 0px 0.3rem; font-size: 1rem; font-weigh=
t: 500; }

div.ProseMirror ul { list-style-type: unset; padding-left: 2rem; }

div.ProseMirror ol { list-style-type: decimal; padding-left: 2rem; }

div.ProseMirror a { cursor: pointer; font-weight: 500; color: hsl(var(--acc=
ent-secondary-000)); }

div.ProseMirror a:hover { color: hsl(var(--accent-secondary-100)); }

div.ProseMirror table { margin: 1.2rem 0px; }

div.ProseMirror th { border: 1px solid rgb(213, 211, 209); padding: 0.5rem;=
 color: rgb(67, 64, 60); font-size: 0.875rem; }

div.ProseMirror td { border: 1px solid rgb(213, 211, 209); padding: 0.4rem;=
 color: rgb(119, 113, 109); }

div.ProseMirror > p > code { border: .5px solid rgb(from hsl(var(--border-3=
00)) r g b/.25); background-color: rgb(from hsl(var(--text-200)) r g b/.05)=
; font-size: 0.9rem; color: hsl(var(--danger-000)); padding: 1px 4px; borde=
r-radius: 0.3rem; white-space: pre-wrap; }

.anthropic-animated-logo * { fill: currentcolor !important; }

.fade-out-bottom { mask-image: linear-gradient(rgb(0, 0, 0) 65%, rgba(0, 0,=
 0, 0)); mask-size: 100% 100%; mask-repeat: no-repeat; }

.ReactMarkdown h1 { font-size: 1.6rem; }

.ReactMarkdown h1, .ReactMarkdown h2 { margin: 0.1rem 0px 0.3rem; font-weig=
ht: 600; }

.ReactMarkdown h3 { margin: 0.1rem 0px 0.3rem; font-size: 1rem; font-weight=
: 500; }

.ReactMarkdown a { cursor: pointer; font-weight: 500; color: hsl(var(--acce=
nt-secondary-000)); }

.ReactMarkdown a:hover { color: hsl(var(--accent-secondary-100)); }

.ReactMarkdown table { display: block; overflow-x: scroll; }

.ReactMarkdown td, .ReactMarkdown th { border: 1px solid rgb(213, 211, 209)=
; padding: 0.5rem; }

.ReactMarkdown code { border: .5px solid rgb(from hsl(var(--border-300)) r =
g b/.25); background-color: rgb(from hsl(var(--text-200)) r g b/.05); font-=
size: 0.9rem; color: hsl(var(--danger-000)); padding: 1px 4px; border-radiu=
s: 0.3rem; white-space: pre-wrap; }

.grecaptcha-badge { visibility: hidden; }

:root { --dropdown-max-height: 480px; }

.shadow-level-1 { box-shadow: rgba(0, 0, 0, 0.1) -80px 200px 120px 0px, rgb=
a(0, 0, 0, 0.15) -8px 20px 48px 0px; }

.animated-loading-background { background-image: linear-gradient(45deg,hsl(=
var(--bg-000)),hsl(var(--bg-200))); background-size: 250% 250%; animation: =
2s linear 0s infinite normal none running loading-background; }

.greeting-container { display: inline-flex; align-items: center; gap: 0.75r=
em; }

.greeting-container-animated { transform: translateX(0px); clip-path: inset=
(0px); transition: transform 0.6s cubic-bezier(0, 0.7, 0.4, 1) 0.1s, clip-p=
ath 0.6s cubic-bezier(0, 0.7, 0.4, 1) 0.1s; will-change: transform, clip-pa=
th; }

@starting-style {
  .greeting-container-animated { transform: translateX(calc(var(--reveal-di=
stance) / 2)); clip-path: inset(0 var(--reveal-distance) 0 0); }
}

@media (prefers-reduced-motion: reduce) {
  .greeting-container-animated { transition: none; transform: translateX(0p=
x); clip-path: inset(0px); }
}

@keyframes loading-background {=20
  0%, 100% { background-position: 0px 0px; }
  25% { background-position: 100% 0px; }
  50% { background-position: 100% 100%; }
  75% { background-position: 0px 100%; }
}

.code-block__code span::selection, .code-block__code::selection { backgroun=
d-color: hsl(var(--accent-secondary-100)); color: hsl(var(--oncolor-100)) !=
important; }

.code-block__code .table { display: inline; }

.code-block__code .linenumber::after { content: attr(data-line-number); use=
r-select: none !important; pointer-events: none !important; }

.u-hidden-scrollbar { scrollbar-width: none; }

.u-hidden-scrollbar::-webkit-scrollbar { width: 0px; opacity: 0; }

[data-mode=3D"dark"] { color-scheme: dark; }

.draggable { app-region: drag; user-select: none; }

.draggable a, .draggable button, .draggable input, .draggable select, .drag=
gable textarea, .draggable-none { app-region: no-drag; }

._dev-mode .debug { border: 1px dashed red; }

._dev-mode .debug2 { border: 1px solid blue; }

.\*\:absolute > * { position: absolute; }

.\*\:w-full > * { width: 100%; }

.\*\:rounded-lg > * { border-radius: 0.5rem; }

.\*\:border > * { border-width: 1px; }

.\*\:border-0 > * { border-width: 0px; }

.\*\:border-0\.5 > * { border-width: 0.5px; }

.\*\:border-border-300 > * { border-color: hsl(var(--border-300)/.15); }

.\*\:\!bg-transparent > * { background-color: transparent !important; }

.\*\:bg-always-white > * { --tw-bg-opacity: 1; background-color: hsl(var(--=
always-white)/var(--tw-bg-opacity)); }

.\*\:transition > * { transition-property: color, background-color, border-=
color, text-decoration-color, fill, stroke, opacity, box-shadow, transform,=
 filter, backdrop-filter; transition-timing-function: cubic-bezier(0.4, 0, =
0.2, 1); transition-duration: 0.15s; }

.\*\:transition-all > * { transition-property: all; transition-timing-funct=
ion: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }

.\*\:duration-300 > * { transition-duration: 0.3s; }

.\*\:ease-in-out > * { transition-timing-function: cubic-bezier(0.4, 0, 0.2=
, 1); }

.\*\:font-small > * { font-family: var(--font-ui); font-size: 0.75rem; font=
-weight: 430; line-height: 1.4; }

.placeholder\:text-sm::placeholder { font-size: 0.875rem; line-height: 1.25=
rem; }

.placeholder\:text-text-300::placeholder { --tw-text-opacity: 1; color: hsl=
(var(--text-300)/var(--tw-text-opacity)); }

.placeholder\:text-text-400::placeholder { --tw-text-opacity: 1; color: hsl=
(var(--text-400)/var(--tw-text-opacity)); }

.placeholder\:text-text-500::placeholder { --tw-text-opacity: 1; color: hsl=
(var(--text-500)/var(--tw-text-opacity)); }

.placeholder\:text-text-500\/50::placeholder { color: hsl(var(--text-500)/.=
5); }

.placeholder\:text-text-500\/70::placeholder { color: hsl(var(--text-500)/.=
7); }

.placeholder\:opacity-60::placeholder { opacity: 0.6; }

.placeholder\:opacity-75::placeholder { opacity: 0.75; }

.placeholder\:font-base::placeholder { font-family: var(--font-ui); font-si=
ze: 0.875rem; font-weight: 430; line-height: 1.4; }

.before\:absolute::before { content: var(--tw-content); position: absolute;=
 }

.before\:-left-2::before { content: var(--tw-content); left: -0.5rem; }

.before\:bottom-0::before { content: var(--tw-content); bottom: 0px; }

.before\:h-2::before { content: var(--tw-content); height: 0.5rem; }

.before\:w-2::before { content: var(--tw-content); width: 0.5rem; }

.before\:whitespace-nowrap::before { content: var(--tw-content); white-spac=
e: nowrap; }

.before\:rounded-br-lg::before { content: var(--tw-content); border-bottom-=
right-radius: 0.5rem; }

.before\:\!text-text-500::before { content: var(--tw-content); --tw-text-op=
acity: 1 !important; color: hsl(var(--text-500)/var(--tw-text-opacity)) !im=
portant; }

.before\:shadow-\[4px_0_0_0_hsl\(var\(--bg-300\)\)\]::before { content: var=
(--tw-content); --tw-shadow: 4px 0 0 0 hsl(var(--bg-300)); --tw-shadow-colo=
red: 4px 0 0 0 var(--tw-shadow-color); box-shadow: var(--tw-ring-offset-sha=
dow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.before\:content-\[\'\'\]::before { --tw-content: ""; content: var(--tw-con=
tent); }

.before\:content-\[\'\+\'\]::before { --tw-content: "+"; content: var(--tw-=
content); }

.before\:content-\[\'=C2=B7\'\]::before { --tw-content: "=C2=B7"; content: =
var(--tw-content); }

.before\:content-\[open-quote\]::before { --tw-content: open-quote; content=
: var(--tw-content); }

.after\:absolute::after { content: var(--tw-content); position: absolute; }

.after\:inset-0::after { content: var(--tw-content); inset: 0px; }

.after\:-right-2::after { content: var(--tw-content); right: -0.5rem; }

.after\:bottom-0::after { content: var(--tw-content); bottom: 0px; }

.after\:h-2::after { content: var(--tw-content); height: 0.5rem; }

.after\:w-2::after { content: var(--tw-content); width: 0.5rem; }

.after\:translate-x-\[-100\%\]::after { --tw-translate-x: -100%; }

.after\:translate-x-\[-100\%\]::after, .after\:translate-y-2::after { conte=
nt: var(--tw-content); transform: translate(var(--tw-translate-x),var(--tw-=
translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--=
tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.after\:translate-y-2::after { --tw-translate-y: 0.5rem; }

@keyframes shimmer {=20
  0% { content: var(--tw-content); transform: translateX(-100%); }
  60% { content: var(--tw-content); transform: translateX(100%); }
  100% { content: var(--tw-content); transform: translateX(100%); }
}

.after\:animate-\[shimmer_1\.5s_infinite\]::after { content: var(--tw-conte=
nt); animation: 1.5s ease 0s infinite normal none running shimmer; }

.after\:rounded-bl-lg::after { content: var(--tw-content); border-bottom-le=
ft-radius: 0.5rem; }

.after\:bg-\[radial-gradient\(at_bottom\,hsla\(var\(--bg-000\)\/20\%\)\,hsl=
a\(var\(--bg-000\)\/0\%\)\)\]::after { content: var(--tw-content); backgrou=
nd-image: radial-gradient(at bottom,hsla(var(--bg-000)/20%),hsla(var(--bg-0=
00)/0%)); }

.after\:bg-gradient-to-r::after { content: var(--tw-content); background-im=
age: linear-gradient(to right,var(--tw-gradient-stops)); }

.after\:from-always-white\/0::after { content: var(--tw-content); --tw-grad=
ient-from: hsl(var(--always-white)/0) var(--tw-gradient-from-position); --t=
w-gradient-to: hsl(var(--always-white)/0) var(--tw-gradient-to-position); -=
-tw-gradient-stops: var(--tw-gradient-from),var(--tw-gradient-to); }

.after\:from-bg-000\/0::after { content: var(--tw-content); --tw-gradient-f=
rom: hsl(var(--bg-000)/0) var(--tw-gradient-from-position); --tw-gradient-t=
o: hsl(var(--bg-000)/0) var(--tw-gradient-to-position); --tw-gradient-stops=
: var(--tw-gradient-from),var(--tw-gradient-to); }

.after\:from-0\%::after { content: var(--tw-content); --tw-gradient-from-po=
sition: 0%; }

.after\:\!via-always-white\/50::after { content: var(--tw-content); --tw-gr=
adient-to: hsl(var(--always-white)/0) var(--tw-gradient-to-position) !impor=
tant; --tw-gradient-stops: var(--tw-gradient-from),hsl(var(--always-white)/=
0.5) var(--tw-gradient-via-position),var(--tw-gradient-to) !important; }

.after\:via-always-white\/20::after { content: var(--tw-content); --tw-grad=
ient-to: hsl(var(--always-white)/0) var(--tw-gradient-to-position); --tw-gr=
adient-stops: var(--tw-gradient-from),hsl(var(--always-white)/0.2) var(--tw=
-gradient-via-position),var(--tw-gradient-to); }

.after\:via-bg-000\/20::after { content: var(--tw-content); --tw-gradient-t=
o: hsl(var(--bg-000)/0) var(--tw-gradient-to-position); --tw-gradient-stops=
: var(--tw-gradient-from),hsl(var(--bg-000)/0.2) var(--tw-gradient-via-posi=
tion),var(--tw-gradient-to); }

.after\:via-50\%::after { content: var(--tw-content); --tw-gradient-via-pos=
ition: 50%; }

.after\:to-always-white\/0::after { content: var(--tw-content); --tw-gradie=
nt-to: hsl(var(--always-white)/0) var(--tw-gradient-to-position); }

.after\:to-bg-000\/0::after { content: var(--tw-content); --tw-gradient-to:=
 hsl(var(--bg-000)/0) var(--tw-gradient-to-position); }

.after\:to-100\%::after { content: var(--tw-content); --tw-gradient-to-posi=
tion: 100%; }

.after\:opacity-0::after { content: var(--tw-content); opacity: 0; }

.after\:shadow-\[-4px_0_0_0_hsl\(var\(--bg-300\)\)\]::after { content: var(=
--tw-content); --tw-shadow: -4px 0 0 0 hsl(var(--bg-300)); --tw-shadow-colo=
red: -4px 0 0 0 var(--tw-shadow-color); box-shadow: var(--tw-ring-offset-sh=
adow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.after\:transition::after { content: var(--tw-content); transition-property=
: color, background-color, border-color, text-decoration-color, fill, strok=
e, opacity, box-shadow, transform, filter, backdrop-filter; transition-timi=
ng-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }

.after\:duration-200::after { content: var(--tw-content); transition-durati=
on: 0.2s; }

.after\:content-\[\'\'\]::after { --tw-content: ""; content: var(--tw-conte=
nt); }

.first\:mt-0:first-child { margin-top: 0px; }

.first\:rounded-t-lg:first-child { border-top-left-radius: 0.5rem; border-t=
op-right-radius: 0.5rem; }

.first\:border-l-0:first-child { border-left-width: 0px; }

.first\:border-t-0:first-child { border-top-width: 0px; }

.first\:pt-0:first-child { padding-top: 0px; }

.last\:mb-0:last-child { margin-bottom: 0px; }

.last\:flex-none:last-child { flex: 0 0 auto; }

.last\:border-0:last-child { border-width: 0px; }

.last\:\!border-b-0:last-child { border-bottom-width: 0px !important; }

.last\:border-b-0:last-child { border-bottom-width: 0px; }

.last\:border-r-0:last-child { border-right-width: 0px; }

.last\:pb-0:last-child { padding-bottom: 0px; }

.read-only\:text-text-200:read-only { --tw-text-opacity: 1; color: hsl(var(=
--text-200)/var(--tw-text-opacity)); }

.read-only\:\!opacity-100:read-only { opacity: 1 !important; }

.read-only\:opacity-50:read-only { opacity: 0.5; }

.focus-within\:border-accent-secondary-100:focus-within { --tw-border-opaci=
ty: 1; border-color: hsl(var(--accent-secondary-100)/var(--tw-border-opacit=
y)); }

.focus-within\:border-accent-secondary-200\/50:focus-within { border-color:=
 hsl(var(--accent-secondary-200)/.5); }

.focus-within\:border-border-200:focus-within { border-color: hsl(var(--bor=
der-200)/.3); }

.focus-within\:bg-bg-000:focus-within { --tw-bg-opacity: 1; background-colo=
r: hsl(var(--bg-000)/var(--tw-bg-opacity)); }

.focus-within\:text-text-100:focus-within { --tw-text-opacity: 1; color: hs=
l(var(--text-100)/var(--tw-text-opacity)); }

.focus-within\:shadow-\[0_0\.25rem_1\.25rem_hsl\(var\(--always-black\)\/7\.=
5\%\)\,0_0_0_0\.5px_hsla\(var\(--border-200\)\/0\.3\)\]:focus-within { --tw=
-shadow: 0 0.25rem 1.25rem hsl(var(--always-black)/7.5%),0 0 0 0.5px hsla(v=
ar(--border-200)/0.3); --tw-shadow-colored: 0 0.25rem 1.25rem var(--tw-shad=
ow-color),0 0 0 0.5px var(--tw-shadow-color); box-shadow: var(--tw-ring-off=
set-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.focus-within\:shadow-\[0_0\.25rem_1\.25rem_hsl\(var\(--always-black\)\/7\.=
5\%\)\]:focus-within { --tw-shadow: 0 0.25rem 1.25rem hsl(var(--always-blac=
k)/7.5%); --tw-shadow-colored: 0 0.25rem 1.25rem var(--tw-shadow-color); bo=
x-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #=
0000),var(--tw-shadow); }

.focus-within\:shadow-\[inset_0_1px_4px_2px_hsl\(var\(--always-black\)\/12\=
%\)\]:focus-within { --tw-shadow: inset 0 1px 4px 2px hsl(var(--always-blac=
k)/12%); --tw-shadow-colored: inset 0 1px 4px 2px var(--tw-shadow-color); b=
ox-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 =
#0000),var(--tw-shadow); }

.focus-within\:shadow-md:focus-within { --tw-shadow: 0 4px 6px -1px rgb(0 0=
 0/0.1),0 2px 4px -2px rgb(0 0 0/0.1); --tw-shadow-colored: 0 4px 6px -1px =
var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color); box-shadow: v=
ar(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(-=
-tw-shadow); }

.focus-within\:shadow-sm:focus-within { --tw-shadow: 0 1px 2px 0 rgb(0 0 0/=
0.05); --tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color); box-shadow:=
 var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var=
(--tw-shadow); }

.focus-within\:outline-2:focus-within { outline-width: 2px; }

.focus-within\:outline-accent-main-200:focus-within { outline-color: hsl(va=
r(--accent-main-200)/1); }

.focus-within\:ring:focus-within { --tw-ring-offset-shadow: var(--tw-ring-i=
nset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color); --tw-r=
ing-shadow: var(--tw-ring-inset) 0 0 0 calc(3px + var(--tw-ring-offset-widt=
h)) var(--tw-ring-color); box-shadow: var(--tw-ring-offset-shadow),var(--tw=
-ring-shadow),var(--tw-shadow,0 0 #0000); }

.hover\:-my-px:hover { margin-top: -1px; margin-bottom: -1px; }

.hover\:w-1:hover { width: 0.25rem; }

.hover\:-rotate-3:hover { --tw-rotate: -3deg; }

.hover\:-rotate-3:hover, .hover\:rotate-2:hover { transform: translate(var(=
--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var=
(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var=
(--tw-scale-y)); }

.hover\:rotate-2:hover { --tw-rotate: 2deg; }

.hover\:scale-105:hover { --tw-scale-x: 1.05; --tw-scale-y: 1.05; }

.hover\:scale-105:hover, .hover\:scale-110:hover { transform: translate(var=
(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(va=
r(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(va=
r(--tw-scale-y)); }

.hover\:scale-110:hover { --tw-scale-x: 1.1; --tw-scale-y: 1.1; }

.hover\:scale-\[1\.01\]:hover { --tw-scale-x: 1.01; --tw-scale-y: 1.01; }

.hover\:scale-\[1\.01\]:hover, .hover\:scale-\[1\.02\]:hover { transform: t=
ranslate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotat=
e)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x=
)) scaleY(var(--tw-scale-y)); }

.hover\:scale-\[1\.02\]:hover { --tw-scale-x: 1.02; --tw-scale-y: 1.02; }

.hover\:scale-x-\[1\.005\]:hover { --tw-scale-x: 1.005; }

.hover\:scale-x-\[1\.005\]:hover, .hover\:scale-y-\[1\.015\]:hover { transf=
orm: translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw=
-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-s=
cale-x)) scaleY(var(--tw-scale-y)); }

.hover\:scale-y-\[1\.015\]:hover { --tw-scale-y: 1.015; }

.hover\:cursor-grab:hover { cursor: grab; }

.hover\:rounded-full:hover { border-radius: 9999px; }

.hover\:rounded-lg:hover { border-radius: 0.5rem; }

.hover\:rounded-xl:hover { border-radius: 0.75rem; }

.hover\:rounded-b-xl:hover { border-bottom-right-radius: 0.75rem; border-bo=
ttom-left-radius: 0.75rem; }

.hover\:rounded-t-xl:hover { border-top-left-radius: 0.75rem; border-top-ri=
ght-radius: 0.75rem; }

.hover\:\!border-0:hover { border-width: 0px !important; }

.hover\:\!border-0\.5:hover { border-width: 0.5px !important; }

.hover\:border-\[0\.5px\]:hover { border-width: 0.5px; }

.hover\:\!border-border-100:hover { border-color: hsl(var(--border-100)/.4)=
 !important; }

.hover\:\!border-border-400:hover { border-color: hsl(var(--border-400)/.15=
) !important; }

.hover\:\!border-danger-200\/90:hover { border-color: hsl(var(--danger-200)=
/.9) !important; }

.hover\:\!border-text-300:hover { --tw-border-opacity: 1 !important; border=
-color: hsl(var(--text-300)/var(--tw-border-opacity)) !important; }

.hover\:border-accent-secondary-000:hover { --tw-border-opacity: 1; border-=
color: hsl(var(--accent-secondary-000)/var(--tw-border-opacity)); }

.hover\:border-accent-secondary-100:hover { --tw-border-opacity: 1; border-=
color: hsl(var(--accent-secondary-100)/var(--tw-border-opacity)); }

.hover\:border-accent-secondary-100\/50:hover { border-color: hsl(var(--acc=
ent-secondary-100)/.5); }

.hover\:border-bg-300:hover { --tw-border-opacity: 1; border-color: hsl(var=
(--bg-300)/var(--tw-border-opacity)); }

.hover\:border-border-100:hover { border-color: hsl(var(--border-100)/.4); =
}

.hover\:border-border-200:hover { border-color: hsl(var(--border-200)/.3); =
}

.hover\:border-border-200\/50:hover { border-color: hsl(var(--border-200)/.=
5); }

.hover\:border-border-300:hover { border-color: hsl(var(--border-300)/.15);=
 }

.hover\:border-border-300\/30:hover { border-color: hsl(var(--border-300)/.=
3); }

.hover\:border-border-400:hover { border-color: hsl(var(--border-400)/.15);=
 }

.hover\:border-border-400\/50:hover { border-color: hsl(var(--border-400)/.=
5); }

.hover\:border-danger-200:hover { --tw-border-opacity: 1; border-color: hsl=
(var(--danger-200)/var(--tw-border-opacity)); }

.hover\:border-text-100:hover { --tw-border-opacity: 1; border-color: hsl(v=
ar(--text-100)/var(--tw-border-opacity)); }

.hover\:border-text-200:hover { --tw-border-opacity: 1; border-color: hsl(v=
ar(--text-200)/var(--tw-border-opacity)); }

.hover\:border-text-300:hover { --tw-border-opacity: 1; border-color: hsl(v=
ar(--text-300)/var(--tw-border-opacity)); }

.hover\:border-text-400:hover { --tw-border-opacity: 1; border-color: hsl(v=
ar(--text-400)/var(--tw-border-opacity)); }

.hover\:border-text-500:hover { --tw-border-opacity: 1; border-color: hsl(v=
ar(--text-500)/var(--tw-border-opacity)); }

.hover\:border-transparent:hover { border-color: transparent; }

.hover\:\!bg-accent-secondary-100:hover { --tw-bg-opacity: 1 !important; ba=
ckground-color: hsl(var(--accent-secondary-100)/var(--tw-bg-opacity)) !impo=
rtant; }

.hover\:\!bg-accent-secondary-100\/10:hover { background-color: hsl(var(--a=
ccent-secondary-100)/.1) !important; }

.hover\:\!bg-accent-secondary-100\/15:hover { background-color: hsl(var(--a=
ccent-secondary-100)/.15) !important; }

.hover\:\!bg-accent-secondary-200:hover { --tw-bg-opacity: 1 !important; ba=
ckground-color: hsl(var(--accent-secondary-200)/var(--tw-bg-opacity)) !impo=
rtant; }

.hover\:\!bg-accent-secondary-200\/20:hover { background-color: hsl(var(--a=
ccent-secondary-200)/.2) !important; }

.hover\:\!bg-accent-secondary-900:hover { --tw-bg-opacity: 1 !important; ba=
ckground-color: hsl(var(--accent-secondary-900)/var(--tw-bg-opacity)) !impo=
rtant; }

.hover\:\!bg-always-white\/10:hover { background-color: hsl(var(--always-wh=
ite)/.1) !important; }

.hover\:\!bg-always-white\/20:hover { background-color: hsl(var(--always-wh=
ite)/.2) !important; }

.hover\:\!bg-bg-000:hover { --tw-bg-opacity: 1 !important; background-color=
: hsl(var(--bg-000)/var(--tw-bg-opacity)) !important; }

.hover\:\!bg-bg-000\/10:hover { background-color: hsl(var(--bg-000)/.1) !im=
portant; }

.hover\:\!bg-bg-200:hover { --tw-bg-opacity: 1 !important; background-color=
: hsl(var(--bg-200)/var(--tw-bg-opacity)) !important; }

.hover\:\!bg-bg-300:hover { --tw-bg-opacity: 1 !important; background-color=
: hsl(var(--bg-300)/var(--tw-bg-opacity)) !important; }

.hover\:\!bg-bg-400:hover { --tw-bg-opacity: 1 !important; background-color=
: hsl(var(--bg-400)/var(--tw-bg-opacity)) !important; }

.hover\:\!bg-text-200:hover { --tw-bg-opacity: 1 !important; background-col=
or: hsl(var(--text-200)/var(--tw-bg-opacity)) !important; }

.hover\:\!bg-transparent:hover { background-color: transparent !important; =
}

.hover\:bg-\[hsl\(210\,70\%\,50\%\)\]\/20:hover { background-color: rgba(38=
, 128, 217, 0.2); }

.hover\:bg-\[hsla\(130\,35\%\,88\%\,0\.9\)\]:hover { background-color: rgba=
(214, 235, 217, 0.9); }

.hover\:bg-accent-main-000:hover { --tw-bg-opacity: 1; background-color: hs=
l(var(--accent-main-000)/var(--tw-bg-opacity)); }

.hover\:bg-accent-main-100:hover { --tw-bg-opacity: 1; background-color: hs=
l(var(--accent-main-100)/var(--tw-bg-opacity)); }

.hover\:bg-accent-main-100\/20:hover { background-color: hsl(var(--accent-m=
ain-100)/.2); }

.hover\:bg-accent-main-200:hover { --tw-bg-opacity: 1; background-color: hs=
l(var(--accent-main-200)/var(--tw-bg-opacity)); }

.hover\:bg-accent-pro-200:hover { --tw-bg-opacity: 1; background-color: hsl=
(var(--accent-pro-200)/var(--tw-bg-opacity)); }

.hover\:bg-accent-secondary-000:hover { --tw-bg-opacity: 1; background-colo=
r: hsl(var(--accent-secondary-000)/var(--tw-bg-opacity)); }

.hover\:bg-accent-secondary-100:hover { --tw-bg-opacity: 1; background-colo=
r: hsl(var(--accent-secondary-100)/var(--tw-bg-opacity)); }

.hover\:bg-accent-secondary-100\/10:hover { background-color: hsl(var(--acc=
ent-secondary-100)/.1); }

.hover\:bg-accent-secondary-100\/\[12\%\]:hover { background-color: hsl(var=
(--accent-secondary-100)/12%); }

.hover\:bg-accent-secondary-200:hover { --tw-bg-opacity: 1; background-colo=
r: hsl(var(--accent-secondary-200)/var(--tw-bg-opacity)); }

.hover\:bg-accent-secondary-900:hover { --tw-bg-opacity: 1; background-colo=
r: hsl(var(--accent-secondary-900)/var(--tw-bg-opacity)); }

.hover\:bg-accent-secondary-900\/45:hover { background-color: hsl(var(--acc=
ent-secondary-900)/.45); }

.hover\:bg-accent-secondary-900\/50:hover { background-color: hsl(var(--acc=
ent-secondary-900)/.5); }

.hover\:bg-always-black\/80:hover { background-color: hsl(var(--always-blac=
k)/.8); }

.hover\:bg-always-white\/10:hover { background-color: hsl(var(--always-whit=
e)/.1); }

.hover\:bg-bg-000:hover { --tw-bg-opacity: 1; background-color: hsl(var(--b=
g-000)/var(--tw-bg-opacity)); }

.hover\:bg-bg-000\/10:hover { background-color: hsl(var(--bg-000)/.1); }

.hover\:bg-bg-000\/20:hover { background-color: hsl(var(--bg-000)/.2); }

.hover\:bg-bg-000\/50:hover { background-color: hsl(var(--bg-000)/.5); }

.hover\:bg-bg-000\/80:hover { background-color: hsl(var(--bg-000)/.8); }

.hover\:bg-bg-100:hover { --tw-bg-opacity: 1; background-color: hsl(var(--b=
g-100)/var(--tw-bg-opacity)); }

.hover\:bg-bg-100\/50:hover { background-color: hsl(var(--bg-100)/.5); }

.hover\:bg-bg-100\/90:hover { background-color: hsl(var(--bg-100)/.9); }

.hover\:bg-bg-200:hover { --tw-bg-opacity: 1; background-color: hsl(var(--b=
g-200)/var(--tw-bg-opacity)); }

.hover\:bg-bg-200\/50:hover { background-color: hsl(var(--bg-200)/.5); }

.hover\:bg-bg-200\/70:hover { background-color: hsl(var(--bg-200)/.7); }

.hover\:bg-bg-200\/90:hover { background-color: hsl(var(--bg-200)/.9); }

.hover\:bg-bg-300:hover { --tw-bg-opacity: 1; background-color: hsl(var(--b=
g-300)/var(--tw-bg-opacity)); }

.hover\:bg-bg-300\/50:hover { background-color: hsl(var(--bg-300)/.5); }

.hover\:bg-bg-300\/60:hover { background-color: hsl(var(--bg-300)/.6); }

.hover\:bg-bg-300\/80:hover { background-color: hsl(var(--bg-300)/.8); }

.hover\:bg-bg-400:hover { --tw-bg-opacity: 1; background-color: hsl(var(--b=
g-400)/var(--tw-bg-opacity)); }

.hover\:bg-bg-400\/40:hover { background-color: hsl(var(--bg-400)/.4); }

.hover\:bg-bg-500:hover { --tw-bg-opacity: 1; background-color: hsl(var(--b=
g-500)/var(--tw-bg-opacity)); }

.hover\:bg-bg-500\/30:hover { background-color: hsl(var(--bg-500)/.3); }

.hover\:bg-bg-500\/60:hover { background-color: hsl(var(--bg-500)/.6); }

.hover\:bg-border-400\/50:hover { background-color: hsl(var(--border-400)/.=
5); }

.hover\:bg-danger-000:hover { --tw-bg-opacity: 1; background-color: hsl(var=
(--danger-000)/var(--tw-bg-opacity)); }

.hover\:bg-danger-100:hover { --tw-bg-opacity: 1; background-color: hsl(var=
(--danger-100)/var(--tw-bg-opacity)); }

.hover\:bg-danger-100\/20:hover { background-color: hsl(var(--danger-100)/.=
2); }

.hover\:bg-danger-200:hover { --tw-bg-opacity: 1; background-color: hsl(var=
(--danger-200)/var(--tw-bg-opacity)); }

.hover\:bg-danger-200\/20:hover { background-color: hsl(var(--danger-200)/.=
2); }

.hover\:bg-danger-900:hover { --tw-bg-opacity: 1; background-color: hsl(var=
(--danger-900)/var(--tw-bg-opacity)); }

.hover\:bg-danger-900\/90:hover { background-color: hsl(var(--danger-900)/.=
9); }

.hover\:bg-success-000:hover { --tw-bg-opacity: 1; background-color: hsl(va=
r(--success-000)/var(--tw-bg-opacity)); }

.hover\:bg-text-100\/50:hover { background-color: hsl(var(--text-100)/.5); =
}

.hover\:bg-text-200:hover { --tw-bg-opacity: 1; background-color: hsl(var(-=
-text-200)/var(--tw-bg-opacity)); }

.hover\:bg-text-500\/70:hover { background-color: hsl(var(--text-500)/.7); =
}

.hover\:bg-transparent:hover { background-color: transparent; }

.hover\:bg-warning-000:hover { --tw-bg-opacity: 1; background-color: hsl(va=
r(--warning-000)/var(--tw-bg-opacity)); }

.hover\:bg-opacity-10:hover { --tw-bg-opacity: 0.1; }

.hover\:from-bg-000:hover { --tw-gradient-from: hsl(var(--bg-000)/1) var(--=
tw-gradient-from-position); --tw-gradient-to: hsl(var(--bg-000)/0) var(--tw=
-gradient-to-position); --tw-gradient-stops: var(--tw-gradient-from),var(--=
tw-gradient-to); }

.hover\:from-bg-000\/70:hover { --tw-gradient-from: hsl(var(--bg-000)/0.7) =
var(--tw-gradient-from-position); --tw-gradient-to: hsl(var(--bg-000)/0) va=
r(--tw-gradient-to-position); --tw-gradient-stops: var(--tw-gradient-from),=
var(--tw-gradient-to); }

.hover\:from-bg-400\/0:hover { --tw-gradient-from: hsl(var(--bg-400)/0) var=
(--tw-gradient-from-position); --tw-gradient-to: hsl(var(--bg-400)/0) var(-=
-tw-gradient-to-position); --tw-gradient-stops: var(--tw-gradient-from),var=
(--tw-gradient-to); }

.hover\:to-bg-000\/50:hover { --tw-gradient-to: hsl(var(--bg-000)/0.5) var(=
--tw-gradient-to-position); }

.hover\:to-bg-000\/80:hover { --tw-gradient-to: hsl(var(--bg-000)/0.8) var(=
--tw-gradient-to-position); }

.hover\:to-bg-400\/50:hover { --tw-gradient-to: hsl(var(--bg-400)/0.5) var(=
--tw-gradient-to-position); }

.hover\:py-\[calc\(1rem\+1px\)\]:hover { padding-top: calc(1px + 1rem); pad=
ding-bottom: calc(1px + 1rem); }

.hover\:pl-2:hover { padding-left: 0.5rem; }

.hover\:\!text-always-white:hover { --tw-text-opacity: 1 !important; color:=
 hsl(var(--always-white)/var(--tw-text-opacity)) !important; }

.hover\:\!text-oncolor-100:hover { --tw-text-opacity: 1 !important; color: =
hsl(var(--oncolor-100)/var(--tw-text-opacity)) !important; }

.hover\:\!text-text-100:hover { --tw-text-opacity: 1 !important; color: hsl=
(var(--text-100)/var(--tw-text-opacity)) !important; }

.hover\:\!text-text-200:hover { --tw-text-opacity: 1 !important; color: hsl=
(var(--text-200)/var(--tw-text-opacity)) !important; }

.hover\:\!text-text-400:hover { --tw-text-opacity: 1 !important; color: hsl=
(var(--text-400)/var(--tw-text-opacity)) !important; }

.hover\:text-accent-main-000:hover { --tw-text-opacity: 1; color: hsl(var(-=
-accent-main-000)/var(--tw-text-opacity)); }

.hover\:text-accent-main-100:hover { --tw-text-opacity: 1; color: hsl(var(-=
-accent-main-100)/var(--tw-text-opacity)); }

.hover\:text-accent-main-200:hover { --tw-text-opacity: 1; color: hsl(var(-=
-accent-main-200)/var(--tw-text-opacity)); }

.hover\:text-accent-secondary-000:hover { --tw-text-opacity: 1; color: hsl(=
var(--accent-secondary-000)/var(--tw-text-opacity)); }

.hover\:text-accent-secondary-200:hover { --tw-text-opacity: 1; color: hsl(=
var(--accent-secondary-200)/var(--tw-text-opacity)); }

.hover\:text-always-white:hover { --tw-text-opacity: 1; color: hsl(var(--al=
ways-white)/var(--tw-text-opacity)); }

.hover\:text-always-white\/80:hover { color: hsl(var(--always-white)/.8); }

.hover\:text-danger-000:hover { --tw-text-opacity: 1; color: hsl(var(--dang=
er-000)/var(--tw-text-opacity)); }

.hover\:text-danger-100:hover { --tw-text-opacity: 1; color: hsl(var(--dang=
er-100)/var(--tw-text-opacity)); }

.hover\:text-oncolor-100:hover { --tw-text-opacity: 1; color: hsl(var(--onc=
olor-100)/var(--tw-text-opacity)); }

.hover\:text-success-000:hover { --tw-text-opacity: 1; color: hsl(var(--suc=
cess-000)/var(--tw-text-opacity)); }

.hover\:text-text-000:hover { --tw-text-opacity: 1; color: hsl(var(--text-0=
00)/var(--tw-text-opacity)); }

.hover\:text-text-100:hover { --tw-text-opacity: 1; color: hsl(var(--text-1=
00)/var(--tw-text-opacity)); }

.hover\:text-text-200:hover { --tw-text-opacity: 1; color: hsl(var(--text-2=
00)/var(--tw-text-opacity)); }

.hover\:text-text-200\/90:hover { color: hsl(var(--text-200)/.9); }

.hover\:text-text-300:hover { --tw-text-opacity: 1; color: hsl(var(--text-3=
00)/var(--tw-text-opacity)); }

.hover\:text-text-400:hover { --tw-text-opacity: 1; color: hsl(var(--text-4=
00)/var(--tw-text-opacity)); }

.hover\:text-warning-100:hover { --tw-text-opacity: 1; color: hsl(var(--war=
ning-100)/var(--tw-text-opacity)); }

.hover\:underline:hover { text-decoration-line: underline; }

.hover\:no-underline:hover { text-decoration-line: none; }

.hover\:decoration-current:hover { text-decoration-color: currentcolor; }

.hover\:\!opacity-90:hover { opacity: 0.9 !important; }

.hover\:opacity-100:hover { opacity: 1; }

.hover\:opacity-60:hover { opacity: 0.6; }

.hover\:opacity-70:hover { opacity: 0.7; }

.hover\:opacity-80:hover { opacity: 0.8; }

.hover\:opacity-90:hover { opacity: 0.9; }

.hover\:opacity-95:hover { opacity: 0.95; }

.hover\:shadow-2xl:hover { --tw-shadow: 0 25px 50px -12px rgb(0 0 0/0.25); =
--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color); box-shadow: =
var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(=
--tw-shadow); }

.hover\:shadow-\[0_0\.25rem_1\.25rem_hsl\(var\(--always-black\)\/3\.5\%\)\,=
0_0_0_0\.5px_hsla\(var\(--border-200\)\/0\.3\)\]:hover { --tw-shadow: 0 0.2=
5rem 1.25rem hsl(var(--always-black)/3.5%),0 0 0 0.5px hsla(var(--border-20=
0)/0.3); --tw-shadow-colored: 0 0.25rem 1.25rem var(--tw-shadow-color),0 0 =
0 0.5px var(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0=
 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.hover\:shadow-\[0_4px_20px_0_hsl\(var\(--always-black\)\/4\%\)\]:hover { -=
-tw-shadow: 0 4px 20px 0 hsl(var(--always-black)/4%); --tw-shadow-colored: =
0 4px 20px 0 var(--tw-shadow-color); }

.hover\:shadow-\[0_4px_20px_0_hsl\(var\(--always-black\)\/4\%\)\]:hover, .h=
over\:shadow-lg:hover { box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),=
var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.hover\:shadow-lg:hover { --tw-shadow: 0 10px 15px -3px rgb(0 0 0/0.1),0 4p=
x 6px -4px rgb(0 0 0/0.1); --tw-shadow-colored: 0 10px 15px -3px var(--tw-s=
hadow-color),0 4px 6px -4px var(--tw-shadow-color); }

.hover\:shadow-md:hover { --tw-shadow: 0 4px 6px -1px rgb(0 0 0/0.1),0 2px =
4px -2px rgb(0 0 0/0.1); --tw-shadow-colored: 0 4px 6px -1px var(--tw-shado=
w-color),0 2px 4px -2px var(--tw-shadow-color); }

.hover\:shadow-md:hover, .hover\:shadow-sm:hover { box-shadow: var(--tw-rin=
g-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)=
; }

.hover\:shadow-sm:hover { --tw-shadow: 0 1px 2px 0 rgb(0 0 0/0.05); --tw-sh=
adow-colored: 0 1px 2px 0 var(--tw-shadow-color); }

.hover\:shadow-always-black\/10:hover { --tw-shadow-color: hsl(var(--always=
-black)/0.1); --tw-shadow: var(--tw-shadow-colored); }

.hover\:shadow-bg-300\/50:hover { --tw-shadow-color: hsl(var(--bg-300)/0.5)=
; --tw-shadow: var(--tw-shadow-colored); }

.hover\:ring-2:hover { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 =
var(--tw-ring-offset-width) var(--tw-ring-offset-color); --tw-ring-shadow: =
var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw=
-ring-color); box-shadow: var(--tw-ring-offset-shadow),var(--tw-ring-shadow=
),var(--tw-shadow,0 0 #0000); }

.hover\:ring-border-400\/30:hover { --tw-ring-color: hsl(var(--border-400)/=
0.3); }

.hover\:ring-offset-2:hover { --tw-ring-offset-width: 2px; }

.hover\:ring-offset-bg-100:hover { --tw-ring-offset-color: hsl(var(--bg-100=
)/1); }

.hover\:drop-shadow-sm:hover { --tw-drop-shadow: drop-shadow(0 1px 1px rgb(=
0 0 0/0.05)); filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast=
) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-satura=
te) var(--tw-sepia) var(--tw-drop-shadow); }

.hover\:\[scrollbar-color\:hsl\(var\(--border-300\)\)_transparent\]:hover {=
 scrollbar-color: hsl(var(--border-300)) transparent; }

.hover\:after\:translate-y-0:hover::after { content: var(--tw-content); --t=
w-translate-y: 0px; transform: translate(var(--tw-translate-x),var(--tw-tra=
nslate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-=
skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.hover\:after\:opacity-100:hover::after { content: var(--tw-content); opaci=
ty: 1; }

.read-only\:hover\:border-border-300:hover:read-only { border-color: hsl(va=
r(--border-300)/.15); }

.hover\:focus-within\:shadow-\[0_0\.25rem_1\.25rem_hsl\(var\(--always-black=
\)\/7\.5\%\)\,0_0_0_0\.5px_hsla\(var\(--border-200\)\/0\.3\)\]:focus-within=
:hover { --tw-shadow: 0 0.25rem 1.25rem hsl(var(--always-black)/7.5%),0 0 0=
 0.5px hsla(var(--border-200)/0.3); --tw-shadow-colored: 0 0.25rem 1.25rem =
var(--tw-shadow-color),0 0 0 0.5px var(--tw-shadow-color); box-shadow: var(=
--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw=
-shadow); }

.focus\:border-0:focus { border-width: 0px; }

.focus\:\!border-danger-200:focus { --tw-border-opacity: 1 !important; bord=
er-color: hsl(var(--danger-200)/var(--tw-border-opacity)) !important; }

.focus\:border-accent-main-100:focus { --tw-border-opacity: 1; border-color=
: hsl(var(--accent-main-100)/var(--tw-border-opacity)); }

.focus\:border-accent-secondary-100:focus { --tw-border-opacity: 1; border-=
color: hsl(var(--accent-secondary-100)/var(--tw-border-opacity)); }

.focus\:border-accent-secondary-200:focus { --tw-border-opacity: 1; border-=
color: hsl(var(--accent-secondary-200)/var(--tw-border-opacity)); }

.focus\:border-border-100:focus { border-color: hsl(var(--border-100)/.4); =
}

.focus\:border-border-200:focus { border-color: hsl(var(--border-200)/.3); =
}

.focus\:border-danger-200:focus { --tw-border-opacity: 1; border-color: hsl=
(var(--danger-200)/var(--tw-border-opacity)); }

.focus\:border-text-000:focus { --tw-border-opacity: 1; border-color: hsl(v=
ar(--text-000)/var(--tw-border-opacity)); }

.focus\:border-transparent:focus { border-color: transparent; }

.focus\:bg-bg-200:focus { --tw-bg-opacity: 1; background-color: hsl(var(--b=
g-200)/var(--tw-bg-opacity)); }

.focus\:bg-bg-300:focus { --tw-bg-opacity: 1; background-color: hsl(var(--b=
g-300)/var(--tw-bg-opacity)); }

.focus\:decoration-current:focus { text-decoration-color: currentcolor; }

.focus\:opacity-100:focus { opacity: 1; }

.focus\:shadow-none:focus { --tw-shadow: 0 0 #0000; --tw-shadow-colored: 0 =
0 #0000; box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-s=
hadow,0 0 #0000),var(--tw-shadow); }

.focus\:\!outline-none:focus { outline: transparent solid 2px !important; o=
utline-offset: 2px !important; }

.focus\:outline-none:focus { outline: transparent solid 2px; outline-offset=
: 2px; }

.focus\:outline-2:focus { outline-width: 2px; }

.focus\:outline-offset-2:focus { outline-offset: 2px; }

.focus\:\!ring-0:focus { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 =
0 var(--tw-ring-offset-width) var(--tw-ring-offset-color) !important; --tw-=
ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-wid=
th)) var(--tw-ring-color) !important; box-shadow: var(--tw-ring-offset-shad=
ow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000) !important; }

.focus\:ring:focus { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 va=
r(--tw-ring-offset-width) var(--tw-ring-offset-color); --tw-ring-shadow: va=
r(--tw-ring-inset) 0 0 0 calc(3px + var(--tw-ring-offset-width)) var(--tw-r=
ing-color); }

.focus\:ring-0:focus, .focus\:ring:focus { box-shadow: var(--tw-ring-offset=
-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000); }

.focus\:ring-0:focus { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 =
var(--tw-ring-offset-width) var(--tw-ring-offset-color); --tw-ring-shadow: =
var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw=
-ring-color); }

.focus\:ring-1:focus { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 =
var(--tw-ring-offset-width) var(--tw-ring-offset-color); --tw-ring-shadow: =
var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw=
-ring-color); }

.focus\:ring-1:focus, .focus\:ring-2:focus { box-shadow: var(--tw-ring-offs=
et-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000); }

.focus\:ring-2:focus { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 =
var(--tw-ring-offset-width) var(--tw-ring-offset-color); --tw-ring-shadow: =
var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw=
-ring-color); }

.focus\:ring-accent-main-000:focus { --tw-ring-opacity: 1; --tw-ring-color:=
 hsl(var(--accent-main-000)/var(--tw-ring-opacity)); }

.focus\:ring-accent-main-100:focus { --tw-ring-opacity: 1; --tw-ring-color:=
 hsl(var(--accent-main-100)/var(--tw-ring-opacity)); }

.focus\:ring-accent-main-100\/20:focus { --tw-ring-color: hsl(var(--accent-=
main-100)/0.2); }

.focus\:ring-accent-main-200:focus { --tw-ring-opacity: 1; --tw-ring-color:=
 hsl(var(--accent-main-200)/var(--tw-ring-opacity)); }

.focus\:ring-accent-main-900:focus { --tw-ring-opacity: 1; --tw-ring-color:=
 hsl(var(--accent-main-900)/var(--tw-ring-opacity)); }

.focus\:ring-accent-secondary-200:focus { --tw-ring-opacity: 1; --tw-ring-c=
olor: hsl(var(--accent-secondary-200)/var(--tw-ring-opacity)); }

.focus\:ring-bg-500:focus { --tw-ring-opacity: 1; --tw-ring-color: hsl(var(=
--bg-500)/var(--tw-ring-opacity)); }

.focus\:ring-offset-2:focus { --tw-ring-offset-width: 2px; }

.focus\:ring-offset-bg-000:focus { --tw-ring-offset-color: hsl(var(--bg-000=
)/1); }

.focus-visible\:z-10:focus-visible { z-index: 10; }

.focus-visible\:outline-none:focus-visible { outline: transparent solid 2px=
; outline-offset: 2px; }

.focus-visible\:ring-1:focus-visible { --tw-ring-offset-shadow: var(--tw-ri=
ng-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color); --=
tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-=
width)) var(--tw-ring-color); box-shadow: var(--tw-ring-offset-shadow),var(=
--tw-ring-shadow),var(--tw-shadow,0 0 #0000); }

.focus-visible\:ring-2:focus-visible { --tw-ring-offset-shadow: var(--tw-ri=
ng-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color); --=
tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-=
width)) var(--tw-ring-color); box-shadow: var(--tw-ring-offset-shadow),var(=
--tw-ring-shadow),var(--tw-shadow,0 0 #0000); }

.focus-visible\:ring-inset:focus-visible { --tw-ring-inset: inset; }

.focus-visible\:ring-accent-main-100:focus-visible { --tw-ring-opacity: 1; =
--tw-ring-color: hsl(var(--accent-main-100)/var(--tw-ring-opacity)); }

.focus-visible\:ring-accent-secondary-100:focus-visible { --tw-ring-opacity=
: 1; --tw-ring-color: hsl(var(--accent-secondary-100)/var(--tw-ring-opacity=
)); }

.focus-visible\:ring-offset-2:focus-visible { --tw-ring-offset-width: 2px; =
}

.active\:rotate-6:active { --tw-rotate: 6deg; transform: translate(var(--tw=
-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--t=
w-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--t=
w-scale-y)); }

.active\:\!scale-100:active { --tw-scale-x: 1 !important; --tw-scale-y: 1 !=
important; }

.active\:\!scale-100:active, .active\:\!scale-95:active { transform: transl=
ate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) s=
kewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) sc=
aleY(var(--tw-scale-y)) !important; }

.active\:\!scale-95:active { --tw-scale-x: .95 !important; --tw-scale-y: .9=
5 !important; }

.active\:scale-90:active { --tw-scale-x: .9; --tw-scale-y: .9; }

.active\:scale-90:active, .active\:scale-95:active { transform: translate(v=
ar(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(=
var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(=
var(--tw-scale-y)); }

.active\:scale-95:active { --tw-scale-x: .95; --tw-scale-y: .95; }

.active\:scale-\[0\.985\]:active { --tw-scale-x: 0.985; --tw-scale-y: 0.985=
; }

.active\:scale-\[0\.985\]:active, .active\:scale-\[0\.9875\]:active { trans=
form: translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--t=
w-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-=
scale-x)) scaleY(var(--tw-scale-y)); }

.active\:scale-\[0\.9875\]:active { --tw-scale-x: 0.9875; --tw-scale-y: 0.9=
875; }

.active\:scale-\[0\.98\]:active { --tw-scale-x: 0.98; --tw-scale-y: 0.98; }

.active\:scale-\[0\.98\]:active, .active\:scale-\[0\.995\]:active { transfo=
rm: translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-=
rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-sc=
ale-x)) scaleY(var(--tw-scale-y)); }

.active\:scale-\[0\.995\]:active { --tw-scale-x: 0.995; --tw-scale-y: 0.995=
; }

.active\:scale-\[0\.99\]:active { --tw-scale-x: 0.99; --tw-scale-y: 0.99; }

.active\:scale-\[0\.99\]:active, .active\:scale-\[1\.015\]:active { transfo=
rm: translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-=
rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-sc=
ale-x)) scaleY(var(--tw-scale-y)); }

.active\:scale-\[1\.015\]:active { --tw-scale-x: 1.015; --tw-scale-y: 1.015=
; }

.active\:scale-\[1\.0\]:active { --tw-scale-x: 1.0; --tw-scale-y: 1.0; }

.active\:scale-\[1\.0\]:active, .active\:scale-x-\[0\.985\]:active { transf=
orm: translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw=
-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-s=
cale-x)) scaleY(var(--tw-scale-y)); }

.active\:scale-x-\[0\.985\]:active { --tw-scale-x: 0.985; }

.active\:scale-y-\[0\.995\]:active { --tw-scale-y: 0.995; transform: transl=
ate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) s=
kewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) sc=
aleY(var(--tw-scale-y)); }

.active\:cursor-grabbing:active { cursor: grabbing; }

.active\:\!bg-bg-500:active { --tw-bg-opacity: 1 !important; background-col=
or: hsl(var(--bg-500)/var(--tw-bg-opacity)) !important; }

.active\:\!bg-transparent:active { background-color: transparent !important=
; }

.active\:bg-accent-secondary-100\/20:active { background-color: hsl(var(--a=
ccent-secondary-100)/.2); }

.active\:bg-bg-300:active { --tw-bg-opacity: 1; background-color: hsl(var(-=
-bg-300)/var(--tw-bg-opacity)); }

.active\:bg-bg-400:active { --tw-bg-opacity: 1; background-color: hsl(var(-=
-bg-400)/var(--tw-bg-opacity)); }

.active\:bg-bg-500\/50:active { background-color: hsl(var(--bg-500)/.5); }

.active\:bg-text-200:active { --tw-bg-opacity: 1; background-color: hsl(var=
(--text-200)/var(--tw-bg-opacity)); }

.hover\:enabled\:border-accent-secondary-200\/50:enabled:hover { border-col=
or: hsl(var(--accent-secondary-200)/.5); }

.hover\:enabled\:from-accent-secondary-200\/0:enabled:hover { --tw-gradient=
-from: hsl(var(--accent-secondary-200)/0) var(--tw-gradient-from-position);=
 --tw-gradient-to: hsl(var(--accent-secondary-200)/0) var(--tw-gradient-to-=
position); --tw-gradient-stops: var(--tw-gradient-from),var(--tw-gradient-t=
o); }

.hover\:enabled\:to-accent-secondary-200\/10:enabled:hover { --tw-gradient-=
to: hsl(var(--accent-secondary-200)/0.1) var(--tw-gradient-to-position); }

.disabled\:pointer-events-none:disabled { pointer-events: none; }

.disabled\:cursor-default:disabled { cursor: default; }

.disabled\:cursor-not-allowed:disabled { cursor: not-allowed; }

.disabled\:cursor-wait:disabled { cursor: wait; }

.disabled\:\!bg-text-100\/50:disabled { background-color: hsl(var(--text-10=
0)/.5) !important; }

.disabled\:bg-always-black\/50:disabled { background-color: hsl(var(--alway=
s-black)/.5); }

.disabled\:bg-bg-200:disabled { --tw-bg-opacity: 1; background-color: hsl(v=
ar(--bg-200)/var(--tw-bg-opacity)); }

.disabled\:text-always-white\/50:disabled { color: hsl(var(--always-white)/=
.5); }

.disabled\:text-text-300:disabled { --tw-text-opacity: 1; color: hsl(var(--=
text-300)/var(--tw-text-opacity)); }

.disabled\:text-text-500:disabled { --tw-text-opacity: 1; color: hsl(var(--=
text-500)/var(--tw-text-opacity)); }

.disabled\:opacity-0:disabled { opacity: 0; }

.disabled\:opacity-30:disabled { opacity: 0.3; }

.disabled\:opacity-40:disabled { opacity: 0.4; }

.disabled\:opacity-50:disabled { opacity: 0.5; }

.disabled\:opacity-60:disabled { opacity: 0.6; }

.disabled\:shadow-none:disabled { --tw-shadow: 0 0 #0000; --tw-shadow-color=
ed: 0 0 #0000; box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-=
ring-shadow,0 0 #0000),var(--tw-shadow); }

.disabled\:drop-shadow-none:disabled { --tw-drop-shadow: drop-shadow(0 0 #0=
000); filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--=
tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(=
--tw-sepia) var(--tw-drop-shadow); }

.disabled\:hover\:bg-transparent:hover:disabled { background-color: transpa=
rent; }

.disabled\:hover\:text-text-400:hover:disabled { --tw-text-opacity: 1; colo=
r: hsl(var(--text-400)/var(--tw-text-opacity)); }

.group:focus-within .group-focus-within\:block { display: block; }

.group\/thumbnail:focus-within .group-focus-within\/thumbnail\:opacity-100 =
{ opacity: 1; }

.group:focus-within .group-focus-within\:opacity-100 { opacity: 1; }

.group:focus-within .group-focus-within\:\[mask-image\:linear-gradient\(to_=
right\,hsl\(var\(--always-black\)\)_78\%\,transparent_95\%\)\] { mask-image=
: linear-gradient(to right,hsl(var(--always-black)) 78%,transparent 95%); }

.group:hover .group-hover\:visible { visibility: visible; }

.group:hover .group-hover\:right-5, .group\/outer:hover .group-hover\/outer=
\:right-5 { right: 1.25rem; }

.group:hover .group-hover\:top-\[2\%\] { top: 2%; }

.group:hover .group-hover\:ml-0 { margin-left: 0px; }

.group:hover .group-hover\:ml-0\.5 { margin-left: 0.125rem; }

.group:hover .group-hover\:ml-\[10px\] { margin-left: 10px; }

.group:hover .group-hover\:ml-\[5px\] { margin-left: 5px; }

.group:hover .group-hover\:mr-1 { margin-right: 0.25rem; }

.group:hover .group-hover\:block { display: block; }

.group:hover .group-hover\:inline-block { display: inline-block; }

.group:hover .group-hover\:flex { display: flex; }

.group:hover .group-hover\:hidden { display: none; }

.group\/repo:hover .group-hover\/repo\:w-7 { width: 1.75rem; }

.group:hover .group-hover\:w-3 { width: 0.75rem; }

.group:hover .group-hover\:w-px { width: 1px; }

.group:hover .group-hover\:max-w-\[calc\(100\%-20px\)\] { max-width: calc(1=
00% - 20px); }

.group:hover .group-hover\:-translate-x-2 { --tw-translate-x: -0.5rem; }

.group:hover .group-hover\:-translate-x-2, .group:hover .group-hover\:-tran=
slate-x-\[0\.5px\] { transform: translate(var(--tw-translate-x),var(--tw-tr=
anslate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw=
-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:hover .group-hover\:-translate-x-\[0\.5px\] { --tw-translate-x: -0.5=
px; }

.group:hover .group-hover\:-translate-x-\[1px\] { --tw-translate-x: -1px; }

.group:hover .group-hover\:-translate-x-\[1px\], .group:hover .group-hover\=
:-translate-y-\[0\.5px\] { transform: translate(var(--tw-translate-x),var(-=
-tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(va=
r(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:hover .group-hover\:-translate-y-\[0\.5px\] { --tw-translate-y: -0.5=
px; }

.group:hover .group-hover\:-translate-y-\[1\.4px\] { --tw-translate-y: -1.4=
px; }

.group:hover .group-hover\:-translate-y-\[1\.4px\], .group:hover .group-hov=
er\:-translate-y-\[2\.8px\] { transform: translate(var(--tw-translate-x),va=
r(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY=
(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:hover .group-hover\:-translate-y-\[2\.8px\] { --tw-translate-y: -2.8=
px; }

.group:hover .group-hover\:translate-x-0 { --tw-translate-x: 0px; }

.group:hover .group-hover\:translate-x-0, .group:hover .group-hover\:transl=
ate-x-0\.5 { transform: translate(var(--tw-translate-x),var(--tw-translate-=
y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)=
) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:hover .group-hover\:translate-x-0\.5 { --tw-translate-x: 0.125rem; }

.group:hover .group-hover\:translate-x-1 { --tw-translate-x: 0.25rem; }

.group:hover .group-hover\:translate-x-1, .group:hover .group-hover\:transl=
ate-x-\[0\.5px\] { transform: translate(var(--tw-translate-x),var(--tw-tran=
slate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-s=
kew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:hover .group-hover\:translate-x-\[0\.5px\] { --tw-translate-x: 0.5px=
; }

.group:hover .group-hover\:translate-x-\[1px\], .group:hover .group-hover\:=
translate-x-px { --tw-translate-x: 1px; }

.group:hover .group-hover\:translate-x-\[1px\], .group:hover .group-hover\:=
translate-x-px, .group:hover .group-hover\:translate-y-0 { transform: trans=
late(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) =
skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) s=
caleY(var(--tw-scale-y)); }

.group:hover .group-hover\:translate-y-0 { --tw-translate-y: 0px; }

.group\/artifact-block:hover .group-hover\/artifact-block\:-rotate-\[0\.065=
rad\] { --tw-rotate: -0.065rad; }

.group\/artifact-block:hover .group-hover\/artifact-block\:-rotate-\[0\.065=
rad\], .group\/artifact-block:hover .group-hover\/artifact-block\:rotate-\[=
0\.065rad\] { transform: translate(var(--tw-translate-x),var(--tw-translate=
-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y=
)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group\/artifact-block:hover .group-hover\/artifact-block\:rotate-\[0\.065r=
ad\] { --tw-rotate: 0.065rad; }

.group\/banner:hover .group-hover\/banner\:rotate-0 { --tw-rotate: 0deg; }

.group:hover .group-hover\:-rotate-1, .group\/banner:hover .group-hover\/ba=
nner\:rotate-0 { transform: translate(var(--tw-translate-x),var(--tw-transl=
ate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-ske=
w-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:hover .group-hover\:-rotate-1 { --tw-rotate: -1deg; }

.group:hover .group-hover\:-rotate-2 { --tw-rotate: -2deg; }

.group:hover .group-hover\:-rotate-2, .group:hover .group-hover\:-rotate-3 =
{ transform: translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(=
var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(va=
r(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:hover .group-hover\:-rotate-3 { --tw-rotate: -3deg; }

.group:hover .group-hover\:-rotate-90 { --tw-rotate: -90deg; }

.group:hover .group-hover\:-rotate-90, .group:hover .group-hover\:rotate-2 =
{ transform: translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(=
var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(va=
r(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:hover .group-hover\:rotate-2 { --tw-rotate: 2deg; }

.group:hover .group-hover\:rotate-3 { --tw-rotate: 3deg; }

.group:hover .group-hover\:rotate-3, .group:hover .group-hover\:rotate-6 { =
transform: translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(va=
r(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(=
--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:hover .group-hover\:rotate-6 { --tw-rotate: 6deg; }

.group:hover .group-hover\:rotate-\[10deg\] { --tw-rotate: 10deg; }

.group:hover .group-hover\:rotate-\[10deg\], .group:hover .group-hover\:rot=
ate-\[120deg\] { transform: translate(var(--tw-translate-x),var(--tw-transl=
ate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-ske=
w-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:hover .group-hover\:rotate-\[120deg\] { --tw-rotate: 120deg; }

.group\/artifact-block:hover .group-hover\/artifact-block\:scale-\[1\.035\]=
 { --tw-scale-x: 1.035; --tw-scale-y: 1.035; }

.group\/artifact-block:hover .group-hover\/artifact-block\:scale-\[1\.035\]=
, .group\/banner:hover .group-hover\/banner\:scale-75 { transform: translat=
e(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) ske=
wX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scal=
eY(var(--tw-scale-y)); }

.group\/banner:hover .group-hover\/banner\:scale-75 { --tw-scale-x: .75; --=
tw-scale-y: .75; }

.group\/row:hover .group-hover\/row\:scale-100 { --tw-scale-x: 1; --tw-scal=
e-y: 1; }

.group\/row:hover .group-hover\/row\:scale-100, .group\/row:hover .group-ho=
ver\/row\:scale-75 { transform: translate(var(--tw-translate-x),var(--tw-tr=
anslate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw=
-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group\/row:hover .group-hover\/row\:scale-75 { --tw-scale-x: .75; --tw-sca=
le-y: .75; }

.group\/summary:hover .group-hover\/summary\:scale-100 { --tw-scale-x: 1; -=
-tw-scale-y: 1; }

.group\/summary:hover .group-hover\/summary\:scale-100, .group\/summary:hov=
er .group-hover\/summary\:scale-\[55\%\] { transform: translate(var(--tw-tr=
anslate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-s=
kew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-s=
cale-y)); }

.group\/summary:hover .group-hover\/summary\:scale-\[55\%\] { --tw-scale-x:=
 55%; --tw-scale-y: 55%; }

.group\/tag:hover .group-hover\/tag\:scale-\[100\%\] { --tw-scale-x: 100%; =
--tw-scale-y: 100%; }

.group:hover .group-hover\:scale-100, .group\/tag:hover .group-hover\/tag\:=
scale-\[100\%\] { transform: translate(var(--tw-translate-x),var(--tw-trans=
late-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-sk=
ew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:hover .group-hover\:scale-100 { --tw-scale-x: 1; --tw-scale-y: 1; }

.group:hover .group-hover\:scale-105 { --tw-scale-x: 1.05; --tw-scale-y: 1.=
05; }

.group:hover .group-hover\:scale-105, .group:hover .group-hover\:scale-110 =
{ transform: translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(=
var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(va=
r(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:hover .group-hover\:scale-110 { --tw-scale-x: 1.1; --tw-scale-y: 1.1=
; }

.group:hover .group-hover\:scale-75 { --tw-scale-x: .75; --tw-scale-y: .75;=
 }

.group:hover .group-hover\:scale-75, .group:hover .group-hover\:scale-90 { =
transform: translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(va=
r(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(=
--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:hover .group-hover\:scale-90 { --tw-scale-x: .9; --tw-scale-y: .9; }

.group:hover .group-hover\:scale-95 { --tw-scale-x: .95; --tw-scale-y: .95;=
 }

.group:hover .group-hover\:scale-95, .group:hover .group-hover\:scale-\[1\.=
15\] { transform: translate(var(--tw-translate-x),var(--tw-translate-y)) ro=
tate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scal=
eX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:hover .group-hover\:scale-\[1\.15\] { --tw-scale-x: 1.15; --tw-scale=
-y: 1.15; }

@keyframes blink {=20
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}

.group:hover .group-hover\:animate-\[blink_4s_ease-in-out_infinite\] { anim=
ation: 4s ease-in-out 0s infinite normal none running blink; }

.group:hover .group-hover\:animate-\[bounceUpRight_0\.6s_ease-in-out_infini=
te\] { animation: 0.6s ease-in-out 0s infinite normal none running bounceUp=
Right; }

.group:hover .group-hover\:animate-\[look-around_2\.4s_ease-in-out_infinite=
\] { animation: 2.4s ease-in-out 0s infinite normal none running look-aroun=
d; }

.group\/tag:hover .group-hover\/tag\:border-accent-secondary-100\/60 { bord=
er-color: hsl(var(--accent-secondary-100)/.6); }

.group:hover .group-hover\:border-accent-secondary-000\/70 { border-color: =
hsl(var(--accent-secondary-000)/.7); }

.group:hover .group-hover\:border-accent-secondary-100\/40 { border-color: =
hsl(var(--accent-secondary-100)/.4); }

.group:hover .group-hover\:border-accent-secondary-100\/50 { border-color: =
hsl(var(--accent-secondary-100)/.5); }

.group:hover .group-hover\:border-accent-secondary-900 { --tw-border-opacit=
y: 1; border-color: hsl(var(--accent-secondary-900)/var(--tw-border-opacity=
)); }

.group:hover .group-hover\:border-border-100 { border-color: hsl(var(--bord=
er-100)/.4); }

.group:hover .group-hover\:border-border-200 { border-color: hsl(var(--bord=
er-200)/.3); }

.group\/banner:hover .group-hover\/banner\:bg-danger-900\/80 { background-c=
olor: hsl(var(--danger-900)/.8); }

.group\/row:hover .group-hover\/row\:bg-bg-400 { --tw-bg-opacity: 1; backgr=
ound-color: hsl(var(--bg-400)/var(--tw-bg-opacity)); }

.group\/tag:hover .group-hover\/tag\:bg-accent-secondary-900 { --tw-bg-opac=
ity: 1; background-color: hsl(var(--accent-secondary-900)/var(--tw-bg-opaci=
ty)); }

.group:hover .group-hover\:bg-accent-secondary-100 { --tw-bg-opacity: 1; ba=
ckground-color: hsl(var(--accent-secondary-100)/var(--tw-bg-opacity)); }

.group:hover .group-hover\:bg-accent-secondary-900 { --tw-bg-opacity: 1; ba=
ckground-color: hsl(var(--accent-secondary-900)/var(--tw-bg-opacity)); }

.group:hover .group-hover\:bg-bg-000 { --tw-bg-opacity: 1; background-color=
: hsl(var(--bg-000)/var(--tw-bg-opacity)); }

.group:hover .group-hover\:bg-bg-100 { --tw-bg-opacity: 1; background-color=
: hsl(var(--bg-100)/var(--tw-bg-opacity)); }

.group:hover .group-hover\:bg-bg-300 { --tw-bg-opacity: 1; background-color=
: hsl(var(--bg-300)/var(--tw-bg-opacity)); }

.group:hover .group-hover\:bg-text-500\/25 { background-color: hsl(var(--te=
xt-500)/.25); }

.group:hover .group-hover\:bg-gradient-to-t { background-image: linear-grad=
ient(to top,var(--tw-gradient-stops)); }

.group:hover .group-hover\:pr-5 { padding-right: 1.25rem; }

.group:hover .group-hover\:font-medium { font-weight: 500; }

.group\/address:hover .group-hover\/address\:text-accent-secondary-000 { --=
tw-text-opacity: 1; color: hsl(var(--accent-secondary-000)/var(--tw-text-op=
acity)); }

.group\/btn:hover .group-hover\/btn\:text-text-100 { --tw-text-opacity: 1; =
color: hsl(var(--text-100)/var(--tw-text-opacity)); }

.group\/collapse-indicator:hover .group-hover\/collapse-indicator\:text-tex=
t-300 { --tw-text-opacity: 1; color: hsl(var(--text-300)/var(--tw-text-opac=
ity)); }

.group\/phone:hover .group-hover\/phone\:text-accent-secondary-000 { --tw-t=
ext-opacity: 1; color: hsl(var(--accent-secondary-000)/var(--tw-text-opacit=
y)); }

.group\/snippet:hover .group-hover\/snippet\:text-text-200, .group\/tag:hov=
er .group-hover\/tag\:text-text-200 { --tw-text-opacity: 1; color: hsl(var(=
--text-200)/var(--tw-text-opacity)); }

.group\/website:hover .group-hover\/website\:text-accent-secondary-000 { --=
tw-text-opacity: 1; color: hsl(var(--accent-secondary-000)/var(--tw-text-op=
acity)); }

.group:hover .group-hover\:\!text-text-100\/40 { color: hsl(var(--text-100)=
/.4) !important; }

.group:hover .group-hover\:\!text-text-400 { --tw-text-opacity: 1 !importan=
t; color: hsl(var(--text-400)/var(--tw-text-opacity)) !important; }

.group:hover .group-hover\:text-accent-pro-000 { --tw-text-opacity: 1; colo=
r: hsl(var(--accent-pro-000)/var(--tw-text-opacity)); }

.group:hover .group-hover\:text-accent-secondary-000 { --tw-text-opacity: 1=
; color: hsl(var(--accent-secondary-000)/var(--tw-text-opacity)); }

.group:hover .group-hover\:text-accent-secondary-000\/80 { color: hsl(var(-=
-accent-secondary-000)/.8); }

.group:hover .group-hover\:text-bg-000 { --tw-text-opacity: 1; color: hsl(v=
ar(--bg-000)/var(--tw-text-opacity)); }

.group:hover .group-hover\:text-text-000 { --tw-text-opacity: 1; color: hsl=
(var(--text-000)/var(--tw-text-opacity)); }

.group:hover .group-hover\:text-text-100 { --tw-text-opacity: 1; color: hsl=
(var(--text-100)/var(--tw-text-opacity)); }

.group:hover .group-hover\:text-text-200 { --tw-text-opacity: 1; color: hsl=
(var(--text-200)/var(--tw-text-opacity)); }

.group:hover .group-hover\:text-text-300 { --tw-text-opacity: 1; color: hsl=
(var(--text-300)/var(--tw-text-opacity)); }

.group\/avatar:hover .group-hover\/avatar\:opacity-100 { opacity: 1; }

.group\/banner:hover .group-hover\/banner\:opacity-0 { opacity: 0; }

.group\/banner:hover .group-hover\/banner\:opacity-100, .group\/branch:hove=
r .group-hover\/branch\:opacity-100, .group\/cell:hover .group-hover\/cell\=
:opacity-100, .group\/copy:hover .group-hover\/copy\:opacity-100 { opacity:=
 1; }

.group\/header:hover .group-hover\/header\:opacity-75 { opacity: 0.75; }

.group\/menu:hover .group-hover\/menu\:opacity-100, .group\/outer:hover .gr=
oup-hover\/outer\:opacity-100, .group\/photo:hover .group-hover\/photo\:opa=
city-100, .group\/repo:hover .group-hover\/repo\:opacity-100 { opacity: 1; =
}

.group\/row:hover .group-hover\/row\:opacity-0 { opacity: 0; }

.group\/row:hover .group-hover\/row\:opacity-100 { opacity: 1; }

.group\/status:hover .group-hover\/status\:opacity-0 { opacity: 0; }

.group\/status:hover .group-hover\/status\:opacity-100 { opacity: 1; }

.group\/tag:hover .group-hover\/tag\:opacity-\[100\%\] { opacity: 1; }

.group\/thumbnail:hover .group-hover\/thumbnail\:opacity-100, .group\/todo:=
hover .group-hover\/todo\:opacity-100 { opacity: 1; }

.group:hover .group-hover\:opacity-0 { opacity: 0; }

.group:hover .group-hover\:opacity-100 { opacity: 1; }

.group:hover .group-hover\:opacity-40 { opacity: 0.4; }

.group:hover .group-hover\:opacity-50 { opacity: 0.5; }

.group:hover .group-hover\:opacity-90 { opacity: 0.9; }

.group:hover .group-hover\:shadow-\[0_6px_12px_0px_hsl\(var\(--always-black=
\)\/8\%\)\] { --tw-shadow: 0 6px 12px 0px hsl(var(--always-black)/8%); --tw=
-shadow-colored: 0 6px 12px 0px var(--tw-shadow-color); box-shadow: var(--t=
w-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-sh=
adow); }

.group:hover .group-hover\:shadow-lg { --tw-shadow: 0 10px 15px -3px rgb(0 =
0 0/0.1),0 4px 6px -4px rgb(0 0 0/0.1); --tw-shadow-colored: 0 10px 15px -3=
px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color); }

.group:hover .group-hover\:shadow-lg, .group:hover .group-hover\:shadow-sm =
{ box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0=
 0 #0000),var(--tw-shadow); }

.group:hover .group-hover\:shadow-sm { --tw-shadow: 0 1px 2px 0 rgb(0 0 0/0=
.05); --tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color); }

.group\/switch:hover .group-hover\/switch\:ring-\[1px\] { --tw-ring-offset-=
shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-rin=
g-offset-color); --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + va=
r(--tw-ring-offset-width)) var(--tw-ring-color); box-shadow: var(--tw-ring-=
offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000); }

.group:hover .group-hover\:blur-\[3px\] { --tw-blur: blur(3px); }

.group:hover .group-hover\:blur-\[3px\], .group:hover .group-hover\:graysca=
le-0 { filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(-=
-tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var=
(--tw-sepia) var(--tw-drop-shadow); }

.group:hover .group-hover\:grayscale-0 { --tw-grayscale: grayscale(0); }

.group:hover .group-hover\:delay-75 { transition-delay: 75ms; }

.group\/artifact-block:hover .group-hover\/artifact-block\:ease-\[cubic-bez=
ier\(0\,0\.9\,0\.5\,1\.35\)\] { transition-timing-function: cubic-bezier(0,=
 0.9, 0.5, 1.35); }

.group\/tag:hover .group-hover\/tag\:ease-out { transition-timing-function:=
 cubic-bezier(0, 0, 0.2, 1); }

.group:hover .group-hover\:\[animation-play-state\:running\] { animation-pl=
ay-state: running; }

.group:hover .group-hover\:\[mask-image\:linear-gradient\(to_right\,hsl\(va=
r\(--always-black\)\)_78\%\,transparent_95\%\)\] { mask-image: linear-gradi=
ent(to right,hsl(var(--always-black)) 78%,transparent 95%); }

.group:hover .\*\:group-hover\:border-accent-secondary-100\/50 > * { border=
-color: hsl(var(--accent-secondary-100)/.5); }

.group:focus-visible .group-focus-visible\:scale-100 { --tw-scale-x: 1; --t=
w-scale-y: 1; transform: translate(var(--tw-translate-x),var(--tw-translate=
-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y=
)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:focus-visible .group-focus-visible\:border-accent-secondary-100\/50 =
{ border-color: hsl(var(--accent-secondary-100)/.5); }

.group:focus-visible .group-focus-visible\:text-text-100 { --tw-text-opacit=
y: 1; color: hsl(var(--text-100)/var(--tw-text-opacity)); }

.group:focus-visible .group-focus-visible\:opacity-100 { opacity: 1; }

.group:focus-visible .group-focus-visible\:outline-2 { outline-width: 2px; =
}

.group:focus-visible .group-focus-visible\:outline-offset-2 { outline-offse=
t: 2px; }

.group:active .group-active\:translate-x-0 { --tw-translate-x: 0px; }

.group:active .group-active\:translate-x-0, .group:active .group-active\:tr=
anslate-y-0 { transform: translate(var(--tw-translate-x),var(--tw-translate=
-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y=
)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:active .group-active\:translate-y-0 { --tw-translate-y: 0px; }

.group:active .group-active\:rotate-0 { --tw-rotate: 0deg; }

.group:active .group-active\:rotate-0, .group:active .group-active\:rotate-=
6 { transform: translate(var(--tw-translate-x),var(--tw-translate-y)) rotat=
e(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(=
var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:active .group-active\:rotate-6 { --tw-rotate: 6deg; }

.group:active .group-active\:scale-\[0\.98\] { --tw-scale-x: 0.98; --tw-sca=
le-y: 0.98; transform: translate(var(--tw-translate-x),var(--tw-translate-y=
)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y))=
 scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group:active .group-active\:animate-none { animation: auto ease 0s 1 norma=
l none running none; }

.group[data-state=3D"open"] .group-\[\&\[data-state\=3Dopen\]\]\:opacity-10=
0 { opacity: 1; }

.peer:checked ~ .peer-checked\:bg-accent-secondary-100 { --tw-bg-opacity: 1=
; background-color: hsl(var(--accent-secondary-100)/var(--tw-bg-opacity)); =
}

.peer:checked ~ .peer-checked\:bg-text-100 { --tw-bg-opacity: 1; background=
-color: hsl(var(--text-100)/var(--tw-bg-opacity)); }

.peer:checked ~ .peer-checked\:ring-\[0\.5px\] { --tw-ring-offset-shadow: v=
ar(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-=
color); --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0.5px + var(--tw-=
ring-offset-width)) var(--tw-ring-color); }

.peer:checked ~ .peer-checked\:ring-\[0\.5px\], .peer:checked ~ .peer-check=
ed\:ring-\[0px\] { box-shadow: var(--tw-ring-offset-shadow),var(--tw-ring-s=
hadow),var(--tw-shadow,0 0 #0000); }

.peer:checked ~ .peer-checked\:ring-\[0px\] { --tw-ring-offset-shadow: var(=
--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-col=
or); --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-=
offset-width)) var(--tw-ring-color); }

.group\/switch:hover .peer:checked ~ .group-hover\/switch\:peer-checked\:ri=
ng-\[0\.5px\] { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--t=
w-ring-offset-width) var(--tw-ring-offset-color); --tw-ring-shadow: var(--t=
w-ring-inset) 0 0 0 calc(0.5px + var(--tw-ring-offset-width)) var(--tw-ring=
-color); box-shadow: var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var=
(--tw-shadow,0 0 #0000); }

.group\/switch:hover .peer:checked ~ .group-hover\/switch\:peer-checked\:ri=
ng-\[0px\] { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-r=
ing-offset-width) var(--tw-ring-offset-color); --tw-ring-shadow: var(--tw-r=
ing-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-colo=
r); box-shadow: var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw=
-shadow,0 0 #0000); }

.group\/switch:hover .peer:checked ~ .group-hover\/switch\:peer-checked\:ri=
ng-\[1px\] { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-r=
ing-offset-width) var(--tw-ring-offset-color); --tw-ring-shadow: var(--tw-r=
ing-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-colo=
r); box-shadow: var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw=
-shadow,0 0 #0000); }

.group\/switch:hover .peer:checked ~ .group-hover\/switch\:peer-checked\:ri=
ng-accent-secondary-000 { --tw-ring-opacity: 1; --tw-ring-color: hsl(var(--=
accent-secondary-000)/var(--tw-ring-opacity)); }

.group\/switch:hover .peer:checked ~ .group-hover\/switch\:peer-checked\:ri=
ng-text-100 { --tw-ring-opacity: 1; --tw-ring-color: hsl(var(--text-100)/va=
r(--tw-ring-opacity)); }

.peer:focus-visible ~ .peer-focus-visible\:outline { outline-style: solid; =
}

.peer:focus-visible ~ .peer-focus-visible\:outline-\[1px\] { outline-width:=
 1px; }

.peer:focus-visible ~ .peer-focus-visible\:outline-offset-2 { outline-offse=
t: 2px; }

.peer:focus-visible ~ .peer-focus-visible\:outline-accent-secondary-100 { o=
utline-color: hsl(var(--accent-secondary-100)/1); }

.peer:focus-visible ~ .peer-focus-visible\:ring-1 { --tw-ring-offset-shadow=
: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offs=
et-color); --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw=
-ring-offset-width)) var(--tw-ring-color); box-shadow: var(--tw-ring-offset=
-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000); }

.peer:disabled ~ .peer-disabled\:opacity-50 { opacity: 0.5; }

.has-\[\:disabled\]\:pointer-events-none:has(:disabled) { pointer-events: n=
one; }

.has-\[\[data-state\=3Dopen\]\]\:bg-bg-200:has([data-state=3D"open"]) { --t=
w-bg-opacity: 1; background-color: hsl(var(--bg-200)/var(--tw-bg-opacity));=
 }

.has-\[\[data-state\=3Dopen\]\]\:bg-danger-900:has([data-state=3D"open"]) {=
 --tw-bg-opacity: 1; background-color: hsl(var(--danger-900)/var(--tw-bg-op=
acity)); }

.group\/row:has(:focus-visible) .group-has-\[\:focus-visible\]\/row\:scale-=
100 { --tw-scale-x: 1; --tw-scale-y: 1; transform: translate(var(--tw-trans=
late-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew=
-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scal=
e-y)); }

.group\/row:has(:focus-visible) .group-has-\[\:focus-visible\]\/row\:opacit=
y-100 { opacity: 1; }

.aria-expanded\:\!bg-bg-300[aria-expanded=3D"true"] { --tw-bg-opacity: 1 !i=
mportant; background-color: hsl(var(--bg-300)/var(--tw-bg-opacity)) !import=
ant; }

.aria-expanded\:\!bg-bg-400[aria-expanded=3D"true"] { --tw-bg-opacity: 1 !i=
mportant; background-color: hsl(var(--bg-400)/var(--tw-bg-opacity)) !import=
ant; }

.aria-expanded\:bg-bg-300[aria-expanded=3D"true"] { --tw-bg-opacity: 1; bac=
kground-color: hsl(var(--bg-300)/var(--tw-bg-opacity)); }

@keyframes accordion-close {=20
  0% { height: var(--radix-accordion-content-height); opacity: 1; }
  100% { height: 0px; opacity: 0; }
}

.data-\[state\=3D\"closed\"\]\:animate-\[accordion-close_150ms_ease-out\][d=
ata-state=3D"closed"] { animation: 0.15s ease-out 0s 1 normal none running =
accordion-close; }

@keyframes accordion-open {=20
  0% { height: 0px; opacity: 0; }
  100% { height: var(--radix-accordion-content-height); opacity: 1; }
}

.data-\[state\=3D\"open\"\]\:animate-\[accordion-open_150ms_ease-out\][data=
-state=3D"open"] { animation: 0.15s ease-out 0s 1 normal none running accor=
dion-open; }

.data-\[state\=3Dclosed\]\:animate-\[fade_125ms_ease-out_reverse_forwards\]=
[data-state=3D"closed"] { animation: 125ms ease-out 0s 1 reverse forwards r=
unning fade; }

.data-\[state\=3Dclosed\]\:animate-\[zoom_125ms_ease-out_reverse_forwards\]=
[data-state=3D"closed"] { animation: 125ms ease-out 0s 1 reverse forwards r=
unning zoom; }

@keyframes fade {=20
  0% { opacity: 0; }
  100% { opacity: 1; }
}

.data-\[state\=3Dopen\]\:animate-\[fade_250ms_ease-in_forwards\][data-state=
=3D"open"] { animation: 0.25s ease-in 0s 1 normal forwards running fade; }

@keyframes zoom {=20
  0% { transform: scale(0.95); }
  100% { transform: scale(1); }
}

.data-\[state\=3Dopen\]\:animate-\[zoom_250ms_ease-in_forwards\][data-state=
=3D"open"] { animation: 0.25s ease-in 0s 1 normal forwards running zoom; }

.data-\[disabled\]\:cursor-not-allowed[data-disabled] { cursor: not-allowed=
; }

.data-\[state\=3Dopen\]\:border-accent-secondary-100[data-state=3D"open"] {=
 --tw-border-opacity: 1; border-color: hsl(var(--accent-secondary-100)/var(=
--tw-border-opacity)); }

.data-\[selected\]\:bg-bg-200[data-selected] { --tw-bg-opacity: 1; backgrou=
nd-color: hsl(var(--bg-200)/var(--tw-bg-opacity)); }

.data-\[state\=3Dopen\]\:bg-bg-400[data-state=3D"open"] { --tw-bg-opacity: =
1; background-color: hsl(var(--bg-400)/var(--tw-bg-opacity)); }

.data-\[checked\]\:text-accent-secondary-100[data-checked] { --tw-text-opac=
ity: 1; color: hsl(var(--accent-secondary-100)/var(--tw-text-opacity)); }

.data-\[placeholder\]\:text-text-500[data-placeholder] { --tw-text-opacity:=
 1; color: hsl(var(--text-500)/var(--tw-text-opacity)); }

.data-\[state\=3D\'on\'\]\:text-text-100[data-state=3D"on"] { --tw-text-opa=
city: 1; color: hsl(var(--text-100)/var(--tw-text-opacity)); }

.data-\[disabled\]\:opacity-50[data-disabled] { opacity: 0.5; }

.data-\[state\=3Dopen\]\:opacity-100[data-state=3D"open"] { opacity: 1; }

.data-\[state\=3Dopen\]\:\!\[animation\:fade_50ms_ease-out_forwards\][data-=
state=3D"open"] { animation: 50ms ease-out 0s 1 normal forwards running fad=
e !important; }

.data-\[state\=3D\"open\"\]\:\[animation\:fade_var\(--modal-animation-durat=
ion\,250ms\)_ease-out_forwards\][data-state=3D"open"] { animation: fade var=
(--modal-animation-duration,.25s) ease-out forwards; }

.data-\[state\=3D\"closed\"\]\:\[animation\:fade_var\(--modal-close-duratio=
n\,125ms\)_ease-in_reverse_forwards\][data-state=3D"closed"] { animation: f=
ade var(--modal-close-duration,125ms) ease-in reverse forwards; }

.data-\[state\=3Dopen\]\:\[animation\:zoom_50ms_ease-out_forwards\][data-st=
ate=3D"open"] { animation: 50ms ease-out 0s 1 normal forwards running zoom;=
 }

.data-\[state\=3D\"open\"\]\:\[animation\:zoom_var\(--modal-animation-durat=
ion\,250ms\)_ease-out_forwards\][data-state=3D"open"] { animation: zoom var=
(--modal-animation-duration,.25s) ease-out forwards; }

.data-\[state\=3D\"closed\"\]\:\[animation\:zoom_var\(--modal-close-duratio=
n\,125ms\)_ease-in_reverse_forwards\][data-state=3D"closed"] { animation: z=
oom var(--modal-close-duration,125ms) ease-in reverse forwards; }

.data-\[highlighted\]\:before\:absolute[data-highlighted]::before { content=
: var(--tw-content); position: absolute; }

.data-\[highlighted\]\:before\:inset-0[data-highlighted]::before { content:=
 var(--tw-content); inset: 0px; }

.data-\[highlighted\]\:before\:-z-\[1\][data-highlighted]::before { content=
: var(--tw-content); z-index: -1; }

.data-\[highlighted\]\:before\:rounded-lg[data-highlighted]::before { conte=
nt: var(--tw-content); border-radius: 0.5rem; }

.data-\[checked\]\:data-\[highlighted\]\:before\:\!bg-accent-secondary-100\=
/10[data-highlighted][data-checked]::before { content: var(--tw-content); b=
ackground-color: hsl(var(--accent-secondary-100)/.1) !important; }

.data-\[highlighted\]\:before\:bg-bg-200[data-highlighted]::before { conten=
t: var(--tw-content); --tw-bg-opacity: 1; background-color: hsl(var(--bg-20=
0)/var(--tw-bg-opacity)); }

.data-\[checked\]\:data-\[highlighted\]\:active\:before\:\!bg-accent-second=
ary-100\/20:active[data-highlighted][data-checked]::before { content: var(-=
-tw-content); background-color: hsl(var(--accent-secondary-100)/.2) !import=
ant; }

.data-\[highlighted\]\:active\:before\:\!bg-bg-300:active[data-highlighted]=
::before { content: var(--tw-content); --tw-bg-opacity: 1 !important; backg=
round-color: hsl(var(--bg-300)/var(--tw-bg-opacity)) !important; }

.group[data-state=3D"closed"] .group-data-\[state\=3Dclosed\]\:hidden, .gro=
up[data-state=3D"open"] .group-data-\[state\=3Dopen\]\:hidden, .group[data-=
state=3D"unchecked"] .group-data-\[state\=3Dunchecked\]\:hidden { display: =
none; }

.group[data-state=3D"open"] .group-data-\[state\=3D\"open\"\]\:rotate-180 {=
 --tw-rotate: 180deg; }

.group[data-state=3D"open"] .group-data-\[state\=3D\"open\"\]\:rotate-180, =
.group[data-state=3D"open"] .group-data-\[state\=3D\"open\"\]\:rotate-45 { =
transform: translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(va=
r(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(=
--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.group[data-state=3D"open"] .group-data-\[state\=3D\"open\"\]\:rotate-45 { =
--tw-rotate: 45deg; }

.group[data-state=3D"closed"] .group-data-\[state\=3D\"closed\"\]\:text-tex=
t-400 { --tw-text-opacity: 1; color: hsl(var(--text-400)/var(--tw-text-opac=
ity)); }

.group[data-state=3D"checked"] .group-data-\[state\=3Dchecked\]\:shadow-ins=
et-border { --tw-shadow: inset 0 0 0 1px var(--tw-shadow-color); --tw-shado=
w-colored: inset 0 0 0 1px var(--tw-shadow-color); box-shadow: var(--tw-rin=
g-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)=
; }

.group[data-state=3D"checked"] .group-data-\[state\=3Dchecked\]\:shadow-acc=
ent-secondary-000 { --tw-shadow-color: hsl(var(--accent-secondary-000)/1); =
--tw-shadow: var(--tw-shadow-colored); }

.group\/switch[data-force-hover=3D"true"] .group-data-\[force-hover\=3Dtrue=
\]\/switch\:ring-\[1px\] { --tw-ring-offset-shadow: var(--tw-ring-inset) 0 =
0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color); --tw-ring-shad=
ow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(=
--tw-ring-color); box-shadow: var(--tw-ring-offset-shadow),var(--tw-ring-sh=
adow),var(--tw-shadow,0 0 #0000); }

.group[data-state=3D"closed"] .group-data-\[state\=3D\"closed\"\]\:hover\:t=
ext-text-200:hover { --tw-text-opacity: 1; color: hsl(var(--text-200)/var(-=
-tw-text-opacity)); }

.group\/switch[data-force-hover=3D"true"] .peer:checked ~ .group-data-\[for=
ce-hover\=3Dtrue\]\/switch\:peer-checked\:ring-\[0\.5px\] { --tw-ring-offse=
t-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-r=
ing-offset-color); --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0.5px =
+ var(--tw-ring-offset-width)) var(--tw-ring-color); box-shadow: var(--tw-r=
ing-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000); }

.group\/switch[data-force-hover=3D"true"] .peer:checked ~ .group-data-\[for=
ce-hover\=3Dtrue\]\/switch\:peer-checked\:ring-\[0px\] { --tw-ring-offset-s=
hadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring=
-offset-color); --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(0px + var=
(--tw-ring-offset-width)) var(--tw-ring-color); box-shadow: var(--tw-ring-o=
ffset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000); }

.group\/switch[data-force-hover=3D"true"] .peer:checked ~ .group-data-\[for=
ce-hover\=3Dtrue\]\/switch\:peer-checked\:ring-\[1px\] { --tw-ring-offset-s=
hadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring=
-offset-color); --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var=
(--tw-ring-offset-width)) var(--tw-ring-color); box-shadow: var(--tw-ring-o=
ffset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000); }

.group\/switch[data-force-hover=3D"true"] .peer:checked ~ .group-data-\[for=
ce-hover\=3Dtrue\]\/switch\:peer-checked\:ring-accent-secondary-000 { --tw-=
ring-opacity: 1; --tw-ring-color: hsl(var(--accent-secondary-000)/var(--tw-=
ring-opacity)); }

.group\/switch[data-force-hover=3D"true"] .peer:checked ~ .group-data-\[for=
ce-hover\=3Dtrue\]\/switch\:peer-checked\:ring-text-100 { --tw-ring-opacity=
: 1; --tw-ring-color: hsl(var(--text-100)/var(--tw-ring-opacity)); }

.peer[data-force-focus=3D"true"] ~ .peer-data-\[force-focus\=3Dtrue\]\:outl=
ine { outline-style: solid; }

.peer[data-force-focus=3D"true"] ~ .peer-data-\[force-focus\=3Dtrue\]\:outl=
ine-\[1px\] { outline-width: 1px; }

.peer[data-force-focus=3D"true"] ~ .peer-data-\[force-focus\=3Dtrue\]\:outl=
ine-offset-2 { outline-offset: 2px; }

.peer[data-force-focus=3D"true"] ~ .peer-data-\[force-focus\=3Dtrue\]\:outl=
ine-accent-secondary-100 { outline-color: hsl(var(--accent-secondary-100)/1=
); }

.next-sibling-hover\:border-transparent:has(+ :hover) { border-color: trans=
parent; }

@supports not (overflow-y:overlay) {
  .supports-\[not_\(overflow-y\:overlay\)\]\:overflow-y-auto { overflow-y: =
auto; }
}

@media (prefers-reduced-motion: reduce) {
  @keyframes spin {=20
  100% { transform: rotate(1turn); }
}
  .motion-reduce\:animate-\[spin_1\.5s_linear_infinite\] { animation: 1.5s =
linear 0s infinite normal none running spin; }
  .motion-reduce\:animate-none { animation: auto ease 0s 1 normal none runn=
ing none; }
  .motion-reduce\:duration-0 { transition-duration: 0s; }
}

@media not all and (min-width: 768px) {
  .max-md\:pointer-events-none { pointer-events: none; }
  .max-md\:pointer-events-auto { pointer-events: auto; }
  .max-md\:fixed { position: fixed; }
  .max-md\:absolute { position: absolute; }
  .max-md\:inset-0 { inset: 0px; }
  .max-md\:inset-x-0 { left: 0px; right: 0px; }
  .max-md\:bottom-0 { bottom: 0px; }
  .max-md\:left-0 { left: 0px; }
  .max-md\:top-0 { top: 0px; }
  .max-md\:z-50 { z-index: 50; }
  .max-md\:z-header { z-index: 20; }
  .max-md\:line-clamp-2 { overflow: hidden; display: -webkit-box; -webkit-b=
ox-orient: vertical; -webkit-line-clamp: 2; }
  .max-md\:flex { display: flex; }
  .max-md\:hidden { display: none; }
  .max-md\:h-full { height: 100%; }
  .max-md\:w-fit { width: fit-content; }
  .max-md\:max-w-\[23\.5rem\] { max-width: 23.5rem; }
  .max-md\:max-w-\[33rem\] { max-width: 33rem; }
  .max-md\:flex-1 { flex: 1 1 0%; }
  .max-md\:-translate-x-full { --tw-translate-x: -100%; }
  .max-md\:-translate-x-full, .max-md\:translate-x-0 { transform: translate=
(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew=
X(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scale=
Y(var(--tw-scale-y)); }
  .max-md\:translate-x-0 { --tw-translate-x: 0px; }
  .max-md\:transform { transform: translate(var(--tw-translate-x),var(--tw-=
translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--=
tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }
  .max-md\:flex-col { flex-direction: column; }
  .max-md\:self-end { align-self: flex-end; }
  .max-md\:break-words { overflow-wrap: break-word; }
  .max-md\:border-0 { border-width: 0px; }
  .max-md\:border-t { border-top-width: 1px; }
  .max-md\:border-border-300 { border-color: hsl(var(--border-300)/.15); }
  .max-md\:bg-bg-100 { --tw-bg-opacity: 1; background-color: hsl(var(--bg-1=
00)/var(--tw-bg-opacity)); }
  .max-md\:via-90\% { --tw-gradient-via-position: 90%; }
  .max-md\:pl-1 { padding-left: 0.25rem; }
  .max-md\:pt-4 { padding-top: 1rem; }
  .max-md\:transition-transform { transition-property: transform; transitio=
n-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s=
; }
  .max-md\:duration-300 { transition-duration: 0.3s; }
  .max-md\:ease-in-out { transition-timing-function: cubic-bezier(0.4, 0, 0=
.2, 1); }
}

@media not all and (min-width: 640px) {
  .max-sm\:mx-1 { margin-left: 0.25rem; margin-right: 0.25rem; }
  .max-sm\:mx-1\.5 { margin-left: 0.375rem; margin-right: 0.375rem; }
  .max-sm\:-mb-2 { margin-bottom: -0.5rem; }
  .max-sm\:mt-3 { margin-top: 0.75rem; }
  .max-sm\:hidden { display: none; }
  .max-sm\:w-full { width: 100%; }
  .max-sm\:min-w-8 { min-width: 2rem; }
  .max-sm\:flex-1 { flex: 1 1 0%; }
  .max-sm\:\!px-1 { padding-left: 0.25rem !important; padding-right: 0.25re=
m !important; }
  .max-sm\:px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
  .max-sm\:pb-8 { padding-bottom: 2rem; }
  .max-sm\:text-sm { font-size: 0.875rem; line-height: 1.25rem; }
}

@media (min-width: 350px) {
  .min-\[350px\]\:text-\[3\.2rem\] { font-size: 3.2rem; }
}

@media (min-width: 500px) {
  .min-\[500px\]\:flex { display: flex; }
  .min-\[500px\]\:text-\[3\.5rem\] { font-size: 3.5rem; }
}

@media (min-width: 640px) {
  .sm\:absolute { position: absolute; }
  .sm\:bottom-4 { bottom: 1rem; }
  .sm\:bottom-6 { bottom: 1.5rem; }
  .sm\:left-\[-1rem\] { left: -1rem; }
  .sm\:right-16 { right: 4rem; }
  .sm\:right-4 { right: 1rem; }
  .sm\:right-6 { right: 1.5rem; }
  .sm\:top-5 { top: 1.25rem; }
  .sm\:top-6 { top: 1.5rem; }
  .sm\:col-span-1 { grid-column: span 1 / span 1; }
  .sm\:col-span-2 { grid-column: span 2 / span 2; }
  .sm\:row-span-2 { grid-row: span 2 / span 2; }
  .sm\:-mx-20 { margin-left: -5rem; margin-right: -5rem; }
  .sm\:-mx-4 { margin-left: -1rem; margin-right: -1rem; }
  .sm\:mx-auto { margin-left: auto; margin-right: auto; }
  .sm\:-ml-0 { margin-left: 0px; }
  .sm\:-ml-0\.5 { margin-left: -0.125rem; }
  .sm\:-ml-6 { margin-left: -1.5rem; }
  .sm\:mb-2 { margin-bottom: 0.5rem; }
  .sm\:mb-4 { margin-bottom: 1rem; }
  .sm\:mb-8 { margin-bottom: 2rem; }
  .sm\:ml-0 { margin-left: 0px; }
  .sm\:ml-2 { margin-left: 0.5rem; }
  .sm\:mt-0 { margin-top: 0px; }
  .sm\:mt-1 { margin-top: 0.25rem; }
  .sm\:mt-10 { margin-top: 2.5rem; }
  .sm\:mt-20 { margin-top: 5rem; }
  .sm\:mt-5 { margin-top: 1.25rem; }
  .sm\:mt-8 { margin-top: 2rem; }
  .sm\:block { display: block; }
  .sm\:inline { display: inline; }
  .sm\:flex { display: flex; }
  .sm\:table-row { display: table-row; }
  .sm\:grid { display: grid; }
  .sm\:hidden { display: none; }
  .sm\:h-28 { height: 7rem; }
  .sm\:h-6 { height: 1.5rem; }
  .sm\:h-7 { height: 1.75rem; }
  .sm\:h-8 { height: 2rem; }
  .sm\:h-\[315px\] { height: 315px; }
  .sm\:h-full { height: 100%; }
  .sm\:w-2\/12 { width: 16.6667%; }
  .sm\:w-3\/12 { width: 25%; }
  .sm\:w-4\/12 { width: 33.3333%; }
  .sm\:w-48 { width: 12rem; }
  .sm\:w-5\/12 { width: 41.6667%; }
  .sm\:w-6 { width: 1.5rem; }
  .sm\:w-6\/12 { width: 50%; }
  .sm\:w-8 { width: 2rem; }
  .sm\:w-\[150px\] { width: 150px; }
  .sm\:w-\[30rem\] { width: 30rem; }
  .sm\:w-auto { width: auto; }
  .sm\:min-w-0 { min-width: 0px; }
  .sm\:min-w-\[140px\] { min-width: 140px; }
  .sm\:min-w-\[150px\] { min-width: 150px; }
  .sm\:min-w-\[30rem\] { min-width: 30rem; }
  .sm\:max-w-48 { max-width: 12rem; }
  .sm\:max-w-56 { max-width: 14rem; }
  .sm\:max-w-\[250px\] { max-width: 250px; }
  .sm\:max-w-\[calc\(100vw-3rem\)\] { max-width: calc(-3rem + 100vw); }
  .sm\:max-w-md { max-width: 28rem; }
  .sm\:max-w-xl { max-width: 36rem; }
  .sm\:max-w-xs { max-width: 20rem; }
  .sm\:flex-1 { flex: 1 1 0%; }
  .sm\:grow { flex-grow: 1; }
  .sm\:table-auto { table-layout: auto; }
  .sm\:scale-75 { --tw-scale-x: .75; --tw-scale-y: .75; transform: translat=
e(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) ske=
wX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scal=
eY(var(--tw-scale-y)); }
  .sm\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0px, 1fr)); }
  .sm\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0px, 1fr)); }
  .sm\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0px, 1fr)); }
  .sm\:grid-rows-2 { grid-template-rows: repeat(2, minmax(0px, 1fr)); }
  .sm\:flex-row { flex-direction: row; }
  .sm\:flex-col { flex-direction: column; }
  .sm\:flex-nowrap { flex-wrap: nowrap; }
  .sm\:items-start { align-items: flex-start; }
  .sm\:items-center { align-items: center; }
  .sm\:justify-start { justify-content: flex-start; }
  .sm\:justify-end { justify-content: flex-end; }
  .sm\:justify-between { justify-content: space-between; }
  .sm\:gap-0 { gap: 0px; }
  .sm\:gap-10 { gap: 2.5rem; }
  .sm\:gap-3 { gap: 0.75rem; }
  .sm\:gap-4 { gap: 1rem; }
  .sm\:gap-8 { gap: 2rem; }
  .sm\:gap-\[0\.15em\] { gap: 0.15em; }
  .sm\:gap-\[0\.25em\] { gap: 0.25em; }
  .sm\:whitespace-nowrap { white-space: nowrap; }
  .sm\:break-normal { overflow-wrap: normal; word-break: normal; }
  .sm\:rounded-none { border-radius: 0px; }
  .sm\:rounded-xl { border-radius: 0.75rem; }
  .sm\:border-l { border-left-width: 1px; }
  .sm\:bg-transparent { background-color: transparent; }
  .sm\:p-3 { padding: 0.75rem; }
  .sm\:p-3\.5 { padding: 0.875rem; }
  .sm\:p-5 { padding: 1.25rem; }
  .sm\:p-8 { padding: 2rem; }
  .sm\:\!px-12 { padding-left: 3rem !important; padding-right: 3rem !import=
ant; }
  .sm\:\!px-8 { padding-left: 2rem !important; padding-right: 2rem !importa=
nt; }
  .sm\:\!py-20 { padding-top: 5rem !important; padding-bottom: 5rem !import=
ant; }
  .sm\:px-0 { padding-left: 0px; padding-right: 0px; }
  .sm\:px-1 { padding-left: 0.25rem; padding-right: 0.25rem; }
  .sm\:px-12 { padding-left: 3rem; padding-right: 3rem; }
  .sm\:px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
  .sm\:px-2\.5 { padding-left: 0.625rem; padding-right: 0.625rem; }
  .sm\:px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
  .sm\:px-8 { padding-left: 2rem; padding-right: 2rem; }
  .sm\:py-20 { padding-top: 5rem; padding-bottom: 5rem; }
  .sm\:\!pb-8 { padding-bottom: 2rem !important; }
  .sm\:\!pt-10 { padding-top: 2.5rem !important; }
  .sm\:\!pt-8 { padding-top: 2rem !important; }
  .sm\:pb-0 { padding-bottom: 0px; }
  .sm\:pb-0\.5 { padding-bottom: 0.125rem; }
  .sm\:pb-12 { padding-bottom: 3rem; }
  .sm\:pb-20 { padding-bottom: 5rem; }
  .sm\:pl-0 { padding-left: 0px; }
  .sm\:pl-3 { padding-left: 0.75rem; }
  .sm\:pl-6 { padding-left: 1.5rem; }
  .sm\:pr-2 { padding-right: 0.5rem; }
  .sm\:pr-3 { padding-right: 0.75rem; }
  .sm\:pr-4 { padding-right: 1rem; }
  .sm\:pr-8 { padding-right: 2rem; }
  .sm\:pt-0 { padding-top: 0px; }
  .sm\:pt-14 { padding-top: 3.5rem; }
  .sm\:pt-9 { padding-top: 2.25rem; }
  .sm\:pt-\[15vh\] { padding-top: 15vh; }
  .sm\:text-left { text-align: left; }
  .sm\:text-center { text-align: center; }
  .sm\:text-2xl { font-size: 1.5rem; line-height: 2rem; }
  .sm\:text-3xl { font-size: 1.875rem; line-height: 2.25rem; }
  .sm\:text-4xl { font-size: 2.25rem; line-height: 2.5rem; }
  .sm\:text-\[2rem\] { font-size: 2rem; }
  .sm\:text-base { font-size: 1rem; line-height: 1.5rem; }
  .sm\:text-lg { font-size: 1.125rem; line-height: 1.75rem; }
  .sm\:text-sm { font-size: 0.875rem; line-height: 1.25rem; }
  .sm\:text-xl { font-size: 1.25rem; line-height: 1.75rem; }
  .sm\:text-xs { font-size: 0.75rem; line-height: 1rem; }
  .sm\:leading-none { line-height: 1; }
  .sm\:opacity-0 { opacity: 0; }
  .sm\:shadow-\[0_4px_20px_0_hsl\(var\(--always-black\)\/4\%\)\] { --tw-sha=
dow: 0 4px 20px 0 hsl(var(--always-black)/4%); --tw-shadow-colored: 0 4px 2=
0px 0 var(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0 #=
0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }
  .sm\:font-base { font-family: var(--font-ui); font-size: 0.875rem; font-w=
eight: 430; line-height: 1.4; }
  .group:hover .sm\:group-hover\:rotate-2 { --tw-rotate: 2deg; transform: t=
ranslate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotat=
e)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x=
)) scaleY(var(--tw-scale-y)); }
  .group\/header:hover .sm\:group-hover\/header\:opacity-100 { opacity: 1; =
}
}

@media (min-width: 768px) {
  .md\:pointer-events-none { pointer-events: none; }
  .md\:absolute { position: absolute; }
  .md\:relative { position: relative; }
  .md\:sticky { position: sticky; }
  .md\:left-3 { left: 0.75rem; }
  .md\:right-0 { right: 0px; }
  .md\:right-10 { right: 2.5rem; }
  .md\:right-\[296px\] { right: 296px; }
  .md\:top-0 { top: 0px; }
  .md\:top-10 { top: 2.5rem; }
  .md\:top-4 { top: 1rem; }
  .md\:z-0 { z-index: 0; }
  .md\:order-1 { order: 1; }
  .md\:col-span-1 { grid-column: span 1 / span 1; }
  .md\:col-span-4 { grid-column: span 4 / span 4; }
  .md\:col-span-8 { grid-column: span 8 / span 8; }
  .md\:m-2 { margin: 0.5rem; }
  .md\:mx-0 { margin-left: 0px; margin-right: 0px; }
  .md\:mx-auto { margin-left: auto; margin-right: auto; }
  .md\:my-8 { margin-top: 2rem; margin-bottom: 2rem; }
  .md\:-mb-6 { margin-bottom: -1.5rem; }
  .md\:-me-6 { margin-inline-end: -1.5rem; }
  .md\:-ml-4 { margin-left: -1rem; }
  .md\:-mt-6 { margin-top: -1.5rem; }
  .md\:mb-0 { margin-bottom: 0px; }
  .md\:mb-12 { margin-bottom: 3rem; }
  .md\:mb-48 { margin-bottom: 12rem; }
  .md\:mb-6 { margin-bottom: 1.5rem; }
  .md\:mb-8 { margin-bottom: 2rem; }
  .md\:mb-\[85px\] { margin-bottom: 85px; }
  .md\:mr-2 { margin-right: 0.5rem; }
  .md\:mr-3 { margin-right: 0.75rem; }
  .md\:mt-10 { margin-top: 2.5rem; }
  .md\:mt-12 { margin-top: 3rem; }
  .md\:mt-14 { margin-top: 3.5rem; }
  .md\:mt-20 { margin-top: 5rem; }
  .md\:mt-6 { margin-top: 1.5rem; }
  .md\:mt-8 { margin-top: 2rem; }
  .md\:mt-\[62px\] { margin-top: 62px; }
  .md\:mt-\[80px\] { margin-top: 80px; }
  .md\:mt-auto { margin-top: auto; }
  .md\:block { display: block; }
  .md\:inline { display: inline; }
  .md\:flex { display: flex; }
  .md\:grid { display: grid; }
  .md\:hidden { display: none; }
  .md\:h-24 { height: 6rem; }
  .md\:h-36 { height: 9rem; }
  .md\:h-80 { height: 20rem; }
  .md\:h-\[540px\] { height: 540px; }
  .md\:h-\[72px\] { height: 72px; }
  .md\:h-\[730px\] { height: 730px; }
  .md\:h-\[calc\(100\%-56px\)\] { height: calc(100% - 56px); }
  .md\:h-\[calc\(100vh-11rem\)\] { height: calc(-11rem + 100vh); }
  .md\:w-1\/2 { width: 50%; }
  .md\:w-5\/6 { width: 83.3333%; }
  .md\:w-7\/12 { width: 58.3333%; }
  .md\:w-\[100\%\] { width: 100%; }
  .md\:w-\[23rem\] { width: 23rem; }
  .md\:w-\[27rem\] { width: 27rem; }
  .md\:w-\[30\%\] { width: 30%; }
  .md\:w-\[342px\] { width: 342px; }
  .md\:w-\[384px\] { width: 384px; }
  .md\:w-\[666px\] { width: 666px; }
  .md\:w-\[70\%\] { width: 70%; }
  .md\:w-\[9rem\] { width: 9rem; }
  .md\:w-\[calc\(50vw-2\.5rem\)\] { width: calc(-2.5rem + 50vw); }
  .md\:w-auto { width: auto; }
  .md\:w-fit { width: fit-content; }
  .md\:w-full { width: 100%; }
  .md\:min-w-40 { min-width: 10rem; }
  .md\:min-w-\[300px\] { min-width: 300px; }
  .md\:max-w-2xl { max-width: 42rem; }
  .md\:max-w-3xl { max-width: 48rem; }
  .md\:max-w-4xl { max-width: 56rem; }
  .md\:max-w-\[350px\] { max-width: 350px; }
  .md\:max-w-\[545px\] { max-width: 545px; }
  .md\:max-w-\[calc\(100vw-4rem\)\] { max-width: calc(-4rem + 100vw); }
  .md\:max-w-none { max-width: none; }
  .md\:max-w-xl { max-width: 36rem; }
  .md\:flex-1 { flex: 1 1 0%; }
  .md\:flex-shrink-0 { flex-shrink: 0; }
  .md\:flex-grow-0 { flex-grow: 0; }
  .md\:basis-0 { flex-basis: 0px; }
  .md\:translate-x-0 { --tw-translate-x: 0px; transform: translate(var(--tw=
-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--t=
w-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--t=
w-scale-y)); }
  @keyframes fade {=20
  0% { opacity: 0; }
  100% { opacity: 1; }
}
  .md\:animate-\[fade_0\.3s_ease-in-out_0\.1s_forwards\] { animation: 0.3s =
ease-in-out 0.1s 1 normal forwards running fade; }
  .md\:grid-cols-12 { grid-template-columns: repeat(12, minmax(0px, 1fr)); =
}
  .md\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0px, 1fr)); }
  .md\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0px, 1fr)); }
  .md\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0px, 1fr)); }
  .md\:grid-cols-\[220px_minmax\(0px\,_1fr\)\] { grid-template-columns: 220=
px minmax(0px, 1fr); }
  .md\:grid-cols-\[400px_1fr\] { grid-template-columns: 400px 1fr; }
  .md\:grid-cols-\[480px_270px\] { grid-template-columns: 480px 270px; }
  .md\:grid-rows-1 { grid-template-rows: repeat(1, minmax(0px, 1fr)); }
  .md\:flex-row { flex-direction: row; }
  .md\:flex-col { flex-direction: column; }
  .md\:flex-wrap { flex-wrap: wrap; }
  .md\:items-end { align-items: flex-end; }
  .md\:items-center { align-items: center; }
  .md\:items-stretch { align-items: stretch; }
  .md\:justify-center { justify-content: center; }
  .md\:justify-between { justify-content: space-between; }
  .md\:gap-12 { gap: 3rem; }
  .md\:gap-2 { gap: 0.5rem; }
  .md\:gap-3 { gap: 0.75rem; }
  .md\:gap-32 { gap: 8rem; }
  .md\:gap-4 { gap: 1rem; }
  .md\:gap-6 { gap: 1.5rem; }
  .md\:gap-8 { gap: 2rem; }
  .md\:gap-\[10px\] { gap: 10px; }
  .md\:gap-\[2rem\] { gap: 2rem; }
  .md\:space-x-4 > :not([hidden]) ~ :not([hidden]) { --tw-space-x-reverse: =
0; margin-right: calc(1rem * var(--tw-space-x-reverse)); margin-left: calc(=
1rem * calc(1 - var(--tw-space-x-reverse))); }
  .md\:space-y-0 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: =
0; margin-top: calc(0px * calc(1 - var(--tw-space-y-reverse))); margin-bott=
om: calc(0px * var(--tw-space-y-reverse)); }
  .md\:overflow-hidden { overflow: hidden; }
  .md\:overflow-ellipsis { text-overflow: ellipsis; }
  .md\:rounded-2xl { border-radius: 1rem; }
  .md\:rounded-e-none { border-start-end-radius: 0px; border-end-end-radius=
: 0px; }
  .md\:rounded-s-2xl { border-start-start-radius: 1rem; border-end-start-ra=
dius: 1rem; }
  .md\:border-0 { border-width: 0px; }
  .md\:border-0\.5 { border-width: 0.5px; }
  .md\:border-border-300 { border-color: hsl(var(--border-300)/.15); }
  .md\:bg-bg-000 { --tw-bg-opacity: 1; background-color: hsl(var(--bg-000)/=
var(--tw-bg-opacity)); }
  .md\:\!p-8 { padding: 2rem !important; }
  .md\:p-10 { padding: 2.5rem; }
  .md\:p-6 { padding: 1.5rem; }
  .md\:p-8 { padding: 2rem; }
  .md\:px-0 { padding-left: 0px; padding-right: 0px; }
  .md\:px-10 { padding-left: 2.5rem; padding-right: 2.5rem; }
  .md\:px-11 { padding-left: 2.75rem; padding-right: 2.75rem; }
  .md\:px-12 { padding-left: 3rem; padding-right: 3rem; }
  .md\:px-14 { padding-left: 3.5rem; padding-right: 3.5rem; }
  .md\:px-16 { padding-left: 4rem; padding-right: 4rem; }
  .md\:px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
  .md\:px-24 { padding-left: 6rem; padding-right: 6rem; }
  .md\:px-4 { padding-left: 1rem; padding-right: 1rem; }
  .md\:px-8 { padding-left: 2rem; padding-right: 2rem; }
  .md\:py-20 { padding-top: 5rem; padding-bottom: 5rem; }
  .md\:py-24 { padding-top: 6rem; padding-bottom: 6rem; }
  .md\:py-6 { padding-top: 1.5rem; padding-bottom: 1.5rem; }
  .md\:pb-0 { padding-bottom: 0px; }
  .md\:pb-10 { padding-bottom: 2.5rem; }
  .md\:pb-12 { padding-bottom: 3rem; }
  .md\:pb-20 { padding-bottom: 5rem; }
  .md\:pb-3 { padding-bottom: 0.75rem; }
  .md\:pb-8 { padding-bottom: 2rem; }
  .md\:pb-\[140px\] { padding-bottom: 140px; }
  .md\:pe-0 { padding-inline-end: 0px; }
  .md\:pe-6 { padding-inline-end: 1.5rem; }
  .md\:pe-8 { padding-inline-end: 2rem; }
  .md\:pl-3 { padding-left: 0.75rem; }
  .md\:pl-5 { padding-left: 1.25rem; }
  .md\:pl-8 { padding-left: 2rem; }
  .md\:pl-\[133px\] { padding-left: 133px; }
  .md\:pr-0 { padding-right: 0px; }
  .md\:pr-2 { padding-right: 0.5rem; }
  .md\:pr-3 { padding-right: 0.75rem; }
  .md\:pt-1 { padding-top: 0.25rem; }
  .md\:pt-10 { padding-top: 2.5rem; }
  .md\:pt-12 { padding-top: 3rem; }
  .md\:pt-2 { padding-top: 0.5rem; }
  .md\:pt-20 { padding-top: 5rem; }
  .md\:pt-24 { padding-top: 6rem; }
  .md\:pt-6 { padding-top: 1.5rem; }
  .md\:pt-8 { padding-top: 2rem; }
  .md\:pt-9 { padding-top: 2.25rem; }
  .md\:pt-\[20vh\] { padding-top: 20vh; }
  .md\:text-left { text-align: left; }
  .md\:text-2xl { font-size: 1.5rem; line-height: 2rem; }
  .md\:text-3xl { font-size: 1.875rem; line-height: 2.25rem; }
  .md\:text-4xl { font-size: 2.25rem; line-height: 2.5rem; }
  .md\:text-6xl { font-size: 3.75rem; line-height: 1; }
  .md\:text-lg { font-size: 1.125rem; line-height: 1.75rem; }
  .md\:text-xl { font-size: 1.25rem; line-height: 1.75rem; }
  .md\:opacity-0 { opacity: 0; }
  .md\:opacity-100 { opacity: 1; }
  .md\:shadow-\[0px_1px_0px_0px_theme\(colors\.border-300\)\] { --tw-shadow=
: 0px 1px 0px 0px hsl(var(--border-300)/0.15); --tw-shadow-colored: 0px 1px=
 0px 0px var(--tw-shadow-color); }
  .md\:shadow-\[0px_1px_0px_0px_theme\(colors\.border-300\)\], .md\:shadow-=
sm { box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shado=
w,0 0 #0000),var(--tw-shadow); }
  .md\:shadow-sm { --tw-shadow: 0 1px 2px 0 rgb(0 0 0/0.05); --tw-shadow-co=
lored: 0 1px 2px 0 var(--tw-shadow-color); }
  .md\:transition-\[width\] { transition-property: width; transition-timing=
-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }
  .md\:transition-opacity { transition-property: opacity; transition-timing=
-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 0.15s; }
  .md\:duration-300 { transition-duration: 0.3s; }
  .md\:ease-in-out { transition-timing-function: cubic-bezier(0.4, 0, 0.2, =
1); }
  .md\:font-large { font-family: var(--font-ui); font-size: 1rem; font-weig=
ht: 430; line-height: 1.4; }
  .md\:font-xl { font-weight: 400; font-variation-settings: "opsz" 20; }
  .md\:font-xl, .md\:font-xl-bold { font-family: var(--font-ui); font-size:=
 1.25rem; line-height: 1.4; }
  .md\:font-xl-bold { font-weight: 600; font-variation-settings: "opsz" 20;=
 }
}

@media (min-width: 1000px) {
  .min-\[1000px\]\:flex { display: flex; }
  .min-\[1000px\]\:hidden { display: none; }
  .min-\[1000px\]\:h-\[5\.25rem\] { height: 5.25rem; }
  .min-\[1000px\]\:max-w-7xl { max-width: 80rem; }
  .min-\[1000px\]\:max-w-\[30rem\] { max-width: 30rem; }
  .min-\[1000px\]\:max-w-\[90rem\] { max-width: 90rem; }
  .min-\[1000px\]\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0p=
x, 1fr)); }
  .min-\[1000px\]\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0p=
x, 1fr)); }
  .min-\[1000px\]\:justify-center { justify-content: center; }
  .min-\[1000px\]\:gap-8 { gap: 2rem; }
}

@media (min-width: 1024px) {
  .lg\:absolute { position: absolute; }
  .lg\:sticky { position: sticky; }
  .lg\:-top-1 { top: -0.25rem; }
  .lg\:-top-1\.5 { top: -0.375rem; }
  .lg\:left-8 { left: 2rem; }
  .lg\:col-span-3 { grid-column: span 3 / span 3; }
  .lg\:col-span-9 { grid-column: span 9 / span 9; }
  .lg\:mx-0 { margin-left: 0px; margin-right: 0px; }
  .lg\:mx-auto { margin-left: auto; margin-right: auto; }
  .lg\:my-10 { margin-top: 2.5rem; margin-bottom: 2.5rem; }
  .lg\:-mt-24 { margin-top: -6rem; }
  .lg\:mb-0 { margin-bottom: 0px; }
  .lg\:mb-\[38px\] { margin-bottom: 38px; }
  .lg\:ml-2 { margin-left: 0.5rem; }
  .lg\:mt-2 { margin-top: 0.5rem; }
  .lg\:mt-6 { margin-top: 1.5rem; }
  .lg\:mt-\[-12rem\] { margin-top: -12rem; }
  .lg\:mt-\[38px\] { margin-top: 38px; }
  .lg\:mt-\[50px\] { margin-top: 50px; }
  .lg\:inline { display: inline; }
  .lg\:flex { display: flex; }
  .lg\:hidden { display: none; }
  .lg\:h-6 { height: 1.5rem; }
  .lg\:h-\[42px\] { height: 42px; }
  .lg\:h-\[96px\] { height: 96px; }
  .lg\:min-h-\[600px\] { min-height: 600px; }
  .lg\:\!w-\[65\%\] { width: 65% !important; }
  .lg\:w-52 { width: 13rem; }
  .lg\:w-6 { width: 1.5rem; }
  .lg\:w-\[23rem\] { width: 23rem; }
  .lg\:w-\[27rem\] { width: 27rem; }
  .lg\:w-\[412px\] { width: 412px; }
  .lg\:w-\[42px\] { width: 42px; }
  .lg\:w-\[calc\(50vw-2\.5rem\)\] { width: calc(-2.5rem + 50vw); }
  .lg\:w-full { width: 100%; }
  .lg\:max-w-3xl { max-width: 48rem; }
  .lg\:max-w-7xl { max-width: 80rem; }
  .lg\:max-w-\[1000px\] { max-width: 1000px; }
  .lg\:max-w-\[230px\] { max-width: 230px; }
  .lg\:max-w-\[500px\] { max-width: 500px; }
  .lg\:max-w-\[65\%\] { max-width: 65%; }
  .lg\:flex-1 { flex: 1 1 0%; }
  .lg\:flex-\[2\.2\] { flex: 2.2 1 0%; }
  .lg\:flex-\[2\.8\] { flex: 2.8 1 0%; }
  .lg\:grid-cols-12 { grid-template-columns: repeat(12, minmax(0px, 1fr)); =
}
  .lg\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0px, 1fr)); }
  .lg\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0px, 1fr)); }
  .lg\:grid-cols-4 { grid-template-columns: repeat(4, minmax(0px, 1fr)); }
  .lg\:flex-row { flex-direction: row; }
  .lg\:flex-row-reverse { flex-direction: row-reverse; }
  .lg\:flex-col { flex-direction: column; }
  .lg\:items-start { align-items: flex-start; }
  .lg\:items-center { align-items: center; }
  .lg\:justify-start { justify-content: flex-start; }
  .lg\:gap-0 { gap: 0px; }
  .lg\:gap-16 { gap: 4rem; }
  .lg\:gap-2 { gap: 0.5rem; }
  .lg\:gap-5 { gap: 1.25rem; }
  .lg\:gap-x-6 { column-gap: 1.5rem; }
  .lg\:gap-y-6 { row-gap: 1.5rem; }
  .lg\:bg-gradient-to-t { background-image: linear-gradient(to top,var(--tw=
-gradient-stops)); }
  .lg\:px-0 { padding-left: 0px; padding-right: 0px; }
  .lg\:px-16 { padding-left: 4rem; padding-right: 4rem; }
  .lg\:px-24 { padding-left: 6rem; padding-right: 6rem; }
  .lg\:px-4 { padding-left: 1rem; padding-right: 1rem; }
  .lg\:px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
  .lg\:px-8 { padding-left: 2rem; padding-right: 2rem; }
  .lg\:px-\[100px\] { padding-left: 100px; padding-right: 100px; }
  .lg\:px-\[160px\] { padding-left: 160px; padding-right: 160px; }
  .lg\:py-24 { padding-top: 6rem; padding-bottom: 6rem; }
  .lg\:py-\[120px\] { padding-top: 120px; padding-bottom: 120px; }
  .lg\:pb-0 { padding-bottom: 0px; }
  .lg\:pb-24 { padding-bottom: 6rem; }
  .lg\:pb-\[120px\] { padding-bottom: 120px; }
  .lg\:pl-0 { padding-left: 0px; }
  .lg\:pl-4 { padding-left: 1rem; }
  .lg\:pl-\[clamp\(0px\,7vw\,80px\)\] { padding-left: clamp(0px, 7vw, 80px)=
; }
  .lg\:pr-0 { padding-right: 0px; }
  .lg\:pr-3 { padding-right: 0.75rem; }
  .lg\:pt-32 { padding-top: 8rem; }
  .lg\:pt-\[100px\] { padding-top: 100px; }
  .lg\:pt-\[25vh\] { padding-top: 25vh; }
  .lg\:pt-\[40px\] { padding-top: 40px; }
  .lg\:text-left { text-align: left; }
  .lg\:shadow-none { --tw-shadow: 0 0 #0000; --tw-shadow-colored: 0 0 #0000=
; box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0=
 0 #0000),var(--tw-shadow); }
  .lg\:font-xl { font-family: var(--font-ui); font-size: 1.25rem; font-weig=
ht: 400; line-height: 1.4; font-variation-settings: "opsz" 20; }
}

@media (min-width: 1280px) {
  .xl\:col-span-5 { grid-column: span 5 / span 5; }
  .xl\:mt-0 { margin-top: 0px; }
  .xl\:grid-cols-12 { grid-template-columns: repeat(12, minmax(0px, 1fr)); =
}
  .xl\:pl-12 { padding-left: 3rem; }
  .xl\:pr-4 { padding-right: 1rem; }
}

.dark\:block:where([data-mode=3D"dark"], [data-mode=3D"dark"] *) { display:=
 block; }

.dark\:hidden:where([data-mode=3D"dark"], [data-mode=3D"dark"] *) { display=
: none; }

.dark\:border-0:where([data-mode=3D"dark"], [data-mode=3D"dark"] *) { borde=
r-width: 0px; }

.dark\:border-always-white\/20:where([data-mode=3D"dark"], [data-mode=3D"da=
rk"] *) { border-color: hsl(var(--always-white)/.2); }

.dark\:border-always-white\/\[9\%\]:where([data-mode=3D"dark"], [data-mode=
=3D"dark"] *) { border-color: hsl(var(--always-white)/9%); }

.dark\:bg-\[\#797979\]\/50:where([data-mode=3D"dark"], [data-mode=3D"dark"]=
 *) { background-color: rgba(121, 121, 121, 0.5); }

.dark\:bg-accent-secondary-900:where([data-mode=3D"dark"], [data-mode=3D"da=
rk"] *) { --tw-bg-opacity: 1; background-color: hsl(var(--accent-secondary-=
900)/var(--tw-bg-opacity)); }

.dark\:bg-always-white\/\[6\%\]:where([data-mode=3D"dark"], [data-mode=3D"d=
ark"] *) { background-color: hsl(var(--always-white)/6%); }

.dark\:bg-bg-200:where([data-mode=3D"dark"], [data-mode=3D"dark"] *) { --tw=
-bg-opacity: 1; background-color: hsl(var(--bg-200)/var(--tw-bg-opacity)); =
}

.dark\:bg-bg-300:where([data-mode=3D"dark"], [data-mode=3D"dark"] *) { --tw=
-bg-opacity: 1; background-color: hsl(var(--bg-300)/var(--tw-bg-opacity)); =
}

.dark\:bg-danger-000\/25:where([data-mode=3D"dark"], [data-mode=3D"dark"] *=
) { background-color: hsl(var(--danger-000)/.25); }

.dark\:bg-danger-900\/35:where([data-mode=3D"dark"], [data-mode=3D"dark"] *=
) { background-color: hsl(var(--danger-900)/.35); }

.dark\:bg-success-000\/25:where([data-mode=3D"dark"], [data-mode=3D"dark"] =
*) { background-color: hsl(var(--success-000)/.25); }

.dark\:bg-success-900\/35:where([data-mode=3D"dark"], [data-mode=3D"dark"] =
*) { background-color: hsl(var(--success-900)/.35); }

.dark\:via-always-white\/10:where([data-mode=3D"dark"], [data-mode=3D"dark"=
] *) { --tw-gradient-to: hsl(var(--always-white)/0) var(--tw-gradient-to-po=
sition); --tw-gradient-stops: var(--tw-gradient-from),hsl(var(--always-whit=
e)/0.1) var(--tw-gradient-via-position),var(--tw-gradient-to); }

.dark\:fill-text-000:where([data-mode=3D"dark"], [data-mode=3D"dark"] *) { =
fill: hsl(var(--text-000)/1); }

.dark\:text-bg-000:where([data-mode=3D"dark"], [data-mode=3D"dark"] *) { --=
tw-text-opacity: 1; color: hsl(var(--bg-000)/var(--tw-text-opacity)); }

.dark\:text-bg-500:where([data-mode=3D"dark"], [data-mode=3D"dark"] *) { --=
tw-text-opacity: 1; color: hsl(var(--bg-500)/var(--tw-text-opacity)); }

.dark\:text-text-100:where([data-mode=3D"dark"], [data-mode=3D"dark"] *) { =
--tw-text-opacity: 1; color: hsl(var(--text-100)/var(--tw-text-opacity)); }

.dark\:\!shadow-\[0px_2px_8px_0px_hsl\(var\(--always-black\)\/24\%\)\]:wher=
e([data-mode=3D"dark"], [data-mode=3D"dark"] *) { --tw-shadow: 0px 2px 8px =
0px hsl(var(--always-black)/24%) !important; --tw-shadow-colored: 0px 2px 8=
px 0px var(--tw-shadow-color) !important; box-shadow: var(--tw-ring-offset-=
shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow) !importa=
nt; }

.dark\:shadow-\[0px_2px_8px_0px_hsl\(var\(--always-black\)\/24\%\)\]:where(=
[data-mode=3D"dark"], [data-mode=3D"dark"] *) { --tw-shadow: 0px 2px 8px 0p=
x hsl(var(--always-black)/24%); --tw-shadow-colored: 0px 2px 8px 0px var(--=
tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0 #0000),var(--=
tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.dark\:ring-border-300\/50:where([data-mode=3D"dark"], [data-mode=3D"dark"]=
 *) { --tw-ring-color: hsl(var(--border-300)/0.5); }

.dark\:drop-shadow-\[0_2px_8px_hsl\(var\(--always-black\)\/16\%\)\]:where([=
data-mode=3D"dark"], [data-mode=3D"dark"] *) { --tw-drop-shadow: drop-shado=
w(0 2px 8px hsl(var(--always-black)/16%)); filter: var(--tw-blur) var(--tw-=
brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var=
(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow); }

.dark\:backdrop-blur-\[14px\]:where([data-mode=3D"dark"], [data-mode=3D"dar=
k"] *) { --tw-backdrop-blur: blur(14px); backdrop-filter: var(--tw-backdrop=
-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-b=
ackdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) =
var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-se=
pia); }

.dark\:hover\:bg-danger-900\/60:hover:where([data-mode=3D"dark"], [data-mod=
e=3D"dark"] *) { background-color: hsl(var(--danger-900)/.6); }

.dark\:hover\:bg-success-900\/60:hover:where([data-mode=3D"dark"], [data-mo=
de=3D"dark"] *) { background-color: hsl(var(--success-900)/.6); }

.\[\&\.has-bottom-scroll\]\:\[mask-image\:linear-gradient\(to_top\,rgba\(0\=
,0\,0\,0\)_0\%\,_rgba\(0\,0\,0\,1\)_3\%\)\].has-bottom-scroll { mask-image:=
 linear-gradient(0deg, rgba(0, 0, 0, 0) 0px, rgb(0, 0, 0) 3%); }

.\[\&\:\:-webkit-calendar-picker-indicator\]\:cursor-pointer::-webkit-calen=
dar-picker-indicator { cursor: pointer; }

.\[\&\:\:-webkit-calendar-picker-indicator\]\:opacity-50::-webkit-calendar-=
picker-indicator { opacity: 0.5; }

.\[\&\:\:-webkit-calendar-picker-indicator\]\:hover\:opacity-100:hover::-we=
bkit-calendar-picker-indicator { opacity: 1; }

.\[\&\:\:-webkit-inner-spin-button\]\:appearance-none::-webkit-inner-spin-b=
utton, .\[\&\:\:-webkit-outer-spin-button\]\:appearance-none::-webkit-outer=
-spin-button { appearance: none; }

.\[\&\:\:-webkit-scrollbar-thumb\:hover\]\:bg-text-500::-webkit-scrollbar-t=
humb:hover { --tw-bg-opacity: 1; background-color: hsl(var(--text-500)/var(=
--tw-bg-opacity)); }

.\[\&\:\:-webkit-scrollbar-thumb\]\:rounded-\[1em\]::-webkit-scrollbar-thum=
b { border-radius: 1em; }

.\[\&\:\:-webkit-scrollbar-thumb\]\:rounded-full::-webkit-scrollbar-thumb {=
 border-radius: 9999px; }

.\[\&\:\:-webkit-scrollbar-thumb\]\:border-\[0\.25rem\]::-webkit-scrollbar-=
thumb { border-width: 0.25rem; }

.\[\&\:\:-webkit-scrollbar-thumb\]\:border-transparent::-webkit-scrollbar-t=
humb { border-color: transparent; }

.\[\&\:\:-webkit-scrollbar-thumb\]\:bg-border-400::-webkit-scrollbar-thumb =
{ background-color: hsl(var(--border-400)/.15); }

.\[\&\:\:-webkit-scrollbar-thumb\]\:bg-text-500\/80::-webkit-scrollbar-thum=
b { background-color: hsl(var(--text-500)/.8); }

.\[\&\:\:-webkit-scrollbar-thumb\]\:bg-transparent::-webkit-scrollbar-thumb=
 { background-color: transparent; }

.\[\&\:\:-webkit-scrollbar-thumb\]\:bg-clip-padding::-webkit-scrollbar-thum=
b { background-clip: padding-box; }

.hover\:\[\&\:\:-webkit-scrollbar-thumb\]\:bg-border-300::-webkit-scrollbar=
-thumb:hover { background-color: hsl(var(--border-300)/.15); }

.\[\&\:\:-webkit-scrollbar-track\]\:my-1::-webkit-scrollbar-track { margin-=
top: 0.25rem; margin-bottom: 0.25rem; }

.\[\&\:\:-webkit-scrollbar-track\]\:bg-transparent::-webkit-scrollbar-track=
 { background-color: transparent; }

.\[\&\:\:-webkit-scrollbar\]\:mt-4::-webkit-scrollbar { margin-top: 1rem; }

.\[\&\:\:-webkit-scrollbar\]\:hidden::-webkit-scrollbar { display: none; }

.\[\&\:\:-webkit-scrollbar\]\:w-1\.5::-webkit-scrollbar { width: 0.375rem; =
}

.\[\&\:\:-webkit-scrollbar\]\:w-\[0\.25rem\]::-webkit-scrollbar { width: 0.=
25rem; }

.\[\&\:\:selection\]\:bg-transparent::selection { background-color: transpa=
rent; }

.\[\&\:has\(\.feedback-link\:hover\)\]\:\!bg-transparent:has(.feedback-link=
:hover) { background-color: transparent !important; }

.\[\&\:has\(\[data-state\=3D\'open\'\]\)\]\:bg-bg-000:has([data-state=3D"op=
en"]) { --tw-bg-opacity: 1; background-color: hsl(var(--bg-000)/var(--tw-bg=
-opacity)); }

.\[\&\:has\(\[data-state\=3D\'open\'\]\)\]\:shadow-sm:has([data-state=3D"op=
en"]) { --tw-shadow: 0 1px 2px 0 rgb(0 0 0/0.05); --tw-shadow-colored: 0 1p=
x 2px 0 var(--tw-shadow-color); box-shadow: var(--tw-ring-offset-shadow,0 0=
 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow); }

.\[\&\:hover\>button\]\:\!bg-bg-300:hover > button { --tw-bg-opacity: 1 !im=
portant; background-color: hsl(var(--bg-300)/var(--tw-bg-opacity)) !importa=
nt; }

.\[\&\:hover\>button\]\:bg-bg-200:hover > button { --tw-bg-opacity: 1; back=
ground-color: hsl(var(--bg-200)/var(--tw-bg-opacity)); }

.\[\&\:hover\]\:border-border-300:hover { border-color: hsl(var(--border-30=
0)/.15); }

.\[\&\:hover\]\:bg-transparent:hover { background-color: transparent; }

.\[\&\:not\(\:is\(\:hover\,\:focus\)\)\]\:decoration-\[color-mix\(in_srgb\,=
currentColor\,transparent_60\%\)\]:not(:is(:hover, :focus)) { text-decorati=
on-color: color-mix(in srgb, currentcolor 40%, transparent); }

.\[\&\:not\(\:last-child\)_ol\]\:pb-1:not(:last-child) ol, .\[\&\:not\(\:la=
st-child\)_ul\]\:pb-1:not(:last-child) ul { padding-bottom: 0.25rem; }

.\[\&\>\*\]\:pointer-events-auto > * { pointer-events: auto; }

.\[\&\>\*\]\:snap-start > * { scroll-snap-align: start; }

.\[\&\>\*\]\:\!text-sm > * { font-size: 0.875rem !important; line-height: 1=
.25rem !important; }

.\[\&\>\*\]\:font-ui > * { font-family: var(--font-ui); }

.\[\&\>button\:first-child\]\:\!border-r > button:first-child { border-righ=
t-width: 1px !important; }

.\[\&\>button\:first-child\]\:\!border-r-oncolor-100\/25 > button:first-chi=
ld { border-right-color: hsl(var(--oncolor-100)/.25) !important; }

.\[\&\>button\:hover\]\:\!bg-bg-500 > button:hover { --tw-bg-opacity: 1 !im=
portant; background-color: hsl(var(--bg-500)/var(--tw-bg-opacity)) !importa=
nt; }

.\[\&\>button\:hover\]\:bg-bg-100 > button:hover { --tw-bg-opacity: 1; back=
ground-color: hsl(var(--bg-100)/var(--tw-bg-opacity)); }

.\[\&\>button\:hover\]\:bg-bg-300 > button:hover { --tw-bg-opacity: 1; back=
ground-color: hsl(var(--bg-300)/var(--tw-bg-opacity)); }

.\[\&\>button\]\:w-full > button { width: 100%; }

.\[\&\>button\]\:min-w-8 > button { min-width: 2rem; }

.\[\&\>button\]\:flex-1 > button { flex: 1 1 0%; }

.\[\&\>button\]\:justify-between > button { justify-content: space-between;=
 }

.\[\&\>button\]\:\!rounded-md > button { border-radius: 0.375rem !important=
; }

.\[\&\>button\]\:rounded-\[\.625rem\] > button { border-radius: 0.625rem; }

.\[\&\>button\]\:rounded-md > button { border-radius: 0.375rem; }

.\[\&\>button\]\:rounded-none > button { border-radius: 0px; }

.\[\&\>button\]\:border > button { border-width: 1px; }

.\[\&\>button\]\:border-border-300 > button { border-color: hsl(var(--borde=
r-300)/.15); }

.\[\&\>button\]\:px-2 > button { padding-left: 0.5rem; padding-right: 0.5re=
m; }

.\[\&\>button\]\:px-3 > button { padding-left: 0.75rem; padding-right: 0.75=
rem; }

.\[\&\>button\]\:py-2 > button { padding-top: 0.5rem; padding-bottom: 0.5re=
m; }

.first\:\[\&\>button\]\:rounded-l-\[6px\] > button:first-child { border-top=
-left-radius: 6px; border-bottom-left-radius: 6px; }

.last\:\[\&\>button\]\:rounded-r-\[6px\] > button:last-child { border-top-r=
ight-radius: 6px; border-bottom-right-radius: 6px; }

.\[\&\>div\>div\:first-child\]\:\!h-\[150px\] > div > div:first-child { hei=
ght: 150px !important; }

.\[\&\>div\>div\>div\]\:min-w-8 > div > div > div { min-width: 2rem; }

.\[\&\>div\>div\>div\]\:flex-1 > div > div > div { flex: 1 1 0%; }

.\[\&\>div\>div\>div\]\:\!rounded-md > div > div > div { border-radius: 0.3=
75rem !important; }

.\[\&\>div\>div\>div\]\:rounded-\[\.625rem\] > div > div > div { border-rad=
ius: 0.625rem; }

.\[\&\>div\>div\>div\]\:px-2 > div > div > div { padding-left: 0.5rem; padd=
ing-right: 0.5rem; }

.\[\&\>div\>div\]\:\!mx-0 > div > div { margin-left: 0px !important; margin=
-right: 0px !important; }

.\[\&\>div\>div\]\:\!mb-0 > div > div { margin-bottom: 0px !important; }

.\[\&\>div\>div\]\:\!h-full > div > div { height: 100% !important; }

.\[\&\>div\>div\]\:\!rounded-md > div > div { border-radius: 0.375rem !impo=
rtant; }

.\[\&\>div\>div\]\:bg-bg-100 > div > div { --tw-bg-opacity: 1; background-c=
olor: hsl(var(--bg-100)/var(--tw-bg-opacity)); }

.\[\&\>div\]\:\!m-0 > div { margin: 0px !important; }

.\[\&\>div\]\:\!mx-0 > div { margin-left: 0px !important; margin-right: 0px=
 !important; }

.\[\&\>div\]\:\!h-full > div { height: 100% !important; }

.\[\&\>div\]\:\!rounded-lg > div { border-radius: 0.5rem !important; }

.\[\&\>div\]\:\!rounded-none > div { border-radius: 0px !important; }

.\[\&\>div\]\:rounded-none > div { border-radius: 0px; }

.\[\&\>div\]\:\!border-0 > div { border-width: 0px !important; }

.\[\&\>div\]\:border-0 > div { border-width: 0px; }

.\[\&\>div\]\:\!p-0 > div { padding: 0px !important; }

.\[\&\>div\]\:pl-\[133px\] > div { padding-left: 133px; }

.\[\&\>div\]\:\!shadow-none > div { --tw-shadow: 0 0 #0000 !important; --tw=
-shadow-colored: 0 0 #0000 !important; box-shadow: var(--tw-ring-offset-sha=
dow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow) !important;=
 }

.\[\&\>hr\:first-child\]\:hidden > hr:first-child { display: none; }

.\[\&\>svg\]\:mx-auto > svg { margin-left: auto; margin-right: auto; }

.\[\&\>svg\]\:block > svg { display: block; }

.\[\&\>svg\]\:hidden > svg { display: none; }

.\[\&\>svg\]\:h-auto > svg { height: auto; }

.\[\&\>svg\]\:h-full > svg { height: 100%; }

.\[\&\>svg\]\:max-h-\[85\%\] > svg { max-height: 85%; }

.\[\&\>svg\]\:max-h-full > svg { max-height: 100%; }

.\[\&\>svg\]\:w-auto > svg { width: auto; }

.\[\&\>svg\]\:w-full > svg { width: 100%; }

.\[\&\>svg\]\:max-w-\[85\%\] > svg { max-width: 85%; }

.\[\&\>svg\]\:max-w-full > svg { max-width: 100%; }

.\[\&\>svg\]\:fill-current > svg { fill: currentcolor; }

.\[\&\[data-disabled\]\]\:cursor-default[data-disabled] { cursor: default; =
}

.\[\&\[data-disabled\]\]\:cursor-not-allowed[data-disabled] { cursor: not-a=
llowed; }

.\[\&\[data-disabled\]\]\:bg-bg-100[data-disabled] { --tw-bg-opacity: 1; ba=
ckground-color: hsl(var(--bg-100)/var(--tw-bg-opacity)); }

.\[\&\[data-disabled\]\]\:\!text-text-500[data-disabled] { --tw-text-opacit=
y: 1 !important; color: hsl(var(--text-500)/var(--tw-text-opacity)) !import=
ant; }

.\[\&\[data-disabled\]\]\:opacity-50[data-disabled] { opacity: 0.5; }

.\[\&\[data-highlighted\]\]\:bg-bg-200[data-highlighted] { --tw-bg-opacity:=
 1; background-color: hsl(var(--bg-200)/var(--tw-bg-opacity)); }

.\[\&\[data-highlighted\]\]\:bg-danger-900[data-highlighted] { --tw-bg-opac=
ity: 1; background-color: hsl(var(--danger-900)/var(--tw-bg-opacity)); }

.\[\&\[data-highlighted\]\]\:text-danger-000[data-highlighted] { --tw-text-=
opacity: 1; color: hsl(var(--danger-000)/var(--tw-text-opacity)); }

.\[\&\[data-highlighted\]\]\:text-text-000[data-highlighted] { --tw-text-op=
acity: 1; color: hsl(var(--text-000)/var(--tw-text-opacity)); }

.\[\&\[data-highlighted\]\]\:text-text-300[data-highlighted] { --tw-text-op=
acity: 1; color: hsl(var(--text-300)/var(--tw-text-opacity)); }

.\[\&\[data-placeholder\]\]\:text-text-400[data-placeholder] { --tw-text-op=
acity: 1; color: hsl(var(--text-400)/var(--tw-text-opacity)); }

.\[\&\[data-popup-open\]\:not\(\[data-highlighted\]\)\]\:before\:absolute[d=
ata-popup-open]:not([data-highlighted])::before { content: var(--tw-content=
); position: absolute; }

.\[\&\[data-popup-open\]\:not\(\[data-highlighted\]\)\]\:before\:inset-0[da=
ta-popup-open]:not([data-highlighted])::before { content: var(--tw-content)=
; inset: 0px; }

.\[\&\[data-popup-open\]\:not\(\[data-highlighted\]\)\]\:before\:-z-\[1\][d=
ata-popup-open]:not([data-highlighted])::before { content: var(--tw-content=
); z-index: -1; }

.\[\&\[data-popup-open\]\:not\(\[data-highlighted\]\)\]\:before\:rounded-lg=
[data-popup-open]:not([data-highlighted])::before { content: var(--tw-conte=
nt); border-radius: 0.5rem; }

.\[\&\[data-popup-open\]\:not\(\[data-highlighted\]\)\]\:before\:bg-bg-100[=
data-popup-open]:not([data-highlighted])::before { content: var(--tw-conten=
t); --tw-bg-opacity: 1; background-color: hsl(var(--bg-100)/var(--tw-bg-opa=
city)); }

.\[\&\[data-state\=3D\"open\"\]\:not\(\[data-highlighted\]\)\]\:bg-bg-100[d=
ata-state=3D"open"]:not([data-highlighted]) { --tw-bg-opacity: 1; backgroun=
d-color: hsl(var(--bg-100)/var(--tw-bg-opacity)); }

.\[\&\[data-state\=3D\"open\"\]\:not\(\[data-highlighted\]\)\]\:text-text-3=
00[data-state=3D"open"]:not([data-highlighted]) { --tw-text-opacity: 1; col=
or: hsl(var(--text-300)/var(--tw-text-opacity)); }

.\[\&\[data-state\=3Dopen\]\>\.icon\]\:rotate-180[data-state=3D"open"] > .i=
con { --tw-rotate: 180deg; transform: translate(var(--tw-translate-x),var(-=
-tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(va=
r(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)); }

.\[\&\[open\]\>summary\]\:hidden[open] > summary { display: none; }

.\[\&_\*\]\:gap-\[0\.05rem\] * { gap: 0.05rem; }

.\[\&_\*\]\:text-text-300 * { --tw-text-opacity: 1; color: hsl(var(--text-3=
00)/var(--tw-text-opacity)); }

.\[\&_\*\]\:\!filter-none * { filter: none !important; }

.\[\&_\.AccordionContent\]\:mb-4 .AccordionContent { margin-bottom: 1rem; }

.\[\&_\.AccordionHeader\]\:w-fit .AccordionHeader { width: fit-content; }

.\[\&_\.AccordionHeader_button\>div\]\:flex-none .AccordionHeader button > =
div { flex: 0 0 auto; }

.\[\&_\.AccordionHeader_button\]\:gap-2 .AccordionHeader button { gap: 0.5r=
em; }

.\[\&_\.AccordionItem\]\:border-b .AccordionItem { border-bottom-width: 1px=
; }

.\[\&_\.AccordionItem\]\:border-b-0\.5 .AccordionItem { border-bottom-width=
: 0.5px; }

.\[\&_\.AccordionItem\]\:border-border-300 .AccordionItem { border-color: h=
sl(var(--border-300)/.15); }

.\[\&_\.AccordionItem\]\:pb-6 .AccordionItem { padding-bottom: 1.5rem; }

.\[\&_\.PhoneInputInput\]\:border-none .PhoneInputInput { border-style: non=
e; }

.\[\&_\.PhoneInputInput\]\:bg-transparent .PhoneInputInput { background-col=
or: transparent; }

.\[\&_\.PhoneInputInput\]\:pl-1\.5 .PhoneInputInput { padding-left: 0.375re=
m; }

.\[\&_\.PhoneInputInput\]\:\!shadow-none .PhoneInputInput { --tw-shadow: 0 =
0 #0000 !important; --tw-shadow-colored: 0 0 #0000 !important; box-shadow: =
var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(=
--tw-shadow) !important; }

.\[\&_\.ProseMirror\]\:italic .ProseMirror { font-style: italic; }

.\[\&_\.ProseMirror\]\:text-text-300 .ProseMirror { --tw-text-opacity: 1; c=
olor: hsl(var(--text-300)/var(--tw-text-opacity)); }

.\[\&_\.fill-bg-000\]\:hidden .fill-bg-000 { display: none; }

.\[\&_\.group\\\/segmented-control\]\:h-\[40px\] .group\/segmented-control =
{ height: 40px; }

.\[\&_\.group\\\/segmented-control\]\:p-0\.5 .group\/segmented-control { pa=
dding: 0.125rem; }

.\[\&_\.ignore-pre-bg\>div\]\:bg-transparent .ignore-pre-bg > div { backgro=
und-color: transparent; }

.\[\&_\.is-editor-empty\]\:before\:\!content-\[\'\'\] .is-editor-empty::bef=
ore { --tw-content: "" !important; content: var(--tw-content) !important; }

.\[\&_\.linenumber\]\:\!not-italic .linenumber { font-style: normal !import=
ant; }

.\[\&_\.peer\+div\]\:\!bg-text-100 .peer + div { --tw-bg-opacity: 1 !import=
ant; background-color: hsl(var(--text-100)/var(--tw-bg-opacity)) !important=
; }

.\[\&_\.progressive-markdown_\:is\(p\,blockquote\,h1\,h2\,h3\,h4\,h5\,h6\)\=
]\:pl-2 .progressive-markdown :is(p, blockquote, h1, h2, h3, h4, h5, h6) { =
padding-left: 0.5rem; }

.\[\&_\.progressive-markdown_\:is\(p\,blockquote\,ul\,ol\,h1\,h2\,h3\,h4\,h=
5\,h6\)\]\:pr-8 .progressive-markdown :is(p, blockquote, ul, ol, h1, h2, h3=
, h4, h5, h6) { padding-right: 2rem; }

.\[\&_\.standard-markdown_\:is\(p\,blockquote\,h1\,h2\,h3\,h4\,h5\,h6\)\]\:=
pl-2 .standard-markdown :is(p, blockquote, h1, h2, h3, h4, h5, h6) { paddin=
g-left: 0.5rem; }

.\[\&_\.standard-markdown_\:is\(p\,blockquote\,ul\,ol\,h1\,h2\,h3\,h4\,h5\,=
h6\)\]\:pr-8 .standard-markdown :is(p, blockquote, ul, ol, h1, h2, h3, h4, =
h5, h6) { padding-right: 2rem; }

.\[\&_\.xterm-screen\]\:mx-auto .xterm-screen { margin-left: auto; margin-r=
ight: auto; }

.\[\&_\>_\*\]\:min-w-0 > * { min-width: 0px; }

.\[\&_a\]\:font-medium a { font-weight: 500; }

.\[\&_a\]\:hover\:underline:hover a, .\[\&_a\]\:underline a { text-decorati=
on-line: underline; }

.\[\&_button\.ml-1\]\:\!border-0\.5 button.ml-1 { border-width: 0.5px !impo=
rtant; }

.\[\&_button\.ml-1\]\:\!border-border-200\/30 button.ml-1 { border-color: h=
sl(var(--border-200)/.3) !important; }

.\[\&_button\.ml-1\]\:\!bg-transparent button.ml-1 { background-color: tran=
sparent !important; }

.\[\&_button\.ml-1\]\:\!text-text-000 button.ml-1 { --tw-text-opacity: 1 !i=
mportant; color: hsl(var(--text-000)/var(--tw-text-opacity)) !important; }

.\[\&_button\]\:\!flex button { display: flex !important; }

.\[\&_button\]\:\!h-9 button { height: 2.25rem !important; }

.\[\&_button\]\:\!w-full button { width: 100% !important; }

.\[\&_button\]\:\!text-xs button { font-size: 0.75rem !important; line-heig=
ht: 1rem !important; }

.\[\&_code\]\:bg-transparent code { background-color: transparent; }

.\[\&_code\]\:\!text-xs code { font-size: 0.75rem !important; line-height: =
1rem !important; }

.\[\&_em\]\:italic em { font-style: italic; }

.\[\&_img\]\:\!h-\[150px\] img { height: 150px !important; }

.\[\&_img\]\:\!scale-125 img { --tw-scale-x: 1.25 !important; --tw-scale-y:=
 1.25 !important; transform: translate(var(--tw-translate-x),var(--tw-trans=
late-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-sk=
ew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y)) !important; }

.\[\&_img\]\:\!object-cover img { object-fit: cover !important; }

.\[\&_img\]\:\!object-\[center_60\%\] img { object-position: center 60% !im=
portant; }

.\[\&_input\]\:pointer-events-none input { pointer-events: none; }

.\[\&_input\]\:truncate input { overflow: hidden; text-overflow: ellipsis; =
white-space: nowrap; }

.\[\&_label\]\:hidden label { display: none; }

.\[\&_li\]\:my-0\.5 li { margin-top: 0.125rem; margin-bottom: 0.125rem; }

.\[\&_li\]\:my-1 li, .\[\&_ol\]\:my-1 ol { margin-top: 0.25rem; margin-bott=
om: 0.25rem; }

.\[\&_ol\]\:my-2 ol { margin-top: 0.5rem; margin-bottom: 0.5rem; }

.\[\&_ol\]\:list-decimal ol { list-style-type: decimal; }

.\[\&_ol\]\:pl-4 ol { padding-left: 1rem; }

.\[\&_ol\]\:pl-6 ol { padding-left: 1.5rem; }

.\[\&_p\:first-child\]\:mt-0 p:first-child { margin-top: 0px; }

.\[\&_p\:last-child\]\:mb-0 p:last-child { margin-bottom: 0px; }

.\[\&_p\]\:\!m-0 p { margin: 0px !important; }

.\[\&_p\]\:my-1 p { margin-top: 0.25rem; margin-bottom: 0.25rem; }

.\[\&_p\]\:my-3 p { margin-top: 0.75rem; margin-bottom: 0.75rem; }

.\[\&_p\]\:\!p-0 p { padding: 0px !important; }

.\[\&_p\]\:\!font-base p { font-family: var(--font-ui) !important; font-siz=
e: 0.875rem !important; font-weight: 430 !important; line-height: 1.4 !impo=
rtant; }

.\[\&_pre\>div\]\:border-0\.5 pre > div { border-width: 0.5px; }

.\[\&_pre\>div\]\:border-border-400 pre > div { border-color: hsl(var(--bor=
der-400)/.15); }

.\[\&_pre\>div\]\:bg-bg-000\/50 pre > div { background-color: hsl(var(--bg-=
000)/.5); }

.\[\&_pre\]\:m-0 pre { margin: 0px; }

.\[\&_pre\]\:bg-transparent pre { background-color: transparent; }

.\[\&_pre\]\:\!text-xs pre { font-size: 0.75rem !important; line-height: 1r=
em !important; }

.\[\&_span\]\:\[backface-visibility\:hidden\] span { backface-visibility: h=
idden; }

.\[\&_strong\]\:font-small-bold strong { font-family: var(--font-ui); font-=
size: 0.75rem; font-weight: 600; line-height: 1.4; }

.\[\&_td\]\:px-4 td { padding-left: 1rem; padding-right: 1rem; }

.\[\&_td\]\:py-4 td { padding-top: 1rem; padding-bottom: 1rem; }

.\[\&_textarea\]\:pointer-events-none textarea { pointer-events: none; }

.\[\&_th\]\:px-4 th { padding-left: 1rem; padding-right: 1rem; }

.\[\&_th\]\:pb-4 th { padding-bottom: 1rem; }

.\[\&_ul\]\:my-1 ul { margin-top: 0.25rem; margin-bottom: 0.25rem; }

.\[\&_ul\]\:my-2 ul { margin-top: 0.5rem; margin-bottom: 0.5rem; }

.\[\&_ul\]\:list-disc ul { list-style-type: disc; }

.\[\&_ul\]\:pl-4 ul { padding-left: 1rem; }

.\[\&_ul\]\:pl-6 ul { padding-left: 1.5rem; }

:disabled .\[\*\:disabled_\&\]\:hidden { display: none; }

fieldset:disabled .\[fieldset\:disabled_\&\]\:pointer-events-none { pointer=
-events: none; }

fieldset:disabled .\[fieldset\:disabled_\&\]\:opacity-50 { opacity: 0.5; }

fieldset:not(:disabled) .\[fieldset\:not\(\:disabled\)_\&\]\:hover\:bg-bg-4=
00:hover { --tw-bg-opacity: 1; background-color: hsl(var(--bg-400)/var(--tw=
-bg-opacity)); }

li .\[li_\&\]\:mb-0 { margin-bottom: 0px; }

li .\[li_\&\]\:mt-1 { margin-top: 0.25rem; }

li .\[li_\&\]\:gap-1 { gap: 0.25rem; }
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://claude.ai/_next/static/css/6492ae367fc05efc.css

@charset "utf-8";

pre code.hljs { display: block; overflow-x: auto; padding: 1em; }

code.hljs { padding: 3px 5px; }

.hljs { color: rgb(171, 178, 191); background: rgb(40, 44, 52); }

.hljs-comment, .hljs-quote { color: rgb(92, 99, 112); font-style: italic; }

.hljs-doctag, .hljs-formula, .hljs-keyword { color: rgb(198, 120, 221); }

.hljs-deletion, .hljs-name, .hljs-section, .hljs-selector-tag, .hljs-subst =
{ color: rgb(224, 108, 117); }

.hljs-literal { color: rgb(86, 182, 194); }

.hljs-addition, .hljs-attribute, .hljs-meta .hljs-string, .hljs-regexp, .hl=
js-string { color: rgb(152, 195, 121); }

.hljs-attr, .hljs-number, .hljs-selector-attr, .hljs-selector-class, .hljs-=
selector-pseudo, .hljs-template-variable, .hljs-type, .hljs-variable { colo=
r: rgb(209, 154, 102); }

.hljs-bullet, .hljs-link, .hljs-meta, .hljs-selector-id, .hljs-symbol, .hlj=
s-title { color: rgb(97, 174, 238); }

.hljs-built_in, .hljs-class .hljs-title, .hljs-title.class_ { color: rgb(23=
0, 192, 123); }

.hljs-emphasis { font-style: italic; }

.hljs-strong { font-weight: 700; }

.hljs-link { text-decoration: underline; }

:root { --always-white: 0 0% 100%; --always-black: 0 0% 0%; }

[data-theme=3D"claude"], [data-theme=3D"claude"][data-mode=3D"light"] { --a=
ccent-brand: 15 63.1% 59.6%; --accent-main-000: 15 54.2% 51.2%; --accent-ma=
in-100: 15 54.2% 51.2%; --accent-main-200: 15 63.1% 59.6%; --accent-main-90=
0: 0 0% 0%; --accent-pro-000: 251 34.2% 33.3%; --accent-pro-100: 251 40% 45=
.1%; --accent-pro-200: 251 61% 72.2%; --accent-pro-900: 253 33.3% 91.8%; --=
accent-secondary-000: 210 73.7% 40.2%; --accent-secondary-100: 210 70.9% 51=
.6%; --accent-secondary-200: 210 70.9% 51.6%; --accent-secondary-900: 211 7=
2% 90%; --bg-000: 0 0% 100%; --bg-100: 48 33.3% 97.1%; --bg-200: 53 28.6% 9=
4.5%; --bg-300: 48 25% 92.2%; --bg-400: 50 20.7% 88.6%; --bg-500: 50 20.7% =
88.6%; --border-100: 30 3.3% 11.8%; --border-200: 30 3.3% 11.8%; --border-3=
00: 30 3.3% 11.8%; --border-400: 30 3.3% 11.8%; --danger-000: 0 58.6% 34.1%=
; --danger-100: 0 56.2% 45.4%; --danger-200: 0 56.2% 45.4%; --danger-900: 0=
 50% 95%; --oncolor-100: 0 0% 100%; --oncolor-200: 60 6.7% 97.1%; --oncolor=
-300: 60 6.7% 97.1%; --pictogram-100: 50 20.7% 88.6%; --pictogram-200: 51 1=
6.5% 84.5%; --pictogram-300: 0 0% 100%; --pictogram-400: 48 33.3% 97.1%; --=
success-000: 125 100% 18%; --success-100: 103 72.3% 26.9%; --success-200: 1=
03 72.3% 26.9%; --success-900: 86 45.1% 90%; --text-000: 60 2.6% 7.6%; --te=
xt-100: 60 2.6% 7.6%; --text-200: 60 2.5% 23.3%; --text-300: 60 2.5% 23.3%;=
 --text-400: 51 3.1% 43.7%; --text-500: 51 3.1% 43.7%; --warning-000: 45 91=
.8% 19%; --warning-100: 39 88.8% 28%; --warning-200: 39 88.8% 28%; --warnin=
g-900: 38 65.9% 92%; }

[data-theme=3D"claude"][data-mode=3D"dark"] { --accent-brand: 15 63.1% 59.6=
%; --accent-main-000: 15 54.2% 51.2%; --accent-main-100: 15 63.1% 59.6%; --=
accent-main-200: 15 63.1% 59.6%; --accent-main-900: 0 0% 0%; --accent-pro-0=
00: 251 84.6% 74.5%; --accent-pro-100: 251 40.2% 54.1%; --accent-pro-200: 2=
51 40% 45.1%; --accent-pro-900: 250 25.3% 19.4%; --accent-secondary-000: 21=
0 65.5% 67.1%; --accent-secondary-100: 210 70.9% 51.6%; --accent-secondary-=
200: 210 70.9% 51.6%; --accent-secondary-900: 210 55.9% 24.6%; --bg-000: 60=
 2.1% 18.4%; --bg-100: 60 2.7% 14.5%; --bg-200: 30 3.3% 11.8%; --bg-300: 60=
 2.6% 7.6%; --bg-400: 0 0% 0%; --bg-500: 0 0% 0%; --border-100: 51 16.5% 84=
.5%; --border-200: 51 16.5% 84.5%; --border-300: 51 16.5% 84.5%; --border-4=
00: 51 16.5% 84.5%; --danger-000: 0 98.4% 75.1%; --danger-100: 0 67% 59.6%;=
 --danger-200: 0 67% 59.6%; --danger-900: 0 46.5% 27.8%; --oncolor-100: 0 0=
% 100%; --oncolor-200: 60 6.7% 97.1%; --oncolor-300: 60 6.7% 97.1%; --picto=
gram-100: 48 3.4% 29.2%; --pictogram-200: 60 2.5% 23.3%; --pictogram-300: 6=
0 2.1% 18.4%; --pictogram-400: 60 2.7% 14.5%; --success-000: 97 59.1% 46.1%=
; --success-100: 97 75% 32.9%; --success-200: 97 75% 32.9%; --success-900: =
127 100% 13.9%; --text-000: 48 33.3% 97.1%; --text-100: 48 33.3% 97.1%; --t=
ext-200: 50 9% 73.7%; --text-300: 50 9% 73.7%; --text-400: 48 4.8% 59.2%; -=
-text-500: 48 4.8% 59.2%; --warning-000: 40 71% 50%; --warning-100: 39 93.4=
% 35.9%; --warning-200: 39 93.4% 35.9%; --warning-900: 45 94.8% 15.1%; }

@media (prefers-color-scheme: dark) {
  [data-theme=3D"claude"] { --accent-brand: 15 63.1% 59.6%; --accent-main-0=
00: 15 54.2% 51.2%; --accent-main-100: 15 63.1% 59.6%; --accent-main-200: 1=
5 63.1% 59.6%; --accent-main-900: 0 0% 0%; --accent-pro-000: 251 84.6% 74.5=
%; --accent-pro-100: 251 40.2% 54.1%; --accent-pro-200: 251 40% 45.1%; --ac=
cent-pro-900: 250 25.3% 19.4%; --accent-secondary-000: 210 65.5% 67.1%; --a=
ccent-secondary-100: 210 70.9% 51.6%; --accent-secondary-200: 210 70.9% 51.=
6%; --accent-secondary-900: 210 55.9% 24.6%; --bg-000: 60 2.1% 18.4%; --bg-=
100: 60 2.7% 14.5%; --bg-200: 30 3.3% 11.8%; --bg-300: 60 2.6% 7.6%; --bg-4=
00: 0 0% 0%; --bg-500: 0 0% 0%; --border-100: 51 16.5% 84.5%; --border-200:=
 51 16.5% 84.5%; --border-300: 51 16.5% 84.5%; --border-400: 51 16.5% 84.5%=
; --danger-000: 0 98.4% 75.1%; --danger-100: 0 67% 59.6%; --danger-200: 0 6=
7% 59.6%; --danger-900: 0 46.5% 27.8%; --oncolor-100: 0 0% 100%; --oncolor-=
200: 60 6.7% 97.1%; --oncolor-300: 60 6.7% 97.1%; --pictogram-100: 48 3.4% =
29.2%; --pictogram-200: 60 2.5% 23.3%; --pictogram-300: 60 2.1% 18.4%; --pi=
ctogram-400: 60 2.7% 14.5%; --success-000: 97 59.1% 46.1%; --success-100: 9=
7 75% 32.9%; --success-200: 97 75% 32.9%; --success-900: 127 100% 13.9%; --=
text-000: 48 33.3% 97.1%; --text-100: 48 33.3% 97.1%; --text-200: 50 9% 73.=
7%; --text-300: 50 9% 73.7%; --text-400: 48 4.8% 59.2%; --text-500: 48 4.8%=
 59.2%; --warning-000: 40 71% 50%; --warning-100: 39 93.4% 35.9%; --warning=
-200: 39 93.4% 35.9%; --warning-900: 45 94.8% 15.1%; }
}

[data-theme=3D"console"], [data-theme=3D"console"][data-mode=3D"dark"] { --=
accent-brand: 15 63.1% 59.6%; --accent-main-000: 18 50.4% 47.5%; --accent-m=
ain-100: 18 56.8% 43.5%; --accent-main-200: 19 58.3% 40.4%; --accent-main-9=
00: 16 21.6% 20%; --accent-pro-000: 251 40.2% 54.1%; --accent-pro-100: 251 =
40% 45.1%; --accent-pro-200: 251 34.2% 33.3%; --accent-pro-900: 249 25% 19.=
4%; --accent-secondary-000: 158 68% 32%; --accent-secondary-100: 158 80.4% =
28%; --accent-secondary-200: 158 79.2% 24.5%; --accent-secondary-900: 160 1=
8.1% 16.3%; --bg-000: 0 0% 6%; --bg-100: 0 0% 10%; --bg-200: 0 0% 14%; --bg=
-300: 0 0% 17%; --bg-400: 0 0% 19%; --bg-500: 0 0% 23%; --border-100: 51 16=
.5% 84.5%; --border-200: 51 16.5% 84.5%; --border-300: 51 16.5% 84.5%; --bo=
rder-400: 51 16.5% 84.5%; --danger-000: 4 90.4% 79.5%; --danger-100: 5 91.7=
% 72.5%; --danger-200: 5 58.4% 33.9%; --danger-900: 0 48.2% 16.5%; --oncolo=
r-100: 0 0% 100%; --oncolor-200: 60 6.7% 97.1%; --oncolor-300: 60 6.7% 97.1=
%; --pictogram-100: 48 3.4% 29.2%; --pictogram-200: 60 2.5% 23.3%; --pictog=
ram-300: 0 0% 6%; --pictogram-400: 0 0% 10%; --success-000: 97 50.9% 43.1%;=
 --success-100: 125 100% 18%; --success-200: 125 100% 18%; --success-900: 1=
35 88.2% 10%; --text-000: 0 0% 100%; --text-100: 60 3.7% 94.7%; --text-200:=
 60 1.5% 86.9%; --text-300: 30 1.4% 71.8%; --text-400: 50 0.8% 65.1%; --tex=
t-500: 45 0.6% 48%; --warning-000: 40 71% 50%; --warning-100: 39 93.4% 35.9=
%; --warning-200: 39 93.4% 35.9%; --warning-900: 45 94.8% 15.1%; }

:root { --font-mono: var(--font-jetbrains); --font-ui: var(--font-anthropic=
-sans); --font-ui-serif: var(--font-anthropic-serif); --font-claude-respons=
e: var(--font-anthropic-serif); --font-user-message: var(--font-ui); --font=
-sans-serif: var(--font-ui); --font-serif: var(--font-ui-serif); --font-sys=
tem: system-ui,sans-serif; --font-dyslexia: var(--font-open-dyslexic),"Comi=
c Sans MS",ui-serif,Georgia,serif; }

body, html { font-family: var(--font-ui); }

.font-system { font-family: var(--font-system); }

.font-normal { font-weight: 430; }

.font-medium { font-weight: 550; }

.font-semibold { font-weight: 580; }

.font-bold, .font-bolder, b, strong { font-weight: 600; }

.font-mono, [class*=3D"font-mono"], code, kbd, pre, samp { font-variant-lig=
atures: none; font-feature-settings: "calt" 0, "liga" 0; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-base { font-weight: 400; =
}

[data-theme=3D"claude"][data-mode=3D"dark"] .font-base-bold { font-weight: =
460; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-display { font-weight: 29=
0; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-heading { font-weight: 46=
0; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-large { font-weight: 400;=
 }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-large-bold { font-weight:=
 560; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-small { font-weight: 400;=
 }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-small-bold { font-weight:=
 560; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-title { font-weight: 460;=
 }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-xl { font-weight: 360; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-xl-bold { font-weight: 56=
0; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-claude-response-body { fo=
nt-weight: 360; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-claude-response-body-bold=
 { font-weight: 530; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-claude-response-code, [da=
ta-theme=3D"claude"][data-mode=3D"dark"] .font-claude-response-code-small {=
 font-weight: 360; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-claude-response-heading {=
 font-weight: 530; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-claude-response-small { f=
ont-weight: 360; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-claude-response-small-bol=
d, [data-theme=3D"claude"][data-mode=3D"dark"] .font-claude-response-subhea=
ding, [data-theme=3D"claude"][data-mode=3D"dark"] .font-claude-response-tit=
le { font-weight: 530; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-normal { font-weight: 400=
; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-claude-response { font-we=
ight: 360; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-medium { font-weight: 510=
; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-semibold { font-weight: 5=
40; }

[data-theme=3D"claude"][data-mode=3D"dark"] .font-bold, [data-theme=3D"clau=
de"][data-mode=3D"dark"] .font-bolder, [data-theme=3D"claude"][data-mode=3D=
"dark"] b, [data-theme=3D"claude"][data-mode=3D"dark"] strong { font-weight=
: 530; }
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://claude.ai/_next/static/css/7bf97b7f00340a78.css

@charset "utf-8";

.ToastComponent_toastAnimation__C_5gv[data-state=3D"open"] { animation: 0.2=
s cubic-bezier(0.16, 1, 0.3, 1) 0s 1 reverse forwards running ToastComponen=
t_translateX__VOS8B; }

.ToastComponent_toastAnimation__C_5gv[data-state=3D"closed"] { animation: 0=
.2s ease-in 0s 1 reverse forwards running ToastComponent_fade__yi0F_; }

.ToastComponent_toastAnimation__C_5gv[data-swipe=3D"move"] { transform: tra=
nslateX(var(--radix-toast-swipe-move-x)); }

.ToastComponent_toastAnimation__C_5gv[data-swipe=3D"cancel"] { transform: t=
ranslateX(0px); transition: transform 0.2s ease-out; }

.ToastComponent_toastAnimation__C_5gv[data-swipe=3D"end"] { animation: 0.1s=
 ease-out 0s 1 normal none running ToastComponent_translateX__VOS8B; }

@keyframes ToastComponent_fade__yi0F_ {=20
  0% { opacity: 0; }
  100% { opacity: 1; }
}

@keyframes ToastComponent_translateX__VOS8B {=20
  100% { transform: translateX(100%); }
}
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://claude.ai/_next/static/css/d6bd087f08a7f52f.css

@charset "utf-8";

@font-face { font-family: jetbrains; src: url("/_next/static/media/b8c97eba=
bd0473a4-s.p.woff2") format("woff2"); font-display: swap; font-weight: 400;=
 font-style: normal; }

@font-face { font-family: "jetbrains Fallback"; src: local("Arial"); ascent=
-override: 77.57%; descent-override: 22.82%; line-gap-override: 0%; size-ad=
just: 131.49%; }

.__className_e4195f { font-family: jetbrains, "jetbrains Fallback", ui-mono=
space, SFMono-Regular, Menlo, Monaco, monospace; font-weight: 400; font-sty=
le: normal; }

.__variable_e4195f { --font-jetbrains: "jetbrains","jetbrains Fallback",ui-=
monospace,SFMono-Regular,Menlo,Monaco,monospace; }
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://claude.ai/_next/static/css/c2fb8af2f7b87066.css

@charset "utf-8";

@font-face { font-family: anthropicSans; src: url("/_next/static/media/01d1=
396bd69a228a-s.p.woff2") format("woff2"); font-display: swap; font-weight: =
300 800; font-style: normal; }

@font-face { font-family: anthropicSans; src: url("/_next/static/media/8d6f=
5db32d507c08-s.p.woff2") format("woff2"); font-display: swap; font-weight: =
300 800; font-style: italic; }

@font-face { font-family: "anthropicSans Fallback"; src: local("Arial"); as=
cent-override: 92.99%; descent-override: 24.13%; line-gap-override: 0%; siz=
e-adjust: 106.73%; }

.__className_8d1da5 { font-family: anthropicSans, "anthropicSans Fallback",=
 system-ui, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }

.__variable_8d1da5 { --font-anthropic-sans: "anthropicSans","anthropicSans =
Fallback",system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif; }

@font-face { font-family: anthropicSerif; src: url("/_next/static/media/fe6=
6948be403232d-s.p.woff2") format("woff2"); font-display: swap; font-weight:=
 300 800; font-style: normal; }

@font-face { font-family: anthropicSerif; src: url("/_next/static/media/561=
39cc7a3934d47-s.p.woff2") format("woff2"); font-display: swap; font-weight:=
 300 800; font-style: italic; }

@font-face { font-family: "anthropicSerif Fallback"; src: local("Arial"); a=
scent-override: 93.6%; descent-override: 24.28%; line-gap-override: 0%; siz=
e-adjust: 106.03%; }

.__className_2d8cf6 { font-family: anthropicSerif, "anthropicSerif Fallback=
", Georgia, "Times New Roman", Times, serif; }

.__variable_2d8cf6 { --font-anthropic-serif: "anthropicSerif","anthropicSer=
if Fallback",Georgia,Times New Roman,Times,serif; }

@font-face { font-family: openDyslexic; src: url("/_next/static/media/a7299=
7480c14a9d4-s.p.woff2") format("woff2"); font-display: swap; font-weight: 5=
00; font-style: normal; }

@font-face { font-family: openDyslexic; src: url("/_next/static/media/a0eaf=
ab536ffd221-s.p.woff2") format("woff2"); font-display: swap; font-weight: 5=
00; font-style: italic; }

@font-face { font-family: openDyslexic; src: url("/_next/static/media/b96ac=
cb76593e50d-s.p.woff2") format("woff2"); font-display: swap; font-weight: 4=
00; font-style: normal; }

@font-face { font-family: openDyslexic; src: url("/_next/static/media/d4ad9=
8ce6ee578c0-s.p.woff2") format("woff2"); font-display: swap; font-weight: 4=
00; font-style: italic; }

@font-face { font-family: "openDyslexic Fallback"; src: local("Arial"); asc=
ent-override: 100.7%; descent-override: 40.28%; line-gap-override: 0%; size=
-adjust: 124.14%; }

.__className_e4ce97 { font-family: openDyslexic, "openDyslexic Fallback"; }

.__variable_e4ce97 { --font-open-dyslexic: "openDyslexic","openDyslexic Fal=
lback"; }
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://claude.ai/_next/static/css/05674d3eb9977543.css

@charset "utf-8";

@font-face { font-family: anthropicMono; src: url("/_next/static/media/5ab8=
4f5ed5bd55bd-s.p.woff2") format("woff2"); font-display: swap; font-weight: =
300 800; font-style: normal; }

@font-face { font-family: anthropicMono; src: url("/_next/static/media/c25f=
e61b276783b5-s.p.woff2") format("woff2"); font-display: swap; font-weight: =
300 800; font-style: italic; }

@font-face { font-family: "anthropicMono Fallback"; src: local("Arial"); as=
cent-override: 75.48%; descent-override: 19.58%; line-gap-override: 0%; siz=
e-adjust: 131.49%; }

.__className_5581e8 { font-family: anthropicMono, "anthropicMono Fallback",=
 ui-monospace, SFMono-Regular, Menlo, Monaco, monospace; }

.__variable_5581e8 { --font-anthropic-mono: "anthropicMono","anthropicMono =
Fallback",ui-monospace,SFMono-Regular,Menlo,Monaco,monospace; }
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://claude.ai/_next/static/css/c91ff5f87fd3377b.css

@charset "utf-8";

.react-date-picker { display: inline-flex; position: relative; }

.react-date-picker, .react-date-picker *, .react-date-picker ::after, .reac=
t-date-picker ::before { box-sizing: border-box; }

.react-date-picker--disabled { background-color: rgb(240, 240, 240); color:=
 rgb(109, 109, 109); }

.react-date-picker__wrapper { display: flex; flex-grow: 1; flex-shrink: 0; =
border: thin solid gray; }

.react-date-picker__inputGroup { min-width: calc(4.754em + 12px); flex-grow=
: 1; padding: 0px 2px; box-sizing: content-box; }

.react-date-picker__inputGroup__divider { padding: 1px 0px; white-space: pr=
e; }

.react-date-picker__inputGroup__divider, .react-date-picker__inputGroup__le=
adingZero { display: inline-block; font: inherit; }

.react-date-picker__inputGroup__input { min-width: 0.54em; height: 100%; po=
sition: relative; padding: 0px 1px; border: 0px; background: none; color: c=
urrentcolor; font: inherit; box-sizing: content-box; appearance: textfield;=
 }

.react-date-picker__inputGroup__input::-webkit-inner-spin-button, .react-da=
te-picker__inputGroup__input::-webkit-outer-spin-button { appearance: none;=
 margin: 0px; }

.react-date-picker__inputGroup__input:invalid { background: rgba(255, 0, 0,=
 0.1); }

.react-date-picker__inputGroup__input--hasLeadingZero { margin-left: -0.54e=
m; padding-left: calc(0.54em + 1px); }

.react-date-picker__button { border: 0px; background: transparent; padding:=
 4px 6px; }

.react-date-picker__button:enabled { cursor: pointer; }

.react-date-picker__button:enabled:focus .react-date-picker__button__icon, =
.react-date-picker__button:enabled:hover .react-date-picker__button__icon {=
 stroke: rgb(0, 120, 215); }

.react-date-picker__button:disabled .react-date-picker__button__icon { stro=
ke: rgb(109, 109, 109); }

.react-date-picker__button svg { display: inherit; }

.react-date-picker__calendar { width: 350px; max-width: 100vw; z-index: 1; =
}

.react-date-picker__calendar--closed { display: none; }

.react-date-picker__calendar .react-calendar { border-width: thin; }

.react-date-picker input:focus, .react-date-picker input:invalid { outline:=
 0px; box-shadow: none; background: none; }

.react-date-picker__wrapper { border: 0px; }

:root { --PhoneInput-color--focus: #03b2cb; --PhoneInputInternationalIconPh=
one-opacity: 0.8; --PhoneInputInternationalIconGlobe-opacity: 0.65; --Phone=
InputCountrySelect-marginRight: 0.35em; --PhoneInputCountrySelectArrow-widt=
h: 0.3em; --PhoneInputCountrySelectArrow-marginLeft: var(--PhoneInputCountr=
ySelect-marginRight); --PhoneInputCountrySelectArrow-borderWidth: 1px; --Ph=
oneInputCountrySelectArrow-opacity: 0.45; --PhoneInputCountrySelectArrow-co=
lor: currentColor; --PhoneInputCountrySelectArrow-color--focus: var(--Phone=
Input-color--focus); --PhoneInputCountrySelectArrow-transform: rotate(45deg=
); --PhoneInputCountryFlag-aspectRatio: 1.5; --PhoneInputCountryFlag-height=
: 1em; --PhoneInputCountryFlag-borderWidth: 1px; --PhoneInputCountryFlag-bo=
rderColor: rgba(0,0,0,0.5); --PhoneInputCountryFlag-borderColor--focus: var=
(--PhoneInput-color--focus); --PhoneInputCountryFlag-backgroundColor--loadi=
ng: rgba(0,0,0,0.1); }

.PhoneInput { display: flex; align-items: center; }

.PhoneInputInput { flex: 1 1 0%; min-width: 0px; }

.PhoneInputCountryIcon { width: calc(var(--PhoneInputCountryFlag-height) * =
var(--PhoneInputCountryFlag-aspectRatio)); height: var(--PhoneInputCountryF=
lag-height); }

.PhoneInputCountryIcon--square { width: var(--PhoneInputCountryFlag-height)=
; }

.PhoneInputCountryIcon--border { background-color: var(--PhoneInputCountryF=
lag-backgroundColor--loading); box-shadow: 0 0 0 var(--PhoneInputCountryFla=
g-borderWidth) var(--PhoneInputCountryFlag-borderColor),inset 0 0 0 var(--P=
honeInputCountryFlag-borderWidth) var(--PhoneInputCountryFlag-borderColor);=
 }

.PhoneInputCountryIconImg { display: block; width: 100%; height: 100%; }

.PhoneInputInternationalIconPhone { opacity: var(--PhoneInputInternationalI=
conPhone-opacity); }

.PhoneInputInternationalIconGlobe { opacity: var(--PhoneInputInternationalI=
conGlobe-opacity); }

.PhoneInputCountry { position: relative; align-self: stretch; display: flex=
; align-items: center; margin-right: var(--PhoneInputCountrySelect-marginRi=
ght); }

.PhoneInputCountrySelect { position: absolute; top: 0px; left: 0px; height:=
 100%; width: 100%; z-index: 1; border: 0px; opacity: 0; cursor: pointer; }

.PhoneInputCountrySelect[disabled], .PhoneInputCountrySelect[readonly] { cu=
rsor: default; }

.PhoneInputCountrySelectArrow { display: block; content: ""; width: var(--P=
honeInputCountrySelectArrow-width); height: var(--PhoneInputCountrySelectAr=
row-width); margin-left: var(--PhoneInputCountrySelectArrow-marginLeft); bo=
rder-style: solid; border-color: var(--PhoneInputCountrySelectArrow-color);=
 border-top-width: 0px; border-bottom-width: var(--PhoneInputCountrySelectA=
rrow-borderWidth); border-left-width: 0px; border-right-width: var(--PhoneI=
nputCountrySelectArrow-borderWidth); transform: var(--PhoneInputCountrySele=
ctArrow-transform); opacity: var(--PhoneInputCountrySelectArrow-opacity); }

.PhoneInputCountrySelect:focus + .PhoneInputCountryIcon + .PhoneInputCountr=
ySelectArrow { opacity: 1; color: var(--PhoneInputCountrySelectArrow-color-=
-focus); }

.PhoneInputCountrySelect:focus + .PhoneInputCountryIcon--border { box-shado=
w: 0 0 0 var(--PhoneInputCountryFlag-borderWidth) var(--PhoneInputCountryFl=
ag-borderColor--focus),inset 0 0 0 var(--PhoneInputCountryFlag-borderWidth)=
 var(--PhoneInputCountryFlag-borderColor--focus); }

.PhoneInputCountrySelect:focus + .PhoneInputCountryIcon .PhoneInputInternat=
ionalIconGlobe { opacity: 1; color: var(--PhoneInputCountrySelectArrow-colo=
r--focus); }
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: https://claude.ai/_next/static/css/f614b4fc9a5ddba6.css

@charset "utf-8";

.Button_primary__0oSjX { --button-bg: hsl(var(--text-000)); --button-text: =
hsl(var(--bg-000)); --button-border: transparent; --button-hover-bg: hsl(va=
r(--text-000)); --button-hover-text: hsl(var(--bg-000)); --button-hover-bor=
der: transparent; --button-focus-outline: hsl(var(--text-000)/75%); --butto=
n-loading-color: hsl(var(--bg-000)); background-color: var(--button-bg); co=
lor: var(--button-text); border-color: var(--button-border); }

.Button_primary__0oSjX:hover:not(:disabled) { background-color: var(--butto=
n-hover-bg); color: var(--button-hover-text); border-color: var(--button-ho=
ver-border); }

.Button_primary__0oSjX:focus-visible { outline-color: var(--button-focus-ou=
tline); }

.Button_secondary__Teecd { --button-bg: transparent; --button-text: hsl(var=
(--text-000)); --button-border: hsl(var(--border-200)/30%); --button-hover-=
bg: hsl(var(--bg-400)); --button-hover-text: hsl(var(--text-000)); --button=
-hover-border: transparent; --button-loading-color: hsl(var(--text-400)); b=
ackground-color: var(--button-bg); color: var(--button-text); border-color:=
 var(--button-border); }

.Button_secondary__Teecd:hover:not(:disabled) { background-color: var(--but=
ton-hover-bg); color: var(--button-hover-text); border-color: var(--button-=
hover-border); }

.Button_ghost__BUAoh { --button-bg: transparent; --button-text: hsl(var(--t=
ext-300)); --button-border: transparent; --button-hover-bg: hsl(var(--bg-30=
0)); --button-hover-text: hsl(var(--text-100)); --button-hover-border: tran=
sparent; --button-loading-color: hsl(var(--bg-300)); background-color: var(=
--button-bg); color: var(--button-text); border-color: var(--button-border)=
; }

.Button_ghost__BUAoh:hover:not(:disabled):not(:active):not([aria-expanded=
=3D"true"]) { background-color: var(--button-hover-bg); color: var(--button=
-hover-text); border-color: var(--button-hover-border); }

.Button_ghost__BUAoh:active:not(:disabled), .Button_ghost__BUAoh[aria-check=
ed=3D"true"], .Button_ghost__BUAoh[aria-expanded=3D"true"] { background-col=
or: hsl(var(--bg-300)); }

.Button_ghost__BUAoh[aria-checked=3D"true"], .Button_ghost__BUAoh[aria-expa=
nded=3D"true"], .Button_ghost__BUAoh[aria-pressed=3D"true"] { color: hsl(va=
r(--text-100)); }

.Button_danger__cHFE4 { --button-bg: hsl(var(--danger-200)); --button-text:=
 hsl(var(--oncolor-100)); --button-border: transparent; --button-hover-bg: =
hsl(var(--danger-200)); --button-hover-text: hsl(var(--oncolor-100)); --but=
ton-hover-border: transparent; --button-focus-outline: hsl(var(--danger-100=
)/50%); --button-loading-color: hsl(var(--bg-000)); background-color: var(-=
-button-bg); color: var(--button-text); border-color: var(--button-border);=
 }

.Button_danger__cHFE4:hover:not(:disabled) { background-color: var(--button=
-hover-bg); color: var(--button-hover-text); border-color: var(--button-hov=
er-border); }

.Button_danger__cHFE4:focus-visible { outline-color: var(--button-focus-out=
line); }

.Button_claude__c_hZy { --button-bg: hsl(var(--accent-main-000)); --button-=
text: hsl(var(--oncolor-100)); --button-border: transparent; --button-hover=
-bg: hsl(var(--accent-main-200)); --button-hover-text: hsl(var(--oncolor-10=
0)); --button-hover-border: transparent; --button-focus-outline: hsl(var(--=
accent-main-100)/75%); --button-loading-color: hsl(var(--bg-000)); backgrou=
nd-color: var(--button-bg); color: var(--button-text); border-color: var(--=
button-border); }

.Button_claude__c_hZy:hover:not(:disabled) { background-color: var(--button=
-hover-bg); color: var(--button-hover-text); border-color: var(--button-hov=
er-border); }

.Button_claude__c_hZy:focus-visible { outline-color: var(--button-focus-out=
line); }

.Button_loadingSpinner__tPfus { color: var(--button-loading-color); }

[data-color-context=3D"main"] .Button_colorized__tnnfC.Button_ghost__BUAoh =
{ --button-hover-bg: hsl(var(--bg-400)); }

[data-color-context=3D"danger"] .Button_colorized__tnnfC.Button_primary__0o=
SjX { --button-bg: hsl(var(--danger-100)); --button-text: hsl(var(--oncolor=
-100)); --button-hover-bg: hsl(var(--danger-200)); --button-hover-text: hsl=
(var(--oncolor-100)); --button-loading-color: hsl(var(--oncolor-100)); }

[data-color-context=3D"danger"] .Button_colorized__tnnfC.Button_secondary__=
Teecd { --button-text: hsl(var(--danger-000)); --button-border: hsl(var(--d=
anger-100)); --button-hover-bg: hsl(var(--danger-100)/10%); --button-hover-=
text: hsl(var(--danger-000)); --button-hover-border: hsl(var(--danger-200))=
; --button-loading-color: hsl(var(--danger-000)); }

[data-color-context=3D"danger"] .Button_colorized__tnnfC.Button_ghost__BUAo=
h { --button-text: hsl(var(--danger-000)); --button-hover-bg: hsl(var(--dan=
ger-100)/8%); --button-hover-text: hsl(var(--danger-000)); --button-loading=
-color: hsl(var(--danger-000)); }
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: cid:css-1e190b87-6176-45b6-838d-9e1d95d6047f@mhtml.blink

@charset "utf-8";

@keyframes intercom-lightweight-app-launcher {=20
  0% { opacity: 0; transform: scale(0.5); }
  100% { opacity: 1; transform: scale(1); }
}

@keyframes intercom-lightweight-app-gradient {=20
  0% { opacity: 0; }
  100% { opacity: 1; }
}

@keyframes intercom-lightweight-app-messenger {=20
  0% { opacity: 0; transform: scale(0); }
  40% { opacity: 1; }
  100% { transform: scale(1); }
}

.intercom-lightweight-app { position: fixed; z-index: 2147483001; width: 0p=
x; height: 0px; font-family: system-ui, "Segoe UI", Roboto, Helvetica, Aria=
l, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; }

.intercom-lightweight-app-gradient { position: fixed; z-index: 2147483002; =
width: 500px; height: 500px; bottom: 0px; right: 0px; pointer-events: none;=
 background: radial-gradient(at right bottom, rgba(29, 39, 54, 0.16) 0%, rg=
ba(29, 39, 54, 0) 72%); animation: 200ms ease-out 0s 1 normal none running =
intercom-lightweight-app-gradient; }

.intercom-lightweight-app-launcher { position: fixed; z-index: 2147483003; =
border: none; bottom: 20px; right: 20px; max-width: 48px; width: 48px; max-=
height: 48px; height: 48px; border-radius: 50%; background: rgb(0, 153, 204=
); cursor: pointer; box-shadow: rgba(0, 0, 0, 0.06) 0px 1px 6px 0px, rgba(0=
, 0, 0, 0.16) 0px 2px 32px 0px; transition: transform 167ms cubic-bezier(0.=
33, 0, 0, 1); box-sizing: content-box; padding: 0px !important; margin: 0px=
 !important; }

.intercom-lightweight-app-launcher:hover { transition: transform 250ms cubi=
c-bezier(0.33, 0, 0, 1); transform: scale(1.1); }

.intercom-lightweight-app-launcher:active { transform: scale(0.85); transit=
ion: transform 134ms cubic-bezier(0.45, 0, 0.2, 1); }

.intercom-lightweight-app-launcher:focus { outline: none; }

.intercom-lightweight-app-launcher-icon { display: flex; align-items: cente=
r; justify-content: center; position: absolute; top: 0px; left: 0px; width:=
 48px; height: 48px; transition: transform 100ms linear, opacity 80ms linea=
r; }

.intercom-lightweight-app-launcher-icon-open { opacity: 1; transform: rotat=
e(0deg) scale(1); }

.intercom-lightweight-app-launcher-icon-open svg { width: 24px; height: 24p=
x; }

.intercom-lightweight-app-launcher-icon-open svg path { fill: rgb(255, 255,=
 255); }

.intercom-lightweight-app-launcher-icon-self-serve { opacity: 1; transform:=
 rotate(0deg) scale(1); }

.intercom-lightweight-app-launcher-icon-self-serve svg { height: 44px; }

.intercom-lightweight-app-launcher-icon-self-serve svg path { fill: rgb(255=
, 255, 255); }

.intercom-lightweight-app-launcher-custom-icon-open { max-height: 24px; max=
-width: 24px; opacity: 1; transform: rotate(0deg) scale(1); }

.intercom-lightweight-app-launcher-icon-minimize { opacity: 0; transform: r=
otate(-60deg) scale(0); }

.intercom-lightweight-app-launcher-icon-minimize svg path { fill: rgb(255, =
255, 255); }

.intercom-lightweight-app-launcher.intercom-launcher-extended { width: calc=
(150px); max-width: calc(150px); height: calc(19px); max-height: calc(19px)=
; border-radius: 12px; display: flex; align-items: center; justify-content:=
 flex-start; gap: 6px; background: rgb(0, 153, 204); border: 1px solid rgba=
(255, 255, 255, 0.15); box-shadow: rgba(0, 0, 0, 0.1) 0px -2px 50px; paddin=
g: 12px 16px 12px 12px !important; }

.intercom-lightweight-app-launcher.intercom-launcher-extended .intercom-lig=
htweight-app-launcher-icon { position: relative; width: 24px; height: 24px;=
 }

.intercom-lightweight-app-launcher-text { color: rgb(255, 255, 255); font-s=
ize: 14px; font-weight: 600; line-height: 1.5; white-space: nowrap; overflo=
w: hidden; text-overflow: ellipsis; max-width: 140px; opacity: 1; transitio=
n: opacity 80ms linear; }

.intercom-lightweight-app-messenger { position: fixed; z-index: 2147483003;=
 overflow: hidden; background-color: rgb(255, 255, 255); animation: 250ms c=
ubic-bezier(0, 1, 1, 1) 0s 1 normal none running intercom-lightweight-app-m=
essenger; transform-origin: right bottom; width: 400px; height: calc(100% -=
 40px); max-height: 704px; min-height: 250px; right: 20px; bottom: 20px; bo=
x-shadow: rgba(0, 0, 0, 0.16) 0px 5px 40px; border-radius: 24px; }

.intercom-lightweight-app-messenger-header { height: 64px; border-bottom: n=
one; background: rgb(255, 255, 255); }

.intercom-lightweight-app-messenger-footer { position: absolute; bottom: 0p=
x; width: 100%; height: 80px; background: rgb(255, 255, 255); font-size: 14=
px; line-height: 21px; border-top: 1px solid rgba(0, 0, 0, 0.05); box-shado=
w: rgba(0, 0, 0, 0.05) 0px 0px 25px; }

@media print {
  .intercom-lightweight-app { display: none; }
}
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: cid:css-1215cd83-0cc1-4c2c-b167-cc23622e7f4c@mhtml.blink

@charset "utf-8";

.ProseMirror { position: relative; }

.ProseMirror { overflow-wrap: break-word; white-space: break-spaces; font-v=
ariant-ligatures: none; font-feature-settings: "liga" 0; }

.ProseMirror [contenteditable=3D"false"] { white-space: normal; }

.ProseMirror [contenteditable=3D"false"] [contenteditable=3D"true"] { white=
-space: pre-wrap; }

.ProseMirror pre { white-space: pre-wrap; }

img.ProseMirror-separator { display: inline !important; border: none !impor=
tant; margin: 0px !important; width: 0px !important; height: 0px !important=
; }

.ProseMirror-gapcursor { display: none; pointer-events: none; position: abs=
olute; margin: 0px; }

.ProseMirror-gapcursor::after { content: ""; display: block; position: abso=
lute; top: -2px; width: 20px; border-top: 1px solid black; animation: 1.1s =
steps(2, start) 0s infinite normal none running ProseMirror-cursor-blink; }

@keyframes ProseMirror-cursor-blink {=20
  100% { visibility: hidden; }
}

.ProseMirror-hideselection ::selection { background: transparent; }

.ProseMirror-hideselection * { caret-color: transparent; }

.ProseMirror-focused .ProseMirror-gapcursor { display: block; }
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: cid:css-3693dc1a-8511-4425-bfe1-f034accf4b16@mhtml.blink

@charset "utf-8";

.qJTHM { user-select: none; color: rgb(32, 33, 36); direction: ltr; font-fa=
mily: Roboto-Regular, arial, sans-serif; -webkit-font-smoothing: antialiase=
d; font-weight: 400; margin: 0px; overflow: hidden; text-size-adjust: 100%;=
 }

.ynRLnc { left: -9999px; position: absolute; top: -9999px; }

.L6cTce { display: none; }

.bltWBb { overflow-wrap: break-word; word-break: break-word; }

.hSRGPd { color: rgb(26, 115, 232); cursor: pointer; font-weight: 500; text=
-decoration: none; }

.Bz112c-W3lGp { height: 16px; width: 16px; }

.Bz112c-E3DyYd { height: 20px; width: 20px; }

.Bz112c-r9oPif { height: 24px; width: 24px; }

.Bz112c-u2z5K { height: 36px; width: 36px; }

.Bz112c-uaxL4e { border-radius: 10px; }

.LgbsSe-Bz112c { display: block; }

.S9gUrf-YoZ4jf { border: none; margin: 0px; padding: 0px; }

.S9gUrf-YoZ4jf * { border: none; margin: 0px; padding: 0px; }

.fFW7wc-ibnC6b > .aZ2wEe > div { border-color: rgb(66, 133, 244); }

.P1ekSe-ZMv3u { transition: height 0.2s linear; }

.P1ekSe-ZMv3u > div:nth-child(1) { transition: width 0.3s linear; backgroun=
d-color: rgb(26, 115, 232) !important; }

.P1ekSe-ZMv3u > div:nth-child(2) { background-image: linear-gradient(to rig=
ht, rgba(255, 255, 255, 0.7), rgba(255, 255, 255, 0.7)), linear-gradient(to=
 right, rgb(26, 115, 232), rgb(26, 115, 232)) !important; }

.P1ekSe-ZMv3u > div:nth-child(3) { background-image: linear-gradient(to rig=
ht, rgba(255, 255, 255, 0.7), rgba(255, 255, 255, 0.7)), linear-gradient(to=
 right, rgb(26, 115, 232), rgb(26, 115, 232)) !important; }

.haAclf { display: inline-block; }

.nsm7Bb-HzV7m-LgbsSe { border-radius: 4px; box-sizing: border-box; transiti=
on: background-color 0.218s, border-color 0.218s; user-select: none; appear=
ance: none; background-color: rgb(255, 255, 255); background-image: none; b=
order: 1px solid rgb(218, 220, 224); color: rgb(60, 64, 67); cursor: pointe=
r; font-family: "Google Sans", arial, sans-serif; font-size: 14px; height: =
40px; letter-spacing: 0.25px; outline: none; overflow: hidden; padding: 0px=
 12px; position: relative; text-align: center; vertical-align: middle; whit=
e-space: nowrap; width: auto; }

@media screen and (-ms-high-contrast:active) {
  .nsm7Bb-HzV7m-LgbsSe { border: 2px solid windowtext; color: windowtext; }
}

@media screen and (preferes-contrast:more) {
  .nsm7Bb-HzV7m-LgbsSe { color: rgb(0, 0, 0); }
}

.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe { font-size: 14px; height: 32px; letter-s=
pacing: 0.25px; padding: 0px 10px; }

.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe { font-size: 11px; height: 20px; letter-s=
pacing: 0.3px; padding: 0px 8px; }

.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe { padding: 0px; width: 40px; }

.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe { width: 32px; }

.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe { width: 20px; }

.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK { border-radius: 20px; }

.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.pSzOP-SxQuSe { border-radius: 16px; }

.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK.purZT-SxQuSe { border-radius: 10px; }

.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc { border: none; color: rgb(255, 255, 255=
); }

.nsm7Bb-HzV7m-LgbsSe.MFS4be-v3pZbf-Ia7Qfc { background-color: rgb(26, 115, =
232); }

.nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc { background-color: rgb(32, 33, 3=
6); color: rgb(232, 234, 237); }

@media screen and (prefers-contrast: more) {
  .nsm7Bb-HzV7m-LgbsSe.MFS4be-JaPV2b-Ia7Qfc { color: rgb(255, 255, 255); }
}

.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c { height: 18px; margin-rig=
ht: 8px; min-width: 18px; width: 18px; }

.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c { height: 14p=
x; min-width: 14px; width: 14px; }

.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c { height: 10p=
x; min-width: 10px; width: 10px; }

.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c { margin-left: 8px;=
 margin-right: -4px; }

.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c { margin: 0p=
x; padding: 10px; }

.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c=
 { padding: 8px; }

.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c=
 { padding: 4px; }

.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf { border-top-left-r=
adius: 3px; border-bottom-left-radius: 3px; display: flex; -webkit-box-pack=
: center; justify-content: center; -webkit-box-align: center; align-items: =
center; background-color: rgb(255, 255, 255); height: 36px; margin-left: -1=
0px; margin-right: 12px; min-width: 36px; width: 36px; }

.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf .nsm7Bb-HzV7m-LgbsS=
e-Bz112c, .nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-ha=
Aclf .nsm7Bb-HzV7m-LgbsSe-Bz112c { margin: 0px; padding: 0px; }

.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf { heig=
ht: 28px; margin-left: -8px; margin-right: 10px; min-width: 28px; width: 28=
px; }

.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf { heig=
ht: 16px; margin-left: -6px; margin-right: 8px; min-width: 16px; width: 16p=
x; }

.nsm7Bb-HzV7m-LgbsSe.Bz112c-LgbsSe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf { bor=
der-radius: 3px; margin-left: 2px; margin-right: 0px; padding: 0px; }

.nsm7Bb-HzV7m-LgbsSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf { borde=
r-radius: 18px; }

.nsm7Bb-HzV7m-LgbsSe.pSzOP-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-h=
aAclf { border-radius: 14px; }

.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-h=
aAclf { border-radius: 8px; }

.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-bN97Pc-sM5MNb { display: flex; -w=
ebkit-box-align: center; align-items: center; -webkit-box-orient: horizonta=
l; -webkit-box-direction: normal; flex-flow: row; -webkit-box-pack: justify=
; justify-content: space-between; height: 100%; position: relative; width: =
100%; }

.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX { -webkit-box-pack: center; justify-cont=
ent: center; }

.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-BPrWId { -webkit-box-flex: 1; fle=
x-grow: 1; font-family: "Google Sans", arial, sans-serif; font-weight: 500;=
 overflow: hidden; text-overflow: ellipsis; vertical-align: top; }

.nsm7Bb-HzV7m-LgbsSe.purZT-SxQuSe .nsm7Bb-HzV7m-LgbsSe-BPrWId { font-weight=
: 300; }

.nsm7Bb-HzV7m-LgbsSe .oXtfBe-l4eHX .nsm7Bb-HzV7m-LgbsSe-BPrWId { -webkit-bo=
x-flex: 0; flex-grow: 0; }

.nsm7Bb-HzV7m-LgbsSe .nsm7Bb-HzV7m-LgbsSe-MJoBVe { transition: background-c=
olor 0.218s; inset: 0px; position: absolute; }

.nsm7Bb-HzV7m-LgbsSe:hover, .nsm7Bb-HzV7m-LgbsSe:focus { box-shadow: none; =
border-color: rgb(210, 227, 252); outline: none; }

.nsm7Bb-HzV7m-LgbsSe:focus-within { outline: rgb(0, 99, 155) solid 2px; bor=
der-color: transparent; }

.nsm7Bb-HzV7m-LgbsSe:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe { background: rgba(6=
6, 133, 244, 0.08); }

.nsm7Bb-HzV7m-LgbsSe:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe, .nsm7Bb-HzV7m-Lgbs=
Se:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe { background: rgba(66, 133, 244, 0.1);=
 }

.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:hover .nsm7Bb-HzV7m-LgbsSe-MJoBVe { back=
ground: rgba(255, 255, 255, 0.24); }

.nsm7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:active .nsm7Bb-HzV7m-LgbsSe-MJoBVe, .nsm=
7Bb-HzV7m-LgbsSe.MFS4be-Ia7Qfc:focus .nsm7Bb-HzV7m-LgbsSe-MJoBVe { backgrou=
nd: rgba(255, 255, 255, 0.32); }

.nsm7Bb-HzV7m-LgbsSe .n1UuX-DkfjY { border-radius: 50%; display: flex; heig=
ht: 20px; margin-left: -4px; margin-right: 8px; min-width: 20px; width: 20p=
x; }

.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId { font-family: Robo=
to; font-size: 12px; text-align: left; }

.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .ssJRIf, .nsm7Bb-Hz=
V7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .fmcmS { overflow: hi=
dden; text-overflow: ellipsis; }

.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff { display: =
flex; -webkit-box-align: center; align-items: center; color: rgb(95, 99, 10=
4); fill: rgb(95, 99, 104); font-size: 11px; font-weight: 400; }

.nsm7Bb-HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4ef=
ff { color: rgb(232, 234, 237); fill: rgb(232, 234, 237); }

@media screen and (prefers-contrast: more) {
  .nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff, .nsm7Bb-=
HzV7m-LgbsSe.jVeSEe.MFS4be-Ia7Qfc .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff { col=
or: rgb(0, 0, 0); fill: rgb(0, 0, 0); }
}

.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-BPrWId .K4efff .Bz112c { h=
eight: 18px; margin: -3px -3px -3px 2px; min-width: 18px; width: 18px; }

.nsm7Bb-HzV7m-LgbsSe.jVeSEe .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf { border-rad=
ius: 0px 3px 3px 0px; margin-left: 12px; margin-right: -10px; }

.nsm7Bb-HzV7m-LgbsSe.jVeSEe.JGcpL-RbRzK .nsm7Bb-HzV7m-LgbsSe-Bz112c-haAclf =
{ border-radius: 18px; }

.L5Fo6c-sM5MNb { border: 0px; display: block; left: 0px; position: relative=
; top: 0px; }

.L5Fo6c-bF1uUb { border-radius: 4px; inset: 0px; cursor: pointer; position:=
 absolute; }

.L5Fo6c-bF1uUb:focus { border: none; outline: none; }

sentinel { }
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/html
Content-ID: <frame-AECE4FD5239B1B17A0428FB165CC310C@mhtml.blink>
Content-Transfer-Encoding: quoted-printable

<html lang=3D"en"><head><meta http-equiv=3D"Content-Type" content=3D"text/h=
tml; charset=3DUTF-8"></head>
      <body>
     =20
    </body></html>
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/html
Content-ID: <frame-C2843BBD6A504116A121C1027C02F4E5@mhtml.blink>
Content-Transfer-Encoding: quoted-printable
Content-Location: https://a.claude.ai/isolated-segment.html?v=afaa5fafb1

<!DOCTYPE html><html lang=3D"en"><head><meta http-equiv=3D"Content-Type" co=
ntent=3D"text/html; charset=3DUTF-8">
   =20
   =20
   =20
  </head>
  <body>
   =20
  <iframe height=3D"1" width=3D"1" style=3D"position: absolute; top: 0px; l=
eft: 0px; border: none; visibility: hidden;"></iframe>

</body></html>
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj----
Content-Type: text/html
Content-ID: <frame-1412B3AAC6187FF99AD1DF877EA630C4@mhtml.blink>
Content-Transfer-Encoding: quoted-printable

<html><head><meta http-equiv=3D"Content-Type" content=3D"text/html; charset=
=3DUTF-8"></head><body></body></html>
------MultipartBoundary--UJyNjtqP5tKEsm1hq105AICsDVfIDJiA527iLg7fqj------
